(self.webpackChunksmart_edit=self.webpackChunksmart_edit||[]).push([[585],{13032:function(t,e,n){"use strict";var s=n(53685),i=n(30888),a=n(53823),r=n(69903),o=n(59415),c=n(48257),u=n(78473),l=n(73014),d=n(46881),h=n(79326),p=n(13274),m=n(95920),g=function(t){function e(){return(0,c.A)(this,e),(0,l.A)(this,e,arguments)}return(0,d.A)(e,t),(0,u.A)(e,[{key:"name",value:function(){return"SmartEditorPlugin"}},{key:"beforeCall",value:function(t){var e=t.params,n=t.event,s=t;return"request"===n&&(s={event:n,params:(0,a.A)((0,a.A)({},e),{},{data:JSON.stringify(e.data)})}),new Promise((function(t,e){t(s)}))}},{key:"afterCall",value:function(t){switch(t.request().event){case"getCache":var e,n=null===(e=t.result.data)||void 0===e?void 0:e.data;n&&(t.result.data=JSON.parse(decodeURIComponent(n)));break;case"request":t.result.data=t.result.data.response}}}])}(h.h),M=new m.A,f=new g;p.Ay.use(M),p.Ay.use(f),window.Capcut={JSBridge:window.JSBridge};var v=JSON.parse('{"mob_chatbot_copy":"Copy","mob_chatbot_addtoeditor":"Add to text edit","mob_chatbot_welcome_message":"What will you create today?","mob_chatbot_Noticeofuse":"Notice","mob_chatbot_typepanel_placeholder text":"Ask me to...","mob_chatbot_chat_warning":"AI responses might be inaccurate.","mob_chatbot_speechbubble_thinking":"Working on it...","mob_chatbot_Noticeofuse_gotit":"OK","copy_success":"Copied","network_error_please_retry":"No internet connection. Connect to the internet and try again.","has_cleared_context":"Context cleared","mob_chatbot_productname":"Ask bot","mob_chatbot_lackability":"Sorry, I\u2019m not able to do that for now. Try asking me something else.","mob_chatbot_dislike":"Dislike","mob_chatbot_quote":"Quote","mob_chatbot_externalexternal":"Quote the text in the editor?","mob_chatbot_generation_stopped":"Generation Stopped","mob_chatbot_safe_notice":"This content may pose a safety risk. Please ask your question again."}');function x(t){return v[t]}var N,y=n(48332),j=n(75168),w=n(50724),z=n(42459),b=n(42719),_=n.n(b),C=Object.defineProperty,A=(t,e)=>{for(var n in e)C(t,n,{get:e[n],enumerable:!0})},I=(t,e,n)=>(((t,e,n)=>{e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),S={apiUrl:{base:"",upsert(){return`${this.base}/aigc/conversation/text_generation_upsert`},upsertStream(){return`${this.base}/aigc/conversation/text_generation_upsert_stream`},cancelStream(){return`${this.base}/aigc/conversation/text_generation_cancel`}},cacheKey:{agreement(){return"p2t.auth.agreed"},staticConfig(){return"p2t.settings.static"},serializedSession(){return"p2t.session.serialized"}}},T={cache:{get(t){throw new Error("Lib.cache.get not implemented")},set(t){throw new Error("Lib.cache.set not implemented")}},app:{request(t){throw new Error("Lib.app.request not implemented.")}},i18n:{t(t,e){throw new Error("Lib.i18n.t not implemented.")}}};(t=>{let e;var n;let s;(n=e=t.Initiator||(t.Initiator={})).User="user",n.System="system",(s=t.Script||(t.Script={})).create=function(t,e){return t.init=e.init,t}})(N||(N={}));var D={};function k(t){return T.app.request({method:"POST",url:S.apiUrl.upsert(),data:{...t},needCommonParams:!0,timeout_ms:9e4})}function L(t){return T.app.request({method:"POST",url:S.apiUrl.upsertStream(),data:{...t},needCommonParams:!0,timeout_ms:9e4})}function E(t){return T.app.request({method:"POST",url:S.apiUrl.cancelStream(),data:{...t},needCommonParams:!0,timeout_ms:9e4})}A(D,{cancelStream:()=>E,upsert:()=>k,upsertStream:()=>L});var P=D,Q=class{constructor(t){this.state=t}},O={},Y=new class{bind(t,e){O[t]=e}},U=new Proxy(Y,{get(t,e,n){return e in t||(t[e]=O[e]()),t[e]}}),Z=class extends Q{upsert(t){return P.upsert({...t,session_id:U.Session.state.upsertSessionId.$value,host_info:{}})}upsertStream(t){const e={...t,session_id:U.Session.state.upsertSessionId.$value,uuid:U.Session.state.uuid.$value};return U.API.state.params.update(e),P.upsertStream(e)}cancelStream(){const{upsertSessionId:t,upsertQueryId:e}=U.Session.state.$value;if(e)return P.cancelStream({query_id:t,session_id:e})}},V=class extends Q{async init(){const t=S.cacheKey.agreement(),e=await T.cache.get({key:t});this.state.update({agreed:null==e?void 0:e.agreed})}agree(){this.state.update({agreed:!0});T.cache.set({key:S.cacheKey.agreement(),value:{agreed:!0}})}},R=class extends Q{select(t){this.state.update({selecting:t})}confirm(t){this.state.update({confirmed:t,selecting:null})}},W=class extends Q{focus(t={}){const e=this.state.$value,{prompt:n=e.prompt}=t;this.state.update({focus:!0,prompt:n})}blur(){this.state.update({focus:!1})}update(t){this.state.update({...this.state.$value,...t})}},H=class{constructor(t){I(this,"session"),this.session=t}get API(){return U.API}prompt(...t){this.session.prompt(...t)}hide(t){this.session.hide(t)}has(t){return this.session.has(t)}run(t,e){return this.session.run(t,e)}update(t,e){return this.session.update(t,e)}cancelPrevious(){return this.session.cancelPrevious()}hideTask(){return this.session.hideTask()}getLastNth(t){const{ids:e,store:n}=this.session.state.$value;return n[e[e.length-1-t]]}},q=((t="",e=0)=>()=>(e=e||Date.now(),`${t=t||(0,y.yT)(6,36)}_${e++}`))();function J(t,e){const n={...t,...e(t)};return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}var F=class extends Q{constructor(){super(...arguments),I(this,"id",""),I(this,"scripts",{}),I(this,"history",new Map)}async init(t,e){this.id=e,this.scripts=t;try{await this.restore()}catch(n){}this.state.update({status:j.n.Success})}prompt(...t){const{ids:e,store:n}=this.state.$value,s=t.map((t=>t.id)),i=t.reduce(((t,e)=>({...t,[e.id]:e})),{});this.state.update({ids:e.concat(s),store:{...n,...i}})}hide(t){const{ids:e,store:n}=this.state.$value,s=e.filter((e=>e!==t.id)),i={[t.id]:null};this.state.update({ids:s,store:{...n,...i}})}update(t,e){const{store:n}=this.state.$value,s={[t.id]:J(t,e)};return this.state.update({store:{...n,...s}}),s[t.id]}cancelPrevious(){const t=this.last();(null==t?void 0:t.status)===j.n.Pending&&(this.state.upsertQueryId.update(""),this.update(t,(t=>({...t,status:j.n.Canceled}))))}hideTask(){const t=this.last();"Task"===(null==t?void 0:t.type)&&(null==t?void 0:t.status)===j.n.Pending&&this.hide(t)}last(){const{ids:t,store:e}=this.state.$value;return 0===t.length?null:e[t[t.length-1]]}has(t){return-1!==this.state.$value.ids.indexOf(t)}async run(t,e,n){const s=new H(this),i=(t,e)=>i=>{const a=(null==n?void 0:n.id)||q(),r=this.history.get(a);let o=null==r?void 0:r.state;o||(o=y.cP.create(e.init(i),0),o.subscribe((t=>this.save()))),this.history.set(a,{name:t,params:i,state:o});e.call(null,s,{state:o},i);this.save()},a=Object.keys(this.scripts).reduce(((t,e)=>({...t,[e]:i(e,this.scripts[e])})),{});await async function(t,e){const n=new Function("context",`\n      with(context) {\n        ${t};\n      }\n    `);return await n.call(null,e)}(t,{...a,params:e,console:console,setTimeout:setTimeout})}save(){const t={id:this.id,upsertSessionId:this.state.$value.upsertSessionId,scripts:[]};this.history.forEach(((e,n)=>{const{name:s,params:i,state:a}=e;t.scripts.push({id:n,name:s,params:i,state:a.$value})})),T.cache.set({key:S.cacheKey.serializedSession(),value:t})}async restore(){const t=S.cacheKey.serializedSession(),e=await T.cache.get({key:t});(null==e?void 0:e.id)===this.id&&(this.state.upsertSessionId.update(e.upsertSessionId),e.scripts.forEach((t=>{const{id:e,name:n,params:s,state:i}=t;this.history.set(e,{name:n,params:s,state:y.cP.create(i,0)}),this.run(`${n}(params)`,s,{id:e})})))}},B=class extends Q{init(){}config(t){this.state.update(t)}async initFromLocalConfig(){const t=S.cacheKey.staticConfig(),e=await T.cache.get({key:t});this.state.update(e)}},$={api:{params:{},logID:""},auth:{agreed:!1,content:""},session:{ids:[],store:{},status:j.n.Pending,upsertSessionId:"",upsertQueryId:"",uuid:`${Math.floor(1e8*Math.random())}${Math.floor(1e10*Math.random())}`},editor:{focus:!1,prompt:""},quote:{confirmed:null,selecting:null},settings:{auth:{content:[""]},guide:{items:[]}}},K={};A(K,{chatbot_writer_conversation_sug_action:()=>tt,chatbot_writer_home_show:()=>G,chatbot_writer_input_panel_action:()=>X,chatbot_writer_runtime_error:()=>et});var G=t=>({action:"show"}),X=t=>({click:"send"}),tt=(t,e)=>({...e}),et=(t,e)=>{let n="";try{n=JSON.stringify(e.context).slice(0,800)}catch(s){}return{...e,context:n}},nt=(new w.C).register({events:K}),st=class{constructor(t){var e;I(this,"id"),I(this,"type"),I(this,"status"),I(this,"initiator"),I(this,"text",""),this.id=t.id||q(),this.type=t.type||"",this.status=null!=(e=t.status)?e:j.n.Normal,this.initiator=t.initiator||N.Initiator.System}},it=class extends st{constructor(t){super({type:"Text",...t}),I(this,"text"),this.text=t.text}},at=class extends it{constructor(t){super({...t,type:"Task",status:j.n.Pending,initiator:N.Initiator.System})}},rt=class extends it{constructor(t){super({...t,type:"Instruct",initiator:N.Initiator.User}),I(this,"quote",""),this.quote=t.quote}},ot=class extends it{constructor(t){super({...t,type:"Divider"})}},ct=N.Script.create(((t,e)=>{t.hideTask();const n=e.state.$value,s=new it({text:n.params.content});t.prompt(s)}),{init:t=>({params:t})}),ut=new y.al,lt={sg:{appKey:"34b53a6f4a1794fc9ef19acf7269208e",url:"frontier.byteoversea.com"},va:{appKey:"464a4a91e5a8af20b3ed20a3c3cf8777",url:"frontier-va.byteoversea.com"},cn:{appKey:"a2bbe1190e232930874b281d07043a20",url:"frontier100-normal.zijieapi.com"}},dt=(t,e)=>_()("73"+e+t+"f8a69f1719916z").toLowerCase(),ht=t=>{const{did:e,region:n="cn"}=t,{appKey:s,url:i}=lt[n];return{fpID:"73",aID:"617174",appKey:s,accessKey:dt(e,s),deviceID:e,isDebug:!1,url:i,enableTransformTextPayload:!0,customParams:{uid:U.Session.state.uuid.$value}}},pt=class t{constructor(){I(this,"_fws"),I(this,"_did"),I(this,"_isCapcut",!1),I(this,"region"),I(this,"messages",{}),I(this,"handleClose",(t=>{ut.emit("websocket.close",t)})),I(this,"handleError",(t=>{ut.emit("websocket.error",t),nt.event("chatbot_writer_runtime_error",{type:"websocket",id:"onerror",context:t})})),I(this,"handleOpen",(t=>{ut.emit("websocket.open",t)})),I(this,"handleMessage",(t=>{var e;const{method:n,textPayload:s}=t.message;try{const t=JSON.parse(s||"{}");if(!t.queryID)return;const{queryID:i,content:a=""}=t;20001===n?this.messages[i].status="finish":20002===n?this.messages[i].status="violation":20003===n&&((null==(e=this.messages[i])?void 0:e.content)?this.messages[i].content+=a:this.messages[i]={content:a,status:""})}catch(i){nt.event("chatbot_writer_runtime_error",{type:"websocket",id:"message",context:{method:n,textPayload:s}})}}))}static getInstance(){return this._instance||(this._instance=new t),this._instance}async auth(t,e){this._did=t,this._isCapcut=e,await this.initFws()}async initFws(){if(!this._did)return;this.closeFws();const t=await this.raceFwsConnect(this._did);t.onopen=this.handleOpen,t.onmessage=this.handleMessage,t.onclose=this.handleClose,t.onerror=this.handleError,this._fws=t}async raceFwsConnect(t){if(this.region)return new z.FWS(ht({did:t,region:this.region}));if(!this._isCapcut){this.region="cn";const e=ht({did:t,region:"cn"});return new z.FWS(e)}const e=ht({did:t,region:"va"}),n=ht({did:t,region:"sg"});return new Promise((t=>{const s=new z.FWS(e),i=new z.FWS(n);s.onopen=()=>{i.close(),this.region="va",t(s)},i.onopen=()=>{s.close(),this.region="sg",t(i)}}))}getFwsUrl(){var t;return(null==(t=this._fws)?void 0:t.url)||""}closeFws(){var t;null==(t=this._fws)||t.close()}async checkAndRestoreWsConnection(){var t,e,n;return"success"!==await(null==(t=this._fws)?void 0:t.pingOnce())||(null==(e=this._fws)?void 0:e.readyState)!==(null==(n=this._fws)?void 0:n.OPEN)?this.reconnect():Promise.resolve()}async reconnect(){return new Promise(((t,e)=>{let n=!1;ut.tap("websocket.open",(()=>{n=!0,t()})),ut.tap("websocket.error",(t=>{n=!1,e(t)})),this.initFws().catch((t=>e(t))),setTimeout((()=>{n||e("connect websocket timeout")}),5e3)}))}};I(pt,"_instance",null);var mt=pt,gt=N.Script.create((async(t,e)=>{const n=mt.getInstance(),s=e.state.$value,{queryID:i="",content:a}=s.params;if(a){const e=new it({text:a,status:j.n.Normal});return t.hideTask(),void t.prompt(e)}U.Session.state.upsertQueryId.update(i);let r=new it({text:"",status:j.n.Pending}),o=!1;const c=()=>{t.getLastNth(0).status!==j.n.Canceled?(t.hideTask(),t.prompt(r),o=!0):U.Session.state.upsertQueryId.update("")};let u=0,l=0,d="",h=Date.now();const p=setInterval((()=>{const t=U.Session.state.upsertQueryId.$value;if(!t)return void clearInterval(p);const s=n.messages[t];s&&d!==s.content&&(d=s.content,e.state.params.update({queryID:i,content:d})),m(s),g()}),35),m=e=>{u&&u===d.length&&"finish"===(null==e?void 0:e.status)&&(r=t.update(r,(t=>({...t,status:j.n.Normal}))),clearInterval(p)),"violation"===(null==e?void 0:e.status)&&(o||c(),r=t.update(r,(()=>({text:T.i18n.t("mob_chatbot_safe_notice"),status:j.n.Error}))),clearInterval(p)),Date.now()-h>3e4&&(o?r=t.update(r,(t=>({...t,status:j.n.Normal}))):(c(),r=t.update(r,(()=>({text:T.i18n.t("network_error_please_retry"),status:j.n.Normal}))),nt.event("chatbot_writer_runtime_error",{type:"script",id:"showText",context:{log_id:U.API.state.logID.$value,frontier_url:n.getFwsUrl(),api_params:JSON.stringify(U.API.state.params.$value)}})),clearInterval(p))},g=()=>{u<d.length&&(o||c(),"\n"===d[u]&&l<6?l++:(l=0,r=t.update(r,(t=>({...t,text:(t.text+d[u++]).replace(/\n{2,}/g,"\n")})))),h=Date.now())}}),{init:t=>({params:t})}),Mt=N.Script.create(((t,e)=>{t.hideTask();const n=new it({text:T.i18n.t("mob_chatbot_lackability")});t.prompt(n)}),{init:t=>({params:t})}),ft=N.Script.create(((t,e)=>{t.hideTask();const n=new ot({text:T.i18n.t("has_cleared_context")}),s=t.getLastNth(0);"Instruct"===(null==s?void 0:s.type)&&t.hide(s),t.prompt(n)}),{init:t=>({params:t})}),vt=N.Script.create((async(t,e)=>{var n,s;t.cancelPrevious();const i=e.state.$value,a=new rt({text:i.params.prompt,quote:i.params.quote});if(t.prompt(a),i.status===j.n.Pending){const a=new at({text:""});t.prompt(a);try{await mt.getInstance().checkAndRestoreWsConnection();const r=await U.API.upsertStream(i.params);if(!t.has(a.id))return;await new Promise((t=>setTimeout(t,100)));const o=null==(n=null==r?void 0:r.data)?void 0:n.answer.scripts,c=null==(s=null==r?void 0:r.data)?void 0:s.session_id,u=null==r?void 0:r.log_id;e.state.update({status:j.n.Success}),U.Session.state.upsertSessionId.update(c||""),U.API.state.logID.update(u||""),o||nt.event("chatbot_writer_runtime_error",{type:"api",context:r}),await t.run(o||"unsupported()",{})}catch(r){if(!t.has(a.id))return;nt.event("chatbot_writer_runtime_error",{type:"script",id:"SendPrompt",context:r}),t.update(a,(t=>({text:T.i18n.t("network_error_please_retry"),status:j.n.Error})))}}}),{init:t=>({params:t,status:j.n.Pending})}),xt={SendPrompt:vt,unsupported:Mt,GenerateText:ct,ShowText:gt,PromptViolation:ft};var Nt=n(26368),yt=Nt.parse(location.search.slice(1)),jt=new Proxy({},{get:function(t,e){return function(t){return function(t,e){return new Promise((function(n,s){console.log("-- callJSB",t,e),p.Ay.call(t,e,(function(t){var e=t||{},i=e.code,a=void 0===i?wt.Fail:i,r=e.data;if(a!==wt.Succeed)s(t);else try{n(r)}catch(o){s(t)}}))}))}(e,t)}}}),wt=function(t){return t[t.Succeed=1]="Succeed",t[t.Fail=0]="Fail",t[t.NotAuthroized=-1]="NotAuthroized",t[t.UnknownError=-1e3]="UnknownError",t[t.NoHandler=-2]="NoHandler",t[t.ParameterError=-3]="ParameterError",t}(wt||{});var zt=jt,bt=n(26507),_t=n(51003),Ct=[{key:"copy",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9ImNvcHkiPgo8cGF0aCBpZD0iVW5pb24iIGQ9Ik0xNCAxMC4zMzMzQzE0IDEwLjUxNzQgMTMuODUwOCAxMC42NjY3IDEzLjY2NjcgMTAuNjY2N0gxM0MxMi44MTU5IDEwLjY2NjcgMTIuNjY2NyAxMC41MTc0IDEyLjY2NjcgMTAuMzMzM1YzLjMzMzMzSDUuNjY2NjdDNS40ODI1NyAzLjMzMzMzIDUuMzMzMzMgMy4xODQwOSA1LjMzMzMzIDNWMi4zMzMzM0M1LjMzMzMzIDIuMTQ5MjQgNS40ODI1NyAyIDUuNjY2NjcgMkgxMi42NjY3QzEzLjQwMyAyIDE0IDIuNTk2OTUgMTQgMy4zMzMzM1YxMC4zMzMzWk0zLjMzMzMzIDZMMy4zMzMzMyAxMi42NjY3SDEwVjZIMy4zMzMzM1pNMiA2QzIgNS4yNjM2MiAyLjU5Njk1IDQuNjY2NjcgMy4zMzMzMyA0LjY2NjY3SDEwQzEwLjczNjQgNC42NjY2NyAxMS4zMzMzIDUuMjYzNjIgMTEuMzMzMyA2VjEyLjY2NjdDMTEuMzMzMyAxMy40MDMgMTAuNzM2NCAxNCAxMCAxNEgzLjMzMzMzQzIuNTk2OTUgMTQgMiAxMy40MDMgMiAxMi42NjY3VjZaIiBmaWxsPSJjdXJyZW50Q29sb3IiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjwvZz4KPC9zdmc+Cg==",text:x("mob_chatbot_copy")},{key:"use",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxwYXRoCgkJZmlsbC1ydWxlPSJldmVub2RkIgoJCWNsaXAtcnVsZT0iZXZlbm9kZCIKCQlkPSJNMTIgMy4zMzMzM0gzLjMzMzMzVjEySDcuMzMzMzNWMTMuMzMzM0gzLjMzMzMzQzIuNTk2OTUgMTMuMzMzMyAyIDEyLjczNjQgMiAxMlYzLjMzMzMzQzIgMi41OTY5NSAyLjU5Njk1IDIgMy4zMzMzMyAySDEyQzEyLjczNjQgMiAxMy4zMzMzIDIuNTk2OTUgMTMuMzMzMyAzLjMzMzMzVjcuMzMzMzNIMTJWMy4zMzMzM1pNNS4wMDA0OSA4LjAwMjAyQzQuODE2MzkgOC4wMDE0MiA0LjY2NzExIDguMTUwMTggNC42NjcwNSA4LjMzNDI3TDQuNjY2ODMgOS4wMDA5NEM0LjY2Njc3IDkuMTg1MDMgNC44MTU5NiA5LjMzNDc2IDUuMDAwMDUgOS4zMzUzNUw4LjMzMzM3IDkuMzQ2MTRDOC41MTc0NiA5LjM0NjczIDguNjY2NzUgOS4xOTc5OCA4LjY2NjgxIDkuMDEzODhMOC42NjcwMiA4LjM0NzIyQzguNjY3MDggOC4xNjMxMiA4LjUxNzkgOC4wMTM0IDguMzMzOCA4LjAxMjgxTDUuMDAwNDkgOC4wMDIwMlpNNC42NjY2NyA2LjM0MTExQzQuNjY2NjcgNi41MjUyIDQuODE1OTEgNi42NzQyMiA1IDYuNjczOTZMMTAuMzMzMyA2LjY2NjE4QzEwLjUxNzQgNi42NjU5MSAxMC42NjY3IDYuNTE2NDYgMTAuNjY2NyA2LjMzMjM2VjUuNjY1NjlDMTAuNjY2NyA1LjQ4MTYgMTAuNTE3NCA1LjMzMjU4IDEwLjMzMzMgNS4zMzI4NUw1IDUuMzQwNjJDNC44MTU5IDUuMzQwODkgNC42NjY2NyA1LjQ5MDM1IDQuNjY2NjcgNS42NzQ0NFY2LjM0MTExWiIKCQlmaWxsPSJjdXJyZW50Q29sb3IiCgkJZmlsbC1vcGFjaXR5PSIwLjUiCgkvPgoJPHBhdGgKCQlmaWxsLXJ1bGU9ImV2ZW5vZGQiCgkJY2xpcC1ydWxlPSJldmVub2RkIgoJCWQ9Ik0xNC42NjY3IDExLjMzMzNDMTQuNjY2NyAxMi44MDYxIDEzLjQ3MjggMTQgMTIgMTRDMTAuNTI3MiAxNCA5LjMzMzMzIDEyLjgwNjEgOS4zMzMzMyAxMS4zMzMzQzkuMzMzMzMgOS44NjA1NyAxMC41MjcyIDguNjY2NjcgMTIgOC42NjY2N0MxMy40NzI4IDguNjY2NjcgMTQuNjY2NyA5Ljg2MDU3IDE0LjY2NjcgMTEuMzMzM1pNMTEuNzgzMyA5LjY2NjY3QzExLjY0NTMgOS42NjY2NyAxMS41MzMzIDkuNzc4NiAxMS41MzMzIDkuOTE2NjdWMTAuODY2N0gxMC41ODMzQzEwLjQ0NTMgMTAuODY2NyAxMC4zMzMzIDEwLjk3ODYgMTAuMzMzMyAxMS4xMTY3VjExLjU1QzEwLjMzMzMgMTEuNjg4MSAxMC40NDUzIDExLjggMTAuNTgzMyAxMS44SDExLjUzMzNWMTIuNzVDMTEuNTMzMyAxMi44ODgxIDExLjY0NTMgMTMgMTEuNzgzMyAxM0gxMi4yMTY3QzEyLjM1NDcgMTMgMTIuNDY2NyAxMi44ODgxIDEyLjQ2NjcgMTIuNzVWMTEuOEgxMy40MTY3QzEzLjU1NDcgMTEuOCAxMy42NjY3IDExLjY4ODEgMTMuNjY2NyAxMS41NVYxMS4xMTY3QzEzLjY2NjcgMTAuOTc4NiAxMy41NTQ3IDEwLjg2NjcgMTMuNDE2NyAxMC44NjY3SDEyLjQ2NjdWOS45MTY2N0MxMi40NjY3IDkuNzc4NiAxMi4zNTQ3IDkuNjY2NjcgMTIuMjE2NyA5LjY2NjY3SDExLjc4MzNaIgoJCWZpbGw9ImN1cnJlbnRDb2xvciIKCQlmaWxsLW9wYWNpdHk9IjAuNSIKCS8+Cjwvc3ZnPg==",text:x("mob_chatbot_addtoeditor")}],At={apiUrl:{base:"https://editor-api.capcutapi.com"}},It={guide:{items:[{title:"Video Copy",content:"Write a marketing copy for CapCut"},{title:"Change Tone",content:"Make my article conversational"},{title:"Copy Summary",content:"Summarize my article with a title"},{title:"Info Search",content:"Introduce Central Park in New York"}]},auth:{content:["By using this feature, you understand that the content is generated by an AI model based on your input. Please do not include personal, sensitive, or confidential information."]}};nt.config({params:function(){return{}},event:function(t,e){zt.reportAppLog({eventName:t,params:e})}});var St,Tt=function(){var t=(0,o.A)((0,r.A)().mark((function t(e){return(0,r.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{localStorage.setItem(e.key,JSON.stringify(e.value))}catch(n){}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Dt=function(){var t=(0,o.A)((0,r.A)().mark((function t(e){return(0,r.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",JSON.parse(localStorage.getItem(e.key)));case 4:t.prev=4,t.t0=t.catch(0);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop()}}),t,null,[[0,4]])})));return function(e){return t.apply(this,arguments)}}();function kt(t){var e=bt.useState(t.$value),n=(0,i.A)(e,2),s=n[0],a=n[1];return bt.useEffect((function(){return t.subscribe((function(t){return a(t)}))}),[]),s}St={var:(0,a.A)({},At),lib:{app:{request:zt.request},cache:{get:Dt,set:Tt},i18n:{t:x}}},(0,y.$Z)(S,St.var),Object.assign(T.app,St.lib.app),Object.assign(T.i18n,St.lib.i18n),Object.assign(T.cache,St.lib.cache),U.bind("API",(()=>new Z(y.cP.create($.api,0)))),U.bind("Auth",(()=>new V(y.cP.create($.auth,0)))),U.bind("Quote",(()=>new R(y.cP.create($.quote,0)))),U.bind("Editor",(()=>new W(y.cP.create($.editor,0)))),U.bind("Session",(()=>new F(y.cP.create($.session,0)))),U.bind("Settings",(()=>new B(y.cP.create($.settings,0)))),U.Auth.init(),U.Settings.init(),U.Settings.config(It),U.Session.init(xt,yt.id),zt.getAppInfo().then((function(t){var e=(t.data||{}).did,n=void 0===e?"":e;mt.getInstance().auth(n,!0)}));var Lt=function(){var t=window.getSelection();if(0!==t.rangeCount){for(var e=!1,n="",s=0;s<t.rangeCount;s++){for(var i=t.getRangeAt(s).startContainer.parentNode;null!=i;){var a,r=null===(a=i)||void 0===a?void 0:a.id;if(r&&r.startsWith("message")){e=!0,n=r.split("-")[1];break}i=i.parentNode}if(e)break}if(e){var o=window.getSelection(),c=o.toString().trim();if(c){var u=o.getRangeAt(0).getBoundingClientRect(),l=u.top+document.getElementById("scroll-root").scrollTop;setTimeout((function(){U.Quote.select({id:n,content:c.replace(/\n{2,}/g,"\n"),rect:{left:u.left,top:l}})}),200)}}}},Et=n(79724),Pt=n(21851),Qt=n.n(Pt),Ot=n(2981),Yt="root-U83Rb1",Ut="guide-Wp0eER",Zt="title-tryyST",Vt="prompt-XucFq8",Rt=function(t){var e=t.items,n=t.onItemClick;return(0,bt.useEffect)((function(){var t=Array.from(document.querySelectorAll("#guide")),e=Math.max.apply(Math,(0,Ot.A)(t.map((function(t){return t.getBoundingClientRect().height}))));t.forEach((function(t){t.style.height="".concat(e,"px")}))}),[]),(0,_t.jsx)("div",{className:Qt()("fadein",Yt),children:e.map((function(t){return(0,_t.jsxs)("div",{id:"guide",className:Ut,onClick:function(){return n(t)},children:[(0,_t.jsx)("p",{className:Qt()("elli",Zt),children:t.title}),(0,_t.jsx)("p",{className:Qt()("elli-2",Vt),children:t.content})]},t.title)}))})},Wt="root-DHbBdT",Ht="main-dNjPg3",qt="content-vVbfyq",Jt="text-J2bZBW",Ft="btn-B47eH_",Bt=function(t){var e=t.content,n=t.unmount,s=t.onAgree,i=t.onUnmounted;return(0,_t.jsxs)("div",{className:Qt()(Wt,Ht,n&&"fadeout"),onAnimationEnd:function(){n&&i()},children:[(0,_t.jsxs)("div",{className:qt,children:[e.map((function(t){return(0,_t.jsx)("p",{className:Jt,children:t},t)})),!1]}),(0,_t.jsx)("span",{className:Ft,onClick:s,children:x("mob_chatbot_Noticeofuse_gotit")})]})},$t="root-ICW8g8",Kt="logo-JF0VdQ",Gt="slogan-VRfsC8",Xt="main-bix6Ou",te=function(t){var e=kt(U.Auth.state),n=kt(U.Settings.state),s=t.unmount,a=t.onUnmounted,r=(0,bt.useState)(!1),o=(0,i.A)(r,2),c=o[0],u=o[1];return(0,_t.jsxs)("div",{className:Qt()($t,s&&"fadeout"),onAnimationEnd:function(){s&&a()},children:[(0,_t.jsx)("img",{src:"https://sf-fe.capcut.com/obj/capcut-static-sg/ies/monorepo/smart_edit_capcut/static/image/waiting_95.8237273e.webp",className:Kt}),(0,_t.jsx)("p",{className:Gt,children:e.agreed?x("mob_chatbot_welcome_message"):x("mob_chatbot_Noticeofuse")}),(0,_t.jsxs)("div",{className:Xt,children:[e.agreed&&(0,_t.jsx)(Rt,{items:n.guide.items,onItemClick:function(t){U.Editor.focus({prompt:t.content})}}),(!e.agreed||c)&&(0,_t.jsx)(Bt,{content:n.auth.content,unmount:c,onAgree:function(){U.Auth.agree(),u(!0)},onUnmounted:function(){u(!1)}})]})]})};var ee="root-NtMauu",ne="main-fwOdbE",se="text-GY3R3l",ie="loading-uT9ifT",ae="cancel-text-OnoNK1",re="root-F9dNoi",oe="line-ytwex_",ce="text-KsVH_q",ue=n(80559),le=n(83633),de="toast-JQM3eV",he="nomask-hsu5zE",pe="main-ekOVbG",me="text-aRG9Ss",ge=function(t){var e=t.content,n=t.masking;return(0,_t.jsx)("div",{className:"".concat(Qt()(de,n?null:he,t.className)," toast-warpper"),children:(0,_t.jsxs)("div",{className:pe,children:[(0,_t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"none",viewBox:"0 0 20 20",children:(0,_t.jsx)("path",{fill:"#2DD196",fillRule:"evenodd",d:"M10 18.333a8.333 8.333 0 1 0 0-16.667 8.333 8.333 0 0 0 0 16.667Zm3.986-9.474a.5.5 0 0 0 0-.707l-.471-.471a.5.5 0 0 0-.708 0l-3.64 3.64-1.974-1.974a.5.5 0 0 0-.707 0l-.471.472a.5.5 0 0 0 0 .707l2.798 2.799a.5.5 0 0 0 .708 0l4.465-4.466Z",clipRule:"evenodd"})}),(0,_t.jsx)("div",{className:"".concat(me," toast-content"),children:e})]})})};function Me(t,e){var n=t.content,i=t.duration,a=void 0===i?3e3:i,r=t.masking,o=t.className,c=document.createElement("div");document.body.appendChild(c);var u=(0,s.createRoot)(c,{});u.render((0,_t.jsx)(ge,{content:n,masking:r,className:o}));var l=!1;function d(){l||(l=!0,u.unmount(),e&&"function"==typeof e&&e())}return setTimeout((function(){return d()}),a),d}function fe(t){return ve.apply(this,arguments)}function ve(){return(ve=(0,o.A)((0,r.A)().mark((function t(e){var n;return(0,r.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.clipboard.writeText(e);case 3:t.next=13;break;case 5:t.prev=5,t.t0=t.catch(0),(n=document.createElement("textArea")).value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n);case 13:case"end":return t.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}function xe(){return(xe=(0,o.A)((0,r.A)().mark((function t(e){return(0,r.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return nt.event("chatbot_writer_conversation_sug_action",{click:"copy"}),t.next=3,fe(e);case 3:Me({content:x("copy_success")});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ne="root-DKTutB",ye="item-wxCmWp",je="text-MZ1U9G",we=function(t){var e=t.items,n=t.handler;return(0,_t.jsx)("div",{className:Qt()("h",Ne),children:e.map((function(t){return(0,_t.jsxs)("div",{className:Qt()("h",ye),onClick:function(){return n(t)},children:["use"===t.key&&(0,_t.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,_t.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 3.33333H3.33333V12H7.33333V13.3333H3.33333C2.59695 13.3333 2 12.7364 2 12V3.33333C2 2.59695 2.59695 2 3.33333 2H12C12.7364 2 13.3333 2.59695 13.3333 3.33333V7.33333H12V3.33333ZM5.00049 8.00202C4.81639 8.00142 4.66711 8.15018 4.66705 8.33427L4.66683 9.00094C4.66677 9.18503 4.81596 9.33476 5.00005 9.33535L8.33337 9.34614C8.51746 9.34673 8.66675 9.19798 8.66681 9.01388L8.66702 8.34722C8.66708 8.16312 8.5179 8.0134 8.3338 8.01281L5.00049 8.00202ZM4.66667 6.34111C4.66667 6.5252 4.81591 6.67422 5 6.67396L10.3333 6.66618C10.5174 6.66591 10.6667 6.51646 10.6667 6.33236V5.66569C10.6667 5.4816 10.5174 5.33258 10.3333 5.33285L5 5.34062C4.8159 5.34089 4.66667 5.49035 4.66667 5.67444V6.34111Z",fill:"currentColor"}),(0,_t.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.6667 11.3333C14.6667 12.8061 13.4728 14 12 14C10.5272 14 9.33333 12.8061 9.33333 11.3333C9.33333 9.86057 10.5272 8.66667 12 8.66667C13.4728 8.66667 14.6667 9.86057 14.6667 11.3333ZM11.7833 9.66667C11.6453 9.66667 11.5333 9.7786 11.5333 9.91667V10.8667H10.5833C10.4453 10.8667 10.3333 10.9786 10.3333 11.1167V11.55C10.3333 11.6881 10.4453 11.8 10.5833 11.8H11.5333V12.75C11.5333 12.8881 11.6453 13 11.7833 13H12.2167C12.3547 13 12.4667 12.8881 12.4667 12.75V11.8H13.4167C13.5547 11.8 13.6667 11.6881 13.6667 11.55V11.1167C13.6667 10.9786 13.5547 10.8667 13.4167 10.8667H12.4667V9.91667C12.4667 9.7786 12.3547 9.66667 12.2167 9.66667H11.7833Z",fill:"currentColor"})]}),"copy"===t.key&&(0,_t.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,_t.jsx)("g",{id:"copy",children:(0,_t.jsx)("path",{id:"Union",d:"M14 10.3333C14 10.5174 13.8508 10.6667 13.6667 10.6667H13C12.8159 10.6667 12.6667 10.5174 12.6667 10.3333V3.33333H5.66667C5.48257 3.33333 5.33333 3.18409 5.33333 3V2.33333C5.33333 2.14924 5.48257 2 5.66667 2H12.6667C13.403 2 14 2.59695 14 3.33333V10.3333ZM3.33333 6L3.33333 12.6667H10V6H3.33333ZM2 6C2 5.26362 2.59695 4.66667 3.33333 4.66667H10C10.7364 4.66667 11.3333 5.26362 11.3333 6V12.6667C11.3333 13.403 10.7364 14 10 14H3.33333C2.59695 14 2 13.403 2 12.6667V6Z",fill:"currentColor"})})}),(0,_t.jsx)("span",{className:je,children:t.text})]})}))})},ze="root-FOP5pt",be="fake-message-NavJFF",_e="main-VrKx8T",Ce="main-error-gtGHAC",Ae="text-tFBnLe",Ie="text-error-QN8HlM",Se="cancel-text-uxlvcB",Te="menu-dCSn04",De=new(n(32684).A),ke=function(t,e){return t[e].content};De.renderer.rules.code_inline=ke,De.renderer.rules.code_block=ke,De.renderer.rules.fence=ke;var Le="line-hVcJKV",Ee="loading-ePw2QD",Pe="loading-inner-1-_XdXGz",Qe="loading-inner-2-dx_ZMd",Oe="loading-inner-3-gZ7p_w",Ye=bt.forwardRef((function(t,e){return(0,_t.jsxs)("div",{ref:e,className:Qt()(Le,Ee),children:[(0,_t.jsx)("div",{className:Qt()(Le,Pe)}),(0,_t.jsx)("div",{className:Qt()(Le,Qe)}),(0,_t.jsx)("div",{className:Qt()(Le,Oe)})]})})),Ue="root-wn0cdu",Ze="text-F3F1GH",Ve="quote-AHCKXd",Re="root-SW1zi2",We="probe-KQLNJS",He="quote-fq0rue",qe={Task:function(t){var e=t.data,n=e.text,s=e.status;return(0,_t.jsx)("div",{className:Qt()("fadein",ee),children:(0,_t.jsx)("div",{className:ne,children:s===Et.n.Canceled?(0,_t.jsx)("p",{className:ae,children:x("mob_chatbot_generation_stopped")}):n?(0,_t.jsx)("p",{className:se,children:n}):(0,_t.jsx)("img",{src:"https://sf-fe.capcut.com/obj/capcut-static-sg/ies/monorepo/smart_edit_capcut/static/image/loading.3c982d50.gif",className:ie})})})},Divider:function(t){var e=t.data.text;return(0,_t.jsxs)("div",{className:re,children:[(0,_t.jsx)("span",{className:oe}),(0,_t.jsx)("span",{className:ce,children:e}),(0,_t.jsx)("span",{className:oe})]})},Text:function(t){var e=t.data,n=e.id,s=e.text,a=e.status,r=(0,bt.useState)(""),o=(0,i.A)(r,2),c=o[0],u=o[1],l=(0,bt.useState)(14),d=(0,i.A)(l,2),h=d[0],p=d[1],m=(0,bt.useRef)(null),g=(0,bt.useRef)(null),M=(0,bt.useRef)(null),f=(0,bt.useRef)(null);(0,bt.useEffect)((function(){var t,e=(t=s.replace(/\n/g,"\n\n"),De.render(t));s.endsWith("##")&&p(28),u(e)}),[s]),(0,bt.useEffect)((function(){f.current=new ResizeObserver((function(t){var e,n=(0,le.A)(t);try{for(n.s();!(e=n.n()).done;){var s=e.value.contentRect,i=s.height,a=s.width,r=document.getElementById("scroll-root");m.current.clientWidth!==a&&(m.current.style.width=a+"px"),m.current.clientHeight!==i&&(m.current.style.height=i+"px",r.scrollHeight-r.scrollTop-r.offsetHeight<50&&(r.scrollTop=r.scrollHeight))}}catch(o){n.e(o)}finally{n.f()}})),a===Et.n.Pending&&g.current&&f.current.observe(g.current),a===Et.n.Normal&&f.current&&g.current&&f.current.unobserve(g.current)}),[a]),(0,bt.useEffect)((function(){a===Et.n.Normal?setTimeout((function(){m.current.style.transition="height 0s linear",m.current.style.width=g.current.clientWidth+"px",m.current.style.height=g.current.clientHeight+"px"}),20):m.current.style.transition="height 0.7s linear"}),[]);var v=(0,bt.useState)(!1),N=(0,i.A)(v,2),y=N[0],j=N[1],w=(0,bt.useState)({x:0,y:0}),z=(0,i.A)(w,2),b=z[0],_=z[1],C=(0,bt.useCallback)((function(t){t.preventDefault(),t.stopPropagation(),_({x:t.clientX,y:t.clientY}),j(!0),window.getSelection().removeAllRanges();var e=function t(){j(!1),document.removeEventListener("click",t),document.removeEventListener("scroll",t)};document.addEventListener("click",e),document.addEventListener("scroll",e)}),[]);return(0,_t.jsx)("div",{className:Qt()("fadein",ze),children:(0,_t.jsxs)("div",{className:Qt()(_e,(0,ue.A)({},Ce,a===Et.n.Error)),children:[(0,_t.jsx)("div",{ref:g,id:"message-".concat(n),className:Qt()(Ae,(0,ue.A)({},Ie,a===Et.n.Error)),onContextMenu:C,dangerouslySetInnerHTML:{__html:c}}),(0,_t.jsx)("div",{ref:m,className:be}),a===Et.n.Pending&&(0,_t.jsx)("div",{style:{height:"".concat(h,"px")}}),a===Et.n.Canceled&&(0,_t.jsx)("div",{className:Qt()(Se),children:x("mob_chatbot_generation_stopped")}),(a===Et.n.Normal||a===Et.n.Canceled)&&(0,_t.jsx)(we,{items:Ct,handler:function(t){switch(t.key){case"copy":!function(t){xe.apply(this,arguments)}(s);break;case"use":!function(t){nt.event("chatbot_writer_conversation_sug_action",{click:"export"}),zt.publishEvent({eventName:"ADD_TO_SMART_EDITOR_EVENT",data:{content:t}})}(s)}}}),y&&(0,_t.jsx)("div",{className:Te,style:{left:b.x,top:b.y},onClick:function(){zt.showFeedbackDialog({positive:!1,enterForm:"chat-bot",extraParams:{sell_points:"",mode:"",script_id:"",prompt_request_id:"",prompt:"",text:s}}),nt.event("chatbot_writer_conversation_sug_action",{click:"dislike"})},children:x("mob_chatbot_dislike")}),e.status===Et.n.Pending&&(0,_t.jsx)(Ye,{ref:M})]})})},Instruct:function(t){var e=t.data,n=e.text,s=e.quote;return(0,_t.jsxs)("div",{className:Qt()("fadein",Ue),children:[s&&(0,_t.jsx)("p",{className:Qt()("quote",Ve),children:s}),(0,_t.jsx)("p",{className:Ze,children:n})]})}},Je=function(){var t,e=kt(U.Quote.state),n=kt(U.Session.state),s=(0,bt.useRef)(null);(0,bt.useEffect)((function(){return U.Session.state.subscribe((function(t,e){var n,i=t.ids,a=t.store,r=e.ids,o=e.store,c=a[i[i.length-1]],u=o[r[r.length-1]];(null==c?void 0:c.id)===(null==u?void 0:u.id)&&(null==c?void 0:c.status)===Et.n.Pending&&(null==u?void 0:u.status)===Et.n.Pending||(n=s.current,setTimeout((function(){var t;null==n||null===(t=n.lastChild)||void 0===t||t.scrollIntoView({behavior:"smooth",block:"end"})}),100))}))}),[]);return(0,_t.jsxs)("div",{className:Re,ref:s,id:"scroll-root",children:[n.ids.map((function(t){var s=n.store[t],i=qe[s.type];return(0,_t.jsx)(i,{data:s,quote:e.selecting})})),(null===(t=e.selecting)||void 0===t?void 0:t.id)&&(0,_t.jsx)("div",{className:He,onMouseDown:function(t){t.preventDefault(),t.stopPropagation(),U.Editor.focus(),setTimeout((function(){return U.Quote.confirm(e.selecting)}),100)},style:{left:"".concat(e.selecting.rect.left,"px"),top:"".concat(e.selecting.rect.top,"px")},children:x("mob_chatbot_quote")}),(0,_t.jsx)("div",{className:We})]})},Fe="root-pRa1WR",Be="tips-O1XnDH",$e="inputBar-SRxye4",Ke="input-MGBvCk",Ge="main-jZbLgv",Xe="submit-yxHTvc",tn="submitDisabled-SdZcG7",en="quoteContainer-V8cPPF",nn="quote-wTnar5",sn="quoteText-hSl2KA",an="clearQuote-hrqVfl",rn="root-jNZOvQ",on="main-Hjq4vH",cn="action-YmeJB7",un="quote-gWF6Zq",ln="text-nVmyBn",dn=function(t){var e=t.unmount,n=t.onQuote,s=t.onClose;return(0,_t.jsxs)("div",{className:Qt()("fadein",rn,on,e&&"fadeout-down"),onAnimationEnd:function(){e&&s()},children:[(0,_t.jsx)("span",{className:ln,children:x("mob_chatbot_externalexternal")}),(0,_t.jsxs)("div",{className:cn,children:[(0,_t.jsx)("span",{onClick:n,className:un,children:x("mob_chatbot_quote")}),(0,_t.jsx)("svg",{onClick:s,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{cursor:"pointer"},children:(0,_t.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.86839 8.00035L2.90231 11.9668C2.77215 12.0969 2.77215 12.308 2.90231 12.4382L3.56225 13.0982C3.69242 13.2283 3.90349 13.2283 4.03367 13.0982L7.99972 9.13176L11.966 13.0984C12.0962 13.2286 12.3072 13.2286 12.4374 13.0984L13.0973 12.4384C13.2275 12.3082 13.2275 12.0972 13.0973 11.967L9.13104 8.00035L13.0973 4.03371C13.2275 3.90354 13.2275 3.6925 13.0973 3.56232L12.4374 2.90233C12.3072 2.77214 12.0962 2.77214 11.966 2.90233L7.99972 6.86893L4.03367 2.90254C3.9035 2.77235 3.69242 2.77235 3.56225 2.90254L2.90231 3.56254C2.77215 3.69271 2.77215 3.90375 2.90231 4.03392L6.86839 8.00035Z",fill:"#090C14"})})]})]})},hn=function(t){var e=(0,bt.useState)(!1),n=(0,i.A)(e,2),s=n[0],a=n[1],c=(0,bt.useState)(!1),u=(0,i.A)(c,2),l=u[0],d=u[1],h=(0,bt.useRef)(""),p=(0,bt.useRef)(null),m=kt(U.Auth.state),g=kt(U.Editor.state),M=kt(U.Quote.state).confirmed,f=m.agreed&&!!g.prompt,v=function(){var e=(0,o.A)((0,r.A)().mark((function e(){return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.prompt.trim()){e.next=2;break}return e.abrupt("return");case 2:t.onSubmit((function(){var t=p.current;U.Editor.update({prompt:""}),t.style.height="auto",U.Quote.confirm(null),U.Session.run("SendPrompt(params)",{prompt:g.prompt,quote:null==M?void 0:M.content}),nt.event("chatbot_writer_input_panel_action",{})}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var t=(0,o.A)((0,r.A)().mark((function t(){return(0,r.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:U.API.cancelStream(),U.Session.cancelPrevious(),v();case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=function(){d(!1)};return(0,bt.useEffect)((function(){return setTimeout((function(){a(!0)}),5e3),!t.isActualInConversation&&yt.quote&&zt.getCache({key:yt.id}).then((function(t){t.content&&(h.current=t.content,d(!0))})).catch((function(){})),U.Editor.state.subscribe((function(t,e){t.focus!==e.focus&&p.current[t.focus?"focus":"blur"](),p.current.value=t.prompt}))}),[]),(0,_t.jsxs)("div",{className:Fe,children:[(0,_t.jsxs)("div",{className:Ge,children:[M&&(0,_t.jsx)("div",{className:en,children:(0,_t.jsxs)("div",{className:nn,children:[(0,_t.jsx)("p",{className:Qt()("quote",sn),children:M.content}),(0,_t.jsx)("svg",{className:an,onClick:function(){U.Quote.confirm(null)},xmlns:"http://www.w3.org/2000/svg",width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",children:(0,_t.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.36839 8.00035L3.40231 11.9668C3.27215 12.0969 3.27215 12.308 3.40231 12.4382L4.06225 13.0982C4.19242 13.2283 4.40349 13.2283 4.53367 13.0982L8.49972 9.13176L12.466 13.0984C12.5962 13.2286 12.8072 13.2286 12.9374 13.0984L13.5973 12.4384C13.7275 12.3082 13.7275 12.0972 13.5973 11.967L9.63104 8.00035L13.5973 4.03371C13.7275 3.90354 13.7275 3.6925 13.5973 3.56232L12.9374 2.90233C12.8072 2.77214 12.5962 2.77214 12.466 2.90233L8.49972 6.86893L4.53367 2.90254C4.4035 2.77235 4.19242 2.77235 4.06225 2.90254L3.40231 3.56254C3.27215 3.69271 3.27215 3.90375 3.40231 4.03392L7.36839 8.00035Z",fill:"#1F2F45",fillOpacity:"0.4"})})]})}),(0,_t.jsxs)("div",{className:$e,children:[(0,_t.jsx)("textarea",{placeholder:x("mob_chatbot_typepanel_placeholder text"),ref:p,rows:1,id:"input",disabled:!m.agreed,className:Ke,onBlur:function(){U.Editor.blur()},onFocus:function(){U.Editor.focus(),l&&y()},onChange:function(t){var e=p.current;e.style.height="auto",e.style.height=e.scrollHeight+"px",U.Editor.update({prompt:t.target.value})},onKeyDown:function(t){13===t.keyCode&&(t.preventDefault(),v())}}),t.isMessagePending?(0,_t.jsxs)("svg",{onClick:N,className:Xe,width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,_t.jsx)("circle",{cx:"21",cy:"21",r:"12",fill:"#090C14"}),(0,_t.jsx)("rect",{x:"17",y:"17",width:"8",height:"8",rx:"1",fill:"white"})]}):(0,_t.jsxs)("svg",{width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:Qt()(Xe,!f&&tn),onClick:v,children:[(0,_t.jsx)("circle",{cx:"21",cy:"21",r:"12",fill:f?"#090C14":"#273C56",fillOpacity:f?"1":"0.2"}),(0,_t.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.8594 18.0372L25.8518 22.0283L27.0642 20.8163L21.6085 15.3623C21.2737 15.0277 20.7309 15.0277 20.3961 15.3623L14.9404 20.8163L16.1528 22.0283L20.1452 18.0372V26.8763H21.8594V18.0372Z",fill:"white"})]})]})]}),(0,_t.jsx)("span",{className:Be,children:x("mob_chatbot_chat_warning")}),l&&(0,_t.jsx)(dn,{unmount:s,onQuote:function(){U.Editor.focus(),U.Quote.confirm({id:"-1",content:h.current,rect:null})},onClose:y})]})},pn="root-wPM8Iz",mn="main-olUyyl",gn=function(){var t,e=kt(U.Auth.state),n=kt(U.Session.state),s=(0,bt.useRef)(null),a=(0,bt.useState)(!1),r=(0,i.A)(a,2),o=r[0],c=r[1],u=(0,bt.useState)(n.ids.length>0),l=(0,i.A)(u,2),d=l[0],h=l[1];(0,bt.useEffect)((function(){return document.addEventListener("mouseup",Lt),function(){document.removeEventListener("mouseup",Lt)}}),[]);if(n.status===Et.n.Pending)return null;var p=d||n.ids.length>0,m=(null===(t=U.Session.last())||void 0===t?void 0:t.status)===Et.n.Pending;return(0,_t.jsxs)("div",{className:pn,onMouseDown:function(){U.Quote.select(null)},children:[(0,_t.jsxs)("div",{className:mn,children:[(!p||o)&&(0,_t.jsx)(te,{unmount:o,onUnmounted:function(){var t;c(!1),h(!0),null===(t=s.current)||void 0===t||t.call(s),s.current=null}}),p&&(0,_t.jsx)(Je,{})]}),e.agreed&&(0,_t.jsx)(hn,{isMessagePending:m,isActualInConversation:p,onSubmit:function(t){if(!o)return d?void t():(s.current=t,void c(!0));s.current=t}})]})},Mn=document.getElementById("root");Mn&&(zt.setTitle({title:x("mob_chatbot_productname")}),nt.event("chatbot_writer_home_show",{}),s.createRoot(Mn).render((0,_t.jsx)(gn,{})))},29160:function(){},15453:function(t,e,n){"use strict";n(26152),n(76672),n(46481),n(38320),n(1973),n(28638),n(67239),n(22293),n(18730),n(57180),n(7544),n(24766),n(75505),n(29262),n(69089),n(13657),n(13423),n(41506),n(26343),n(55932),n(37757),n(68750),n(67962),n(48532),n(75187),n(90238),n(53651),n(64063),n(8462),n(32670),n(76241),n(94790),n(57129),n(72352),n(95467),n(46855),n(1401),n(6380),n(98579),n(95784),n(5613),n(52871),n(51928),n(94171),n(34047),n(11685),n(10565),n(12519),n(37349),n(60587),n(84428),n(63001),n(58605),n(95850),n(11528),n(43049),n(58288),n(85830),n(6974),n(30336),n(86636),n(1061),n(42861),n(16015),n(75276),n(65781),n(11240),n(14012),n(72749),n(94012),n(55216),n(30511),n(45954),n(46745),n(66882),n(39725),n(14022),n(59151),n(75385),n(63840),n(63986),n(9297),n(49259),n(7211),n(69566),n(78039),n(85160),n(8491),n(63240),n(88626),n(81983),n(19457),n(20115),n(27376),n(97899),n(23418),n(39948),n(72678),n(62839),n(66888),n(12492),n(29349),n(78491),n(54384),n(94300),n(62680),n(30917),n(52930),n(1764),n(55384),n(17511),n(893),n(48426),n(6886),n(51492),n(2593),n(62263),n(90332),n(46142),n(22769),n(72327),n(36739),n(34910),n(348),n(43294),n(91332),n(50679),n(96002),n(18565),n(31991),n(99046),n(32091),n(13542),n(8603),n(81181),n(63632),n(59922),n(40202),n(32921),n(11768),n(67786),n(88277),n(51351),n(45126),n(12318),n(34205),n(88990),n(80161),n(99547),n(83214),n(66586),n(63232),n(54816),n(32251),n(68142),n(44138),n(41376),n(99539),n(47194),n(6662),n(32678),n(51730),n(21797),n(20922),n(97588),n(14118),n(91323),n(83945),n(26476),n(24511),n(24957),n(49667),n(73759),n(65151),n(42255),n(50683),n(67543),n(64746),n(19586),n(57879),n(9931),n(17047),n(69831),n(2080),n(15701),n(36222),n(95352),n(98356),n(53391),n(11829),n(40339),n(28371),n(99275),n(16007),n(37331),n(25488),n(24985),n(45324),n(80574),n(69491),n(59605),n(10130),n(96895),n(9476),n(10344),n(46286),n(35825),n(5894),n(62291),n(61440),n(84311),n(25218),n(12628),n(30342),n(75686),n(87974),n(509),n(27902),n(78230),n(43633),n(91957),n(87902),n(39511),n(50409),n(71852),n(40279),n(25433),n(34210),n(74935),n(85645),n(93888),n(10202),n(47161),n(82363),n(91228),n(58771),n(2297),n(10972),n(7334),n(42548),n(68491),n(7347),n(6092),n(79869),n(31578),n(17233),n(41110),n(91845),n(35682),n(19980),n(89642),n(28889),n(75343),n(76799),n(61786),n(6565),n(36143),n(64689),n(57147),n(5237),n(9690),n(56301),n(81190),n(68560),n(24028),n(60471),n(50687),n(68843),n(70654),n(23682),n(61692),n(3385),n(14484),n(26851),n(95812),n(63107),n(93458),n(91365),n(96474),n(46685),n(77195),n(87740),n(89358),n(67587),n(91099),n(7096),n(59704),n(75938),n(29602),n(64432),n(68045),n(62160),n(40274),n(75887),n(58534),n(66724),n(50924),n(30378),n(25804),n(52499),n(95346),n(24529),n(6967),n(80162),n(20730),n(1904),n(93044),n(15559),n(98722),n(44815),n(14824),n(47981),n(69138),n(92454),n(94079),n(59521),n(86077),n(6097),n(49427),n(17646),n(60658),n(12237),n(37685),n(47361),n(77223),n(53586),n(5481),n(53419),n(88995),n(88996),n(32813),n(69871),n(80748),n(38896),n(61003),n(78163),n(6629),n(53796),n(53216),n(9418),n(98042),n(88026),n(59251),n(67070),n(79913),n(17364),n(76548),n(47453),n(48831),n(59060),n(65028),n(37755),n(54965),n(61881),n(61299),n(2760),n(84455),n(31045),n(27920),n(200),n(7602),n(45250),n(78471),n(28423),n(68567),n(66868),n(5857),n(70540),n(16407),n(41898),n(32946),n(31848),n(27371),n(99536),n(54962),n(71724),n(46451),n(82555),n(38040),n(80118),n(2735),n(97078),n(18985),n(95998),n(95453),n(83669),n(10958),n(7752),n(31885),n(24148),n(22641),n(21315),n(26039),n(55861),n(407),n(52770),n(45731),n(62208),n(49342),n(70665),n(42588),n(4536),n(6504),n(42824),n(62467),n(96029),n(94470),n(85671),n(8867),n(54465),n(48867),n(88687),n(2006),n(47661),n(75872)},68804:function(){"use strict";window.__assetPrefix__="."}},function(t){var e=function(e){return t(t.s=e)};t.O(0,[740,594,294],(function(){return e(68804),e(15453),e(13032)}));t.O()}]);