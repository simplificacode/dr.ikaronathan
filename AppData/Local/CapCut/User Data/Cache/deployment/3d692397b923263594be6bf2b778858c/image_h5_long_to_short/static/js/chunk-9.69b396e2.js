/*!
* @ies/filter-xss v3.1.4
* (c) 2024
*/var e,t;e=this,t=function(e){"use strict";var t=function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function n(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var r=/[^a-zA-Z0-9\\_:.-]/gim,i=/</g,o=/>/g,s=/&#([a-zA-Z0-9]*);?/gim,a=/&quot;/g,l=/&colon;?/gim,c=/&newline;?/gim,d=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,u=/u\s*r\s*l\s*\(.*/gi,h=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,p=/"/g,f=function(e){return e.replace(i,"&lt;").replace(o,"&gt;")},m={indexOf:function(e,t){var n,r;for(n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return -1},forEach:function(e,t,n){var r,i;for(r=0,i=e.length;r<i;r++)t.call(n,e[r],r,e)},some:function(e,t,n){var r,i;for(r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e))return!0;return!1},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},includes:function(e,t){if("string"==typeof e)return -1!==e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1},uniq:function(e){for(var t={},n=[],r=0;r<e.length;r++)t[e[r]]||(n.push(e[r]),t[e[r]]=!0);return n},from:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},keys:function(e){var t=[];for(var n in e)t.push(n);return t}};function g(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]?e.substr(1,e.length-2):e}function v(e){var t,n,r,i,o,s,a,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",d=0;for(e=function(e){e=e.replace(/rn/g,"n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?t+=String.fromCharCode(r>>6|192)+String.fromCharCode(63&r|128):t+=String.fromCharCode(r>>12|224)+String.fromCharCode(r>>6&63|128)+String.fromCharCode(63&r|128)}return t}(e);d<e.length;)i=(t=e.charCodeAt(d++))>>2,o=(3&t)<<4|(n=e.charCodeAt(d++))>>4,s=(15&n)<<2|(r=e.charCodeAt(d++))>>6,a=63&r,isNaN(n)?s=a=64:isNaN(r)&&(a=64),c=c+l.charAt(i)+l.charAt(o)+l.charAt(s)+l.charAt(a);return c}function y(e){var t,n,r,i,o,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");c<e.length;)t=a.indexOf(e.charAt(c++))<<2|(i=a.indexOf(e.charAt(c++)))>>4,n=(15&i)<<4|(o=a.indexOf(e.charAt(c++)))>>2,r=(3&o)<<6|(s=a.indexOf(e.charAt(c++))),l+=String.fromCharCode(t),64!==o&&(l+=String.fromCharCode(n)),64!==s&&(l+=String.fromCharCode(r));return function(e){for(var t="",n=0,r=0,i=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(t+=String.fromCharCode((31&r)<<6|63&e.charCodeAt(n+1)),n+=2):(t+=String.fromCharCode((15&r)<<12|(63&e.charCodeAt(n+1))<<6|63&e.charCodeAt(n+2)),n+=3);return t}(l)}function b(e,t,n){var r="",i=0,o=!1,s=!1,a=0,l=e.length,c="",d="";e:for(a=0;a<l;a++){var u=e.charAt(a);if(!1===o){if("<"===u){o=a;continue}}else if(!1===s){if("<"===u){r+=n(e.slice(i,a)),o=a,i=a;continue}if(">"===u||a===l-1){r+=n(e.slice(i,o)),c=function(e){var t,n=m.spaceIndex(e);return t=-1===n?e.slice(1,-1):e.slice(1,n+1),"/"===(t=m.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}(d=e.slice(o,a+1)),r+=t(o,r.length,c,d,"</"===d.slice(0,2)),i=a+1,o=!1;continue}if('"'===u||"'"===u)for(var h=1,p=e.charAt(a-h);""===p.trim()||"="===p;){if("="===p){s=u;continue e}p=e.charAt(a-++h)}}else if(u===s){s=!1;continue}}return i<l&&(r+=n(e.substr(i))),r}function _(e,t){var n=0,i=0,o=[],s=!1,a=e.length;function l(e,n){if(!((e=(e=m.trim(e)).replace(r,"").toLowerCase()).length<1)){var i=t(e,n||"");i&&o.push(i)}}for(var c=0;c<a;c++){var d=e.charAt(c),u=void 0;if(!1!==s||"="!==d){if(!1===s||c!==i){if(/\s|\n|\t/.test(d)){if(e=e.replace(/\s|\n|\t/g," "),!1===s){if(-1===(u=function(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"="===n?t:-1}return -1}(e,c))){l(m.trim(e.slice(n,c))),s=!1,n=c+1;continue}c=u-1;continue}if(-1===(u=function(e,t){for(;t>0;t--){var n=e[t];if(" "!==n)return"="===n?t:-1}return -1}(e,c-1))){l(s,g(m.trim(e.slice(n,c)))),s=!1,n=c+1;continue}}}else{if(-1===(u=e.indexOf(d,c+1)))break;l(s,m.trim(e.slice(i+1,u))),s=!1,n=(c=u)+1}}else s=e.slice(n,c),n=c+1,i='"'===e.charAt(n)||"'"===e.charAt(n)?n:function(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"'"===n||'"'===n?t:-1}return -1}(e,c+1)}return n<e.length&&(!1===s?l(e.slice(n)):l(s,g(m.trim(e.slice(n))))),m.trim(o.join(" "))}function w(e,t,n){var r,i;if(n=function(e){for(var t="",n=0,r=e.length;n<r;n++)t+=32>e.charCodeAt(n)?" ":e.charAt(n);return m.trim(t)}(n.replace(a,'"').replace(s,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))}).replace(l,":").replace(c," ")),"href"===t||"src"===t){if("#"===(n=m.trim(n)))return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"tel:"!==n.substr(0,4)&&"data:image/"!==n.substr(0,11)&&"ftp://"!==n.substr(0,6)&&"./"!==n.substr(0,2)&&"../"!==n.substr(0,3)&&"#"!==n[0]&&"/"!==n[0])return""}else if("background"===t){if(d.lastIndex=0,d.test(n))return""}else if("style"===t&&(h.lastIndex=0,h.test(n)||(u.lastIndex=0,u.test(n)&&(d.lastIndex=0,d.test(n)))))return"";return n=f(n.replace(p,"&quot;"))}var x=function(e){return"string"==typeof e?e.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},S=function(){function e(e){var t=function(e){var t={};for(var n in e)t[n]=e[n];return t}(e||{});t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=function(){return""}),t.whiteList={},t.onTag=function(){},t.onTagAttr=function(){},t.onIgnoreTag=function(){},t.onIgnoreTagAttr=function(){},t.safeAttrValue=w,t.escapeHtml=f,this.options=Object.assign(t,e)}return e.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t,n,r,i,o,s=this.options,a=s.whiteList,l=s.onTag,c=s.onIgnoreTag,d=s.onTagAttr,u=s.onIgnoreTagAttr,h=s.safeAttrValue,p=s.escapeHtml;s.stripBlankChar&&(e=e.split("").filter(function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)}).join("")),s.allowCommentTag||(e=function(e){for(var t="",n=0;n<e.length;){var r=e.indexOf("<!--",n);if(-1===r){t+=e.slice(n);break}t+=e.slice(n,r);var i=e.indexOf("-->",r);if(-1===i)break;n=i+3}return t}(e));var f=!1;s.stripIgnoreTagBody&&(t=s.stripIgnoreTagBody,"function"!=typeof(n=c)&&(n=function(){}),r=!Array.isArray(t),i=[],o=!1,c=(f={onIgnoreTag:function(e,s,a){if(r||-1!==m.indexOf(t,e)){if(a.isClosing){var l=a.position+10;return i.push([!1!==o?o:a.position,l]),o=!1,"[/removed]"}return o||(o=a.position),"[removed]"}return n(e,s,a)},remove:function(e){var t="",n=0;return m.forEach(i,function(r){t+=e.slice(n,r[0]),n=r[1]}),t+=e.slice(n)}}).onIgnoreTag);var g=b(e,function(e,t,n,r,i){var o={sourcePosition:e,position:t,isClosing:i,isWhite:Object.prototype.hasOwnProperty.call(a,n)},s=l(n,r,o);if(null!=s)return s;if(o.isWhite){if(o.isClosing)return"</".concat(n,">");var f=function(e){var t=m.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var n="/"===(e=m.trim(e.slice(t+1,-1)))[e.length-1];return n&&(e=m.trim(e.slice(0,-1))),{html:e,closing:n}}(r),g=a[n],v=_(f.html,function(e,t){var r=-1!==m.indexOf(g,e),i=d(n,e,t,r);return null==i?r?(t=h(n,e,t,null))?"".concat(e,'="').concat(t,'"'):e:null==(i=u(n,e,t,r))?void 0:i:i});return r="<".concat(n),v&&(r+=" ".concat(v)),f.closing&&(r+=" /"),r+=">"}return null==(s=c(n,r,o))?p(r):s},p);return f&&(g=f.remove(g)),g},e}(),k=!0,C=function(e){return e&&e.Math==Math&&e},M=C("object"==typeof globalThis&&globalThis)||C("object"==typeof window&&window)||C("object"==typeof self&&self)||C("object"==typeof global&&global)||Function("return this")();try{!0!==(k=!!(k=String(k)).startsWith("<%=")||JSON.parse(k))&&"true"!==k||(M=Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")())}catch(e){console.log(e)}var O=new(function(){function e(){var e=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.isSetedConfig=!1,this.getSlardarBid=function(){var t,n,r="cc_web_smart_tools";if(!m.includes(r,"bid"))return r;if(e.config&&e.config.bid)return e.config.bid;var i=M;if(i&&i._xssBid)return i._xssBid;if(i&&i.slardar&&"function"==typeof i.slardar.config){var o=(i.slardar.config()||{}).bid;if(o)return o}if(i&&i.Slardar&&"function"==typeof i.Slardar.config){var s=(i.Slardar.config()||{}).bid;if(s)return s}return(null===(n=null===(t=null==i?void 0:i.Slardar)||void 0===t?void 0:t._baseParams)||void 0===n?void 0:n.bid)||"argus"},this.getConfigRegion=function(){var t,n="maliva";return m.includes(n,"region")?e.config&&e.config.region?e.config.region:((null===(t=null==M?void 0:M.gfdatav1)||void 0===t?void 0:t.region)||"cn").toLowerCase():n},this.gerReportUrl=function(){var t={cn:y("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:y("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:y("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[e.getConfigRegion()];if(t)return t+e.getSlardarBid()}}return e.prototype.setConfig=function(e){this.isSetedConfig||(this.config=e)},e.prototype.upload=function(){var e=this;if(!this.config||!this.config.isCloseSSRReport||(null==M?void 0:M.document)){var t=!1;t=String(!1);try{if((!0===(t=!t.startsWith("<%=")&&JSON.parse(t))||"true"===t)&&!(null==M?void 0:M.document))return}catch(e){console.log(e)}var n=this.gerReportUrl();!this.lock&&n&&0!==this.batchData.length&&(this.lock=!0,setTimeout(function(){var t=e.batchData.slice(0,100);e.batchData=e.batchData.slice(100),M.fetch(n,{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).catch(function(e){console.warn("xss defense report error",e)}),e.lock=!1,e.upload()},this.timeout))}},e.prototype.generateKey=function(e){return e.collectKey?[e.collectMode,e.collectKey].join("___"):""},e.prototype.push=function(e){this.batchData.push(e),this.upload()},e.prototype.report=function(e){var t=this.generateKey(e);if(M.fetch&&e.collectKey){var n="SSR";void 0!==M&&void 0!==M.location&&void 0!==M.location.href&&(n=M.location.href),e.documentUrl=n;var r={age:Math.floor(Date.now()),type:"xss",url:n,body:e,"user-agent":""};r.url="".concat(t,"___").concat(e.documentUrl),"SSR"===n&&(r.url="SSR___".concat(r.url),r.body.ssr=!0),this.push(r)}},e}());function T(e,t){return O.setConfig(t),new S(t).process(e)}var A=function(e){return -1===(e=(e=(e=(e=e.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?e.trim().toLowerCase():e.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,function(e,t,n,r){return String.fromCharCode(t?parseInt(n,16):parseInt(r))}).replace(/(\t|\n|\r)/g,"").toLowerCase()};function N(e,t){if(void 0===e&&(e=""),"string"!=typeof e)return!0;if(e=A(e),m.includes(e,"base64")&&!function(e){if(""===e||""===e.trim())return!0;try{return!m.includes(e,"data:text/html;base64")}catch(e){return!0}}(e))return t&&t("data:text/html;base64"),!1;var n=["expression(","behavior:","view-source:"];if(m.some(n,function(t){return -1!==e.indexOf(t)}))return m.forEach(n,function(n){-1!==e.indexOf(n)&&t&&t(n)}),!1;var r=["data:application","data:javascript","data:text/html","data:texthtml"];if(m.some(r,function(t){return -1!==e.indexOf(t)}))return m.forEach(r,function(n){-1!==e.indexOf(n)&&t&&t(n)}),!1;if(e.indexOf("javascript:")>0)return t&&t("javascript:"),!1;if(/^javascript:/i.test(e)){var i=e.slice(11).replace(/\s/g,"").trim();return!!m.some(["void","void(0)","void0","false","undefined",";"],function(e){return e===i})||(t&&t("javascript:"),!1)}return!0}var D=function(e,t){var n,r,i=!1;if(i=String(!1),"string"!=typeof e||(r=Number(1e4),void 0!==n&&(r=n),"NaN"!==r.toString()&&-1!==r&&e.length>=r)||N(e,t))return e;try{if(!0===(i=!i.startsWith("<%=")&&JSON.parse(i))||"true"===i){var o=new URL(e);return o.origin+o.pathname}}catch(e){return console.log(e),"#"}return"#"};function E(e,t,r){if(void 0===e&&(e=""),void 0===t&&(t=[]),"string"!=typeof e)return!0;if(!N(e=A(e)))return!1;var i,o={url:(i=e.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[])[0],scheme:i[1],slash:i[2],host:i[3],port:i[4],path:i[5],query:i[6],hash:i[7]},s=o.scheme,a=o.host;return r?!!r(e):!(!s||!a)&&(!m.includes(["http","https","file"],s)||("object"==typeof window&&window&&(t=n(n([],t,!0),[location.host],!1)),m.some(t,function(e){return!!(e instanceof RegExp&&e.test(a))||e===a})))}var I=function(e,t){for(var n={},r=0,i=m.keys(e);r<i.length;r++){var o=i[r];Array.isArray(e[o])?n[o]=m.from(e[o]):n[o]=I({},e[o])}for(var s=0,a=m.keys(t);s<a.length;s++)(o=a[s])in e?Array.isArray(e[o])?n[o]=e[o].concat(t[o]):n[o]=I(e[o],t[o]):Array.isArray(t[o])?n[o]=m.from(t[o]):n[o]=I({},t[o]);return n},P={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"],specialContentClosure:["title","style","noscript","textarea","xmp","iframe","noembed","noframes"]};try{var R={};R.blackAttrRegExps&&(R.blackAttrRegExps=R.blackAttrRegExps.map(function(e){return new RegExp(e.toString().slice(1,e.toString().length-1))}));var B="merge";m.includes(B,"override")&&(P=R),m.includes(B,"merge")&&(P=I(P,R))}catch(e){console.log(e)}var j={mode:"black",whiteList:{},blackConfig:P,collect:null,initCollect:function(){j.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var e=function(e){for(var t=0,n=function(n){Array.isArray(e[n])?0===e[n].length?delete e[n]:(e[n]=m.from(m.uniq(e[n])),t+=e[n].length):0===m.keys(e[n]).length?delete e[n]:m.keys(e[n]).forEach(function(r){e[n][r]=m.from(m.uniq(e[n][r])),t+=e[n][r].length})},r=0,i=m.keys(e);r<i.length;r++)n(i[r]);return{count:t,ret:e}}(j.collect),t=e.count,n=e.ret;return j.collect=null,{collectKey:0===t?null:JSON.stringify(n),collectMode:"black"}},onIgnoreTag:function(e,t){var n;if(!m.includes(P.blackTags,e))return b(t,function(e,t,n,r,i){if(-1!==n.indexOf("/"))return f(r);if(i)return"</".concat(n,">");var o=function(e){var t,n=(t=/\s|\n|\t/.exec(e))?t.index:-1;if(-1===n)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=e.slice(n+1,-1).trim())[e.length-1];return r&&(e=e.slice(0,-1).trim()),{html:e,closing:r}}(r),s=_(o.html,function(e,t){var r,i,o=0;if(P.blackList[n]&&m.includes(P.blackList[n],e)&&(j.collect.blackList[n]=j.collect.blackList[n]||[],j.collect.blackList[n].push(e),o++),P.blackAttrRegExps.length&&P.blackAttrRegExps.some(function(t){return t.test(e)})&&m.forEach(P.blackAttrRegExps,function(t){t.test(e)&&(j.collect.blackAttrRegExps.push("".concat(t.toString(),"->").concat(e)),o++)}),P.blackAttrs.length&&m.includes(P.blackAttrs,e)&&(P.blackAttrs.push(e),o++),!o){if(Array.isArray(P.specialContentClosure)&&"string"==typeof t&&P.specialContentClosure.find(function(e){return t.includes("</".concat(e,">"))})){null===(r=j.collect)||void 0===r||r.filterAttrs.push(e);var s="#";return t?"".concat(e,"='").concat(s,"'"):e}return P.filterList&&P.filterList[n]&&m.includes(P.filterList[n],e)?((s=D(t,function(e){var t;null===(t=j.collect)||void 0===t||t.filterProtocol.push(e)}))!==t&&(j.collect.filterList[n]=j.collect.filterList[n]||[],j.collect.filterList[n].push(e)),t?"".concat(e,"='").concat(s,"'"):e):P.filterAttrs&&m.includes(P.filterAttrs,e)?((s=D(t,function(e){var t;null===(t=j.collect)||void 0===t||t.filterProtocol.push(e)}))!==t&&(null===(i=j.collect)||void 0===i||i.filterAttrs.push(e)),t?"".concat(e,"='").concat(s,"'"):e):t?"".concat(e,"='").concat(t,"'"):e}});return r="<".concat(n),s&&(r+=" ".concat(s)),o.closing&&(r+=" /"),r+=">"},f);null===(n=j.collect)||void 0===n||n.blackTags.push(e)}},L=function(e){var t=e.reportOnly,n=void 0===t||t,r=e.block;return n&&"all"===n?"report":("string"==typeof n&&("true"===n&&(n=!0),"false"===n&&(n=!1)),r?"enforce":n?"report":"enforce")},V=function(e){return function(n,r,i){if(!n||"string"!=typeof n)return n;var o=r;e===T&&(o=j).initCollect();var s=e(n,o);if(x(s)===x(n))return n;if(!i)return s;var a=i.logType,l=L(i),c=o.removeCollect();return O.report(t(t({type:a,disposition:l},c),{sourceText:v(n.replace(/'/g,'"')),filterText:v(s.replace(/'/g,'"'))})),"enforce"===l?s:n}},F=V(function(e,t){return void 0===t&&(t={}),t&&t.whiteList||(t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new S(t).process(e)}),U=V(T),q=function(e,t,n){var r=[],i=D(e,function(e){r.push(e)});if(i===e)return e;r=m.from(m.uniq(r));var o=t||n||{};if(!o)return i;var s=o.logType,a=L(n);return O.report({type:s,disposition:a,collectKey:r.join("___"),collectData:JSON.stringify(r),collectMode:"black",sourceText:v(e),filterText:v(i)}),"enforce"===a?i:e},W=M._xssProject||{},H=M.xssNamespace||{},z="3.1.4",Z={FilterXSS:S,version:z,webpackPluginVersion:"3.1.9",reportOnly:"all",filterXSS:F,_filterXSS:U,filterUrl:q,BlackConfig:j,project:W,setProjectName:function(e){W[e]=this,M._xssProjectName=e}};H["lvweb/smart-tools"]=Z,M.xssNamespace=H,M.Math&&!M.Math.xssNamespace&&(M.Math.xssNamespace=H),W[z]=Z,M.globalThis=M,M.getFilterXss=function(){return void 0!==this._xssProjectName?this._xssProject[this._xssProjectName]:Z},M.xss=Z,M.isSafeUrl=E,M.isSafeDomain=E,M.isSafeProtocol=N,M._xssProject=W,M._xssProjectName&&(W[M._xssProjectName]=Z);var G=Z.setProjectName.bind(Z);e.BlackConfig=j,e.FilterXSS=S,e._filterXSS=U,e.filterUrl=q,e.filterXSS=F,e.isSafeDomain=E,e.isSafeProtocol=N,e.isSafeUrl=E,e.project=W,e.setProjectName=G,e.setXssNamespace=function(e){var t=e.appId,n=e.bid,r=e.region,i=e.isCloseSSRReport;H[t]=Z,j.bid=n,j.region=r,j.enabled=!0,j.isCloseSSRReport=i},e.xssNamespace=H,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xss={}),(self.webpackChunksmart_tools=self.webpackChunksmart_tools||[]).push([["5245"],{614343:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(269001),o=n(471664);t.default=function(e){var t=this;this.sendCode=function(e){var n=e.mobile,s=e.unbind_exist,a=e.extra_params,l=(0,i.encryptParams)(r({mobile:n,type:17,unbind_exist:void 0===s?0:s},void 0===a?{}:a),["mobile","type","unbind_exist"]);return t.request({url:o.WEB_URL.SEND_MOBILE_CODE,method:"POST",data:l})},this.bindMobile=function(e){void 0===e&&(e={});var n=e.mobile,s=e.code,a=e.password,l=e.verify_ticket,c=e.unbind_exist,d=e.extra_params,u=(0,i.encryptParams)(r({mobile:n,code:s,password:a,verify_ticket:l,unbind_exist:void 0===c?0:c,type:17},void 0===d?{}:d),["mobile","code","password","unbind_exist","type"]);return t.request({url:o.WEB_URL.MOBILE_BIND,method:"POST",data:u})},this.sendEmailCode=function(e){var n=e.email,s=e.extra_params,a=(0,i.encryptParams)(r({email:n,type:8},void 0===s?{}:s),["email","type"]);return new Promise(function(e,n){t.request({url:o.WEB_URL.SEND_EMAIL_CODE,method:"POST",data:a}).then(function(t){e(t)}).catch(function(e){n(e)})})},this.bindEmail=function(e){var n=e.email,s=e.code,a=e.extra_params,l=(0,i.encryptParams)(r({email:n,code:s},void 0===a?{}:a),["email","code"]);return new Promise(function(e,n){t.request({url:o.WEB_URL.EMAIL_BIND,method:"POST",data:l}).then(function(t){e(t)}).catch(function(e){n(e)})})},this.bindAuth=function(e){var n=e.platform_app_id,i=e.code,s=e.access_token,a=e.access_token_secret,l=e.openid,c=e.profile_key,d=e.extra_params,u=void 0===d?{}:d;return new Promise(function(e,d){t.request({url:o.WEB_URL.AUTH_BIND,method:"POST",data:r({platform_app_id:n,code:i,access_token:s,access_token_secret:a,openid:l,profile_key:c},u)}).then(function(t){e(t)}).catch(function(e){d(e)})})},this.unbindAuth=function(e){var n=e.platform,i=e.extra_params,s=void 0===i?{}:i;return new Promise(function(e,i){t.request({url:o.WEB_URL.AUTH_UNBIND,method:"POST",data:r({platform:n},s)}).then(function(t){e(t)}).catch(function(e){i(e)})})},this.switchBindAuth=function(e){var n=e.platform_app_id,i=e.profile_key,s=e.extra_params,a=void 0===s?{}:s;return new Promise(function(e,s){t.request({url:o.WEB_URL.AUTH_SWITCH_BIND,method:"POST",data:r({platform_app_id:n,profile_key:i},a)}).then(function(t){e(t)}).catch(function(e){s(e)})})},this.changeQrcodeSuccess=function(e){var n=e.token,i=e.extra_params;return t.request({url:o.WEB_URL.CHANGE_QRCODE_SUCCESS,method:"POST",data:r({token:n},void 0===i?{}:i)})},this.changeQrcodeComfirm=function(e){var n=e.token,i=e.verify_ticket,s=e.extra_params;return t.request({url:o.WEB_URL.CHANGE_QRCODE_CONFIRM,method:"POST",data:r({token:n,verify_ticket:i},void 0===s?{}:s)})};var n=e.request;this.request=n}},12413:function(e,t,n){"use strict";n.d(t,{B:function(){return s}});var r=n(386859),i=n(858708),o=n(182855),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return(0,i.uc)(r,o.a6,t,n),r}return(0,r.d)(t,e),t}(n(276673).O)},45327:function(e,t,n){"use strict";n.d(t,{D:function(){return s}});var r=n(190595),i=n(929766);n(218571),n(195291);var o=n(156194);function s(e,t,n){var s=(n||{}).PluginContextProvider;s&&(0,i.RM)(s),(0,i.$i)(!0);var a=(0,o.az)(e,t);s&&(0,i.RM)(null),(0,i.$i)(!1);var l=document.createElement("div");return Array.isArray(a)?l.append.apply(l,(0,r.d)(a)):l.append(a),l.innerHTML}},895753:function(e,t,n){"use strict";n.d(t,{R:function(){return o}});var r=n(190595),i=n(789771);function o(e){var t=e.content,n=(0,r._)(e,["content"]),o=document.createElement("span");return(0,i.T)(o,n),"string"==typeof t&&(o.textContent=t),o}},896679:function(e,t,n){"use strict";n.d(t,{ZP:function(){return r}}),n(218571),n(195291);let r=n(51111).z},632099:function(e,t,n){"use strict";function r(e,t,n){var r,i,o,s,a,l,c=0,d=!1,u=!1,h=!0,p=!t&&0!==t&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof e)throw TypeError("Expected a function");function f(t){var n=r,o=i;return r=i=void 0,c=t,s=e.apply(o,n)}function m(e,t){return p?(window.cancelAnimationFrame(a),window.requestAnimationFrame(e)):setTimeout(e,t)}function g(e){var n=e-l,r=e-c;return void 0===l||n>=t||n<0||u&&r>=o}function v(){var e,n,r,i=Date.now();if(g(i))return y(i);a=m(v,(e=i-l,n=i-c,r=t-e,u?Math.min(r,o-n):r))}function y(e){return(a=void 0,h&&r)?f(e):(r=i=void 0,s)}function b(){for(var e,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var h=Date.now(),p=g(h);if(r=n,i=this,l=h,p){if(void 0===a)return c=e=l,a=m(v,t),d?f(e):s;if(u)return a=m(v,t),f(l)}return void 0===a&&(a=m(v,t)),s}return t=+t||0,"object"==typeof n&&(d=!!n.leading,o=(u="maxWait"in n)?Math.max(+n.maxWait||0,t):o,h="trailing"in n?!!n.trailing:h),b.cancel=function(){void 0!==a&&function(e){if(p)return window.cancelAnimationFrame(e);clearTimeout(e)}(a),c=0,r=l=i=a=void 0},b.flush=function(){return void 0===a?s:y(Date.now())},b.pending=function(){return void 0!==a},b}n.d(t,{D:function(){return r}})},502031:function(e,t,n){"use strict";function r(e){return!!["div","p","blockquote","li","h1","h2","h3","h4","h5","h6","ol","table","td","th","tr","ul","address","article","canvas","dd","dl","dt","fieldset","figcaption","figure","footer","form","header","iframe","main","nav","output","pre","section","video"].includes(e.nodeName.toLowerCase())&&(!(e instanceof HTMLElement)||!(e.style.display&&"inline"===e.style.display))}n.d(t,{P:function(){return r}})},493360:function(e,t,n){"use strict";function r(e,t,n){e.loadNamespaces(t,function(){if(e.isInitialized)n();else{var t=function(){setTimeout(function(){e.off("initialized",t)},0),n()};e.on("initialized",t)}})}function i(e,t,n){if(void 0===n&&(n={}),!t.languages||!t.languages.length)return console.warn("i18n.languages were undefined or empty",t.languages),!0;var r=t.languages[0],i=!!t.options&&t.options.fallbackLng,o=t.languages[t.languages.length-1];if("cimode"===r.toLowerCase())return!0;var s=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return -1===r||2===r};return(!(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1)||!t.services.backendConnector.backend||!t.isLanguageChangingTo||!!s(t.isLanguageChangingTo,e))&&!!(t.hasResourceBundle(r,e)||!t.services.backendConnector.backend||s(r,e)&&(!i||s(o,e)))}n.d(t,{DC:function(){return r},F0:function(){return i}})},56052:function(e,t,n){"use strict";n.d(t,{Z1:function(){return u},in:function(){return h},lg:function(){return f},mL:function(){return v},rA:function(){return m},tR:function(){return d},yv:function(){return g},yy:function(){return p}});var r,i,o,s,a,l,c,d=((r=d||{}).beforeFetchUserInfo="beforeFetchUserInfo",r.afterFetchUserInfo="afterFetchUserInfo",r.beforeFetchConsentData="beforeFetchConsentData",r.afterFetchConsentData="afterFetchConsentData",r.beforeFetchNotificationData="beforeFetchNotificationData",r.afterFetchNotificationData="afterFetchNotificationData",r.beforeUpdateRecords="beforeUpdateRecords",r.afterUpdateRecords="afterUpdateRecords",r.beforeNotify="beforeNotify",r.afterNotify="afterNotify",r.beforeRemoveNotification="beforeRemoveNotification",r.afterRemoveNotification="afterRemoveNotification",r.beforeThirdPartyApprove="beforeThirdPartyApprove",r.afterThirdPartyApprove="afterThirdPartyApprove",r.beforeThirdPartyReject="beforeThirdPartyReject",r.afterThirdPartyReject="afterThirdPartyReject",r),u=((i=u||{}).sessionStorage="sessionStorage",i.localStorage="localStorage",i.inMem="inMem",i),h=((o=h||{}).INFO="info",o.WARN="warn",o.ERROR="error",o),p=((s=p||{}).AND="AND",s.OR="OR",s),f=((a=f||{}).UNSUPPORTED="Unsupported",a.APPROVE="Approve",a.REJECT="Reject",a);let m={Unsupported:0,Approve:1,Reject:2};var g=((l=g||{}).DEVICE_ID="DeviceID",l.USER_ID="UserID",l.ANY="Any",l.BOTH="Both",l),v=((c=v||{}).DEVICE_CONSENT="device",c.USER_CONSENT="user",c.BOTH_CONSENT="both",c.NOTIFICATION="notification",c)},897863:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var r=n(203037).Z},123356:function(){},412382:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r={Breadcrumbs_Container:"Breadcrumbs_Container-p2oGC1",breadcrumbsContainer:"Breadcrumbs_Container-p2oGC1",Breadcrumbs:"Breadcrumbs-u9l153",breadcrumbs:"Breadcrumbs-u9l153",Breadcrumbs_More:"Breadcrumbs_More-RdKl1p",breadcrumbsMore:"Breadcrumbs_More-RdKl1p",BreadcrumbsItem:"BreadcrumbsItem-WJ2W5F",breadcrumbsItem:"BreadcrumbsItem-WJ2W5F",BreadcrumbsMoreIcon:"BreadcrumbsMoreIcon-KUKB_E",breadcrumbsMoreIcon:"BreadcrumbsMoreIcon-KUKB_E",BreadcrumbsSplitIcon:"BreadcrumbsSplitIcon-QMYZhj",breadcrumbsSplitIcon:"BreadcrumbsSplitIcon-QMYZhj"}},245934:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r={"report-btn":"report-btn-R_W0YJ",reportBtn:"report-btn-R_W0YJ","report-icon":"report-icon-vOHiBO",reportIcon:"report-icon-vOHiBO"}},950059:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r={assetVideo:"assetVideo-WB481M",error:"error-lxXIvg",errorInfo:"errorInfo-HkIueB",errorInfoIcon:"errorInfoIcon-C9chEk",switchContainer:"switchContainer-neFHxs",text:"text-OtZnTG",disable:"disable-ap6ho2",exportVideo:"exportVideo-m63MCG"}},302387:function(){},590447:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r={renameContainer:"renameContainer-aY2V88",content:"content-VLlILa",list:"list-ST_kq0",failedMessage:"failedMessage-UfA5Yt",actionGroup:"actionGroup-L6OjJg"}},314337:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r={container:"container-alGcAJ",elementFadeIn:"elementFadeIn-Tga8ER",left:"left-royBlA",right:"right-kTs3bL",body:"body-Te6bT7",title:"title-oifIwh",content:"content-Zazn9v",icon:"icon-SgK6sq",elementFadeOut:"elementFadeOut-MOGD7H"}},22508:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r={mark:"mark-Ix1Z8Q"}},105789:function(e){!/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/function(){"use strict";var t={}.hasOwnProperty;function n(){for(var e=[],r=0;r<arguments.length;r++){var i=arguments[r];if(i){var o=typeof i;if("string"===o||"number"===o)e.push(i);else if(Array.isArray(i)){if(i.length){var s=n.apply(null,i);s&&e.push(s)}}else if("object"===o){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){e.push(i.toString());continue}for(var a in i)t.call(i,a)&&i[a]&&e.push(a)}}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],function(){return n}):window.classNames=n}()},195291:function(e,t,n){"use strict";(function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}})(),e.exports=n(915850)},603892:function(e,t,n){"use strict";n.d(t,{b:function(){return l}});var r=n(826637),i=n(923428),o=n(683738),s=n(689425),a=n(429152),l=function(){var e,t;function n(e){var t=this;(0,r.PA)(this,n),(0,r._x)(this,"error",null),(0,r._x)(this,"_emitOnLoaded",function(e,n){var r=e.data,o=e.response,s=e.option||{},a=s.firstByteTime,l=s.startTime,c=s.endTime,d=s.contentLength,u=c-l;t._bandwidthService.addRecord(d||r.byteLength,u),t.hls.emit(i.K.SPEED,{time:u,byteLength:d,url:n}),t.hls.emit(i.K.LOAD_COMPLETE,{url:n,elapsed:u||0}),t.hls.emit(i.K.TTFB,{url:n,responseUrl:o.url,elapsed:a-l}),t.hls.emit(i.K.LOAD_RESPONSE_HEADERS,{headers:o.headers})}),(0,r._x)(this,"_onLoaderRetry",function(e,n){t.hls.emit(i.K.LOAD_RETRY,{error:o.Fc.network(e),retryTime:n})}),this.hls=e,this._bandwidthService=new s.W,this._mapCache={},this._keyCache={};var l=this.hls.config,c=l.retryCount,d=l.retryDelay,u=l.loadTimeout,h=l.fetchOptions;this._segmentLoader=new a.mf((0,r.Zj)((0,r.Zj)({},h),{},{responseType:"arraybuffer",retry:c,retryDelay:d,timeout:u,onRetryError:this._onLoaderRetry})),this._audioSegmentLoader=new a.mf((0,r.Zj)((0,r.Zj)({},h),{},{responseType:"arraybuffer",retry:c,retryDelay:d,timeout:u,onRetryError:this._onLoaderRetry})),this._keyLoader=new a.mf((0,r.Zj)((0,r.Zj)({},h),{},{responseType:"arraybuffer",retry:c,retryDelay:d,timeout:u,onRetryError:this._onLoaderRetry}))}return(0,r.qH)(n,[{key:"speedInfo",value:function(){return{speed:this._bandwidthService.getLatestSpeed(),avgSpeed:this._bandwidthService.getAvgSpeed()}}},{key:"load",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,i=[];return e&&(i[0]=this.loadVideoSegment(e,n)),t&&(i[1]=this.loadAudioSegment(t,r)),Promise.all(i)}},{key:"loadVideoSegment",value:function(e,t){return this._loadSegment(this._segmentLoader,e,t)}},{key:"loadAudioSegment",value:function(e,t){return this._loadSegment(this._audioSegmentLoader,e,t)}},{key:"_loadSegment",value:(e=(0,r.x)((0,r.l5)().mark(function e(t,n,o){var s,a,l,c,d,u,h,p,f,m,g,v,y,b,_=this;return(0,r.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=[],this.hls.emit(i.K.LOAD_START,{url:n.url}),u[0]=t.load(n.url),o&&n.initSegment&&(p=n.initSegment.url,(s=this._mapCache[p])||(this.hls.emit(i.K.LOAD_START,{url:p}),u[1]=t.load(p).then(function(e){e&&(Object.keys(_._mapCache)>30&&(_._mapCache={}),s=_._mapCache[p]=e.data,_._emitOnLoaded(e,p))})),(f=null===(h=n.initSegment.key)||void 0===h?void 0:h.url)&&(d=n.initSegment.key.iv,(c=this._keyCache[f])||(this.hls.emit(i.K.LOAD_START,{url:f}),u[2]=this._keyLoader.load(f).then(function(e){e&&(c=_._keyCache[f]=e.data,_._emitOnLoaded(e,f))})))),(m=null===(b=n.key)||void 0===b?void 0:b.url)&&(l=n.key.iv,(a=this._keyCache[m])||(this.hls.emit(i.K.LOAD_START,{url:m}),u[3]=this._keyLoader.load(m).then(function(e){e&&(a=_._keyCache[m]=e.data,_._emitOnLoaded(e,m))}))),e.next=8,Promise.all(u);case 8:if(g=e.sent,v=(0,r.ZQ)(g,1)[0]){e.next=13;break}return e.abrupt("return");case 13:return y=v.data,this._emitOnLoaded(v,n.url),e.abrupt("return",{data:y,map:s,key:a,mapKey:c,keyIv:l,mapKeyIv:d});case 16:case"end":return e.stop()}},e,this)})),function(t,n,r){return e.apply(this,arguments)})},{key:"reset",value:function(){this.error=null,this._mapCache={},this._keyCache={},this._bandwidthService.reset()}},{key:"cancel",value:(t=(0,r.x)((0,r.l5)().mark(function e(){return(0,r.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this._keyLoader.cancel(),this._segmentLoader.cancel(),this._audioSegmentLoader.cancel()]);case 2:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})}]),n}()},690516:function(e,t,n){"use strict";n.d(t,{X:function(){return i}});var r=n(949024),i=(0,r.qH)(function e(t,n,i,o){(0,r.PA)(this,e),(0,r._x)(this,"duration",1024),(0,r._x)(this,"flag",{dependsOn:2,isNonSyncSample:0}),(0,r._x)(this,"keyframe",!0),this.originPts=this.pts=this.dts=t,this.data=n,this.size=n.byteLength,this.sampleOffset=o,i&&(this.duration=i)})},971921:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(949024),i=n(400880),o=function(){function e(){(0,r.PA)(this,e),(0,r._x)(this,"id",2),(0,r._x)(this,"type",i.Vc.AUDIO),(0,r._x)(this,"codecType",i.yQ.AAC),(0,r._x)(this,"pid",-1),(0,r._x)(this,"codec",""),(0,r._x)(this,"sequenceNumber",0),(0,r._x)(this,"sampleDuration",0),(0,r._x)(this,"timescale",0),(0,r._x)(this,"formatTimescale",0),(0,r._x)(this,"baseMediaDecodeTime",0),(0,r._x)(this,"duration",0),(0,r._x)(this,"warnings",[]),(0,r._x)(this,"samples",[]),(0,r._x)(this,"baseDts",0),(0,r._x)(this,"sampleSize",16),(0,r._x)(this,"sampleRate",0),(0,r._x)(this,"channelCount",0),(0,r._x)(this,"objectType",0),(0,r._x)(this,"sampleRateIndex",0),(0,r._x)(this,"config",[]),(0,r._x)(this,"present",!1),(0,r._x)(this,"isVideoEncryption",!1),(0,r._x)(this,"isAudioEncryption",!1),(0,r._x)(this,"kid",null),(0,r._x)(this,"ext",void 0)}return(0,r.qH)(e,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec&&this.codecType===i.yQ.AAC)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isAudioEncryption}}]),e}()},853459:function(e,t,n){"use strict";n.d(t,{G:function(){return s},Ij:function(){return function e(t,n){return"compound"===n.type?s(n).some(function(e){return"final"===e.type&&u(t,e)}):"parallel"===n.type&&s(n).every(function(n){return e(t,n)})}},N9:function(){return o},NA:function(){return d},Oe:function(){return f},P_:function(){return l},ac:function(){return a},e$:function(){return u},nJ:function(){return h},xZ:function(){return p}});var r=n(188389),i=n(404382),o=function(e){return"atomic"===e.type||"final"===e.type};function s(e){return Object.keys(e.states).map(function(t){return e.states[t]})}function a(e){var t=[e];return o(e)?t:t.concat((0,i.xH)(s(e).map(a)))}function l(e,t){var n,i,o,a,l,d,u,h,p=c(new Set(e)),f=new Set(t);try{for(var m=(0,r.XA)(f),g=m.next();!g.done;g=m.next())for(var v=g.value,y=v.parent;y&&!f.has(y);)f.add(y),y=y.parent}catch(e){n={error:e}}finally{try{g&&!g.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}var b=c(f);try{for(var _=(0,r.XA)(f),w=_.next();!w.done;w=_.next()){var v=w.value;if("compound"!==v.type||b.get(v)&&b.get(v).length){if("parallel"===v.type)try{for(var x=(l=void 0,(0,r.XA)(s(v))),S=x.next();!S.done;S=x.next()){var k=S.value;"history"!==k.type&&(f.has(k)||(f.add(k),p.get(k)?p.get(k).forEach(function(e){return f.add(e)}):k.initialStateNodes.forEach(function(e){return f.add(e)})))}}catch(e){l={error:e}}finally{try{S&&!S.done&&(d=x.return)&&d.call(x)}finally{if(l)throw l.error}}}else p.get(v)?p.get(v).forEach(function(e){return f.add(e)}):v.initialStateNodes.forEach(function(e){return f.add(e)})}}catch(e){o={error:e}}finally{try{w&&!w.done&&(a=_.return)&&a.call(_)}finally{if(o)throw o.error}}try{for(var C=(0,r.XA)(f),M=C.next();!M.done;M=C.next())for(var v=M.value,y=v.parent;y&&!f.has(y);)f.add(y),y=y.parent}catch(e){u={error:e}}finally{try{M&&!M.done&&(h=C.return)&&h.call(C)}finally{if(u)throw u.error}}return f}function c(e){var t,n,i=new Map;try{for(var o=(0,r.XA)(e),s=o.next();!s.done;s=o.next()){var a=s.value;i.has(a)||i.set(a,[]),a.parent&&(i.has(a.parent)||i.set(a.parent,[]),i.get(a.parent).push(a))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i}function d(e,t){var n=l([e],t);return function e(t,n){var r=n.get(t);if(!r)return{};if("compound"===t.type){var i=r[0];if(!i)return{};if(o(i))return i.key}var s={};return r.forEach(function(t){s[t.key]=e(t,n)}),s}(e,c(n))}function u(e,t){return Array.isArray(e)?e.some(function(e){return e===t}):e instanceof Set&&e.has(t)}function h(e){return(0,r.ev)([],(0,r.CR)(new Set((0,i.xH)((0,r.ev)([],(0,r.CR)(e.map(function(e){return e.ownEvents})),!1)))),!1)}function p(e){return void 0===e&&(e=[]),e.reduce(function(e,t){return void 0!==t.meta&&(e[t.id]=t.meta),e},{})}function f(e){return new Set((0,i.xH)(e.map(function(e){return e.tags})))}},285112:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAZhSURBVHgB5Zw9bBNLEMdn12fzHCTwK7BdAM/UIOVFooLG0FG9RwN0ThpKkhTUEIkOpAQ6KuIOqrxXUcYNVEgECWocoLBNcyCRQHy+ZWbti84fZ9+u7+w75yclF58d++7vmdnZmdtjMEFEoZBpNpsFsKwiA/gLdxUEwN/0HBOi0PVaxqq4zwTGTHy4g6/bZYztJGu1CkwQBiEjRdnfX8QP+geEIDEyMC6MVYRtl5OJRIXValUIkVAE6hGlCGHSESv19esmhECgApEw1t7eMv65AkFYigJ4IlV0w02D83KQVhWIQNMUphdHqGSjsQYBMLZAzXy+iCb+DN+oABGChMLNqtFo/AdjoC2QtJofP+5hDFiBKMPYhpFOr7Fq1QQNtATaz+cLCdvejprVeEHWlOD8ik5s4qAIuZRh22/jIg6BMalg4TFb2ey/oIiSQAe53DKg5cCUA7EmGRRq62cupxQSfAvUzGbvYWa7ATEnIcQ6nYvf1/uKQWQ5syCOmxZjq3/U6yPPaaRA5LdkmjCLYOAeNbcbKhCNVhSQIZ4xxw8mZt4Lw0Y3zxhEeU4ivgHZL5kWniOdq9cLPAWiJDBOQ7kuMgXY3/cM2gNdbKbjjhce8WigBdkA63DEYDifHORqfQLJfOcIuFYv0tX29vqSyC4Xi9scKwRMY27unHti22VBOKSXjrA4RKbXiros6CCb/Ti2QCdOADt5EoB+zpxpb+mDcD89dwjuZ+7HQxCfP3fv+P4dBP5InOc+fep/nR5dVmQ4ew9OnVrUFYdduwb85k2ACxeAkSgBo1STIfFevQLx8iXYL16ABrKejtuNrs9u5nLbygV2tIBEuQzs0iWIIuL1a2iVSlI0JbARkKzXr8g/6VdnSvERFOFPnrQtJ8JIka5fB1XQzf4kN5NBOtFqFUERspqoi0PQcbLLl0GVjpu1RzHGeQkUYbduQVzgN26AKrKnB84wr9HcY+fPQ1zQsSDqAlNmzanGDBowHLFig97IKq8j4KLdL5/EB04VrfTDsoocJ2kFUCSoXIdGGAgmuRtNJ2FVgfJCjtP8eZgSlNBZOATbDx9C2Oh8qbYUSAj1imGQLoYWZD96BNbFi2A/fw6h4XNa4wY7IPNcRKWkSkItL7eTukm5nQ+4zvyLhRikKS5Ja7pzJ1ihNGKQkC4WUWiiGWh80nAxIrICSSYVn4YQbYEcvn0D+PIFpoGBflaNchWRJsT8wQNtFxkHumzGgIgiqwV370611iQYMw1UaQcULUiEOQyjpZDFBF5K0Ttm08BEcRcraBAFyGL47dtTcScP3hmCc7qiXem/lEuYIyA3SmB1MsxJsNAI8kLGINuuKFsQjSpBcPYsJLa2IlvTpqUPTGQyGSuVonq0/ykHftPGmzcQJ1qYS6nGzmSjwTgzTVowsqP0nxGaK/lFeWDBzgZtZKKIvvY/KCLiJNKHD6AKDvFl2kqBkr9+bYIiVMuJCwK7rqokASq0bXc12m5WUXoHjW9lWlCXVQnUwrks73Aupupmsq0bBzejCa9iC9pxL+JQoI6b+V/PgEO9FbHiVh94bJZiVxWH9mqqVtt0Hh8KJN0M4DGo0DkAWYoIOHkcCzwW++lTsK5eVf4CsctTdj/uyhC1ciL3m1GvjKYJmACy06fb+5zs2Lkkxo3fzJkSU/cXQI87yaozmspMmfa9f689wpL1JBjrWvTSl0I3s9n7uPF9qf6MsYbJ4X33jj6ByIqax4697V2FPOuQ9Rj1+rne/X0VRYpF+OIlOGoIsTpo98CSq7xeWAi1gB1nGHvstXTTcxp/VFxNBuZ0esFryaZn0Z5crYURHVRyo/hhylFryHrWoV2NNA13nKtfvxYT0H2WRq1jHdn2oXiEqfcqzBh0Tn6WjPvqi6XaK/PWYHZYS/lYbUgo1VoPcrkVDNqxXuhCluNXHEK5ndFZKvUM4rfQzqR4qnp7Hf0bCwixHZcUYNAcyy9avXka3bA8shCLZBKTQJnnaN4RZuyOIbmczdh61KyJrAbjzdK4d6wKrKVKVQA8oFIEhJJ1LWNubkP3hiZuAu05d9Z8LE5JqECFcQitKX+Qzy+iSKWJ3KIL6+nJdHozSGEO3x5CRo54AMUAxZKNzjBFcTPxyzrkHavaV/cX8MPn6TJkdMnMoNsE0hb37+Dfu0B3lLLtSvL48WrYorj5DdJ3uq+buBITAAAAAElFTkSuQmCC"},723887:function(e,t,n){"use strict";e.exports=n.p+"static/image/video_stabilization_cover.0c97b3df.jpg"},741445:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIPSURBVHgB7ZltbcMwEIZfDUEhGMIgGEIhGMIYzAw2Bi2DloHDYGNgDUHHIIu1RsouZ8d2cqkm+ZHuR3P+eu/8kbhAo9Fo/GfUYG6w22B9hV3ubYigB/sY7ID44GsHPrUb4iLC8xAggwLUvdLYwVuk3BXrBz+ai/RxnpQ5ITNblungmSnXb2g3pn3FlHtBJh7LEeo3NsqF+D0K0EwHGvsJMIzfoBCHeQSmC1pSgCe+KypQTCcW8gJeGZ9CJe+ILzYpAZ48PyHBE9J8kt/fkIeeO19YAY2GnfikMmARz3oRBum5KCXggPkJf0QFHum5KCUgQNeeQyEa6ehLC1CMX6MAh+WdQFIAN4bsLCjkqZcWoDPHMeNMKnWRctICAg7LM2FxYCaznISAIykz21K5g4weXgqPg26fWQdpeOemqrmvMukMKMy3coMMuIPEYn8Bhvg9CrBYmHsA+o2N4ok/+2sswGXBYD8BhvErFGJJAw77CfDEd0IFB6YTDXkBR2wQ/RF6deIgL8Bhg+iPcNGQFkCfV71Kj3jSWAd5AQ7xrBdhkJ6LUgI049OowCM9F6UEBBzxeRRikI6+tADF+IsOMo909KUFBLgrndhN+R9esRx9YJur9ZSA3HeyGQq/u81SJQesHvRosatDOynToXAx63slFfGH59J/cIQsXFG5C+WgUP9HRxh4h8d+MDUajcZKfgDs9KgPNHQcXQAAAABJRU5ErkJggg=="},987969:function(e,t,n){"use strict";n.d(t,{r:function(){return s}});var r=n(69984),i=n(764112),o=n(772322);n(218571);var s=e=>(0,o.jsxs)("svg",(0,i._)((0,r._)({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),{children:[(0,o.jsx)("path",{fill:"url(#failed_svg__a)",fillOpacity:.4,fillRule:"evenodd",d:"M28.524 2.045a1.17 1.17 0 0 1 2.34 0v3.512a1.17 1.17 0 1 1-2.34 0zM44.299 29.73q.369.637.7 1.285l-27.28 15.75L2.4 20.23q.932-.638 1.926-1.212c13.996-8.08 31.893-3.285 39.973 10.71M39.341 5.213a1.17 1.17 0 0 1 0 1.655l-2.483 2.483a1.17 1.17 0 1 1-1.655-1.655l2.483-2.483a1.17 1.17 0 0 1 1.655 0",clipRule:"evenodd"}),(0,o.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M24.256 10.035a1.17 1.17 0 0 1 1.152-.965h4.437A1.17 1.17 0 0 1 30.96 10.6L27.5 21.36h1.991c.886 0 1.45.946 1.031 1.726L19.161 44.185l5.762-18.728H22.9a1.17 1.17 0 0 1-1.152-1.376zM4.53 21.325a27.96 27.96 0 0 1 15.14-7.83l-.303 3.63a24.47 24.47 0 0 0-12.354 6.683 1.756 1.756 0 0 1-2.483-2.483m29.673-6.467-1.111 3.335a24.5 24.5 0 0 1 8.683 5.615 1.756 1.756 0 0 0 2.483-2.483 28 28 0 0 0-10.055-6.467m-23.88 12.26a19.8 19.8 0 0 1 8.634-5.074l-.316 3.797a16.3 16.3 0 0 0-5.834 3.76 1.756 1.756 0 0 1-2.484-2.482m23.484-3.466-1.98 2.928a16.4 16.4 0 0 1 4.154 3.022 1.756 1.756 0 0 0 2.483-2.483 19.9 19.9 0 0 0-4.657-3.467m-17.69 9.26a11.65 11.65 0 0 1 4.783-2.897l-.599 4.074a8.2 8.2 0 0 0-1.7 1.306 1.756 1.756 0 1 1-2.484-2.483m13.057-2.41-2.012 2.973a8.2 8.2 0 0 1 3.025 1.92 1.756 1.756 0 1 0 2.483-2.483 11.7 11.7 0 0 0-3.496-2.41m-4.855 7.176L21.93 41.21l1.24 1.274a1.756 1.756 0 0 0 2.55-.036l1.207-1.312a1.756 1.756 0 0 0-.05-2.43 3.5 3.5 0 0 0-2.558-1.028",clipRule:"evenodd"}),(0,o.jsx)("defs",{children:(0,o.jsxs)("linearGradient",{id:"failed_svg__a",x1:2.579,x2:45.208,y1:15.694,y2:15.694,gradientUnits:"userSpaceOnUse",children:[(0,o.jsx)("stop",{stopColor:"#A799FF"}),(0,o.jsx)("stop",{offset:1,stopColor:"#91BEFB"})]})})]}))},500576:function(e,t,n){"use strict";n.d(t,{r:function(){return s}});var r=n(69984),i=n(764112),o=n(772322);n(218571);var s=e=>(0,o.jsxs)("svg",(0,i._)((0,r._)({xmlns:"http://www.w3.org/2000/svg",width:24,height:25,fill:"none",viewBox:"0 0 24 25"},e),{children:[(0,o.jsx)("path",{fill:"#000",fillOpacity:.01,d:"M0 .133h24v24H0z"}),(0,o.jsx)("path",{fill:"#00C17C",fillRule:"evenodd",d:"M5 5.133h14v14h-7v-7a2 2 0 0 0-2-2H5zm-2 7v-7a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",clipRule:"evenodd"})]}))},187157:function(e,t,n){"use strict";n.d(t,{r:function(){return s}});var r=n(69984),i=n(764112),o=n(772322);n(218571);var s=e=>(0,o.jsx)("svg",(0,i._)((0,r._)({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",viewBox:"0 0 20 20"},e),{children:(0,o.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M3.023 5.4a2.325 2.325 0 0 1 2.325-2.325h9.3A2.325 2.325 0 0 1 16.973 5.4v9.3a2.325 2.325 0 0 1-2.325 2.325h-9.3A2.325 2.325 0 0 1 3.023 14.7zm10.85 2.325a1.55 1.55 0 1 1-3.1 0 1.55 1.55 0 0 1 3.1 0m-9.301 6.744 2.457-2.33a.39.39 0 0 1 .53-.001l3.573 3.337h2.27l-4.784-4.47a1.937 1.937 0 0 0-2.656.01l-1.39 1.318z",clipRule:"evenodd"})}))},146717:function(e,t,n){"use strict";n.d(t,{r:function(){return s}});var r=n(69984),i=n(764112),o=n(772322);n(218571);var s=e=>(0,o.jsxs)("svg",(0,i._)((0,r._)({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},e),{children:[(0,o.jsx)("g",{filter:"url(#spin-loading-black_svg__a)",opacity:.12,children:(0,o.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M12 17.555a5.556 5.556 0 1 0 0-11.11 5.556 5.556 0 0 0 0 11.11m0 2.778a8.333 8.333 0 1 0 0-16.666 8.333 8.333 0 0 0 0 16.666",clipRule:"evenodd"})}),(0,o.jsx)("g",{filter:"url(#spin-loading-black_svg__b)",children:(0,o.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M12 6.444A5.556 5.556 0 1 0 17.556 12a1.389 1.389 0 0 1 2.777 0A8.333 8.333 0 1 1 12 3.667a1.389 1.389 0 0 1 0 2.777",clipRule:"evenodd"})}),(0,o.jsxs)("defs",{children:[(0,o.jsxs)("filter",{id:"spin-loading-black_svg__a",width:23.333,height:23.333,x:.333,y:.375,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,o.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,o.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,o.jsx)("feOffset",{dy:.042}),(0,o.jsx)("feGaussianBlur",{stdDeviation:1.667}),(0,o.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,o.jsx)("feColorMatrix",{values:"0 0 0 0 0.121569 0 0 0 0 0.258824 0 0 0 0 0.4 0 0 0 0.04 0"}),(0,o.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_17_6892"}),(0,o.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_17_6892",result:"shape"})]}),(0,o.jsxs)("filter",{id:"spin-loading-black_svg__b",width:23.333,height:23.333,x:.333,y:.375,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,o.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,o.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,o.jsx)("feOffset",{dy:.042}),(0,o.jsx)("feGaussianBlur",{stdDeviation:1.667}),(0,o.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,o.jsx)("feColorMatrix",{values:"0 0 0 0 0.121569 0 0 0 0 0.258824 0 0 0 0 0.4 0 0 0 0.04 0"}),(0,o.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_17_6892"}),(0,o.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_17_6892",result:"shape"})]})]})]}))},575065:function(e,t,n){"use strict";var r=n(46395),i=n(978495);(0,r.cE)({App:i.Z})},285617:function(e,t,n){"use strict";n.d(t,{U:function(){return u}});var r=n(461228),i=n(676113),o=n(123951),s=n(91933),a=n(555177),l=n(710799),c={baseURL:"/lv/v1/user",method:"POST",headers:{loc:s.yM.CHANNEL,lan:o.ZP.language||s.yM.LAN,pf:s.yM.APP_PF,appvr:s.yM.VERSION,tdid:"","sign-ver":1,"app-sdk-version":s.yM.APP_SDK_VERSION},params:{}},d=i.Z.create(c);d.interceptors.request.use(e=>{var{pf:t,appvr:n,tdid:r}=c.headers;return Object.assign(e.headers,(0,l.O)({url:"".concat(e.baseURL).concat(e.url),pf:t,appvr:n,tdid:r})),e}),d.interceptors.response.use(e=>{if(200!==e.status)return Promise.reject(e);var t=e.data;return"0"===t.ret?Promise.resolve(t):Promise.reject(e)}),(0,a.Z)(d,{retries:5,resetTimeout:!0,retryDelay:1e3,isRetry:()=>!0});var u={getLocation:()=>(0,r._)(function*(){return yield d({url:"/web/get_location",data:{}})})()}},940097:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(772322),i=n(218571),o=n(123951),s=n(152155),a=n.n(s);n(573258);let l=e=>{var{className:t,toLogIn:n}=e;return(0,i.useEffect)(()=>{var e=document.getElementById("back-login-btn");e&&(e.onclick=n)},[]),(0,r.jsxs)("div",{className:a()(t,"lv_sign_in_panel_wide-footer-switch-text"),children:[o.oc.t("web_signin_text_go_back_signin",{},"Go back to"),(0,r.jsx)("span",{id:"back-login-btn",className:"lv_sign_in_panel_wide-footer-switch-button",children:o.oc.t("web_signin_button_sign_in",{},"Sign in")})]})}},492460:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var r=n(772322);n(822289),n(529114);var i=n(5622),o=n(595051),s=n(218571),a=n(44324),l=n(984452),c=n(366667),d=n(454078),u=n(793676),h=n(282893),p=n(625656),f=n(50751),m=n(123951),g=n(937729),v=n(639500),y=n(71789);n(659847);let b=e=>{var{isFromModal:t,isMobile:n}=e,b=(0,d.t)(),_=(0,u.v)(b,e=>{var t,n;return null!==(n=null===(t=e.context.userInfo)||void 0===t?void 0:t.region)&&void 0!==n?n:p.yp.US}),w=(0,u.v)(b,e=>e.context.enableDeviceAgeBan),x=(0,u.v)(b,e=>{var t;return null===(t=e.context.ipLocationInfo)||void 0===t?void 0:t.Subdivisions}),S=(0,u.v)(b,e=>e.context.emailSignInRef),[k]=(0,h.L)(b),C=k.context.emailSignInRef,M=(0,u.v)(C,e=>e.context.birthday),[,O]=(0,h.L)(S),[T,A]=(0,s.useState)(""),N=(0,s.useCallback)(e=>{A(e)},[]),D=(0,s.useCallback)(()=>{var e,t=(0,l.Ig)(_,T,(null==x?void 0:null===(e=x.map)||void 0===e?void 0:e.call(x,e=>e.GeoNameID))||[]),[n,r,o]=T.split("-").map(e=>Number(e));t?(b.send({type:"UPDATE_REPORT_PARAMS",params:{age_year:n,age_month:r,age_date:o}}),O({type:"CONFIRM_BIRTHDAY",value:T,region:_})):(k.context.ageGateChecker.ageDeviceBan.ban(),i.Z.error({className:"lv_sign_in_panel_wide-birthday-modal",maskStyle:{zIndex:1103},wrapStyle:{zIndex:1103},title:w?m.ZP.t("dre_account_title_capcut_not_available_age_reason",{},"Can\u2019t access"):m.ZP.t("web_quebec_users_tiitle_minimum_age",{},"Minimum age requirement not met"),content:w?m.ZP.t("dre_account_toast_capcut_not_available_age_reason",{},"You\u2019re not eligible for CapCut."):m.ZP.t("web_quebec_users_text_minimum_age",{},"According to local laws, you don\u2019t meet the minimum age requirement to use CapCut."),okText:m.ZP.t("web_quebec_users_button_get_it_one",{},"Got it"),onOk:()=>{O("RETURN_SIGN_IN")}})),new g.S().report({action:"next",age_year:n,age_month:r,age_date:o})},[_,T,b,O]);(0,s.useEffect)(()=>{new g.S().report({action:"show"})},[]);var E=(0,s.useMemo)(()=>{if(!T)return!1;var e=Number(null==T?void 0:T.split("-")[0]);return e>=1e3&&e>=new Date().getFullYear()-130&&e<new Date().getFullYear()+1},[T]);return(0,r.jsxs)("div",{className:"lv_sign_in_panel_wide-birthday-detail",children:[(0,r.jsx)(v.Z,{progress:1,total:t||n?2:3}),(0,r.jsx)("img",{className:"lv_sign_in_panel_wide-birthday-cover",src:"https://lf16-web-buz.capcut.com/obj/capcut-web-buz-us/common/images/signin_panel_birthday.png",alt:m.ZP.t("yout_birth"),crossOrigin:"anonymous"}),(0,r.jsx)("h2",{className:"lv_sign_in_panel_wide-birthday-title",children:m.ZP.t("web_signin_title_birthday_when",{},"When\u2019s your birthday?")}),(0,r.jsx)("p",{className:"lv_sign_in_panel_wide-birthday-subtitle",children:m.ZP.t("web_signin_desc_birthday_when",{},"Your birthday won\u2019t be shown publicly.")}),(0,r.jsx)("div",{className:"lv_sign_in_panel_wide-birthday-picker",children:w?(0,r.jsx)(c.i,{theme:f.Q.Light,mode:(0,a.S7)().isMobile?"native":"custom",onChange:N}):(0,r.jsx)(y.aI,{mode:(0,a.S7)().isMobile?"native":"custom",theme:"hide-label",birthdayStr:M,onChange:N})}),(0,r.jsx)(o.Z,{className:"lv_sign_in_panel_wide-birthday-next lv_sign_in_panel_wide-primary-button",disabled:""===T||!E,type:"primary",onClick:D,children:m.ZP.t("web_signin_button_next_step",{},"Next")})]})}},855877:function(e,t,n){"use strict";n.d(t,{O:function(){return f}});var r=n(461228),i=n(69984),o=n(772322),s=n(793676),a=n(282893),l=n(41723),c=n.n(l),d=n(218571),u=n(123951),h=n(659179);n(990172);var p=n(569796),f=e=>{var t,n,l,f,{expandModalInstance:m,eventParams:g}=e,[v,y]=(0,d.useState)(!1),[b,_]=(0,d.useState)({key:"web_first_subscribe_text_upgrading",value:"Upgrade to Pro"}),w=(0,s.v)(null==m?void 0:m.getService(),e=>e.context.enableSubscription),x=(t=(0,r._)(function*(){if(m)return y((yield null==m?void 0:m.isSupportExpand()));y(!1)}),function(){return t.apply(this,arguments)}),[S]=(0,a.L)(null==m?void 0:m.getService()),{flag:k=!1,vipRealEnd:C,canFreeTrial:M=!1,canFreeTrialDays:O=7}=(null==S?void 0:null===(l=S.context)||void 0===l?void 0:null===(n=l.userInfo)||void 0===n?void 0:n.vipInfo)||{};(0,d.useEffect)(()=>{x(),!k&&M&&_({key:"web_first_subscribe_text_conditional_seven_day",value:"".concat(O,"-day free trial")})},[k,C,M]);var T=()=>{var e=p._.VIP_BUY;k&&(e=p._.MANAGEMENT),null==m||m.show({type:e,reporterParams:(0,i._)({pageFrom:"profile_icon_upgrade"},g)})};return(k||w&&v)&&(null==S?void 0:null===(f=S.context)||void 0===f?void 0:f.userInfo)?(0,o.jsx)("div",{className:"lv-vip-entry",children:k?(0,o.jsxs)("div",{onClick:T,className:"lv-vip-card",children:[(0,o.jsxs)("div",{className:"content",children:[(0,o.jsx)("div",{className:"name",children:u.ZP.t("web_first_subscribe_text_Cap_cut",{},"CapCut")}),(0,o.jsxs)("div",{className:"time",children:[(0,o.jsx)(h.qSk,{}),(0,o.jsx)("span",{style:{marginLeft:4},children:C?c()(1e3*C).format("YYYY/MM/DD"):"--/-/-"})]})]}),(0,o.jsx)(h.NeZ,{className:"arrow"})]}):(0,o.jsxs)("div",{onClick:T,className:"lv-notVip-card",children:[(0,o.jsxs)("div",{className:"left",children:[(0,o.jsx)(h.t7E,{className:"icon"}),(0,o.jsx)("div",{className:"line"}),(0,o.jsx)("div",{style:{color:"#000000"},children:u.ZP.t(b.key,{number0:O},b.value)})]}),(0,o.jsx)(h.NeZ,{className:"arrow"})]})}):null}},375359:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(772322);n(349601),n(529114);var i=n(781494),o=n(595051),s=n(218571),a=n(123688),l=n(91933),c=n(123951),d=n(152155),u=n.n(d),h=n(942777),p=n(437069);n(415486);let f=e=>{var{toLogIn:t,send:n}=e,[d,f]=(0,s.useState)(""),[m,g]=(0,s.useState)(""),[v,y]=(0,s.useState)(""),[b,_]=(0,s.useState)(""),[w,x]=(0,s.useState)(!1),S=new URLSearchParams(location.search).get("aid");return(0,s.useEffect)(()=>{n({type:"INIT_RESET_SUCCESS_CB",func:()=>{i.Z.success(c.oc.t("password_reset_successfully")),x(!1)}})},[]),(0,r.jsxs)("div",{className:u()("lv_new_forget_pwd_panel-content","lv_forget_pwd_panel_reset_pwd"),children:[(0,r.jsx)("div",{className:"lv_new_forget_pwd_panel-icon-wrapper",children:(0,r.jsx)("img",{src:"https://lf16-web-buz.capcut.com/obj/capcut-web-buz-us/common/images/signin_panel_reset.png",className:"lv_new_forget_pwd_panel-icon lv_new_forget_pwd_panel-icon-reset",alt:"ForgetPasswordPNG"})}),(0,r.jsx)("div",{className:"lv_new_forget_pwd_panel-title lv_new_forget_pwd_panel-title-reset",children:c.oc.t("set_new_password")}),(0,r.jsx)(h.Z,{className:"lv_new_forget_pwd_panel-input-reset  ",warning:v,onInputChange:e=>(f(e),!a.lI.test(e)&&e?y(c.oc.t("set_password_rule")):y(""),e),value:d,placeholder:c.oc.t("web_signin_placeholder_new_password",{},"Enter new password")}),(0,r.jsx)(h.Z,{className:u()("lv_new_forget_pwd_panel-input-reset-pwd"),warning:b,onInputChange:e=>(g(e),e!==d?_(c.oc.t("web_signin_error_text_same_password",{},"Enter the same password as the above line")):_(""),e),value:m,placeholder:c.oc.t("web_signin_placeholder_new_password_again",{},"Enter new password again")}),(0,r.jsx)(o.Z,{loading:w,onClick:()=>{a.lI.test(d)&&d===m&&(x(!0),n({type:"CONFIRM_PASSWORD",pwd:m}))},type:"primary",className:"lv_new_forget_pwd_panel-btn lv_new_forget_pwd_panel-btn-reset lv_new_sign_in_panel_wide-primary-button",children:c.oc.t("confirm_key")}),S===l.yM.APP_ID&&(0,r.jsx)(p.Z,{onClick:()=>{n("BACK_SIGN_IN"),t()}})]})}},443354:function(e,t,n){"use strict";n.d(t,{N:function(){return i}});var r=n(554269);class i{report(e,t){var{immediately:n}=t||{};n?this.reporter.reportBecon("aigc_report_result",e):this.reporter.report("aigc_report_result",e)}constructor(){this.reporter=(0,r.y)()}}},591824:function(e,t,n){"use strict";n.d(t,{y:function(){return i}});var r=n(625656);function i(e){return[r.yp.US,r.yp.BR].find(t=>t===e)?r._s.VA:r._s.GCP}},85624:function(e,t,n){"use strict";function r(e){return URL.createObjectURL(e)}n.d(t,{S:function(){return r}})},282560:function(e,t,n){"use strict";n.d(t,{Gk:function(){return a},bF:function(){return l},dP:function(){return o},vN:function(){return s}});var r,i,o,s,a={VIDEO:"video",AUDIO:"audio",IMAGE:"image",LIVE_PHOTO:"live-photo",FILM:"film",PACKAGE:"package",CLUSTER_FILM:"cluster-film",NORMAL:"file",FOLDER:"folder"};class l{constructor(e){this._sourceData=e}}(r=o||(o={}))[r.NORMAL=0]="NORMAL",r[r.SCRIPT=3]="SCRIPT",r[r.GRAPHIC=5]="GRAPHIC",(i=s||(s={}))[i.EDIT=0]="EDIT",i[i.TEMPLATE=1]="TEMPLATE",i[i.IMAGE_TEXT=2]="IMAGE_TEXT",i[i.SCRIPT=3]="SCRIPT",i[i.TOOL=4]="TOOL",i[i.GRAPHIC=5]="GRAPHIC"},350834:function(e,t,n){"use strict";n.d(t,{w:function(){return o}});var r=n(282560),i=n(16884);class o extends i.o{get type(){return r.Gk.LIVE_PHOTO}}},614155:function(e,t,n){"use strict";function r(e){var t=new Uint8Array(e.reduce((e,t)=>e+t.length,0)),n=0;return e.forEach(e=>{t.set(e,n),n+=e.length}),t}n.d(t,{A:function(){return r}})},946373:function(){"use strict";var e,t;(t=e||(e={})).Default="default",t.TextEdit="text-edit"},695761:function(e,t,n){"use strict";var r,i;n.d(t,{fb:function(){return i}}),(r=i||(i={})).PX="px",r.CM="cm",(60/(96/2.54)).toFixed(3),(5e3/(96/2.54)).toFixed(3)},867299:function(){"use strict";var e,t;(t=e||(e={}))[t.PORTRAIT=0]="PORTRAIT",t[t.VERTICAL=1]="VERTICAL"},435600:function(e,t,n){"use strict";n(901814)},37011:function(e,t,n){"use strict";n.d(t,{T:function(){return r}});var r=(0,n(30276).yh)("instantiation")},183489:function(e,t,n){"use strict";var r,i;n.d(t,{x:function(){return r},z:function(){return o}}),(i=r||(r={}))[i.Owned=1]="Owned",i[i.Reference=2]="Reference";class o{get entries(){return this._entries}set(e,t){this._entries.set(e,t)}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}constructor(...e){for(var[t,n]of(this._entries=new Map,e))this.set(t,n)}}},266425:function(e,t,n){"use strict";n.d(t,{Z:()=>u});let r=n("69984"),i=n("574451"),o=n("772322"),s=n("218571"),a=n("105789"),l=n.n(a),c=n("247130"),d={"image-wrapper":"image-wrapper-P0OW1B","loader-music":"loader-music-Qw_BZ6",image:"image-Gycrag",loading:"loading-yBGQIU"},u=(0,s.memo)(e=>{var{src:t="",draggable:n=!1,alt:a="",phType:u,className:h,wrapperStyle:p,withCredentials:f=!1,onLoad:m,loading:g,style:v,loader:y,fallbackImgSrc:b,onError:_,onMouseLeave:w,onMouseOver:x}=e,S=(0,i._)(e,["src","draggable","alt","phType","className","wrapperStyle","withCredentials","onLoad","loading","style","loader","fallbackImgSrc","onError","onMouseLeave","onMouseOver"]),[k,C]=(0,s.useState)(!1),M=(0,s.useRef)(!1),O=(0,s.useRef)([]),T=(0,s.useRef)(null),[A,N]=(0,s.useState)(t||b),D=(0,s.useMemo)(()=>k?(0,o.jsx)(o.Fragment,{}):y?(0,o.jsx)("div",{className:d.loading,children:y}):"music"===u?(0,o.jsx)("div",{className:d["loader-music"],children:(0,o.jsx)(c.hQw,{})}):"sound"===u?(0,o.jsx)("div",{className:d["loader-music"],children:(0,o.jsx)(c.AjX,{})}):(0,o.jsx)(o.Fragment,{}),[y,k,u]);return(0,s.useEffect)(()=>{if(t){N(t);var e=()=>{var e=T.current;e&&(e.src="",e.onload=null,e.onerror=null,e=null)};return O.current.includes(t)||(C(!1),M.current=!1),()=>e()}},[t]),(0,o.jsxs)("div",{className:l()(d["image-wrapper"],h),style:p,onMouseLeave:w,onMouseOver:x,children:[D,(0,o.jsx)("img",(0,r._)({ref:T,className:d.image,crossOrigin:f?"use-credentials":"anonymous",src:globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(A,null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),draggable:n,alt:a,style:v,loading:g,onLoad:e=>{C(!0),null==m||m(e),M.current=!1},onError:e=>{A&&O.current.push(A),C(!0),!(b&&O.current.includes(b))&&(null==_||_(e),M.current=!0,b&&(C(!1),M.current=!1,N(b)))}},S))]})})},380324:function(e,t,n){"use strict";n.d(t,{C5:function(){return d}});var r=n(69984),i=n(764112),o=n(574451),s=n(772322),a=n(324160),l=n(218571),c={threshold:1},d=e=>{var{children:t,ioOptions:n,onEnter:d,onLeave:u}=e,h=(0,o._)(e,["children","ioOptions","onEnter","onLeave"]),p=(0,l.useMemo)(()=>(0,r._)({},c,n),[n]),[f,m]=(0,a.default)(void 0,(0,r._)({},p),void 0);return(0,l.useEffect)(()=>{m?null==d||d():null==u||u()},[m]),(0,s.jsx)("div",(0,i._)((0,r._)({ref:f},h),{children:t}))}},192031:function(e,t,n){"use strict";n.d(t,{e:function(){return d}});var r=n(577729),i=n(980014),o=n(900268),s=n(658742),a=n(939051),l=n(399573),c=n(475956);class d extends r.JT{get isReady(){return this._isReady}bootstrap(e){var t=[];(null==e?void 0:e.autoMaterials)&&e.autoMaterials.forEach(e=>{var t,n,r,i=e.getModel();this._addAndBindMaterial(e,"auto"),this.getOrCreateAutoGeneratedMaterialNamespace(null!==(r=null===(n=i.draftDelta)||void 0===n?void 0:null===(t=n.meta)||void 0===t?void 0:t.id)&&void 0!==r?r:c.U).addMaterials([e])}),e.materials.forEach(e=>{var n,r,i,o,s,a,l=e.getModel();if(!(null===(n=l.draftDelta)||void 0===n?void 0:n.meta)||(null===(i=l.draftDelta)||void 0===i?void 0:null===(r=i.meta)||void 0===r?void 0:r.visible)){this._addAndBindMaterial(e,"user"),t.push(e);return}this._addAndBindMaterial(e,"auto"),this.getOrCreateAutoGeneratedMaterialNamespace(null!==(a=null===(s=l.draftDelta)||void 0===s?void 0:null===(o=s.meta)||void 0===o?void 0:o.id)&&void 0!==a?a:c.U).addMaterials([e])}),t.forEach(e=>{this._referenceData.userGeneratedMaterials.add(e.id)}),this._onDidMaterialAdd.fire(e.materials.map(e=>e.id)),this._isReady=!0,this._onDidReady.fire()}getMaterials(){var e=[],t=[];for(var n of(this._referenceData.userGeneratedMaterials.forEach(t=>{e.push(this._materials.get(t).getModel())}),this._namespaceMap.values()))t.push(...n.getMaterials());return{userGeneratedMaterials:e,autoGeneratedMaterials:t}}getUnUploadedMaterials(){var e=[];for(var t of this._materials.values())(0,l.p)(t)||e.push(t.getModel());return e}getMaterialById(e){var t=this._materials.get(e);return(0,i.ZB)(t),t.getModel()}invokeFunctionWithLifeCycleById(e,t){var n=this._materials.get(e);(0,i.ZB)(n),t(n)}invokeFunctionWithLifeCycle(e){for(var t of this._materials.values())e(t)}isMaterialAllDone(){if(!this._isReady)return!1;for(var e of this._getUsedMaterialIds())if(this._materials.get(e).status!==a.a.Success)return!1;return!0}hasMaterialSyncing(){if(!this._isReady)return!1;for(var e of this._getUsedMaterialIds()){var t=this._materials.get(e);if(t.status===a.a.Preparing||t.status===a.a.WaitingUpload||t.status===a.a.Uploading||t.status===a.a.Transcoding||t.status===a.a.WaitForSync2UserMaterial||t.status===a.a.Syncing2UserMaterial)return!0}return!1}getMaterialsByMd5(e){var t=[];for(var n of this._materials.values())n.md5===e&&t.push(n.getModel());return(0,i.Y2)(t.length,"material is not found by md5(".concat(e,"), please check")),t}getMaterialByKey(e){for(var t of this._materials.values())if(t.getModel().key===e)return t.getModel();(0,i.ss)("not found resource key")}isMaterialExistByKey(e){for(var t of this._referenceData.userGeneratedMaterials){var n=this._materials.get(t);if((null==n?void 0:n.getModel().key)===e)return!0}for(var r of this._namespaceMap.values())if(r.getMaterials().find(t=>t.key===e))return!0;return!1}isMaterialExistInUserGeneratedByMd5(e){for(var t of this._referenceData.userGeneratedMaterials){var n=this._materials.get(t);if((null==n?void 0:n.md5)===e)return!0}return!1}isMaterialExistInUserGenerated(e){return this._referenceData.userGeneratedMaterials.has(e)}addToUserGenerated(e,t){this._addAndBindMaterial(e,"user"),this._referenceData.userGeneratedMaterials.add(e.id),this._onDidMaterialAdd.fire([e.id],t),e.onDidDelete(()=>{this.removeFromUserGenerated(e.id)}),this._removeWhenDuplicateMd5(e)}removeFromUserGenerated(e){var t=this._materials.get(e);(0,i.Y2)(t,"material not found, could not remove"),this._referenceData.userGeneratedMaterials.delete(e),this._onDidMaterialRemove.fire([t.getModel()]),this._checkAndNotifyMaterialDoneState()}addToAutoGenerated(e){this.getOrCreateAutoGeneratedMaterialNamespace(c.U).addMaterials([e])}batchAddToAutoGenerated(e){this.getOrCreateAutoGeneratedMaterialNamespace(c.U).addMaterials(e)}removeFromAutoGenerated(e){this.getOrCreateAutoGeneratedMaterialNamespace(c.U).removeMaterials([e])}getOrCreateAutoGeneratedMaterialNamespace(e){if(this._namespaceMap.has(e))return this._namespaceMap.get(e);var t=new c.m({namespace:e,handler:{findById:e=>this._materials.get(e).getModel(),add:e=>{this._addAndBindMaterial(e,"auto")},remove:e=>{this._checkAndNotifyMaterialDoneState()},replace:(e,t)=>{this._replaceAndBindMaterial(e,t,"auto")},onDidAdd:e=>{this._onDidMaterialAdd.fire(e)},onDidRemove:e=>{this._onDidMaterialRemove.fire(e)},onDidReplace:(e,t)=>{this._onDidMaterialReplace.fire(e,t)}}});return this._namespaceMap.set(e,t),t}_addAndBindMaterial(e,t){if(!this._materials.has(e.id)){var n=[e.onDidDone,e.onSyncing2UserMaterial].map(e=>e(()=>{this._checkAndNotifyMaterialDoneState()}));(0,o.V)(e.onDidRemove)(()=>{n.forEach(e=>null==e?void 0:e.dispose())}),this._materials.set(e.id,e),e.status===a.a.Success||(this._checkAndNotifyMaterialDoneState(!1),(0,o.V)(e.onDidCancelUpload)(()=>{"user"===t?this.removeFromUserGenerated(e.id):this.removeFromAutoGenerated(e.id)}))}}_replaceAndBindMaterial(e,t,n){this._addAndBindMaterial(t,n),this._checkAndNotifyMaterialDoneState()}_checkAndNotifyMaterialDoneState(e){void 0===e&&(e=this.isMaterialAllDone()),this._preNotifyMaterialIsDone!==e&&(this._preNotifyMaterialIsDone=e,this._onMaterialAllDoneChange.fire(this._preNotifyMaterialIsDone))}_getUsedMaterialIds(){var e=new Set;for(var t of(this._referenceData.userGeneratedMaterials.forEach(t=>{e.add(t)}),this._namespaceMap.values()))t.getMaterials().forEach(t=>{e.add(t.id)});return[...e]}_removeWhenDuplicateMd5(e){var t=()=>{var t=[];for(var n of[...this._referenceData.userGeneratedMaterials])if(n!==e.id){var r=this._materials.get(n);(null==r?void 0:r.status)===a.a.Success&&(null==r?void 0:r.md5)===e.md5&&(this.removeFromUserGenerated(n),t.push(this._materials.get(n).getModel()))}this._onMaterialDuplicate.fire(t)};e.status===a.a.Success?t():(0,o.V)(e.onDidDone)(()=>{t()})}constructor(){super(),this._isReady=!1,this._onDidReady=this._store.add(new s.Q),this.onDidReady=this._onDidReady.event,this._namespaceMap=new Map,this._preNotifyMaterialIsDone=!0,this._onMaterialAllDoneChange=this._store.add(new s.Q),this.onMaterialAllDoneChange=this._onMaterialAllDoneChange.event,this._onDidMaterialAdd=this._store.add(new s.Q),this.onDidMaterialAdd=this._onDidMaterialAdd.event,this._onDidMaterialRemove=this._store.add(new s.Q),this.onDidMaterialRemove=this._onDidMaterialRemove.event,this._onMaterialDuplicate=this._store.add(new s.Q),this.onMaterialDuplicate=this._onMaterialDuplicate.event,this._onDidMaterialReplace=this._store.add(new s.Q),this.onDidMaterialReplace=this._onDidMaterialReplace.event,this._materials=new Map,this._referenceData={userGeneratedMaterials:new Set},this.getOrCreateAutoGeneratedMaterialNamespace(c.U)}}},471499:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(900268),i=n(248176),o=n(897317);function s(e){e.invokeFunction(e=>{var t=e.get(i.Gw),n=e.get(o.x),s=()=>{var e=t.userProfile;n.updateRequestInfo({domainMap:{[o.Y.DEFAULT]:e.reqDomain.web_domain,[o.Y.TTS]:e.reqDomain.web_domain,[o.Y.SAMI]:e.reqDomain.web_domain,[o.Y.FRONTIER]:e.reqDomain.frontier_domain,[o.Y.COMMERCE]:e.reqDomain.commerce_domain,[o.Y.JIANYING]:e.reqDomain.web_domain},locationInfo:{region:e.region,idc:e.newIdc,idcEnum:e.idc}})};t.hasLogin?s():(s(),(0,r.V)(t.onDidLogin)(()=>{s()}))})}},299075:function(e,t,n){"use strict";n(833094),n(509932)},283602:function(e,t,n){"use strict";n.d(t,{h:function(){return m}});var r=n(461228),i=n(772322);n(5410),n(822289),n(529114);var o=n(699482),s=n(5622),a=n(595051),l=n(218571),c=n(400921),d=n(862794),u=n(123951),h=n(659179),p=n(624804),f=n(771268),m=(0,n(193320).Pi)(e=>{var{downloadManager:t,exportManager:n,onClose:m}=e,[g,v]=(0,l.useState)(0),y=(0,l.useRef)(null),b=(0,l.useRef)(),[_,w]=(0,l.useState)(!1),{taskProgress:x,taskStatus:S,isCanceling:k,fileId:C,fileName:M,fileWorkspaceId:O,coverImgUrl:T}=n.observableData,{isLoadError:A,isLoading:N,videoDownloadUrl:D}=t.observableData,E=S===f.tN.Processing||S===f.tN.Idle;return(0,l.useEffect)(()=>{if(S===f.tN.Cancel){m();return}if(E){if(y.current)return;y.current=new d.B,y.current.setOption({initProgress:0,maxProgress:99,duration:60,callback:e=>{n.observableData.isCanceling||v(Math.max(e,x,g))}})}else{var e,r;S===f.tN.Success&&t.init({fileId:C,fileName:M,fileWorkspaceId:O}),null===(e=y.current)||void 0===e||e.stop(),y.current=null,null===(r=b.current)||void 0===r||r.close(),v(0)}},[k,g,t,x,S,C,M,O,m]),(0,l.useEffect)(()=>{N||A||!D||_||(t.autoDownloadVideo(),w(!0))},[t,_,A,N,D]),(0,i.jsxs)("div",{className:c.Z.downloadVideoExport,children:[E?(0,i.jsxs)("div",{className:c.Z.progress,children:[(0,i.jsx)(o.Z,{value:g.toFixed(),suffix:(0,i.jsx)("div",{className:c.Z.unit,children:"%"}),className:c.Z.percent,countUp:!0,styleValue:{color:"#0fbf60"}}),(0,i.jsx)("div",{className:c.Z.text,children:"Video rendering..."}),(0,i.jsx)(a.Z,{className:c.Z.cancelBtn,onClick:()=>{b.current=s.Z.confirm({icon:null,title:u.ZP.t("cancel_running_export",{},"Cancel exporting?"),content:u.ZP.t("no_stored_cloud",{},"Your video will not be saved in Cloud."),okText:u.ZP.t("cancel_tiktok",{},"Cancel"),cancelText:u.ZP.t("goback",{},"Go back"),onOk:(0,r._)(function*(){var e;yield n.cancel(),null===(e=n.onStateChange)||void 0===e||e.call(n,"cancelExport")})})},loading:k,children:u.ZP.t("web_cancel",{},"Cancel")})]}):null,S===f.tN.Success?(0,i.jsxs)(i.Fragment,{children:[N?(0,i.jsxs)("div",{className:c.Z.loading,children:[(0,i.jsx)(p.I,{}),(0,i.jsx)("div",{className:c.Z.desc,children:u.ZP.t("loading_resources",{},"Loading resources...")})]}):null,A?(0,i.jsxs)("div",{className:c.Z.loadError,children:[(0,i.jsx)(h.Y88,{size:68,className:c.Z.icon}),(0,i.jsx)("div",{className:c.Z.desc,children:u.ZP.t("web_delete_move_file")})]}):null,N||A?null:(0,i.jsxs)("div",{className:c.Z.successContainer,children:[T?(0,i.jsx)("div",{className:c.Z.coverImgContainer,children:(0,i.jsx)("img",{src:globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(T,null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),className:c.Z.coverImg})}):null,(0,i.jsxs)("div",{className:c.Z.success,children:[(0,i.jsxs)("div",{className:c.Z.title,children:[(0,i.jsx)(h.PvJ,{className:c.Z.icon,size:16}),(0,i.jsx)("span",{children:u.ZP.t("export_successfully",{},"Export successfully")})]}),(0,i.jsx)("div",{className:c.Z.desc,children:u.ZP.t("ccecommerce_video_export_auto_downloading",{},"The video is automatically downloading to your computer.")})]})]})]}):null,(0,i.jsx)("div",{className:c.Z.exportVideo,children:n.renderExportFailureMask(m)})]})})},390104:function(e,t,n){"use strict";n.d(t,{Y:function(){return i},e:function(){return g}});var r,i,o=n(69984),s=n(772322);n(529114),n(459360);var a=n(595051),l=n(401725),c=n(218571),d=n(659179),u=n(123951),h=n(891215);(r=i||(i={})).feedback="feedback",r.close="close",r.hide="hide";var p=e=>{var{setForbidHideTipVisible:t}=e;return(0,s.jsxs)("div",{className:h.Z.headerTipForbid,children:[(0,s.jsx)("div",{className:h.Z.forbidTitle,children:u.oc.t("web_not_hide")}),(0,s.jsx)("div",{className:h.Z.forbidContent,children:u.oc.t("web_not_hide_window")}),(0,s.jsx)("div",{className:h.Z.forbidFooter,children:(0,s.jsx)(a.Z,{type:"primary",className:h.Z.forbidFooterButton,onClick:()=>{t(!1)},children:u.oc.t("web_got_it")})}),(0,s.jsx)("div",{className:h.Z.headerTipArrow})]})},f={feedback:e=>(0,s.jsx)(l.Z,{position:"top",trigger:"hover",content:u.oc.t("web_ttam_feedback"),triggerProps:{style:{zIndex:1002}},children:(0,s.jsx)(d.CgH,{className:h.Z.actionButton,size:20,onClick:()=>{e("feedback")}})},"feedback"),close:e=>(0,s.jsx)(l.Z,{position:"top",trigger:"hover",content:u.oc.t("web_ttam_close",{},"Close"),triggerProps:{style:{zIndex:1002}},children:(0,s.jsx)(d.xcW,{className:h.Z.actionButton,size:20,onClick:()=>{e("close")}})},"close"),hide:(e,t)=>{var{allowHide:n,setForbidHideTipVisible:r}=t;return(0,s.jsx)(l.Z,{position:"top",trigger:"hover",content:u.oc.t("ccecommerce_video_export_hide",{},"Hide"),triggerProps:{style:{zIndex:1002}},children:(0,s.jsx)(d.HrH,{className:h.Z.actionButton,size:20,onClick:()=>{if(n){e("hide");return}r(!0)}})},"hide")}},m=(e,t,n)=>{var r=f[e];return r?r(t,n):null},g=e=>{var{actions:t,allowHide:n,handleAction:r}=e,[i,a]=(0,c.useState)(!1),l={allowHide:n,setForbidHideTipVisible:a};return(0,s.jsxs)("div",{className:h.Z.headerRight,children:[(0,s.jsx)("div",{className:h.Z.headerRightActions,children:t.map(e=>m(e,r,l))}),i&&(0,s.jsx)(p,(0,o._)({},l))]})}},116266:function(e,t,n){"use strict";n.d(t,{U:function(){return d}});var r=n(461228),i=n(789786),o=n(577729),s=n(980014),a=n(781440),l=n(111954),c=n(603430);class d extends o.JT{_getEverCloudInstance(){var e=this;return(0,r._)(function*(){if(!e._everInstance){var t,n=null===(t=e._workspaceService.workspaceList[0])||void 0===t?void 0:t.workspace_id;(0,s.ZB)(n),e._everInstance=yield e._userMaterialsService.getEvercloudInstance(n)}return e._everInstance})()}getFileDetail(e){var t=this;return(0,r._)(function*(){var n,r,i=yield t._getEverCloudInstance(),o=yield c.b.getWithCache(e,()=>i.getFileDetailWithTranscode({id:e})),[{key:s,url:a}]=o.videoInfo,l=o.asset;return{size:null!==(n=l.size)&&void 0!==n?n:0,duration:l.duration,width:l.width,height:l.height,subType:l.subType,key:s,url:a,fileName:null!==(r=o.fileName)&&void 0!==r?r:""}})()}constructor(e,t){super(),this._userMaterialsService=e,this._workspaceService=t}}d=(0,i.gn)([(0,i.fM)(0,a.b),(0,i.fM)(1,l.W),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===a.b?Object:a.b,void 0===l.W?Object:l.W])],d)},905054:function(e,t,n){"use strict";n.d(t,{Z:()=>a});let r=n("772322");n("529114");let i=n("595051"),o=n("813727"),s=n("247130");function a(e){var{onRetry:t}=e,{i18n:n}=(0,o.$)();return(0,r.jsxs)("div",{className:"loading-failed-ehEGg_",children:[(0,r.jsx)("div",{className:"text-dDLVrm",children:n.t("web_autocut_toast_cannot_load",{},"Couldn\u2019t load")}),(0,r.jsx)("div",{className:"button-rCFho1",children:(0,r.jsx)(i.Z,{type:"secondary",size:"default",icon:(0,r.jsx)(s.hYj,{}),onClick:t,children:n.t("web_autocut_button_retry",{},"Retry")})})]})}},884226:function(e,t,n){"use strict";n.d(t,{n:function(){return p}});var r=n(772322),i=n(218571),o=n(170883),s=n(565523),a=n(461644),l=n(810381),c=n(429188),d=n(592693),u=n(621002),h=n(484),p=(0,c.Pi)(i.forwardRef((e,t)=>{var n,c,{playerControls:p,allowUpdate:f}=e,m=(0,s.G)(a.t),g=(0,s.G)(l.m),{rawSupportHls:v}=(0,d.g4)(g),y=e.needM3u8&&!v,b=!!(null===(n=e.playerConfig)||void 0===n?void 0:n.poster),{onStateUpdate:_,onPauseCallback:w,onPlayCallback:x,onTimeUpdateCallback:S}=e,k=(0,i.useMemo)(()=>"st-audio-viewer-xgplayer-".concat((0,o.Z)()),[]),C=(0,i.useRef)(m.createInstance(u.u,{})),{playerState:M,playerInstance:O}=C.current;(0,i.useImperativeHandle)(t,()=>({play:()=>{C.current.playerInstance&&C.current.playerInstance.play()},pause:()=>{C.current.playerInstance&&C.current.playerInstance.pause()}}));var T=(0,i.useRef)(null),A=(0,i.useCallback)(()=>{C.current.initPlayer({playerConfig:(0,d.q2)(e.playerConfig||{},{id:k}),options:e.options,onPauseCallback:w,onPlayCallback:x,onTimeUpdateCallback:S})},[k,e.options,e.playerConfig,y,b]);return(0,i.useEffect)(()=>{A()},[]),(0,i.useEffect)(()=>{f&&A()},[null==e?void 0:null===(c=e.playerConfig)||void 0===c?void 0:c.url]),(0,i.useLayoutEffect)(()=>{O&&(null==_||_({playerInstance:O,playerState:M}))},[_,O,M]),(0,r.jsxs)("div",{className:h.Z["st-audio-viewer"],ref:T,children:[(0,r.jsx)("div",{id:k}),(0,r.jsx)("div",{className:h.Z.controller,children:null==p?void 0:p({player:O,playerState:M,isEmbed:!0})})]})}))},228250:function(e,t,n){"use strict";n.d(t,{Z:()=>S});let r=n("772322");n("459360"),n("529114"),n("463844"),n("387346");let i=n("401725"),o=n("595051"),s=n("279134"),a=n("221489"),l=n("218571"),c=n("659179"),d=n("247130"),u=n("315247"),h=n("123951"),p=n("559433"),f=n("790233"),m=n("355016"),g={materialSelector:"material-selector-o4RC08",materialSelectorBody:"material-selector-body-lUyJ0O",optionsContainer:"options-container-k1__lD",breadCrumb:"bread-crumb-mrBwjd",breadCrumbComp:"bread-crumb-comp-vRUj3a",options:"options-vT_wll",optionItem:"option-item-T6vo8u",optionText:"option-text-qlI7SR",optionDownIcon:"option-down-icon-q4Wzl0",optionMenu:"option-menu-Xr_Bkr",optionMenuItem:"option-menu-item-XYAXdm",optionMenuIcon:"option-menu-icon-yhgar7"};(v=b||(b={})).All="all",v.Video="video",v.Photo="image",(y=_||(_={}))[y.EarliestToLatest=0]="EarliestToLatest",y[y.LatestToEarliest=1]="LatestToEarliest";var v,y,b,_,w=()=>[{label:h.oc.t("space_files_all",{},"All"),value:"all"},{label:h.oc.t("video_web",{},"Video"),value:"video"},{label:h.oc.t("picture",{},"Photo"),value:"image"}],x=()=>[{label:h.oc.t("space_files_sort_order1",{},"Newest first"),value:0},{label:h.oc.t("space_files_sort_order2",{},"Oldest first"),value:1}];let S=e=>{var{multiple:t=!1,data:n=[],value:v,folder:y,globalData:b,loading:_,confirmButtonLoading:S,supportFileType:k,onSelect:C,onConfirm:M,onValueOrderChange:O,showSpaceSelector:T,defaultWorkspace:A,workspaceList:N,onWorkspaceChange:D,onDirectorySelect:E,sourcePath:I,status:P,onRetry:R}=e,B=(0,l.useRef)(null),[j,L]=(0,l.useState)(0),[V,F]=(0,l.useState)("all"),[U,q]=(0,l.useState)(m.d.GRID),W=(0,l.useMemo)(()=>(0,r.jsx)(s.Z,{className:g.optionMenu,children:w().filter(e=>"all"===e.value||(null==k?void 0:k.includes(e.value))).map(e=>(0,r.jsxs)(s.Z.Item,{className:g.optionMenuItem,onClick:()=>F(e.value),children:[(0,r.jsx)(c.mT,{style:{visibility:e.value===V?"visible":"hidden"},className:g.optionMenuIcon,size:20}),e.label]},e.label))}),[V,k]),H=(0,l.useMemo)(()=>(0,r.jsx)(s.Z,{className:g.optionMenu,children:x().map(e=>(0,r.jsxs)(s.Z.Item,{className:g.optionMenuItem,onClick:()=>L(e.value),children:[(0,r.jsx)(c.mT,{style:{visibility:e.value===j?"visible":"hidden"},className:g.optionMenuIcon,size:20}),e.label]},e.label))}),[j]),z=(0,l.useMemo)(()=>null==n?void 0:n.filter(e=>(null==k?void 0:k.length)&&!(null==k?void 0:k.some(t=>null==e?void 0:e.fileType.startsWith(t)))?void 0:"all"===V||(null==e?void 0:e.fileType.startsWith(V))).sort((e,t)=>1===j?e.updatedAt-t.updatedAt:t.updatedAt-e.updatedAt),[n,k,V,j]),Z=(0,l.useMemo)(()=>{var e=null!=b?b:z;return Array.from((t?v.map(t=>e.find(e=>e.md5===t)).filter(e=>void 0!==e):e.filter(e=>v[0]===(null==e?void 0:e.md5))).reduce((e,t)=>e.set(t.md5,t),new Map).values())},[t,z,v]),G=(0,l.useMemo)(()=>{var e=w().find(e=>e.value===V);return null==e?void 0:e.label},[V]);return(0,r.jsxs)("div",{className:g.materialSelector,ref:B,children:[(0,r.jsxs)("div",{className:g.materialSelectorBody,children:[T&&(null==N?void 0:N.length)&&(0,r.jsx)(p.r,{defaultWorkspace:A,workspaceList:N,onWorkspaceChange:D}),(0,r.jsxs)("div",{className:g.optionsContainer,children:[(0,r.jsx)("div",{className:g.breadCrumb,children:(0,r.jsx)(u.U,{className:g.breadCrumbComp,data:I,onClick:e=>{E({assetId:e.value,name:e.label})}})}),(0,r.jsxs)("div",{className:g.options,children:[k&&(null==k?void 0:k.length)>1&&(0,r.jsx)(a.Z,{position:"bottom",droplist:W,triggerProps:{getPopupContainer:()=>B.current},children:(0,r.jsxs)(o.Z,{type:"text",className:g.optionItem,children:[(0,r.jsx)(c.WHs,{size:20}),(0,r.jsx)("span",{className:g.optionText,children:G}),(0,r.jsx)(c.r9L,{className:g.optionDownIcon,size:12})]})}),(0,r.jsx)(a.Z,{position:"br",droplist:H,triggerProps:{getPopupContainer:()=>B.current},children:(0,r.jsxs)(o.Z,{type:"text",className:g.optionItem,children:[(0,r.jsx)(c.sB2,{size:20}),(0,r.jsx)("span",{className:g.optionText,children:h.oc.t("space_files_sort_order",{},"Order")}),(0,r.jsx)(c.r9L,{className:g.optionDownIcon,size:12})]})}),(0,r.jsx)("div",{className:g.optionItem,onClick:()=>{U===m.d.GRID?q(m.d.LIST):q(m.d.GRID)},children:U===m.d.GRID?(0,r.jsx)(i.Z,{position:"bottom",content:h.oc.t("web_space_folder_hover_view_as_list",{},"View as list"),children:(0,r.jsx)(d.aVo,{size:20})}):(0,r.jsx)(i.Z,{position:"bottom",content:h.oc.t("web_space_folder_hover_view_as_grid",{},"View as grid"),children:(0,r.jsx)(c.lCO,{size:20})})})]})]}),(0,r.jsx)(m.Z,{multiple:t,data:z,value:v,folder:y,onSelect:e=>{null==C||C(e)},onDirectorySelect:E,loading:_,mode:U,status:P,onRetry:R})]}),(0,r.jsx)(f.Z,{loading:S,multiple:t,selectedMaterialList:Z,onConfirm:M,value:t?v:void 0,setValue:t?O:void 0,onDelete:e=>{if(Array.isArray(v)){var t=null==v?void 0:v.indexOf(e);if(-1!==t){var n=[...v];null==n||n.splice(t,1),null==C||C([...n])}}}})]})}},703388:function(e,t,n){"use strict";n.d(t,{Hq:function(){return o},dY:function(){return C}});var r,i,o,s,a=n(461228),l=n(69984),c=n(764112),d=n(789786),u=n(254845),h=n(123951),p=n(248176),f=n(111954),m=n(226134),g=n(810381),v=n(523474),y=n(577729),b=n(658742),_=n(554487),w=n(239534),x=n(658384),S=n(988441),k=n(414203);(r=o||(o={}))[r.ExpandOnExport=0]="ExpandOnExport",r[r.ExpandOnSync=1]="ExpandOnSync",r[r.ExpandOnUpload=2]="ExpandOnUpload",(i=s||(s={})).CAPACITY_BUY="CAPACITY_BUY",i.CAPACITY_INSUFFICIENT="CAPACITY_INSUFFICIENT";class C extends y.JT{get _isLogin(){return this._accountService.hasLogin}get _okText(){return this._hasStorageExpandAbility?h.oc.t("web_editor_storage_expand",{},"Expand"):h.oc.t("web_Get_it",{},"Got it")}get _cancelText(){return this._hasStorageExpandAbility?h.oc.t("web_Get_it",{},"Got it"):h.oc.t("web_tool_Retry",{},"Try again")}get _contentText(){return this._hasStorageExpandAbility?h.oc.t("web_magicTools_toast_no_space_to_save",{"text-action":e=>e},"Your cloud space is almost full. <text-action>Expand</text-action> your cloud space storage and try again."):h.oc.t("web_editor_transfer_storage_limit2",{},"Your cloud space has reached the storage limit. You can delete some of your cloud files.")}get _titleText(){return 1===this._expandType?h.oc.t("cannot_web_save_web_peoject",{},"Couidn't save project"):2===this._expandType?h.oc.t("web_space_uploadlist_failed",{},"Couldn't upload"):0===this._expandType?h.oc.t("failed_export",{},"Couldn't export"):h.oc.t("cannot_web_save_web_peoject",{},"Couldn't save project")}get _reporterParams(){var e=x.mb[(0,k.j)(this._smartToolType)],t="auto_save_fail";return 1===this._expandType&&(t="sync_fail"),2===this._expandType&&(t="upload_fail"),0===this._expandType&&(t="export_fail"),{pageFrom:_.K1.spaceLimitUpgrade,enterFrom:t,currentPage:"smart_tool_page",toolType:e}}get _workspaceInfo(){if(this.expandWorkspaceId)return this._workspaceService.getWorkspace(this.expandWorkspaceId)}get _onAfterOk(){return()=>{this._expandType=void 0}}get _onAfterCancel(){return()=>{if(this._hasStorageExpandAbility){this._expandType=void 0,this._expandType;return}this._expandType=void 0}}setExpandWorkspaceId(e){this.expandWorkspaceId=e,this._onExpandWorkspaceChange.fire()}setExpandModalInstance(e){this.expandModalInstance=e}_initExpandInstance(){var e=this;return(0,a._)(function*(){if(!e._isLogin)return null;var t,r,i,o,s,{userProfile:a}=e._accountService,{workspaceExpandInfoMap:l}=e._workspaceService,c=e._workspaceService.workspaceList,d=null==a?void 0:null===(t=a.spaceInfo)||void 0===t?void 0:t.workspaceId,u=d&&(null==c?void 0:c.find(e=>e.workspace_id===d)),h=e._teaReportService.getTeaConfig(),{LvStorageExpandModalSingleton:p}=yield Promise.all([n.e("8583"),n.e("3173"),n.e("7716"),n.e("9680")]).then(n.bind(n,463350)),f=e._userService.dangerUsedUserMachineService,m=e._workspaceInfo,g=p({userInfo:{name:null!==(i=null==a?void 0:a.name)&&void 0!==i?i:"",avatar:null!==(o=null==a?void 0:a.avatar)&&void 0!==o?o:"",hasLogined:e._isLogin||!1,uid:null==a?void 0:a.uid,email:null==a?void 0:a.email,idc:null==a?void 0:a.idc,region:null!==(s=a.region)&&void 0!==s?s:"",createTime:null==a?void 0:a.create_time,vipInfo:e._accountService.userVipInfo,reqDomain:a.reqDomain},workspaceInfo:m,defaultWorkspaceInfo:u,cloudInfo:l&&(null==m?void 0:m.workspace_id)?l[m.workspace_id]:void 0,isBOE:!1,cookieConsent:w.g,riskInfo:{webid:null==h?void 0:null===(r=h.user)||void 0===r?void 0:r.web_id},getABTestConfig:e._teaReportService.getABTestVar.bind(e._teaReportService),onPayStatusChange:(t,n)=>{"SUCCESS"===t&&(e._refreshUserSpace(),f.send({type:"UPDATE_WORKSPACE",workspaceId:null==m?void 0:m.workspace_id}),f.send({type:"UPDATE_VIP_INFO"}))},handleReporterProcessing:(t,n)=>{e._hasStorageExpandAbility&&e._reportService.reportBusinessEvent(t,n)},onModalStatusChange:t=>{"CLOSED"===t&&e._onAfterOk()}});return e.setExpandModalInstance(g),g})()}_handleIsSupportExpand(){var e=this;return(0,a._)(function*(){if(e._isLogin){var t=yield e._initExpandInstance(),n=yield null==t?void 0:t.isSupportExpand();n&&(e._hasStorageExpandAbility=!!n)}})()}_handleShowBuyModal(){var e=this;return(0,a._)(function*(){if(e._onAfterOk(),!e._hasStorageExpandAbility){window.open("".concat(location.origin,"/my-cloud/").concat(e.expandWorkspaceId),"_blank");return}var t=yield e._initExpandInstance();null==t||t.show({type:"CAPACITY_BUY",reporterParams:e._reporterParams})})()}handleShowStorageFullModal(e){var t=this;return(0,a._)(function*(){if(!t._expandType&&t._isLogin){t._expandType=e,t._refreshUserSpace();var n=yield t._initExpandInstance();null==n||n.show({type:"CAPACITY_INSUFFICIENT",modalProps:{okText:t._okText,cancelText:t._cancelText,title:t._titleText,content:t._contentText,onOk:t._handleShowBuyModal.bind(t),onCancel:t._onAfterCancel.bind(t)},reporterParams:(0,c._)((0,l._)({},t._reporterParams),{pageFrom:_.K1.spaceLimitUpgrade})})}})()}constructor(e,t,n,r,i,o){super(),this._accountService=t,this._workspaceService=n,this._teaReportService=r,this._reportService=i,this._userService=o,this._hasStorageExpandAbility=!1,this._expandType=void 0,this._onExpandWorkspaceChange=this._store.add(new b.Q),this.expandModalInstance=null,this.onExpandWorkspaceChange=this._onExpandWorkspaceChange.event,this._refreshUserSpace=()=>{this._userService.dangerUsedUserMachineService.send("REFRESH_WORKSPACE_LIST")},(0,u.rC)(this),this._smartToolType=e,[this._accountService.onDidChangeVipInfo,this._workspaceService.onDidWorkspaceExpandInfoMapChange,this._workspaceService.onDidWorkspaceChange,this.onExpandWorkspaceChange].forEach(e=>{e(()=>{this._handleIsSupportExpand()})})}}(0,d.gn)([u.LO,(0,d.w6)("design:type",Object)],C.prototype,"expandModalInstance",void 0),(0,d.gn)([u.Fl,(0,d.w6)("design:type",Function),(0,d.w6)("design:paramtypes",[]),(0,d.w6)("design:returntype",void 0)],C.prototype,"_isLogin",null),(0,d.gn)([u.Fl,(0,d.w6)("design:type",Function),(0,d.w6)("design:paramtypes",[]),(0,d.w6)("design:returntype",void 0)],C.prototype,"_okText",null),(0,d.gn)([u.Fl,(0,d.w6)("design:type",Function),(0,d.w6)("design:paramtypes",[]),(0,d.w6)("design:returntype",void 0)],C.prototype,"_cancelText",null),(0,d.gn)([u.Fl,(0,d.w6)("design:type",Function),(0,d.w6)("design:paramtypes",[]),(0,d.w6)("design:returntype",void 0)],C.prototype,"_contentText",null),(0,d.gn)([u.Fl,(0,d.w6)("design:type",Function),(0,d.w6)("design:paramtypes",[]),(0,d.w6)("design:returntype",void 0)],C.prototype,"_titleText",null),(0,d.gn)([u.Fl,(0,d.w6)("design:type",Function),(0,d.w6)("design:paramtypes",[]),(0,d.w6)("design:returntype",void 0)],C.prototype,"_reporterParams",null),(0,d.gn)([u.Fl,(0,d.w6)("design:type",Function),(0,d.w6)("design:paramtypes",[]),(0,d.w6)("design:returntype",void 0)],C.prototype,"_workspaceInfo",null),(0,d.gn)([u.aD,(0,d.w6)("design:type",Function),(0,d.w6)("design:paramtypes",["undefined"==typeof TStorageExpandInstanceOrUndefined?Object:TStorageExpandInstanceOrUndefined]),(0,d.w6)("design:returntype",void 0)],C.prototype,"setExpandModalInstance",null),C=(0,d.gn)([(0,d.fM)(1,p.Gw),(0,d.fM)(2,f.W),(0,d.fM)(3,m.w),(0,d.fM)(4,g.m),(0,d.fM)(5,v.S),(0,d.w6)("design:type",Function),(0,d.w6)("design:paramtypes",[void 0===S.o?Object:S.o,void 0===p.Gw?Object:p.Gw,void 0===f.W?Object:f.W,void 0===m.w?Object:m.w,void 0===g.m?Object:g.m,void 0===v.S?Object:v.S])],C)},527117:function(e,t,n){"use strict";n.d(t,{bY:function(){return O},jD:function(){return o},x:function(){return i}});var r,i,o,s=n(461228),a=n(789786);n(349601);var l=n(781494),c=n(64367),d=n(216518),u=n(626171),h=n(461644),p=n(333205),f=n(248176),m=n(254845),g=n(980014),v=n(386527),y=n(405859),b=n(543544),_=n(466928),w=n(195894),x=n(950544),S=n(48224),k=n(202659),C=n(519326),M=n(123951);(i||(i={})).initOnTextToVideoService="AIWriterManager",(r=o||(o={}))[r.Rewrite=0]="Rewrite";class O{get editor(){return this._mainTextToVideoWidgetService.textEditorManager.editor}get isLike(){return!!this.isLikeMap[this.current]}get isDislike(){return!!this.isDislikeMap[this.current]}get aiWriterResultBarType(){(0,g.Y2)(this._fetchResultsParams);var{type:e}=this._fetchResultsParams;return e===u.Yq.Rewrite?"rewrite":e===u.Yq.Longer?"write_longer":"write_shorter"}restore(){var e;this._persistanceService.restore(this,["isHoverAIWriterButton","loading","results","current","isLikeMap","isDislikeMap","records","_fetchResultsParams","_timesMap"],{shouldRestore:!!(null===(e=this._capcutAccountService.userProfile)||void 0===e?void 0:e.uid),storeId:this._storeId,uid:this._capcutAccountService.userProfile.uid})&&this.loading&&this.destroy()}handleRewrite(e){var{selectionData:t,content:n}=e;this._fetchResultsParams={content:n,type:u.Yq.Rewrite,selectionData:t},this._handleWriterTask()}handleWriterShorter(e){var{selectionData:t,content:n}=e;this._fetchResultsParams={content:n,type:u.Yq.Shorter,selectionData:t},this._handleWriterTask()}handleWriterLonger(e){var{selectionData:t,content:n}=e;this._fetchResultsParams={content:n,type:u.Yq.Longer,selectionData:t},this._handleWriterTask()}handleGenerate(e){(0,S.Gy)(this.editor,{triggerFrom:e,records:this.records}),(0,k.z)(this._containerService,{action:"ai_writer",aiWriterEntrance:e})}handleLoadMore(){var e=this;return(0,s._)(function*(){return(0,g.Y2)(e._fetchResultsParams),yield e._fetchResults(e._fetchResultsParams,!0)})()}setRecords(e){this.records=e}addRecord(e){this.records.push(e)}clearRecords(){this.records=[]}shouldShowWriteShorter(e){return e.replace(/\s/g,"").length>=50}setLike(e){(0,v.Z)(this.isLikeMap,this.current,e)}setDislike(e){(0,v.Z)(this.isDislikeMap,this.current,e)}setCurrent(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||this.undoStack.push(this.current),this.current=e}deleteSingleScript(e){this.results.splice(e,1)}saveAPartialTrackData(){var e=this.results[this.current];(0,g.Y2)(e),(0,g.Y2)(this._fetchResultsParams),this._timesMap[this._fetchResultsParams.type]+=1,this._aiWriterTrackDataManager.mergeTrackData({script_category_list:"",script_id_list:e.scriptId,smart_script_id_list:"",script_request_id_list:"",prompt_text_cnt_list:0,prompt_text_detail_list:"",prompt_source_list:"",product_list:"",selling_points_text_cnt_list:0,selling_points_text_detail_list:"",selling_points_num_list:0,model_name_list:"",routine_list:"",script_list:"",ai_writer_template_name_list:"",text_to_video_rewrite_times:this._timesMap[u.Yq.Rewrite],text_to_video_shorter_times:this._timesMap[u.Yq.Shorter],text_to_video_longer_times:this._timesMap[u.Yq.Longer]})}checkText(e,t){var n=(0,C.i4)(e),r=(0,C.In)(e)>500,i="";return n||(0===t?i=M.ZP.t("web_ai_writer_hover_only_support_english",{},"Use prompt in English to generate"):(0,g.bP)(t)),r&&(0===t?i=M.ZP.t("web_ai_writer_toast_words_limit",{},"Can\u2019t polish. Delete some words and try again."):(0,g.bP)(t)),i&&l.Z.warning(i),n&&!r}destroy(){this.isHoverAIWriterButton=!1,this.records=[],this.results=[],this.current=0,this.isLikeMap={},this.isDislikeMap={},this.undoStack=[],this.redoStack=[],this.loading=!1,this._fetchResultsParams=null}_fetchResults(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return(0,s._)(function*(){t||(n.current=0),n.loading=!0;var r=yield n._aiWriterDataService.textRewrite(e);return r.ok?(n.results.push(...r.value.texts),n.loading=!1,!0):(l.Z.error(r.msg),n.loading=!1,!1)})()}_handleWriterTask(){var e=this;return(0,s._)(function*(){var t,n;(0,g.Y2)(e._fetchResultsParams),(yield e._fetchResults(e._fetchResultsParams))?e.editor.execCommand(_.b,{selection:e._fetchResultsParams.selectionData,data:{result:null===(n=e.results)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.text,records:e.records}}):(0,w.P2)(e.editor,x.Lv,"true",!0)})()}constructor(e,t,n,r,i,o,s){this._mainTextToVideoWidgetService=n,this._containerService=r,this._aiWriterDataService=i,this._capcutAccountService=o,this._persistanceService=s,this.isHoverAIWriterButton=!1,this.loading=!1,this.results=[],this.current=0,this.isLikeMap={},this.isDislikeMap={},this.records=[],this.undoStack=[],this.redoStack=[],this.isEditorMouseDown=!1,this.isSelecting=!1,this._fetchResultsParams=null,this._timesMap={[u.Yq.Rewrite]:0,[u.Yq.Longer]:0,[u.Yq.Shorter]:0},this._storeId="",this.handleAIWriterButtonMouseEnter=()=>{var e=this.editor.getContentState(),t=e.getZoneState(c.S),n=this.editor.selection.getSelection(),r=t.getLine(n.end.line),i=r.isEmpty(),o=r.getText(),s=r.length()-1;if(this.clearRecords(),!i){this.isHoverAIWriterButton=!0;var a=new d.e({editor:this.editor,start:{offset:0,zoneId:c.S,line:n.end.line},end:{offset:s,zoneId:c.S,line:n.end.line}}),l=e.setAttributes(a,{[x.Lv]:"true"});l&&this.addRecord(l),requestAnimationFrame(()=>{this.editor.blur()})}return{isEmpty:i,showWriteShorter:this.shouldShowWriteShorter(o)}},this.handleAIWriterButtonMouseLeave=()=>{this.isHoverAIWriterButton=!1,(0,w.P2)(this.editor,x.Lv,"true",!0)},(0,m.rC)(this),this._storeId=e,this._aiWriterTrackDataManager=t}}(0,a.gn)([m.LO,(0,a.w6)("design:type",Boolean)],O.prototype,"isHoverAIWriterButton",void 0),(0,a.gn)([m.LO],O.prototype,"loading",void 0),(0,a.gn)([m.LO,(0,a.w6)("design:type",Array)],O.prototype,"results",void 0),(0,a.gn)([m.LO,(0,a.w6)("design:type",Number)],O.prototype,"current",void 0),(0,a.gn)([m.LO,(0,a.w6)("design:type","undefined"==typeof Record?Object:Record)],O.prototype,"isLikeMap",void 0),(0,a.gn)([m.LO,(0,a.w6)("design:type","undefined"==typeof Record?Object:Record)],O.prototype,"isDislikeMap",void 0),(0,a.gn)([m.LO,(0,a.w6)("design:type",Boolean)],O.prototype,"isEditorMouseDown",void 0),(0,a.gn)([m.LO,(0,a.w6)("design:type",Boolean)],O.prototype,"isSelecting",void 0),(0,a.gn)([m.Fl,(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[]),(0,a.w6)("design:returntype",void 0)],O.prototype,"isLike",null),(0,a.gn)([m.Fl,(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[]),(0,a.w6)("design:returntype",void 0)],O.prototype,"isDislike",null),(0,a.gn)([m.aD],O.prototype,"handleAIWriterButtonMouseEnter",void 0),(0,a.gn)([m.aD,(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[Boolean]),(0,a.w6)("design:returntype",void 0)],O.prototype,"setLike",null),(0,a.gn)([m.aD,(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[Boolean]),(0,a.w6)("design:returntype",void 0)],O.prototype,"setDislike",null),(0,a.gn)([m.aD,(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[Number,void 0]),(0,a.w6)("design:returntype",void 0)],O.prototype,"setCurrent",null),O=(0,a.gn)([(0,a.fM)(2,y.J),(0,a.fM)(3,h.t),(0,a.fM)(4,p.J),(0,a.fM)(5,f.Gw),(0,a.fM)(6,b.t),(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[void 0===i?Object:i,"undefined"==typeof AIWriterTrackDataManager?Object:AIWriterTrackDataManager,void 0===y.J?Object:y.J,void 0===h.t?Object:h.t,void 0===p.J?Object:p.J,void 0===f.Gw?Object:f.Gw,void 0===b.t?Object:b.t])],O)},399199:function(e,t,n){"use strict";n.d(t,{k:function(){return s}});var r=n(461228),i=n(650248),o=n(577729);class s extends o.JT{get timestamp(){return this._timestamp}_updateTimestamp(){this._timestamp=Date.now()}get duration(){return isFinite(this._audio.duration)?1e3*this._audio.duration:0}onCanPlay(e){this._audio.oncanplay=e}onProgress(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n=arguments.length>2?arguments[2]:void 0;null===e?this._audio.ontimeupdate=null:(n&&(e=(0,i.Z)(e,n)),this._audio.ontimeupdate=n=>{if("percent"!==t)return null==e?void 0:e(1e3*n.target.currentTime);var{currentTime:r,duration:i}=n.target,o=r/i;return null==e?void 0:e(isFinite(o)?o:0)})}onEnded(e){this._audio.onended=e}play(){this._audio.play()}pause(){this._audio.pause()}seek(e){var t=this;return(0,r._)(function*(){t._audio.currentTime=e/1e3,yield new Promise(e=>t._audio.onseeked=e)})()}setVolume(e){if(e<0||e>1)throw Error("Volume must be between 0 and 1");this._audio.volume=e}setSrc(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=this;return(0,r._)(function*(){var r=e;if("string"!=typeof e){var o=new Blob([e],{type:"audio"});r=URL.createObjectURL(o)}i._audio.src=globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(r,null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),i._updateTimestamp(),t&&(yield new Promise(e=>i._audio.oncanplay=e),null==n||n(),i._audio.src===r&&i.play())})()}reset(){try{this._audio.src.startsWith("blob:")&&URL.revokeObjectURL(this._audio.src),this._audio.pause(),this._audio.removeAttribute("src"),this._audio.load()}catch(e){}}constructor(){super(),this._serviceBrand=void 0,this._audio=new Audio,this._timestamp=Date.now()}}},335335:function(e,t,n){"use strict";n.d(t,{O:function(){return o},a:function(){return i}});var r=n(988441);function i(e,t){if(t===r.o.URLToVideo){var n,i,o=null===(i=window.navigator)||void 0===i?void 0:null===(n=i.language)||void 0===n?void 0:n.startsWith("en"),s=e.startsWith("en");return o||s}return"en"===e}function o(e,t){if(t===r.o.URLToVideo){var n=["US","GB","CA","AU","NZ"].some(t=>t===e);if(window.is_sensitive_region)return 2===window.history.length||1===window.history.length?location.href=globalThis.xssNamespace["lvweb/smart-tools"].filterUrl("".concat(location.origin,"/").concat(location.search),null,{logType:"js.href/src",mode:"black",reportOnly:"all"}):window.history.back(),!0;if(n)return!0}return!1}},523474:function(e,t,n){"use strict";n.d(t,{S:function(){return r}});var r=(0,n(30276).yh)("user")},808979:function(e,t,n){"use strict";n.d(t,{V:function(){return s}});var r=n(716913),i=n(386527),o=n(824547);class s{get contents(){return this._contents}getValue(e){return(0,r.Z)(this._contents,e)}setValue(e,t){(0,i.Z)(this._contents,e,t)}isEmpty(){return 0===Object.keys(this._contents).length}init(e){this._contents=e}reset(e){this._contents=e}merge(e){return(0,o.Z)(this._contents,e),this}constructor(e={}){this._contents=e}}},341091:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var r=(0,n(30276).yh)("tcc-configuration")},356180:function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var r={PROMPT_TO_TEXT:"/lv/v1/intelligence/prompt_to_text",TEXT_REWRITE:"/lv/v1/intelligence/text_rewrite",TEXT_REWRITE_CN:"/lv/v1/aigc_text/rewrite",REPORT:"/lv/v1/report/report"}},987799:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var r=(0,n(30276).yh)("graffiti-data-service")},988441:function(e,t,n){"use strict";var r,i;n.d(t,{o:function(){return r}}),(i=r||(r={}))[i.TextToImage=1]="TextToImage",i[i.ImageToImage=2]="ImageToImage",i[i.ImageStyleAvatar=3]="ImageStyleAvatar",i[i.ImageNightEnhance=4]="ImageNightEnhance",i[i.ImageStyleConversion=5]="ImageStyleConversion",i[i.ImageUpscaler=6]="ImageUpscaler",i[i.ImageAiToning=7]="ImageAiToning",i[i.ImageColoring=8]="ImageColoring",i[i.ImageRestoration=9]="ImageRestoration",i[i.VideoStyleConversion=10]="VideoStyleConversion",i[i.VideoUpscaler=11]="VideoUpscaler",i[i.VideoSlowMotion=12]="VideoSlowMotion",i[i.VideoStabilization=13]="VideoStabilization",i[i.Autocut=14]="Autocut",i[i.TextToVideo=15]="TextToVideo",i[i.URLToVideo=16]="URLToVideo",i[i.LongToShort=21]="LongToShort",i[i.TextToSpeech=30]="TextToSpeech",i[i.AudioVideoTranslator=31]="AudioVideoTranslator",i[i.Resize=1001]="Resize",i[i.RemoveBackground=1002]="RemoveBackground",i[i.Script=1003]="Script",i[i.BatchEdit=1004]="BatchEdit",i[i.TextToDesign=1005]="TextToDesign",i[i.ProductPhotos=1006]="ProductPhotos",i[i.AIModel=1007]="AIModel",i[i.TextToImageInGraphic=1008]="TextToImageInGraphic"},164295:function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var r=(0,n(30276).yh)("mix-data-service")},375340:function(e,t,n){"use strict";n.d(t,{c:function(){return g}});var r=n(461228),i=n(69984),o=n(764112),s=n(327736),a=n(243307),l=n(669403),c=n(89772),d=n(816752),u=n(446176),h=n(618230),p=n(963473),f=n(950403),m=n(530487);class g{get _createTaskApi(){return"".concat(d._L.getVar("web_domain")).concat(f.b.CREATE_INTELLIGENT_TASK)}get _getTaskDetailApi(){return"".concat(d._L.getVar("web_domain")).concat(f.b.GET_INTELLIGENT_TASK_DETAIL)}get _networkClient(){if(!this._networkClientInstance){var e,t;this._networkClientInstance=(e=this._disabledRetry,t=new s.yk().build({headers:{"Content-Type":"application/json"}}),(0,a.Y)(t),(0,l.i3)(t),(0,c.mH)(t),e||(0,h.V)(t),t)}return this._networkClientInstance}createIntelligentTask(e,t){var n=this;return(0,r._)(function*(){try{var r=JSON.stringify(e),s=n._cacheTaskReqMap.get(r);s||(s=n._networkClient.post(n._createTaskApi,(0,o._)((0,i._)({},e),{app_id:u.k}),{withCredentials:!0,params:t}).finally(()=>{n._cacheTaskReqMap.delete(r)}),n._cacheTaskReqMap.set(r,s));var a=yield s;if("0"!==a.ret)return(0,p.wf)(Number(a.ret),a.errmsg);return(0,p.oW)(a)}catch(e){return(0,m.m)(e,-1,"createIntelligentTask api error.")}})()}getIntelligentTask(e,t){var n=this;return(0,r._)(function*(){try{var r=yield n._networkClient.post(n._getTaskDetailApi,(0,i._)({},e),{withCredentials:!0,params:t});if("0"!==r.ret)return(0,p.wf)(Number(r.ret),r.errmsg);return r.data._meta={log_id:r.log_id},(0,p.oW)(r.data)}catch(e){return(0,m.m)(e,-1,"getIntelligentTaskDetail api error.")}})()}constructor(e){this._cacheTaskReqMap=new Map,this._disabledRetry=e}}},856537:function(e,t,n){"use strict";n.d(t,{v:function(){return b}});var r=n(461228),i=n(69984),o=n(789786),s=n(85024),a=n(963473),l=n(179667),c=n(203427),d=n(980014),u=n(658742),h=n(197737),p=n(211928),f=n(189619),m=n(211151),g=n(804e3),v=n(271835);function y(e,t){return"".concat(e,"_").concat(t)}class b{get onSuccess(){return this._value?(0,s.V)(this._value):this._onSuccess.event}get onFail(){return this._error?(0,s.V)(this._error):this._onFail.event}get key(){return this._options.key}get status(){return this._status}get value(){return this._value}get sourceFrom(){return this._sourceFrom}get error(){return this._error}get downloadType(){return this._downloadType}set downloadType(e){this._config.downloadType=e}fetch(){var e=this;return(0,r._)(function*(){e._status=p.lh.Loading,e._clearCacheIfExist&&(yield e._deleteResourceCacheIfExist()),e._databaseFirst&&(yield e._fetchByStorage()),e._status===p.lh.Loading&&(e._options.url.startsWith("blob:")?yield e._fetchByBlobUrl():yield e._fetchByNetwork())})()}cancel(){this._downloadService.remove(this),this._cancellationTokenSource.cancel(),this._fireFail((0,a.wf)(l.pY.Cancelled,"download task canceled."))}startImmediately(){this._downloadService.startImmediately(this)}equal(e){return(0,c.v)(this._options,e._options)&&(0,c.v)(this._compareConfig,e._compareConfig)}toJSON(){return{options:this._options,config:this._compareConfig}}get _compareConfig(){var e={};return this._config.cacheInDatabase&&(e.cacheInDatabase=this._config.cacheInDatabase),this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),this._config.headers&&(e.headers=this._config.headers),this._config.disableTokenHeaders&&(e.disableTokenHeaders=this._config.disableTokenHeaders),e}get _downloadType(){var e;return null!==(e=this._config.downloadType)&&void 0!==e?e:p._5.Idle}get _cacheInDatabase(){var e;return null===(e=this._config.cacheInDatabase)||void 0===e||e}get _databaseFirst(){var e;return null===(e=this._config.databaseFirst)||void 0===e||e}get _clearCacheIfExist(){var e;return null!==(e=this._config.clearCacheIfExist)&&void 0!==e&&e}get _headers(){return this._config.headers}get _disableTokenHeaders(){var e;return null!==(e=this._config.disableTokenHeaders)&&void 0!==e&&e}_deleteResourceCacheIfExist(){var e=this;return(0,r._)(function*(){var t=yield e._storageService.database.connect(f.g.id,m.d.name);if(!t.ok)return!1;var n=t.value,[r]=(yield n.delete(e._options.key,{durability:"relaxed"})).pair();return!r||!!r.ok})()}_fetchMetaByStorage(){var e=this;return(0,r._)(function*(){var t=yield e._storageService.database.connect(f.g.id,m.d.name);if(!t.ok)return t;var n=t.value,[r,i]=(yield n.query(e._options.key,{durability:"relaxed"})).pair();return r&&!r.ok?r:i?(0,a.oW)(i):(0,l.PX)()})()}_fetchDetailByStorage(e){var t=this;return(0,r._)(function*(){var n=yield t._storageService.database.connect(f.g.id,m.z.name);if(!n.ok)return n;var r=n.value,[i,o]=(yield r.query(y(e.uniqueId,e.decryptHash),{durability:"relaxed"})).pair();return i&&!i.ok?i:o?(0,a.oW)(o):(0,l.PX)()})()}_fetchByStorage(){var e=this;return(0,r._)(function*(){var t=e._fetchDetailByStorage({uniqueId:e._options.uniqueId,decryptHash:e._options.decryptHash}),[n,r]=(yield e._fetchMetaByStorage()).pair();if(!n&&r.uniqueId===e._options.uniqueId&&r.decryptHash===e._options.decryptHash){var[i,o]=(yield t).pair();i||e._fireSuccess({key:e._options.key,url:e._options.url,uniqueId:e._options.uniqueId,decryptHash:e._options.decryptHash,contentType:r.contentType,buffer:o.buffer},p.Gu.Cache)}})()}_fetchByNetwork(){var e=this;return(0,r._)(function*(){try{var t,n={};if(e._options.url.match(/origin/)){var[r,o]=(yield e._evercloudTokenDataService.getEvercloudToken()).pair();r||e._disableTokenHeaders||(n={"x-everphoto-global-session-token":o.token,"x-everphoto-token":o.token})}var s=yield e._networkClient.request({method:"GET",url:e._options.url,headers:(0,i._)({},e._headers,n),withCredentials:e._config.withCredentials,signal:e._cancellationTokenSource.signal}),l=s.data,c=null!==(t=s.headers["content-type"])&&void 0!==t?t:"";e._fireSuccess({key:e._options.key,url:e._options.url,uniqueId:e._options.uniqueId,decryptHash:e._options.decryptHash,buffer:l,contentType:c},p.Gu.Online),e._cacheInDatabase&&e._cache(l,c)}catch(t){if(e._cancellationTokenSource.token.isCancellationRequested)return;e._fireFail((0,a.Mx)(-1,"download error.",t))}})()}_fetchByBlobUrl(){var e=this;return(0,r._)(function*(){try{var t,n=yield fetch(e._options.url),r=yield n.arrayBuffer(),i=null!==(t=n.headers.get("content-type"))&&void 0!==t?t:"";e._fireSuccess({key:e._options.key,url:e._options.url,uniqueId:e._options.uniqueId,decryptHash:e._options.decryptHash,buffer:r,contentType:i},p.Gu.Memory)}catch(t){e._fireFail((0,a.Mx)(l.pY.Interrupted,"download error.",t))}})()}_fireSuccess(e,t){this._cancellationTokenSource.token.isCancellationRequested||((0,d.Y2)(this._status===p.lh.Loading),this._status=p.lh.Completed,this._value=e,this._sourceFrom=t,this._onSuccess.fire())}_fireFail(e){this._status!==p.lh.Error&&(this._status=p.lh.Error,this._error=e,this._onFail.fire(this._error))}_cache(e,t){var n=this;return(0,r._)(function*(){(yield n._cacheDetail(e)).ok&&n._cacheMeta(t)})()}_cacheMeta(e){var t=this;return(0,r._)(function*(){var n=yield t._storageService.database.connect(f.g.id,m.d.name);if(!n.ok)return n;var r=n.value,i={key:t._options.key,contentType:e,uniqueId:t._options.uniqueId,decryptHash:t._options.decryptHash};return r.set(t._options.key,i,{durability:"relaxed"})})()}_cacheDetail(e){var t=this;return(0,r._)(function*(){var n=yield t._storageService.database.connect(f.g.id,m.z.name);if(!n.ok)return n;var r=n.value,i=y(t._options.uniqueId,t._options.decryptHash);return r.set(i,{uniqueIdWithDecryptHash:i,buffer:e},{durability:"relaxed"})})()}constructor(e,t,n,r,i,o){this._config=e,this._options=t,this._networkClient=n,this._downloadService=r,this._storageService=i,this._evercloudTokenDataService=o,this._status=p.lh.Waiting,this._onSuccess=new u.Q,this._onFail=new u.Q,this._cancellationTokenSource=new h.A}}b=(0,o.gn)([(0,o.fM)(4,v.U),(0,o.fM)(5,g.o),(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",["undefined"==typeof IDownloadConfig?Object:IDownloadConfig,"undefined"==typeof IDownloadOptions?Object:IDownloadOptions,"undefined"==typeof NetworkClientInstance?Object:NetworkClientInstance,"undefined"==typeof ResourceDownloadService?Object:ResourceDownloadService,void 0===v.U?Object:v.U,void 0===g.o?Object:g.o])],b)},815844:function(e,t,n){"use strict";n.d(t,{D:function(){return a}});var r=n(461228),i=n(156216),o=n(320698),s=n(980014);class a extends i.w{doParseArrayBuffer(e){var t=this,n=()=>super.doParseArrayBuffer;return(0,r._)(function*(){n().call(t,e);var r=yield(0,o.x)(e.buffer,e.contentType);(0,s.Y2)(!(r instanceof ArrayBuffer));var i=Object.keys(r).find(e=>t._contentFileFilter(e));(0,s.Y2)(i),Object.defineProperty(t.value,"content",{get:()=>new TextDecoder("utf-8").decode(r[i].arrayBuffer),enumerable:!0})})()}constructor(e,t,n){super(e,t),this._contentFileFilter=n}}},57365:function(e,t,n){"use strict";n.d(t,{M:function(){return p}});var r=n(461228),i=n(69984),o=n(789786),s=n(175462),a=n(211928),l=n(980014),c=n(466477),d=n(806797),u=n(762134),h=n(250047);class p extends u.B{getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}getContentResourceToken(){return this._getResourceTokenSync(this._createContentToken.bind(this),()=>this._contentResourceToken,e=>this._contentResourceToken=e)}_createContentToken(e){var t=this._getContentResourceKey(),n=this.getContentUrl(e);return(0,h.T0)({key:t,url:n},this._downloadService)}_getContentResourceKey(){return"".concat(this.key,"_content")}doFetch(){var e=this;return(0,r._)(function*(){(0,l.Y2)(!(0,c.R)(e.value));var[t,n]=(yield e._imageFigureEffectDataService.batchGetEffectByIds({enterFrom:e._configurationService.editorCategory,list:[{ids:[e.value.resourceId],type:e._configurationService.resourcePanel[e.resourceType]}]})).pair();if(t)throw Error("doFetch error ".concat(t.code));return(0,i._)({type:e.value.type},n.list[0])})()}constructor(e,t,n,r,i){super(e,t,n),this.key=e,this._downloadService=n,this._imageFigureEffectDataService=r,this._configurationService=i}}p=(0,o.gn)([(0,o.fM)(2,a.tx),(0,o.fM)(3,s.x),(0,o.fM)(4,d.Ui),(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IImageFigureEffectMeta?Object:IImageFigureEffectMeta,void 0===a.tx?Object:a.tx,void 0===s.x?Object:s.x,void 0===d.Ui?Object:d.Ui])],p)},112471:function(e,t,n){"use strict";n.d(t,{K:function(){return l}});var r=n(789786),i=n(251164),o=n(476693),s=n(963730),a=n(37011);class l extends i.e{createResource(e,t){return this._instantiationService.createInstance(new s.M(o.U,[e,t]))}constructor(e){super(e),this._instantiationService=e}}l=(0,r.gn)([(0,r.fM)(0,a.T),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[void 0===a.T?Object:a.T])],l)},17116:function(e,t,n){"use strict";n.d(t,{Y:function(){return i}});var r=n(392174);function i(e){var{tokenKey:t,decryptKey:n}=e;return n?"".concat(t,"_").concat((0,r.Cv)(n)):t}},600282:function(e,t,n){"use strict";var r=n(583531),i=n(246513),o=r("%Number%"),s=n(942799),a=n(4084),l=n(139701);e.exports=function(e){var t=s(e)?e:a(e,o);if("symbol"==typeof t)throw new i("Cannot convert a Symbol value to a number");if("bigint"==typeof t)throw new i("Conversion from 'BigInt' to 'number' is not allowed.");return"string"==typeof t?l(t):o(t)}},347198:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(804430);function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&i.push.apply(i,Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),i.forEach(function(t){(0,r.Z)(e,t,n[t])})}return e}},498989:function(e,t,n){"use strict";n.d(t,{DK:function(){return ey},ML:function(){return em},NB:function(){return ev},P1:function(){return v},hj:function(){return I},pr:function(){return eo}});var r=n(135611),i=n(496418),o=n(100315),s=n(881714),a=n(187457),l=n(956245),c=n(935010);function d(e){let{state:t,transaction:n}=e,{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}class u{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:n}=this,{view:r}=t,{tr:i}=n,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{let n=t(...e)(o);return i.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(i),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:n,editor:r,state:i}=this,{view:o}=r,s=[],a=!!e,l=e||i.tr,c={...Object.fromEntries(Object.entries(n).map(([e,n])=>[e,(...e)=>{let r=this.buildProps(l,t),i=n(...e)(r);return s.push(i),c}])),run:()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(l),s.every(e=>!0===e))};return c}createCan(e){let{rawCommands:t,state:n}=this,r=e||n.tr,i=this.buildProps(r,!1);return{...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...i,dispatch:void 0})])),chain:()=>this.createChain(r,!1)}}buildProps(e,t=!0){let{rawCommands:n,editor:r,state:i}=this,{view:o}=r,s={tr:e,editor:r,view:o,state:d({state:i,transaction:e}),dispatch:t?()=>void 0:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,(...e)=>t(...e)(s)]))}};return s}}class h{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){let n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function p(e,t,n){return void 0===e.config[t]&&e.parent?p(e.parent,t,n):"function"==typeof e.config[t]?e.config[t].bind({...n,parent:e.parent?p(e.parent,t,n):null}):e.config[t]}function f(e){return{baseExtensions:e.filter(e=>"extension"===e.type),nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function m(e){let t=[],{nodeExtensions:n,markExtensions:r}=f(e),i=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage},r=p(e,"addGlobalAttributes",n);r&&r().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,r])=>{t.push({type:n,name:e,attribute:{...o,...r}})})})})}),i.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage},r=p(e,"addAttributes",n);r&&Object.entries(r()).forEach(([n,r])=>{let i={...o,...r};"function"==typeof(null==i?void 0:i.default)&&(i.default=i.default()),(null==i?void 0:i.isRequired)&&(null==i?void 0:i.default)===void 0&&delete i.default,t.push({type:e.name,name:n,attribute:i})})}),t}function g(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function v(...e){return e.filter(e=>!!e).reduce((e,t)=>{let n={...e};return Object.entries(t).forEach(([e,t])=>{if(!n[e]){n[e]=t;return}if("class"===e){let r=t?t.split(" "):[],i=n[e]?n[e].split(" "):[],o=r.filter(e=>!i.includes(e));n[e]=[...i,...o].join(" ")}else"style"===e?n[e]=[n[e],t].join("; "):n[e]=t}),n},{})}function y(e,t){return t.filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>v(e,t),{})}function b(e){return"function"==typeof e}function _(e,t,...n){return b(e)?t?e.bind(t)(...n):e(...n):e}function w(e,t){return e.style?e:{...e,getAttrs:n=>{let r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;let i=t.reduce((e,t)=>{var r;let i=t.attribute.parseHTML?t.attribute.parseHTML(n):"string"!=typeof(r=n.getAttribute(t.name))?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):"true"===r||"false"!==r&&r;return null==i?e:{...e,[t.name]:i}},{});return{...r,...i}}}}function x(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>!("attrs"===e&&function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function S(e,t){return t.nodes[e]||t.marks[e]||null}function k(e,t){return Array.isArray(t)?t.some(t=>("string"==typeof t?t:t.name)===e.name):t}let C=(e,t=500)=>{let n="",r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,i,o)=>{var s,a;let l=(null===(a=(s=e.type.spec).toText)||void 0===a?void 0:a.call(s,{node:e,pos:t,parent:i,index:o}))||e.textContent||"%leaf%";n+=l.slice(0,Math.max(0,r-t))}),n};function M(e){return"[object RegExp]"===Object.prototype.toString.call(e)}let O=(e,t)=>{if(M(t))return t.exec(e);let n=t(e);if(!n)return null;let r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function T(e){var t;let{editor:n,from:r,to:i,text:o,rules:s,plugin:a}=e,{view:l}=n;if(l.composing)return!1;let c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(null===(t=c.nodeBefore||c.nodeAfter)||void 0===t?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let h=!1,p=C(c)+o;return s.forEach(e=>{if(h)return;let t=O(p,e.find);if(!t)return;let s=l.state.tr,c=d({state:l.state,transaction:s}),f={from:r-(t[0].length-o.length),to:i},{commands:m,chain:g,can:v}=new u({editor:n,state:c});null!==e.handler({state:c,range:f,match:t,commands:m,chain:g,can:v})&&s.steps.length&&(s.setMeta(a,{transform:s,from:r,to:i,text:o}),l.dispatch(s),h=!0)}),h}let A=(e,t,n)=>{if(M(t))return[...e.matchAll(t)];let r=t(e,n);return r?r.map(t=>{let n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]};class N{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=N.resolve(e),this.schema=function(e,t){var n;let r=m(e),{nodeExtensions:i,markExtensions:o}=f(e),a=null===(n=i.find(e=>p(e,"topNode")))||void 0===n?void 0:n.name,l=Object.fromEntries(i.map(n=>{let i=r.filter(e=>e.type===n.name),o={name:n.name,options:n.options,storage:n.storage,editor:t},s=x({...e.reduce((e,t)=>{let r=p(t,"extendNodeSchema",o);return{...e,...r?r(n):{}}},{}),content:_(p(n,"content",o)),marks:_(p(n,"marks",o)),group:_(p(n,"group",o)),inline:_(p(n,"inline",o)),atom:_(p(n,"atom",o)),selectable:_(p(n,"selectable",o)),draggable:_(p(n,"draggable",o)),code:_(p(n,"code",o)),defining:_(p(n,"defining",o)),isolating:_(p(n,"isolating",o)),attrs:Object.fromEntries(i.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=_(p(n,"parseHTML",o));a&&(s.parseDOM=a.map(e=>w(e,i)));let l=p(n,"renderHTML",o);l&&(s.toDOM=e=>l({node:e,HTMLAttributes:y(e,i)}));let c=p(n,"renderText",o);return c&&(s.toText=c),[n.name,s]})),c=Object.fromEntries(o.map(n=>{let i=r.filter(e=>e.type===n.name),o={name:n.name,options:n.options,storage:n.storage,editor:t},s=x({...e.reduce((e,t)=>{let r=p(t,"extendMarkSchema",o);return{...e,...r?r(n):{}}},{}),inclusive:_(p(n,"inclusive",o)),excludes:_(p(n,"excludes",o)),group:_(p(n,"group",o)),spanning:_(p(n,"spanning",o)),code:_(p(n,"code",o)),attrs:Object.fromEntries(i.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=_(p(n,"parseHTML",o));a&&(s.parseDOM=a.map(e=>w(e,i)));let l=p(n,"renderHTML",o);return l&&(s.toDOM=e=>l({mark:e,HTMLAttributes:y(e,i)})),[n.name,s]}));return new s.V_({topNode:a,nodes:l,marks:c})}(this.extensions,t),this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;let n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:S(e.name,this.schema)};"mark"===e.type&&(null===(t=_(p(e,"keepOnSplit",n)))||void 0===t||t)&&this.splittableMarks.push(e.name);let r=p(e,"onBeforeCreate",n);r&&this.editor.on("beforeCreate",r);let i=p(e,"onCreate",n);i&&this.editor.on("create",i);let o=p(e,"onUpdate",n);o&&this.editor.on("update",o);let s=p(e,"onSelectionUpdate",n);s&&this.editor.on("selectionUpdate",s);let a=p(e,"onTransaction",n);a&&this.editor.on("transaction",a);let l=p(e,"onFocus",n);l&&this.editor.on("focus",l);let c=p(e,"onBlur",n);c&&this.editor.on("blur",c);let d=p(e,"onDestroy",n);d&&this.editor.on("destroy",d)})}static resolve(e){var t;let n=N.sort(N.flatten(e)),r=[...new Set((t=n.map(e=>e.name)).filter((e,n)=>t.indexOf(e)!==n))];return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(e=>`'${e}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(e=>{let t={name:e.name,options:e.options,storage:e.storage},n=p(e,"addExtensions",t);return n?[e,...this.flatten(n())]:e}).flat(10)}static sort(e){return e.sort((e,t)=>{let n=p(e,"priority")||100,r=p(t,"priority")||100;return n>r?-1:n<r?1:0})}get commands(){return this.extensions.reduce((e,t)=>{let n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:S(t.name,this.schema)},r=p(t,"addCommands",n);return r?{...e,...r()}:e},{})}get plugins(){let{editor:e}=this,t=N.sort([...this.extensions].reverse()),n=[],i=[],s=t.map(t=>{let r={name:t.name,options:t.options,storage:t.storage,editor:e,type:S(t.name,this.schema)},s=[],a=p(t,"addKeyboardShortcuts",r),l={};if("mark"===t.type&&t.config.exitable&&(l.ArrowRight=()=>eg.handleExit({editor:e,mark:t})),a){let t=Object.fromEntries(Object.entries(a()).map(([t,n])=>[t,()=>n({editor:e})]));l={...l,...t}}let c=(0,o.h)(l);s.push(c);let d=p(t,"addInputRules",r);k(t,e.options.enableInputRules)&&d&&n.push(...d());let u=p(t,"addPasteRules",r);k(t,e.options.enablePasteRules)&&u&&i.push(...u());let h=p(t,"addProseMirrorPlugins",r);if(h){let e=h();s.push(...e)}return s}).flat();return[function(e){let{editor:t,rules:n}=e,i=new r.Sy({state:{init:()=>null,apply:(e,t)=>e.getMeta(i)||(e.selectionSet||e.docChanged?null:t)},props:{handleTextInput:(e,r,o,s)=>T({editor:t,from:r,to:o,text:s,rules:n,plugin:i}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{let{$cursor:r}=e.state.selection;r&&T({editor:t,from:r.pos,to:r.pos,text:"",rules:n,plugin:i})}),!1)},handleKeyDown(e,r){if("Enter"!==r.key)return!1;let{$cursor:o}=e.state.selection;return!!o&&T({editor:t,from:o.pos,to:o.pos,text:"\n",rules:n,plugin:i})}},isInputRules:!0});return i}({editor:e,rules:n}),...function(e){let{editor:t,rules:n}=e,i=null,o=!1,s=!1,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,l="undefined"!=typeof DragEvent?new DragEvent("drop"):null;return n.map(e=>new r.Sy({view(e){let t=t=>{var n;i=(null===(n=e.dom.parentElement)||void 0===n?void 0:n.contains(t.target))?e.dom.parentElement:null};return window.addEventListener("dragstart",t),{destroy(){window.removeEventListener("dragstart",t)}}},props:{handleDOMEvents:{drop:(e,t)=>(s=i===e.dom.parentElement,l=t,!1),paste:(e,t)=>{var n;let r=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");return a=t,o=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(n,r,i)=>{let c=n[0],h="paste"===c.getMeta("uiEvent")&&!o,p="drop"===c.getMeta("uiEvent")&&!s;if(!h&&!p)return;let f=r.doc.content.findDiffStart(i.doc.content),m=r.doc.content.findDiffEnd(i.doc.content);if("number"!=typeof f||!m||f===m.b)return;let g=i.tr;if(function(e){let{editor:t,state:n,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:c,can:d}=new u({editor:t,state:n}),h=[];return n.doc.nodesBetween(r,i,(e,t)=>{if(!e.isTextblock||e.type.spec.code)return;let u=Math.max(r,t),p=Math.min(i,t+e.content.size);A(e.textBetween(u-t,p-t,void 0,"\uFFFC"),o.find,s).forEach(e=>{if(void 0===e.index)return;let t=u+e.index+1,r=t+e[0].length,i={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},p=o.handler({state:n,range:i,match:e,commands:l,chain:c,can:d,pasteEvent:s,dropEvent:a});h.push(p)})}),h.every(e=>null!==e)}({editor:t,state:d({state:i,transaction:g}),from:Math.max(f-1,0),to:m.b-1,rule:e,pasteEvent:a,dropEvent:l})&&g.steps.length)return l="undefined"!=typeof DragEvent?new DragEvent("drop"):null,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,g}}))}({editor:e,rules:i}),...s]}get attributes(){return m(this.extensions)}get nodeViews(){let{editor:e}=this,{nodeExtensions:t}=f(this.extensions);return Object.fromEntries(t.filter(e=>!!p(e,"addNodeView")).map(t=>{let n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:t.storage,editor:e,type:g(t.name,this.schema)},i=p(t,"addNodeView",r);return i?[t.name,(r,o,s,a)=>{let l=y(r,n);return i()({editor:e,node:r,getPos:s,decorations:a,HTMLAttributes:l,extension:t})}]:[]}))}}function D(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function E(e,t){let n={...e};return D(e)&&D(t)&&Object.keys(t).forEach(r=>{D(t[r])&&r in e?n[r]=E(e[r],t[r]):Object.assign(n,{[r]:t[r]})}),n}class I{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_(p(this,"addOptions",{name:this.name}))),this.storage=_(p(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new I(e)}configure(e={}){let t=this.extend();return t.options=E(this.options,e),t.storage=_(p(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){let t=new I({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=_(p(t,"addOptions",{name:t.name})),t.storage=_(p(t,"addStorage",{name:t.name,options:t.options})),t}}function P(e,t,n){let{from:r,to:i}=t,{blockSeparator:o="\n\n",textSerializers:s={}}=n||{},a="",l=!0;return e.nodesBetween(r,i,(e,n,c,d)=>{var u;let h=null==s?void 0:s[e.type.name];h?(e.isBlock&&!l&&(a+=o,l=!0),c&&(a+=h({node:e,pos:n,parent:c,index:d,range:t}))):e.isText?(a+=null===(u=null==e?void 0:e.text)||void 0===u?void 0:u.slice(Math.max(r,n)-n,i-n),l=!1):e.isBlock&&!l&&(a+=o,l=!0)}),a}function R(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}let B=I.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new r.Sy({key:new r.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:i}=t,{ranges:o}=i,s=Math.min(...o.map(e=>e.$from.pos));return P(r,{from:s,to:Math.max(...o.map(e=>e.$to.pos))},{textSerializers:R(n)})}}})]}});function j(e,t,n={strict:!0}){let r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:M(t[r])?t[r].test(e[r]):t[r]===e[r])}function L(e,t,n={}){return e.find(e=>e.type===t&&j(e.attrs,n))}function V(e,t,n={}){if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if(e.parentOffset===r.offset&&0!==r.offset&&(r=e.parent.childBefore(e.parentOffset)),!r.node)return;let i=L([...r.node.marks],t,n);if(!i)return;let o=r.index,s=e.start()+r.offset,a=o+1,l=s+r.node.nodeSize;for(L([...r.node.marks],t,n);o>0&&i.isInSet(e.parent.child(o-1).marks);)o-=1,s-=e.parent.child(o).nodeSize;for(;a<e.parent.childCount&&function(e,t,n={}){return!!L(e,t,n)}([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function F(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function U(e){return e instanceof r.Bs}function q(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function W(e,t=null){if(!t)return null;let n=r.Y1.atStart(e),i=r.Y1.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return i;let o=n.from,s=i.to;return"all"===t?r.Bs.create(e,q(0,o,s),q(e.content.size,o,s)):r.Bs.create(e,q(t,o,s),q(t,o,s))}function H(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}let z=e=>{let t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){let r=t[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&z(r)}return e};function Z(e){let t=`<body>${e}</body>`;return z(new window.DOMParser().parseFromString(t,"text/html").body)}function G(e,t,n){if(n={slice:!0,parseOptions:{},...n},"object"==typeof e&&null!==e)try{if(Array.isArray(e)&&e.length>0)return s.HY.fromArray(e.map(e=>t.nodeFromJSON(e)));return t.nodeFromJSON(e)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),G("",t,n)}if("string"==typeof e){let r=s.aw.fromSchema(t);return n.slice?r.parseSlice(Z(e),n.parseOptions).content:r.parse(Z(e),n.parseOptions)}return G("",t,n)}let Y=e=>e.toString().startsWith("<");function K(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function J(e,t,n={}){let{from:r,to:i,empty:o}=e.selection,s=t?g(t,e.schema):null,a=[];e.doc.nodesBetween(r,i,(e,t)=>{if(e.isText)return;let n=Math.max(r,t),o=Math.min(i,t+e.nodeSize);a.push({node:e,from:n,to:o})});let l=i-r,c=a.filter(e=>!s||s.name===e.node.type.name).filter(e=>j(e.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((e,t)=>e+t.to-t.from,0)>=l}function $(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function Q(e,t){let n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}function X(e,t,n={}){return G(e,t,{slice:!1,parseOptions:n})}function ee(e,t){let n=F(t,e.schema),{from:r,to:i,empty:o}=e.selection,s=[];o?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,i,e=>{s.push(...e.marks)});let a=s.find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function et(e){return t=>(function(e,t){for(let n=e.depth;n>0;n-=1){let r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}})(t.$from,e)}function en(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{let r=e.find(e=>e.type===t&&e.name===n);return!!r&&r.attribute.keepOnSplit}))}function er(e,t,n={}){let{empty:r,ranges:i}=e.selection,o=t?F(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!o||o.name===e.type.name).find(e=>j(e.attrs,n,{strict:!1}));let s=0,a=[];if(i.forEach(({$from:t,$to:n})=>{let r=t.pos,i=n.pos;e.doc.nodesBetween(r,i,(e,t)=>{if(!e.isText&&!e.marks.length)return;let n=Math.max(r,t),o=Math.min(i,t+e.nodeSize);s+=o-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:o})))})}),0===s)return!1;let l=a.filter(e=>!o||o.name===e.mark.type.name).filter(e=>j(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!o||e.mark.type!==o&&e.mark.type.excludes(o)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=s}function ei(e,t){let{nodeExtensions:n}=f(t),r=n.find(t=>t.name===e);if(!r)return!1;let i={name:r.name,options:r.options,storage:r.storage},o=_(p(r,"group",i));return"string"==typeof o&&o.split(" ").includes("list")}function eo(e,t,n){let r=e.state.doc.content.size,i=q(t,0,r),o=q(n,0,r),s=e.coordsAtPos(i),a=e.coordsAtPos(o,-1),l=Math.min(s.top,a.top),c=Math.max(s.bottom,a.bottom),d=Math.min(s.left,a.left),u=Math.max(s.right,a.right),h={top:l,bottom:c,left:d,right:u,width:u-d,height:c-l,x:d,y:l};return{...h,toJSON:()=>h}}function es(e,t){let n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){let r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}let ea=(e,t)=>{let n=et(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;let i=e.doc.nodeAt(r);return!(n.node.type===(null==i?void 0:i.type)&&(0,a.Mn)(e.doc,n.pos))||(e.join(n.pos),!0)},el=(e,t)=>{let n=et(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;let i=e.doc.nodeAt(r);return!(n.node.type===(null==i?void 0:i.type)&&(0,a.Mn)(e.doc,r))||(e.join(r),!0)};var ec=Object.freeze({__proto__:null,blur:()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null===(n=null==window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())}),!0),clearContent:(e=!1)=>({commands:t})=>t.setContent("",e),clearNodes:()=>({state:e,tr:t,dispatch:n})=>{let{selection:r}=t,{ranges:i}=r;return!n||(i.forEach(({$from:n,$to:r})=>{e.doc.nodesBetween(n.pos,r.pos,(e,n)=>{if(e.type.isText)return;let{doc:r,mapping:i}=t,o=r.resolve(i.map(n)),s=r.resolve(i.map(n+e.nodeSize)),l=o.blockRange(s);if(!l)return;let c=(0,a.k9)(l);if(e.type.isTextblock){let{defaultType:e}=o.parent.contentMatchAt(o.index());t.setNodeMarkup(l.start,e)}(c||0===c)&&t.lift(l,c)})}),!0)},command:e=>t=>e(t),createParagraphNear:()=>({state:e,dispatch:t})=>(0,l.mD)(e,t),cut:(e,t)=>({editor:n,tr:i})=>{let{state:o}=n,s=o.doc.slice(e.from,e.to);i.deleteRange(e.from,e.to);let a=i.mapping.map(t);return i.insert(a,s.content),i.setSelection(new r.Bs(i.doc.resolve(a-1))),!0},deleteCurrentNode:()=>({tr:e,dispatch:t})=>{let{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;let i=e.selection.$anchor;for(let n=i.depth;n>0;n-=1)if(i.node(n).type===r.type){if(t){let t=i.before(n),r=i.after(n);e.delete(t,r).scrollIntoView()}return!0}return!1},deleteNode:e=>({tr:t,state:n,dispatch:r})=>{let i=g(e,n.schema),o=t.selection.$anchor;for(let e=o.depth;e>0;e-=1)if(o.node(e).type===i){if(r){let n=o.before(e),r=o.after(e);t.delete(n,r).scrollIntoView()}return!0}return!1},deleteRange:e=>({tr:t,dispatch:n})=>{let{from:r,to:i}=e;return n&&t.delete(r,i),!0},deleteSelection:()=>({state:e,dispatch:t})=>(0,l.NE)(e,t),enter:()=>({commands:e})=>e.keyboardShortcut("Enter"),exitCode:()=>({state:e,dispatch:t})=>(0,l.uo)(e,t),extendMarkRange:(e,t={})=>({tr:n,state:i,dispatch:o})=>{let s=F(e,i.schema),{doc:a,selection:l}=n,{$from:c,from:d,to:u}=l;if(o){let e=V(c,s,t);if(e&&e.from<=d&&e.to>=u){let t=r.Bs.create(a,e.from,e.to);n.setSelection(t)}}return!0},first:e=>t=>{let n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1},focus:(e=null,t={})=>({editor:n,view:r,tr:i,dispatch:o})=>{t={scrollIntoView:!0,...t};let s=()=>{H()&&r.dom.focus(),requestAnimationFrame(()=>{!n.isDestroyed&&(r.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(o&&null===e&&!U(n.state.selection))return s(),!0;let a=W(i.doc,e)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},forEach:(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r})),insertContent:(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),insertContentAt:(e,t,n)=>({tr:i,dispatch:o,editor:s})=>{if(o){n={parseOptions:{},updateSelection:!0,...n};let o=G(t,s.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if("<>"===o.toString())return!0;let{from:l,to:c}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},d=!0,u=!0;if((Y(o)?o:[o]).forEach(e=>{e.check(),d=!!d&&e.isText&&0===e.marks.length,u=!!u&&e.isBlock}),l===c&&u){let{parent:e}=i.doc.resolve(l);!e.isTextblock||e.type.spec.code||e.childCount||(l-=1,c+=1)}d?Array.isArray(t)?i.insertText(t.map(e=>e.text||"").join(""),l,c):"object"==typeof t&&t&&t.text?i.insertText(t.text,l,c):i.insertText(t,l,c):i.replaceWith(l,c,o),n.updateSelection&&function(e,t,n){let i=e.steps.length-1;if(i<t)return;let o=e.steps[i];if(!(o instanceof a.Pu||o instanceof a.FC))return;let s=e.mapping.maps[i],l=0;s.forEach((e,t,n,r)=>{0===l&&(l=r)}),e.setSelection(r.Y1.near(e.doc.resolve(l),-1))}(i,i.steps.length-1,0)}return!0},joinUp:()=>({state:e,dispatch:t})=>(0,l.MI)(e,t),joinDown:()=>({state:e,dispatch:t})=>(0,l.Ig)(e,t),joinBackward:()=>({state:e,dispatch:t})=>(0,l.al)(e,t),joinForward:()=>({state:e,dispatch:t})=>(0,l.Y_)(e,t),joinItemBackward:()=>({tr:e,state:t,dispatch:n})=>{try{let r=(0,a.GJ)(t.doc,t.selection.$from.pos,-1);if(null==r)return!1;return e.join(r,2),n&&n(e),!0}catch{return!1}},joinItemForward:()=>({state:e,dispatch:t,tr:n})=>{try{let r=(0,a.GJ)(e.doc,e.selection.$from.pos,1);if(null==r)return!1;return n.join(r,2),t&&t(n),!0}catch(e){return!1}},joinTextblockBackward:()=>({state:e,dispatch:t})=>(0,l.rr)(e,t),joinTextblockForward:()=>({state:e,dispatch:t})=>(0,l.cR)(e,t),keyboardShortcut:e=>({editor:t,view:n,tr:r,dispatch:i})=>{let o=(function(e){let t,n,r,i;let o=e.split(/-(?!$)/),s=o[o.length-1];"Space"===s&&(s=" ");for(let e=0;e<o.length-1;e+=1){let s=o[e];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))H()||K()?i=!0:n=!0;else throw Error(`Unrecognized modifier name: ${s}`)}return t&&(s=`Alt-${s}`),n&&(s=`Ctrl-${s}`),i&&(s=`Meta-${s}`),r&&(s=`Shift-${s}`),s})(e).split(/-(?!$)/),s=o.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,a))});return null==l||l.steps.forEach(e=>{let t=e.map(r.mapping);t&&i&&r.maybeStep(t)}),!0},lift:(e,t={})=>({state:n,dispatch:r})=>{let i=g(e,n.schema);return!!J(n,i,t)&&(0,l.xb)(n,r)},liftEmptyBlock:()=>({state:e,dispatch:t})=>(0,l.X0)(e,t),liftListItem:e=>({state:t,dispatch:n})=>{let r=g(e,t.schema);return(0,c.IB)(r)(t,n)},newlineInCode:()=>({state:e,dispatch:t})=>(0,l.QK)(e,t),resetAttributes:(e,t)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null,a=$("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(o=g(e,r.schema)),"mark"===a&&(s=F(e,r.schema)),i&&n.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,r)=>{o&&o===e.type&&n.setNodeMarkup(r,void 0,Q(e.attrs,t)),s&&e.marks.length&&e.marks.forEach(i=>{s===i.type&&n.addMark(r,r+e.nodeSize,s.create(Q(i.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),selectAll:()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),selectNodeBackward:()=>({state:e,dispatch:t})=>(0,l._M)(e,t),selectNodeForward:()=>({state:e,dispatch:t})=>(0,l.o)(e,t),selectParentNode:()=>({state:e,dispatch:t})=>(0,l.N0)(e,t),selectTextblockEnd:()=>({state:e,dispatch:t})=>(0,l.nw)(e,t),selectTextblockStart:()=>({state:e,dispatch:t})=>(0,l.U9)(e,t),setContent:(e,t=!1,n={})=>({tr:r,editor:i,dispatch:o})=>{let{doc:s}=r,a=X(e,i.schema,n);return o&&r.replaceWith(0,s.content.size,a).setMeta("preventUpdate",!t),!0},setMark:(e,t={})=>({tr:n,state:r,dispatch:i})=>{let{selection:o}=n,{empty:s,ranges:a}=o,l=F(e,r.schema);if(i){if(s){let e=ee(r,l);n.addStoredMark(l.create({...e,...t}))}else a.forEach(e=>{let i=e.$from.pos,o=e.$to.pos;r.doc.nodesBetween(i,o,(e,r)=>{let s=Math.max(r,i),a=Math.min(r+e.nodeSize,o);e.marks.find(e=>e.type===l)?e.marks.forEach(e=>{l===e.type&&n.addMark(s,a,l.create({...e.attrs,...t}))}):n.addMark(s,a,l.create(t))})})}return function(e,t,n){var r;let{selection:i}=t,o=null;if(U(i)&&(o=i.$cursor),o){let t=null!==(r=e.storedMarks)&&void 0!==r?r:o.marks();return!!n.isInSet(t)||!t.some(e=>e.type.excludes(n))}let{ranges:s}=i;return s.some(({$from:t,$to:r})=>{let i=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,r.pos,(e,t,r)=>{if(i)return!1;if(e.isInline){let t=!r||r.type.allowsMarkType(n),o=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));i=t&&o}return!i}),i})}(r,n,l)},setMeta:(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),setNode:(e,t={})=>({state:n,dispatch:r,chain:i})=>{let o=g(e,n.schema);return o.isTextblock?i().command(({commands:e})=>!!(0,l.uJ)(o,t)(n)||e.clearNodes()).command(({state:e})=>(0,l.uJ)(o,t)(e,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,i=q(e,0,n.content.size),o=r.qv.create(n,i);t.setSelection(o)}return!0},setTextSelection:e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,{from:i,to:o}="number"==typeof e?{from:e,to:e}:e,s=r.Bs.atStart(n).from,a=r.Bs.atEnd(n).to,l=q(i,s,a),c=q(o,s,a),d=r.Bs.create(n,l,c);t.setSelection(d)}return!0},sinkListItem:e=>({state:t,dispatch:n})=>{let r=g(e,t.schema);return(0,c.bw)(r)(t,n)},splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:i,editor:o})=>{let{selection:s,doc:l}=t,{$from:c,$to:d}=s,u=en(o.extensionManager.attributes,c.node().type.name,c.node().attrs);if(s instanceof r.qv&&s.node.isBlock)return!!(c.parentOffset&&(0,a.Ax)(l,c.pos))&&(i&&(e&&es(n,o.extensionManager.splittableMarks),t.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;if(i){let i=d.parentOffset===d.parent.content.size;s instanceof r.Bs&&t.deleteSelection();let l=0===c.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(c.node(-1).contentMatchAt(c.indexAfter(-1))),h=i&&l?[{type:l,attrs:u}]:void 0,p=(0,a.Ax)(t.doc,t.mapping.map(c.pos),1,h);if(!h&&!p&&(0,a.Ax)(t.doc,t.mapping.map(c.pos),1,l?[{type:l}]:void 0)&&(p=!0,h=l?[{type:l,attrs:u}]:void 0),p&&(t.split(t.mapping.map(c.pos),1,h),l&&!i&&!c.parentOffset&&c.parent.type!==l)){let e=t.mapping.map(c.before()),n=t.doc.resolve(e);c.node(-1).canReplaceWith(n.index(),n.index()+1,l)&&t.setNodeMarkup(t.mapping.map(c.before()),l)}e&&es(n,o.extensionManager.splittableMarks),t.scrollIntoView()}return!0},splitListItem:e=>({tr:t,state:n,dispatch:i,editor:o})=>{var l;let c=g(e,n.schema),{$from:d,$to:u}=n.selection,h=n.selection.node;if(h&&h.isBlock||d.depth<2||!d.sameParent(u))return!1;let p=d.node(-1);if(p.type!==c)return!1;let f=o.extensionManager.attributes;if(0===d.parent.content.size&&d.node(-1).childCount===d.indexAfter(-1)){if(2===d.depth||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let e=s.HY.empty,n=d.index(-1)?1:d.index(-2)?2:3;for(let t=d.depth-n;t>=d.depth-3;t-=1)e=s.HY.from(d.node(t).copy(e));let i=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,o=en(f,d.node().type.name,d.node().attrs),a=(null===(l=c.contentMatch.defaultType)||void 0===l?void 0:l.createAndFill(o))||void 0;e=e.append(s.HY.from(c.createAndFill(null,a)||void 0));let u=d.before(d.depth-(n-1));t.replace(u,d.after(-i),new s.p2(e,4-n,0));let h=-1;t.doc.nodesBetween(u,t.doc.content.size,(e,t)=>{if(h>-1)return!1;e.isTextblock&&0===e.content.size&&(h=t+1)}),h>-1&&t.setSelection(r.Bs.near(t.doc.resolve(h))),t.scrollIntoView()}return!0}let m=u.pos===d.end()?p.contentMatchAt(0).defaultType:null,v=en(f,p.type.name,p.attrs),y=en(f,d.node().type.name,d.node().attrs);t.delete(d.pos,u.pos);let b=m?[{type:c,attrs:v},{type:m,attrs:y}]:[{type:c,attrs:v}];if(!(0,a.Ax)(t.doc,d.pos,2))return!1;if(i){let{selection:e,storedMarks:r}=n,{splittableMarks:s}=o.extensionManager,a=r||e.$to.parentOffset&&e.$from.marks();if(t.split(d.pos,2,b).scrollIntoView(),!a||!i)return!0;let l=a.filter(e=>s.includes(e.type.name));t.ensureMarks(l)}return!0},toggleList:(e,t,n,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:c,can:d})=>{let{extensions:u,splittableMarks:h}=i.extensionManager,p=g(e,s.schema),f=g(t,s.schema),{selection:m,storedMarks:v}=s,{$from:y,$to:b}=m,_=y.blockRange(b),w=v||m.$to.parentOffset&&m.$from.marks();if(!_)return!1;let x=et(e=>ei(e.type.name,u))(m);if(_.depth>=1&&x&&_.depth-x.depth<=1){if(x.node.type===p)return c.liftListItem(f);if(ei(x.node.type.name,u)&&p.validContent(x.node.content)&&a)return l().command(()=>(o.setNodeMarkup(x.pos,p),!0)).command(()=>ea(o,p)).command(()=>el(o,p)).run()}return n&&w&&a?l().command(()=>{let e=d().wrapInList(p,r),t=w.filter(e=>h.includes(e.type.name));return o.ensureMarks(t),!!e||c.clearNodes()}).wrapInList(p,r).command(()=>ea(o,p)).command(()=>el(o,p)).run():l().command(()=>!!d().wrapInList(p,r)||c.clearNodes()).wrapInList(p,r).command(()=>ea(o,p)).command(()=>el(o,p)).run()},toggleMark:(e,t={},n={})=>({state:r,commands:i})=>{let{extendEmptyMarkRange:o=!1}=n,s=F(e,r.schema);return er(r,s,t)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,t)},toggleNode:(e,t,n={})=>({state:r,commands:i})=>{let o=g(e,r.schema),s=g(t,r.schema);return J(r,o,n)?i.setNode(s):i.setNode(o,n)},toggleWrap:(e,t={})=>({state:n,commands:r})=>{let i=g(e,n.schema);return J(n,i,t)?r.lift(i):r.wrapIn(i,t)},undoInputRule:()=>({state:e,dispatch:t})=>{let n=e.plugins;for(let r=0;r<n.length;r+=1){let i;let o=n[r];if(o.spec.isInputRules&&(i=o.getState(e))){if(t){let t=e.tr,n=i.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(i.text){let n=t.doc.resolve(i.from).marks();t.replaceWith(i.from,i.to,e.schema.text(i.text,n))}else t.delete(i.from,i.to)}return!0}}return!1},unsetAllMarks:()=>({tr:e,dispatch:t})=>{let{selection:n}=e,{empty:r,ranges:i}=n;return!!r||(t&&i.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0)},unsetMark:(e,t={})=>({tr:n,state:r,dispatch:i})=>{var o;let{extendEmptyMarkRange:s=!1}=t,{selection:a}=n,l=F(e,r.schema),{$from:c,empty:d,ranges:u}=a;if(!i)return!0;if(d&&s){let{from:e,to:t}=a,r=null===(o=c.marks().find(e=>e.type===l))||void 0===o?void 0:o.attrs,i=V(c,l,r);i&&(e=i.from,t=i.to),n.removeMark(e,t,l)}else u.forEach(e=>{n.removeMark(e.$from.pos,e.$to.pos,l)});return n.removeStoredMark(l),!0},updateAttributes:(e,t={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null,a=$("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(o=g(e,r.schema)),"mark"===a&&(s=F(e,r.schema)),i&&n.selection.ranges.forEach(e=>{let i=e.$from.pos,a=e.$to.pos;r.doc.nodesBetween(i,a,(e,r)=>{o&&o===e.type&&n.setNodeMarkup(r,void 0,{...e.attrs,...t}),s&&e.marks.length&&e.marks.forEach(o=>{if(s===o.type){let l=Math.max(r,i),c=Math.min(r+e.nodeSize,a);n.addMark(l,c,s.create({...o.attrs,...t}))}})})}),!0)},wrapIn:(e,t={})=>({state:n,dispatch:r})=>{let i=g(e,n.schema);return(0,l.ym)(i,t)(n,r)},wrapInList:(e,t={})=>({state:n,dispatch:r})=>{let i=g(e,n.schema);return(0,c.KI)(i,t)(n,r)}});let ed=I.create({name:"commands",addCommands:()=>({...ec})}),eu=I.create({name:"editable",addProseMirrorPlugins(){return[new r.Sy({key:new r.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}});var eh=Object.freeze({__proto__:null,ClipboardTextSerializer:B,Commands:ed,Editable:eu,FocusEvents:I.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new r.Sy({key:new r.H$("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;let r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;let r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Keymap:I.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{let{selection:n,doc:i}=t,{empty:o,$anchor:s}=n,{pos:a,parent:l}=s,c=s.parent.isTextblock?t.doc.resolve(a-1):s,d=c.parent.type.spec.isolating,u=s.pos-s.parentOffset,h=d&&1===c.parent.childCount?u===s.pos:r.Y1.atStart(i).from===a;return!!o&&!!h&&!!l.type.isTextblock&&!l.textContent.length&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},o={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return H()||K()?o:i},addProseMirrorPlugins(){return[new r.Sy({key:new r.H$("clearDocument"),appendTransaction:(e,t,n)=>{if(!(e.some(e=>e.docChanged)&&!t.doc.eq(n.doc)))return;let{empty:i,from:o,to:s}=t.selection,a=r.Y1.atStart(t.doc).from,l=r.Y1.atEnd(t.doc).to;if(i||!(o===a&&s===l)||0!==n.doc.textBetween(0,n.doc.content.size," "," ").length)return;let c=n.tr,h=d({state:n,transaction:c}),{commands:p}=new u({editor:this.editor,state:h});if(p.clearNodes(),c.steps.length)return c}})]}}),Tabindex:I.create({name:"tabindex",addProseMirrorPlugins(){return[new r.Sy({key:new r.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}})});class ep{constructor(e,t,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=r}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!==(e=this.actualDepth)&&void 0!==e?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size){console.error(`You can\u{2019}t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;let e=this.resolvedPos.start(this.resolvedPos.depth-1);return new ep(this.resolvedPos.doc.resolve(e),this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new ep(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new ep(e,this.editor)}get children(){let e=[];return this.node.content.forEach((t,n)=>{let r=t.isBlock&&!t.isTextblock,i=this.pos+n+(r?0:1),o=this.resolvedPos.doc.resolve(i);if(!r&&o.depth<=this.depth)return;let s=new ep(o,this.editor,r,r?t:null);r&&(s.actualDepth=this.depth+1),e.push(new ep(o,this.editor,r,r?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){let e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e){if(Object.keys(t).length>0){let e=r.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){let i=n[r];if(e[i]!==t[i])break}}else n=r}r=r.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let r=[];return this.isBlock||!this.children||0===this.children.length||this.children.forEach(i=>{if(i.node.type.name===e){if(Object.keys(t).length>0){let e=i.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){let i=n[r];if(e[i]!==t[i])return}}if(r.push(i),n)return}r=r.concat(i.querySelectorAll(e))}),r}setAttribute(e){let t=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,e).setTextSelection(t.from).run()}}let ef=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;class em extends h{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,n){let r=document.querySelector("style[data-tiptap-style]");if(null!==r)return r;let i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute("data-tiptap-style",""),i.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(i),i}(ef,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){let n=b(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});this.view.updateState(r)}unregisterPlugin(e){if(this.isDestroyed)return;let t="string"==typeof e?`${e}$`:e.key,n=this.state.reconfigure({plugins:this.state.plugins.filter(e=>!e.key.startsWith(t))});this.view.updateState(n)}createExtensionManager(){let e=[...this.options.enableCoreExtensions?Object.values(eh):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new N(e,this)}createCommandManager(){this.commandManager=new u({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){let e=X(this.options.content,this.schema,this.options.parseOptions),t=W(e,this.options.autofocus);this.view=new i.tk(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:r.yy.create({doc:e,selection:t||void 0})});let n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.createNodeViews(),this.prependClass(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)});return}let t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let r=e.getMeta("focus"),i=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!e.docChanged||e.getMeta("preventUpdate")||this.emit("update",{editor:this,transaction:e})}getAttributes(e){return function(e,t){let n=$("string"==typeof t?t:t.name,e.schema);return"node"===n?function(e,t){let n=g(t,e.schema),{from:r,to:i}=e.selection,o=[];e.doc.nodesBetween(r,i,e=>{o.push(e)});let s=o.reverse().find(e=>e.type.name===n.name);return s?{...s.attrs}:{}}(e,t):"mark"===n?ee(e,t):{}}(this.state,e)}isActive(e,t){let n="string"==typeof e?e:null,r="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return J(e,null,n)||er(e,null,n);let r=$(t,e.schema);return"node"===r?J(e,t,n):"mark"===r&&er(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return function(e,t){let n=s.PW.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return function(e,t){let n={from:0,to:e.content.size};return P(e,n,t)}(this.state.doc,{blockSeparator:t,textSerializers:{...R(this.schema),...n}})}get isEmpty(){return function(e){var t;let n=null===(t=e.type.createAndFill())||void 0===t?void 0:t.toJSON(),r=e.toJSON();return JSON.stringify(n)===JSON.stringify(r)}(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}$node(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelectorAll(e,t))||null}$pos(e){return new ep(this.state.doc.resolve(e),this)}get $doc(){return this.$pos(0)}}class eg{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_(p(this,"addOptions",{name:this.name}))),this.storage=_(p(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new eg(e)}configure(e={}){let t=this.extend();return t.options=E(this.options,e),t.storage=_(p(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){let t=new eg({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=_(p(t,"addOptions",{name:t.name})),t.storage=_(p(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){let{tr:n}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){let i=r.marks();if(!i.find(e=>(null==e?void 0:e.type.name)===t.name))return!1;let o=i.find(e=>(null==e?void 0:e.type.name)===t.name);return o&&n.removeStoredMark(o),n.insertText(" ",r.pos),e.view.dispatch(n),!0}return!1}}class ev{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_(p(this,"addOptions",{name:this.name}))),this.storage=_(p(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new ev(e)}configure(e={}){let t=this.extend();return t.options=E(this.options,e),t.storage=_(p(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){let t=new ev({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=_(p(t,"addOptions",{name:t.name})),t.storage=_(p(t,"addStorage",{name:t.name,options:t.options})),t}}class ey{constructor(e,t,n){this.isDragging=!1,this.component=e,this.editor=t.editor,this.options={stopEvent:null,ignoreMutation:null,...n},this.extension=t.extension,this.node=t.node,this.decorations=t.decorations,this.getPos=t.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(e){var t,n,i,o,s,a,l;let{view:c}=this.editor,d=e.target,u=3===d.nodeType?null===(t=d.parentElement)||void 0===t?void 0:t.closest("[data-drag-handle]"):d.closest("[data-drag-handle]");if(!this.dom||(null===(n=this.contentDOM)||void 0===n?void 0:n.contains(d))||!u)return;let h=0,p=0;if(this.dom!==u){let t=this.dom.getBoundingClientRect(),n=u.getBoundingClientRect(),r=null!==(i=e.offsetX)&&void 0!==i?i:null===(o=e.nativeEvent)||void 0===o?void 0:o.offsetX,l=null!==(s=e.offsetY)&&void 0!==s?s:null===(a=e.nativeEvent)||void 0===a?void 0:a.offsetY;h=n.x-t.x+r,p=n.y-t.y+l}null===(l=e.dataTransfer)||void 0===l||l.setDragImage(this.dom,h,p);let f=r.qv.create(c.state.doc,this.getPos()),m=c.state.tr.setSelection(f);c.dispatch(m)}stopEvent(e){var t;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:e});let n=e.target;if(!(this.dom.contains(n)&&!(null===(t=this.contentDOM)||void 0===t?void 0:t.contains(n))))return!1;let i=e.type.startsWith("drag"),o="drop"===e.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(n.tagName)||n.isContentEditable)&&!o&&!i)return!0;let{isEditable:s}=this.editor,{isDragging:a}=this,l=!!this.node.type.spec.draggable,c=r.qv.isSelectable(this.node),d="copy"===e.type,u="paste"===e.type,h="cut"===e.type,p="mousedown"===e.type;if(!l&&c&&i&&e.preventDefault(),l&&i&&!a)return e.preventDefault(),!1;if(l&&s&&!a&&p){let e=n.closest("[data-drag-handle]");e&&(this.dom===e||this.dom.contains(e))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!a&&!o&&!d&&!u&&!h&&(!p||!c)}ignoreMutation(e){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:e}):!!this.node.isLeaf||!!this.node.isAtom||!("selection"===e.type||this.dom.contains(e.target)&&"childList"===e.type&&(H()||"Android"===navigator.platform||/android/i.test(navigator.userAgent))&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(e=>e.isContentEditable))&&(this.contentDOM===e.target&&"attributes"===e.type||!this.contentDOM.contains(e.target)))}updateAttributes(e){this.editor.commands.command(({tr:t})=>{let n=this.getPos();return t.setNodeMarkup(n,void 0,{...this.node.attrs,...e}),!0})}deleteNode(){let e=this.getPos(),t=e+this.node.nodeSize;this.editor.commands.deleteRange({from:e,to:t})}}},743560:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(628225),i=n(156940);let o={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{o[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});let s={};o.transitional=function(e,t,n){function o(e,t){return"[Axios v"+r.q+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,r,a)=>{if(!1===e)throw new i.Z(o(r," has been removed"+(t?" in "+t:"")),i.Z.ERR_DEPRECATED);return t&&!s[r]&&(s[r]=!0,console.warn(o(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,a)}};let a={assertOptions:function(e,t,n){if("object"!=typeof e)throw new i.Z("options must be an object",i.Z.ERR_BAD_OPTION_VALUE);let r=Object.keys(e),o=r.length;for(;o-- >0;){let s=r[o],a=t[s];if(a){let t=e[s],n=void 0===t||a(t,s,e);if(!0!==n)throw new i.Z("option "+s+" must be "+n,i.Z.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new i.Z("Unknown option "+s,i.Z.ERR_BAD_OPTION)}},validators:o}},496418:function(e,t,n){"use strict";n.d(t,{EH:function(){return tv},p:function(){return tf},tk:function(){return tF}});var r=n(135611),i=n(881714),o=n(187457);let s=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},a=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},l=null,c=function(e,t,n){let r=l||(l=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},d=function(){l=null},u=function(e,t,n,r){return n&&(p(e,t,n,r,-1)||p(e,t,n,r,1))},h=/^(img|br|input|textarea|hr)$/i;function p(e,t,n,r,i){for(;;){if(e==n&&t==r)return!0;if(t==(i<0?0:f(e))){let n=e.parentNode;if(!n||1!=n.nodeType||m(e)||h.test(e.nodeName)||"false"==e.contentEditable)return!1;t=s(e)+(i<0?0:1),e=n}else{if(1!=e.nodeType||"false"==(e=e.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?f(e):0}}}function f(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function m(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}let g=function(e){return e.focusNode&&u(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function v(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}let y="undefined"!=typeof navigator?navigator:null,b="undefined"!=typeof document?document:null,_=y&&y.userAgent||"",w=/Edge\/(\d+)/.exec(_),x=/MSIE \d/.exec(_),S=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(_),k=!!(x||S||w),C=x?document.documentMode:S?+S[1]:w?+w[1]:0,M=!k&&/gecko\/(\d+)/i.test(_);M&&(/Firefox\/(\d+)/.exec(_)||[0,0])[1];let O=!k&&/Chrome\/(\d+)/.exec(_),T=!!O,A=O?+O[1]:0,N=!k&&!!y&&/Apple Computer/.test(y.vendor),D=N&&(/Mobile\/\w+/.test(_)||!!y&&y.maxTouchPoints>2),E=D||!!y&&/Mac/.test(y.platform),I=!!y&&/Win/.test(y.platform),P=/Android \d/.test(_),R=!!b&&"webkitFontSmoothing"in b.documentElement.style,B=R?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function j(e,t){return"number"==typeof e?e:e[t]}function L(e,t,n){let r=e.someProp("scrollThreshold")||0,i=e.someProp("scrollMargin")||5,o=e.dom.ownerDocument;for(let s=n||e.dom;s;s=a(s)){if(1!=s.nodeType)continue;let e=s,n=e==o.body,a=n?function(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}(o):function(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}(e),l=0,c=0;if(t.top<a.top+j(r,"top")?c=-(a.top-t.top+j(i,"top")):t.bottom>a.bottom-j(r,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+j(i,"top")-a.top:t.bottom-a.bottom+j(i,"bottom")),t.left<a.left+j(r,"left")?l=-(a.left-t.left+j(i,"left")):t.right>a.right-j(r,"right")&&(l=t.right-a.right+j(i,"right")),l||c){if(n)o.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let i=e.scrollLeft-n,o=e.scrollTop-r;t={left:t.left-i,top:t.top-o,right:t.right-i,bottom:t.bottom-o}}}if(n||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function V(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=a(r));return t}function F(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:i,left:o}=e[n];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=o&&(r.scrollLeft=o)}}let U=null;function q(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function W(e){return e.top<e.bottom||e.left<e.right}function H(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(W(e))return e}return Array.prototype.find.call(n,W)||e.getBoundingClientRect()}let z=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Z(e,t,n){let{node:r,offset:i,atom:o}=e.docView.domFromPos(t,n<0?-1:1),s=R||M;if(3==r.nodeType){if(s&&(z.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let e=H(c(r,i,i),n);if(M&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let t=H(c(r,i-1,i-1),-1);if(t.top==e.top){let n=H(c(r,i,i+1),-1);if(n.top!=e.top)return G(n,n.left<t.left)}}return e}{let e=i,t=i,o=n<0?1:-1;return n<0&&!i?(t++,o=-1):n>=0&&i==r.nodeValue.length?(e--,o=1):n<0?e--:t++,G(H(c(r,e,t),o),o<0)}}if(!e.state.doc.resolve(t-(o||0)).parent.inlineContent){if(null==o&&i&&(n<0||i==f(r))){let e=r.childNodes[i-1];if(1==e.nodeType)return Y(e.getBoundingClientRect(),!1)}if(null==o&&i<f(r)){let e=r.childNodes[i];if(1==e.nodeType)return Y(e.getBoundingClientRect(),!0)}return Y(r.getBoundingClientRect(),n>=0)}if(null==o&&i&&(n<0||i==f(r))){let e=r.childNodes[i-1],t=3==e.nodeType?c(e,f(e)-(s?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return G(H(t,1),!1)}if(null==o&&i<f(r)){let e=r.childNodes[i];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?c(e,0,s?0:1):1==e.nodeType?e:null:null;if(t)return G(H(t,-1),!0)}return G(H(3==r.nodeType?c(r):r,-n),n>=0)}function G(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function Y(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function K(e,t,n){let r=e.state,i=e.root.activeElement;r!=t&&e.updateState(t),i!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),i!=e.dom&&i&&i.focus()}}let J=/[\u0590-\u08ac]/,$=null,Q=null,X=!1;class ee{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){let r;if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}}if(e==this.dom&&this.contentDOM)r=t>s(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,r=e;r;r=r.parentNode){let i=this.getDesc(r),o;if(i&&(!t||i.node)){if(!n||!(o=i.nodeDOM)||(1==o.nodeType?o.contains(1==e.nodeType?e:e.parentNode):o==e))return i;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let e=t;e;e=e.parent)if(e==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let i=this.getDesc(r);if(i)return i.localPosFromDOM(e,t,n)}return -1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],i=n+r.size;if(n==e&&i!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(e<i)return r.descAt(e-n-r.border);n=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let t=0;n<this.children.length;n++){let i=this.children[n],o=t+i.size;if(o>e||i instanceof ea){r=e-t;break}t=o}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let e;n&&!(e=this.children[n-1]).size&&e instanceof et&&e.side>=0;n--);if(t<=0){let e,r=!0;for(;(e=n?this.children[n-1]:null)&&e.dom.parentNode!=this.contentDOM;n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?s(e.dom)+1:0}}{let e,r=!0;for(;(e=n<this.children.length?this.children[n]:null)&&e.dom.parentNode!=this.contentDOM;n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?s(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,i=-1;for(let o=n,a=0;;a++){let n=this.children[a],l=o+n.size;if(-1==r&&e<=l){let i=o+n.border;if(e>=i&&t<=l-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,i);e=o;for(let t=a;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=s(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(l>t||a==this.children.length-1)){t=l;for(let e=a+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){i=s(n.dom);break}t+=n.size}-1==i&&(i=this.contentDOM.childNodes.length);break}o=l}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,r=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let s=0,a=0;s<this.children.length;s++){let l=this.children[s],c=a+l.size;if(i>a&&o<c)return l.setSelection(e-a-l.border,t-a-l.border,n,r);a=c}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=n.getSelection(),d=!1;if((M||N)&&e==t){let{node:e,offset:t}=a;if(3==e.nodeType){if((d=!!(t&&"\n"==e.nodeValue[t-1]))&&t==e.nodeValue.length)for(let t=e,n;t;t=t.parentNode){if(n=t.nextSibling){"BR"==n.nodeName&&(a=l={node:n.parentNode,offset:s(n)+1});break}let e=t.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];d=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(M&&c.focusNode&&c.focusNode!=l.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||d&&N)&&u(a.node,a.offset,c.anchorNode,c.anchorOffset)&&u(l.node,l.offset,c.focusNode,c.focusOffset))return;let h=!1;if((c.extend||e==t)&&!d){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),h=!0}catch(e){}}if(!h){if(e>t){let e=a;a=l,l=e}let n=document.createRange();n.setEnd(l.node,l.offset),n.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let i=this.children[r],o=n+i.size;if(n==o?e<=o&&t>=n:e<o&&t>n){let r=n+i.border,s=o-i.border;if(e>=r&&t<=s){this.dirty=e==n||t==o?2:1,e==r&&t==s&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=3:i.markDirty(e-r,t-r);return}i.dirty=i.dom!=i.contentDOM||i.dom.parentNode!=this.contentDOM||i.children.length?3:2}n=o}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class et extends ee{constructor(e,t,n,r){let i,o=t.type.toDOM;if("function"==typeof o&&(o=o(n,()=>i?i.parent?i.parent.posBeforeChild(i):void 0:r)),!t.type.spec.raw){if(1!=o.nodeType){let e=document.createElement("span");e.appendChild(o),o=e}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class en extends ee{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class er extends ee{constructor(e,t,n,r){super(e,[],n,r),this.mark=t}static create(e,t,n,r){let o=r.nodeViews[t.type.name],s=o&&o(t,r,n);return s&&s.dom||(s=i.PW.renderSpec(document,t.type.spec.toDOM(t,n))),new er(e,t,s.dom,s.contentDOM||s.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=er.create(this.parent,this.mark,!0,n),i=this.children,o=this.size;t<o&&(i=ey(i,t,o,n)),e>0&&(i=ey(i,0,e,n));for(let e=0;e<i.length;e++)i[e].parent=r;return r.children=i,r}}class ei extends ee{constructor(e,t,n,r,i,o,s,a,l){super(e,[],i,o),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=s}static create(e,t,n,r,o,s){let a=o.nodeViews[t.type.name],l,c=a&&a(t,o,()=>l?l.parent?l.parent.posBeforeChild(l):void 0:s,n,r),d=c&&c.dom,u=c&&c.contentDOM;if(t.isText){if(d){if(3!=d.nodeType)throw RangeError("Text must be rendered as a DOM text node")}else d=document.createTextNode(t.text)}else d||({dom:d,contentDOM:u}=i.PW.renderSpec(document,t.type.spec.toDOM(t)));u||t.isText||"BR"==d.nodeName||(d.hasAttribute("contenteditable")||(d.contentEditable="false"),t.type.spec.draggable&&(d.draggable=!0));let h=d;return(d=ep(d,n,t),c)?l=new el(e,t,n,r,d,u||null,h,c,o,s+1):t.isText?new es(e,t,n,r,d,h,o):new ei(e,t,n,r,d,u||null,h,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM){if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>i.HY.empty)}else e.contentElement=this.contentDOM}else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&ef(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,r=t,o=e.composing?this.localCompositionInfo(e,t):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new eg(this,s&&s.node,e);(function(e,t,n,r){let i=t.locals(e),o=0;if(0==i.length){for(let n=0;n<e.childCount;n++){let s=e.child(n);r(s,i,t.forChild(o,s),n),o+=s.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let d,u,h,p;for(;s<i.length&&i[s].to==o;){let e=i[s++];e.widget&&(d?(u||(u=[d])).push(e):d=e)}if(d){if(u){u.sort(ev);for(let e=0;e<u.length;e++)n(u[e],c,!!l)}else n(d,c,!!l)}if(l)p=-1,h=l,l=null;else if(c<e.childCount)p=c,h=e.child(c++);else break;for(let e=0;e<a.length;e++)a[e].to<=o&&a.splice(e--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let f=o+h.nodeSize;if(h.isText){let e=f;s<i.length&&i[s].from<e&&(e=i[s].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<f&&(l=h.cut(e-o),h=h.cut(0,e-o),f=e,p=-1)}else for(;s<i.length&&i[s].to<f;)s++;let m=h.isInline&&!h.isLeaf?a.filter(e=>!e.inline):a.slice();r(h,m,t.forChild(o,h),p),o=f}})(this.node,this.innerDeco,(t,o,s)=>{t.spec.marks?l.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!s&&l.syncToMarks(o==this.node.childCount?i.vc.none:this.node.child(o).marks,n,e),l.placeWidget(t,e,r)},(t,i,s,c)=>{let d;l.syncToMarks(t.marks,n,e),l.findNodeMatch(t,i,s,c)||a&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(d=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(t,i,s,d,e)||l.updateNextNode(t,i,s,e,c,r)||l.addNode(t,i,s,e,r),r+=t.nodeSize}),l.syncToMarks([],n,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),function e(t,n,r){let i=t.firstChild,o=!1;for(let s=0;s<n.length;s++){let a=n[s],l=a.dom;if(l.parentNode==t){for(;l!=i;)i=em(i),o=!0;i=i.nextSibling}else o=!0,t.insertBefore(l,i);if(a instanceof er){let n=i?i.previousSibling:t.lastChild;e(a.contentDOM,a.children,r),i=n?n.nextSibling:t.firstChild}}for(;i;)i=em(i),o=!0;o&&r.trackWrites==t&&(r.trackWrites=null)}(this.contentDOM,this.children,e),D&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof r.Bs)||n<t||i>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(!this.node.inlineContent)return{node:o,pos:-1,text:""};{let e=o.nodeValue,r=function(e,t,n,r){for(let i=0,o=0;i<e.childCount&&o<=r;){let s=e.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<e.childCount;){let t=e.child(i++);if(o+=t.nodeSize,!t.isText)break;l+=t.text}if(o>=n){if(o>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let e=a<r?l.lastIndexOf(t,r-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return -1}(this.node.content,e,n-t,i-t);return r<0?null:{node:o,pos:r,text:e}}}protectLocalComposition(e,{node:t,pos:n,text:r}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new en(this,i,t,r);e.input.compositionNodes.push(o),this.children=ey(this.children,n,n+r.length,e,o)}update(e,t,n,r){return!!(3!=this.dirty&&e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(ef(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=eh(this.dom,this.nodeDOM,eu(this.outerDeco,this.node,t),eu(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function eo(e,t,n,r,i){ep(r,t,e);let o=new ei(void 0,e,t,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class es extends ei{constructor(e,t,n,r,i,o,s){super(e,t,n,r,i,null,o,s,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return!!(3!=this.dirty&&(0==this.dirty||this.inParent())&&e.sameMarkup(this.node))&&(this.updateOuterDeco(t),(0!=this.dirty||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),i=document.createTextNode(r.text);return new es(this.parent,r,this.outerDeco,this.innerDeco,i,i,n)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(0==e||t==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class ea extends ee{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class el extends ei{constructor(e,t,n,r,i,o,s,a,l,c){super(e,t,n,r,i,o,s,l,c),this.spec=a}update(e,t,n,r){if(3==this.dirty)return!1;if(this.spec.update){let i=this.spec.update(e,t,n);return i&&this.updateInner(e,t,n,r),i}return(!!this.contentDOM||!!e.isLeaf)&&super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}let ec=function(e){e&&(this.nodeName=e)};ec.prototype=Object.create(null);let ed=[new ec];function eu(e,t,n){if(0==e.length)return ed;let r=n?ed[0]:new ec,i=[r];for(let o=0;o<e.length;o++){let s=e[o].type.attrs;if(s)for(let e in s.nodeName&&i.push(r=new ec(s.nodeName)),s){let o=s[e];null!=o&&(n&&1==i.length&&i.push(r=new ec(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+o:"style"==e?r.style=(r.style?r.style+";":"")+o:"nodeName"!=e&&(r[e]=o))}}return i}function eh(e,t,n,r){if(n==ed&&r==ed)return t;let i=t;for(let t=0;t<r.length;t++){let o=r[t],s=n[t];if(t){let t;s&&s.nodeName==o.nodeName&&i!=e&&(t=i.parentNode)&&t.nodeName.toLowerCase()==o.nodeName||((t=document.createElement(o.nodeName)).pmIsDeco=!0,t.appendChild(i),s=ed[0]),i=t}(function(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==i.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<i.length;t++)-1==r.indexOf(i[t])&&e.classList.add(i[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=n.exec(t.style);)e.style.removeProperty(r[1])}n.style&&(e.style.cssText+=n.style)}})(i,s||ed[0],o)}return i}function ep(e,t,n){return eh(e,e,ed,eu(t,n,1!=e.nodeType))}function ef(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function em(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class eg{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,i=e.childCount,o=new Map,s=[];t:for(;i>0;){let a;for(;;)if(r){let e=n.children[r-1];if(e instanceof er)n=e,r=e.children.length;else{a=e,r--;break}}else if(n==t)break t;else r=n.parent.children.indexOf(n),n=n.parent;let l=a.node;if(l){if(l!=e.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;r<o&&(r==i-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<i;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[i])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=er.create(this.top,e[i],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,n,r){let i=-1,o;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,n))i=this.top.children.indexOf(o,this.index);else for(let r=this.index,o=Math.min(this.top.children.length,r+5);r<o;r++){let o=this.top.children[r];if(o.matchesNode(e,t,n)&&!this.preMatch.matched.has(o)){i=r;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,n,r,i){let o=this.top.children[r];return 3==o.dirty&&o.dom==o.contentDOM&&(o.dirty=2),!!o.update(e,t,n,i)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return -1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t){for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e}return -1}e=t}}updateNextNode(e,t,n,r,i,o){for(let s=this.index;s<this.top.children.length;s++){let a=this.top.children[s];if(a instanceof ei){let l=this.preMatch.matched.get(a);if(null!=l&&l!=i)return!1;let c=a.dom,d,u=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&ef(t,a.outerDeco));if(!u&&a.update(e,t,n,r))return this.destroyBetween(this.index,s),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!u&&(d=this.recreateWrapper(a,e,t,n,r,o)))return this.top.children[this.index]=d,d.contentDOM&&(d.dirty=2,d.updateChildren(r,o+1),d.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let s=ei.create(this.top,t,n,r,i,o);if(s.contentDOM)for(let t of(s.children=e.children,e.children=[],s.children))t.parent=s;return e.destroy(),s}addNode(e,t,n,r,i){let o=ei.create(this.top,e,t,n,r,i);o.contentDOM&&o.updateChildren(r,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let r=new et(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof er;)e=(t=e).children[t.children.length-1];(!e||!(e instanceof es)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((N||T)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new ea(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function ev(e,t){return e.type.side-t.type.side}function ey(e,t,n,r,i){let o=[];for(let s=0,a=0;s<e.length;s++){let l=e[s],c=a,d=a+=l.size;c>=n||d<=t?o.push(l):(c<t&&o.push(l.slice(0,t-c,r)),i&&(o.push(i),i=void 0),d>n&&o.push(l.slice(n-c,l.size,r)))}return o}function eb(e,t=null){let n=e.domSelectionRange(),i=e.state.doc;if(!n.focusNode)return null;let o=e.docView.nearestDesc(n.focusNode),a=o&&0==o.size,l=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(l<0)return null;let c=i.resolve(l),d,u;if(g(n)){for(d=c;o&&!o.node;)o=o.parent;let e=o.node;if(o&&e.isAtom&&r.qv.isSelectable(e)&&o.parent&&!(e.isInline&&function(e,t,n){for(let r=0==t,i=t==f(e);r||i;){if(e==n)return!0;let t=s(e);if(!(e=e.parentNode))return!1;r=r&&0==t,i=i&&t==f(e)}}(n.focusNode,n.focusOffset,o.dom))){let e=o.posBefore;u=new r.qv(l==e?c:i.resolve(e))}}else{let t=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(t<0)return null;d=i.resolve(t)}if(!u){let n="pointer"==t||e.state.selection.head<c.pos&&!a?1:-1;u=eT(e,d,c,n)}return u}function e_(e){return e.editable?e.hasFocus():eN(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function ew(e,t=!1){let n=e.state.selection;if(eM(e,n),e_(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&T){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&u(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper){let t,n,r,i;t=e.domSelection(),n=document.createRange(),(i="IMG"==(r=e.cursorWrapper.dom).nodeName)?n.setEnd(r.parentNode,s(r)+1):n.setEnd(r,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!i&&!e.state.selection.visible&&k&&C<=11&&(r.disabled=!0,r.disabled=!1)}else{let i,o,s,a,{anchor:l,head:c}=n,d,u;!ex||n instanceof r.Bs||(n.$from.parent.inlineContent||(d=eS(e,n.from)),n.empty||n.$from.parent.inlineContent||(u=eS(e,n.to))),e.docView.setSelection(l,c,e.root,t),ex&&(d&&eC(d),u&&eC(u)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&((i=e.dom.ownerDocument).removeEventListener("selectionchange",e.input.hideSelectionGuard),s=(o=e.domSelectionRange()).anchorNode,a=o.anchorOffset,i.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(o.anchorNode!=s||o.anchorOffset!=a)&&(i.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!e_(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}let ex=N||T&&A<63;function eS(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(N&&i&&"false"==i.contentEditable)return ek(i);if((!i||"false"==i.contentEditable)&&(!o||"false"==o.contentEditable)){if(i)return ek(i);if(o)return ek(o)}}function ek(e){return e.contentEditable="true",N&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function eC(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function eM(e,t){if(t instanceof r.qv){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(eO(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else eO(e)}function eO(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function eT(e,t,n,i){return e.someProp("createSelectionBetween",r=>r(e,t,n))||r.Bs.between(t,n,i)}function eA(e){return(!e.editable||!!e.hasFocus())&&eN(e)}function eN(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function eD(e,t){let{$anchor:n,$head:i}=e.selection,o=t>0?n.max(i):n.min(i),s=o.parent.inlineContent?o.depth?e.doc.resolve(t>0?o.after():o.before()):null:o;return s&&r.Y1.findFrom(s,t)}function eE(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function eI(e,t,n){let i=e.state.selection;if(i instanceof r.Bs){if(n.indexOf("s")>-1){let{$head:n}=i,o=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=e.state.doc.resolve(n.pos+o.nodeSize*(t<0?-1:1));return eE(e,new r.Bs(i.$anchor,s))}if(!i.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=eD(e.state,t);return!!n&&n instanceof r.qv&&eE(e,n)}if(!(E&&n.indexOf("m")>-1)){let n=i.$head,o=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter,s;if(!o||o.isText)return!1;let a=t<0?n.pos-o.nodeSize:n.pos;return!!(o.isAtom||(s=e.docView.descAt(a))&&!s.contentDOM)&&(r.qv.isSelectable(o)?eE(e,new r.qv(t<0?e.state.doc.resolve(n.pos-o.nodeSize):n)):!!R&&eE(e,new r.Bs(e.state.doc.resolve(t<0?a:a+o.nodeSize))))}}else{if(i instanceof r.qv&&i.node.isInline)return eE(e,new r.Bs(t>0?i.$to:i.$from));let n=eD(e.state,t);return!!n&&eE(e,n)}}function eP(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function eR(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function eB(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let i,o,a=!1;for(M&&1==n.nodeType&&r<eP(n)&&eR(n.childNodes[r],-1)&&(a=!0);;)if(r>0){if(1!=n.nodeType)break;{let e=n.childNodes[r-1];if(eR(e,-1))i=n,o=--r;else if(3==e.nodeType)r=(n=e).nodeValue.length;else break}}else if(ej(n))break;else{let t=n.previousSibling;for(;t&&eR(t,-1);)i=n.parentNode,o=s(t),t=t.previousSibling;if(t)r=eP(n=t);else{if((n=n.parentNode)==e.dom)break;r=0}}a?eL(e,n,r):i&&eL(e,i,o)}(e):function(e){let t,n,r=e.domSelectionRange(),i=r.focusNode,o=r.focusOffset;if(!i)return;let a=eP(i);for(;;)if(o<a){if(1!=i.nodeType)break;if(eR(i.childNodes[o],1))t=i,n=++o;else break}else if(ej(i))break;else{let r=i.nextSibling;for(;r&&eR(r,1);)t=r.parentNode,n=s(r)+1,r=r.nextSibling;if(r)o=0,a=eP(i=r);else{if((i=i.parentNode)==e.dom)break;o=a=0}}t&&eL(e,t,n)}(e)}function ej(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function eL(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!m(e);)t=s(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!m(e);)t=s(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(g(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:i}=e;setTimeout(()=>{e.state==i&&ew(e)},50)}function eV(e,t){let n=e.state.doc.resolve(t);if(!(T||I)&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),i=(n.top+n.bottom)/2;if(i>r.top&&i<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),i=(n.top+n.bottom)/2;if(i>r.top&&i<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function eF(e,t,n){let i=e.state.selection;if(i instanceof r.Bs&&!i.empty||n.indexOf("s")>-1||E&&n.indexOf("m")>-1)return!1;let{$from:o,$to:s}=i;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=eD(e.state,t);if(n&&n instanceof r.qv)return eE(e,n)}if(!o.parent.inlineContent){let n=t<0?o:s,a=i instanceof r.C1?r.Y1.near(n,t):r.Y1.findFrom(n,t);return!!a&&eE(e,a)}return!1}function eU(e,t){if(!(e.state.selection instanceof r.Bs))return!0;let{$head:n,$anchor:i,empty:o}=e.state.selection;if(!n.sameParent(i))return!0;if(!o)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let r=e.state.tr;return t<0?r.delete(n.pos-s.nodeSize,n.pos):r.delete(n.pos,n.pos+s.nodeSize),e.dispatch(r),!0}return!1}function eq(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function eW(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:o,openEnd:s}=t;for(;o>1&&s>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,s--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let a=e.someProp("clipboardSerializer")||i.PW.fromSchema(e.state.schema),l=e$(),c=l.createElement("div");c.appendChild(a.serializeFragment(r,{document:l}));let d=c.firstChild,u,h=0;for(;d&&1==d.nodeType&&(u=eK[d.nodeName.toLowerCase()]);){for(let e=u.length-1;e>=0;e--){let t=l.createElement(u[e]);for(;c.firstChild;)t.appendChild(c.firstChild);c.appendChild(t),h++}d=c.firstChild}return d&&1==d.nodeType&&d.setAttribute("data-pm-slice",`${o} ${s}${h?` -${h}`:""} ${JSON.stringify(n)}`),{dom:c,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function eH(e,t,n,r,o){let s,a,l=o.parent.type.spec.code;if(!n&&!t)return null;let c=t&&(r||l||!n);if(c){if(e.someProp("transformPastedText",n=>{t=n(t,l||r,e)}),l)return t?new i.p2(i.HY.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):i.p2.empty;let n=e.someProp("clipboardTextParser",n=>n(t,o,r,e));if(n)a=n;else{let n=o.marks(),{schema:r}=e.state,a=i.PW.fromSchema(r);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=s.appendChild(document.createElement("p"));e&&t.appendChild(a.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),s=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n=e$().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(e),i;if((i=r&&eK[r[1].toLowerCase()])&&(e=i.map(e=>"<"+e+">").join("")+e+i.map(e=>"</"+e+">").reverse().join("")),n.innerHTML=e,i)for(let e=0;e<i.length;e++)n=n.querySelector(i[e])||n;return n}(n),R&&function(e){let t=e.querySelectorAll(T?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(s);let d=s&&s.querySelector("[data-pm-slice]"),u=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let e=+u[3];e>0;e--){let e=s.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;s=e}if(a||(a=(e.someProp("clipboardParser")||e.someProp("domParser")||i.aw.fromSchema(e.state.schema)).parseSlice(s,{preserveWhitespace:!!(c||u),context:o,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||ez.test(e.parentNode.nodeName)?null:{ignore:!0}})),u)a=function(e,t){if(!e.size)return e;let n=e.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch(t){return e}let{content:o,openStart:s,openEnd:a}=e;for(let e=r.length-2;e>=0;e-=2){let t=n.nodes[r[e]];if(!t||t.hasRequiredAttrs())break;o=i.HY.from(t.create(r[e+1],o)),s++,a++}return new i.p2(o,s,a)}(eY(a,+u[1],+u[2]),u[4]);else if((a=i.p2.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r=t.node(n).contentMatchAt(t.index(n)),o,s=[];if(e.forEach(e=>{if(!s)return;let t=r.findWrapping(e.type),n;if(!t)return s=null;if(n=s.length&&o.length&&function e(t,n,r,o,s){if(s<t.length&&s<n.length&&t[s]==n[s]){let a=e(t,n,r,o.lastChild,s+1);if(a)return o.copy(o.content.replaceChild(o.childCount-1,a));if(o.contentMatchAt(o.childCount).matchType(s==t.length-1?r.type:t[s+1]))return o.copy(o.content.append(i.HY.from(eZ(r,t,s+1))))}}(t,o,e,s[s.length-1],0))s[s.length-1]=n;else{s.length&&(s[s.length-1]=function e(t,n){if(0==n)return t;let r=t.content.replaceChild(t.childCount-1,e(t.lastChild,n-1)),o=t.contentMatchAt(t.childCount).fillBefore(i.HY.empty,!0);return t.copy(r.append(o))}(s[s.length-1],o.length));let n=eZ(e,t);s.push(n),r=r.matchType(n.type),o=t}}),s)return i.HY.from(s)}return e}(a.content,o),!0)).openStart||a.openEnd){let e=0,t=0;for(let t=a.content.firstChild;e<a.openStart&&!t.type.spec.isolating;e++,t=t.firstChild);for(let e=a.content.lastChild;t<a.openEnd&&!e.type.spec.isolating;t++,e=e.lastChild);a=eY(a,e,t)}return e.someProp("transformPasted",t=>{a=t(a,e)}),a}let ez=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function eZ(e,t,n=0){for(let r=t.length-1;r>=n;r--)e=t[r].create(null,i.HY.from(e));return e}function eG(e,t,n,r,o,s){let a=t<0?e.firstChild:e.lastChild,l=a.content;return e.childCount>1&&(s=0),o<r-1&&(l=eG(l,t,n,r,o+1,s)),o>=n&&(l=t<0?a.contentMatchAt(0).fillBefore(l,s<=o).append(l):l.append(a.contentMatchAt(a.childCount).fillBefore(i.HY.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,a.copy(l))}function eY(e,t,n){return t<e.openStart&&(e=new i.p2(eG(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new i.p2(eG(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}let eK={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},eJ=null;function e$(){return eJ||(eJ=document.implementation.createHTMLDocument("title"))}let eQ={},eX={},e0={touchstart:!0,touchmove:!0};class e1{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function e2(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function e3(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>e5(e,t))})}function e5(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function e6(e){return{left:e.clientX,top:e.clientY}}function e4(e,t,n,r,i){if(-1==r)return!1;let o=e.state.doc.resolve(r);for(let r=o.depth+1;r>0;r--)if(e.someProp(t,t=>r>o.depth?t(e,n,o.nodeAfter,o.before(r),i,!0):t(e,n,o.node(r),o.before(r),i,!1)))return!0;return!1}function e9(e,t,n){e.focused||e.focus();let r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}eX.keydown=(e,t)=>{if(e.input.shiftKey=16==t.keyCode||t.shiftKey,!te(e,t)&&(e.input.lastKeyCode=t.keyCode,e.input.lastKeyCodeTime=Date.now(),!P||!T||13!=t.keyCode)){if(229!=t.keyCode&&e.domObserver.forceFlush(),!D||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",n=>n(e,t))||function(e,t){let n;let r=t.keyCode,i=(n="",t.ctrlKey&&(n+="c"),t.metaKey&&(n+="m"),t.altKey&&(n+="a"),t.shiftKey&&(n+="s"),n);if(8==r||E&&72==r&&"c"==i)return eU(e,-1)||eB(e,-1);if(46==r&&!t.shiftKey||E&&68==r&&"c"==i)return eU(e,1)||eB(e,1);if(13==r||27==r)return!0;if(37==r||E&&66==r&&"c"==i){let t=37==r?"ltr"==eV(e,e.state.selection.from)?-1:1:-1;return eI(e,t,i)||eB(e,t)}if(39==r||E&&70==r&&"c"==i){let t=39==r?"ltr"==eV(e,e.state.selection.from)?1:-1:1;return eI(e,t,i)||eB(e,t)}if(38==r||E&&80==r&&"c"==i)return eF(e,-1,i)||eB(e,-1);if(40==r||E&&78==r&&"c"==i)return function(e){if(!N||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;eq(e,n,"true"),setTimeout(()=>eq(e,n,"false"),20)}return!1}(e)||eF(e,1,i)||eB(e,1);else if(i==(E?"m":"c")&&(66==r||73==r||89==r||90==r))return!0;return!1}(e,t)?t.preventDefault():e2(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,v(13,"Enter"))),e.input.lastIOSEnter=0)},200)}}},eX.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},eX.keypress=(e,t)=>{if(te(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||E&&t.metaKey)return;if(e.someProp("handleKeyPress",n=>n(e,t))){t.preventDefault();return}let n=e.state.selection;if(!(n instanceof r.Bs)||!n.$from.sameParent(n.$to)){let r=String.fromCharCode(t.charCode);/[\r\n]/.test(r)||e.someProp("handleTextInput",t=>t(e,n.$from.pos,n.$to.pos,r))||e.dispatch(e.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}};let e7=E?"metaKey":"ctrlKey";eQ.mousedown=(e,t)=>{var n;let i,o;e.input.shiftKey=t.shiftKey;let s=ti(e),a=Date.now(),l="singleClick";a-e.input.lastClick.time<500&&(i=(n=e.input.lastClick).x-t.clientX)*i+(o=n.y-t.clientY)*o<100&&!t[e7]&&("singleClick"==e.input.lastClick.type?l="doubleClick":"doubleClick"==e.input.lastClick.type&&(l="tripleClick")),e.input.lastClick={time:a,x:t.clientX,y:t.clientY,type:l};let c=e.posAtCoords(e6(t));c&&("singleClick"==l?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new e8(e,c,t,!!s)):("doubleClick"==l?function(e,t,n,r){return e4(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}:function(e,t,n,i){return e4(e,"handleTripleClickOn",t,n,i)||e.someProp("handleTripleClick",n=>n(e,t,i))||function(e,t,n){if(0!=n.button)return!1;let i=e.state.doc;if(-1==t)return!!i.inlineContent&&(e9(e,r.Bs.create(i,0,i.content.size),"pointer"),!0);let o=i.resolve(t);for(let t=o.depth+1;t>0;t--){let n=t>o.depth?o.nodeAfter:o.node(t),s=o.before(t);if(n.inlineContent)e9(e,r.Bs.create(i,s+1,s+1+n.content.size),"pointer");else{if(!r.qv.isSelectable(n))continue;e9(e,r.qv.create(i,s),"pointer")}return!0}}(e,n,i)})(e,c.pos,c.inside,t)?t.preventDefault():e2(e,"pointer"))};class e8{constructor(e,t,n,i){let o,s;if(this.view=e,this.pos=t,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[e7],this.allowDefault=n.shiftKey,t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let n=e.state.doc.resolve(t.pos);o=n.parent,s=n.depth?n.before():0}let a=i?null:n.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&1==l.dom.nodeType?l.dom:null;let{selection:c}=e.state;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||c instanceof r.qv&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&M&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),e2(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ew(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;if(this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(e6(e))),this.updateAllowDefault(e),this.allowDefault||!t)e2(this.view,"pointer");else{var n,i,o,s;(n=this.view,i=t.pos,o=t.inside,s=this.selectNode,e4(n,"handleClickOn",i,o,e)||n.someProp("handleClick",t=>t(n,i,e))||(s?function(e,t){if(-1==t)return!1;let n=e.state.selection,i,o;n instanceof r.qv&&(i=n.node);let s=e.state.doc.resolve(t);for(let e=s.depth+1;e>0;e--){let t=e>s.depth?s.nodeAfter:s.node(e);if(r.qv.isSelectable(t)){o=i&&n.$from.depth>0&&e>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?s.before(n.$from.depth):s.before(e);break}}return null!=o&&(e9(e,r.qv.create(e.state.doc,o),"pointer"),!0)}(n,o):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),i=n.nodeAfter;return!!(i&&i.isAtom&&r.qv.isSelectable(i))&&(e9(e,new r.qv(n),"pointer"),!0)}(n,o)))?e.preventDefault():0==e.button&&(this.flushed||N&&this.mightDrag&&!this.mightDrag.node.isAtom||T&&!this.view.state.selection.visible&&2>=Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to)))?(e9(this.view,r.Y1.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):e2(this.view,"pointer")}}move(e){this.updateAllowDefault(e),e2(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function te(e,t){return!!e.composing||!!(N&&500>Math.abs(t.timeStamp-e.input.compositionEndedAt))&&(e.input.compositionEndedAt=-2e8,!0)}eQ.touchstart=e=>{e.input.lastTouch=Date.now(),ti(e),e2(e,"pointer")},eQ.touchmove=e=>{e.input.lastTouch=Date.now(),e2(e,"pointer")},eQ.contextmenu=e=>ti(e);let tt=P?5e3:-1;function tn(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>ti(e),t))}function tr(e){let t;for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=((t=document.createEvent("Event")).initEvent("event",!0,!0),t.timeStamp));e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function ti(e,t=!1){if(!P||!(e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),tr(e),t||e.docView&&e.docView.dirty){let t=eb(e);return t&&!t.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(t)):e.updateState(e.state),!0}return!1}}eX.compositionstart=eX.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),ti(e,!0),e.markCursor=null;else if(ti(e),M&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){e.domSelection().collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}tn(e,tt)},eX.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,tn(e,20))};let to=k&&C<15||D&&B<604;function ts(e,t,n,r,o){let s=eH(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,o,s||i.p2.empty)))return!0;if(!s)return!1;let a=0==s.openStart&&0==s.openEnd&&1==s.content.childCount?s.content.firstChild:null,l=a?e.state.tr.replaceSelectionWith(a,r):e.state.tr.replaceSelection(s);return e.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function ta(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}eQ.copy=eX.cut=(e,t)=>{let n=e.state.selection,r="cut"==t.type;if(n.empty)return;let i=to?null:t.clipboardData,{dom:o,text:s}=eW(e,n.content());i?(t.preventDefault(),i.clearData(),i.setData("text/html",o.innerHTML),i.setData("text/plain",s)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,o),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},eX.paste=(e,t)=>{if(e.composing&&!P)return;let n=to?null:t.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;n&&ts(e,ta(n),n.getData("text/html"),r,t)?t.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?ts(e,r.value,null,i,t):ts(e,r.textContent,r.innerHTML,i,t)},50)}(e,t)};class tl{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}let tc=E?"altKey":"ctrlKey";for(let e in eQ.dragstart=(e,t)=>{let n;let i=e.input.mouseDown;if(i&&i.done(),!t.dataTransfer)return;let o=e.state.selection,s=o.empty?null:e.posAtCoords(e6(t));if(s&&s.pos>=o.from&&s.pos<=(o instanceof r.qv?o.to-1:o.to));else if(i&&i.mightDrag)n=r.qv.create(e.state.doc,i.mightDrag.pos);else if(t.target&&1==t.target.nodeType){let i=e.docView.nearestDesc(t.target,!0);i&&i.node.type.spec.draggable&&i!=e.docView&&(n=r.qv.create(e.state.doc,i.posBefore))}let a=(n||e.state.selection).content(),{dom:l,text:c,slice:d}=eW(e,a);t.dataTransfer.clearData(),t.dataTransfer.setData(to?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",to||t.dataTransfer.setData("text/plain",c),e.dragging=new tl(d,!t[tc],n)},eQ.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},eX.dragover=eX.dragenter=(e,t)=>t.preventDefault(),eX.drop=(e,t)=>{let n=e.dragging;if(e.dragging=null,!t.dataTransfer)return;let s=e.posAtCoords(e6(t));if(!s)return;let a=e.state.doc.resolve(s.pos),l=n&&n.slice;l?e.someProp("transformPasted",t=>{l=t(l,e)}):l=eH(e,ta(t.dataTransfer),to?null:t.dataTransfer.getData("text/html"),!1,a);let c=!!(n&&!t[tc]);if(e.someProp("handleDrop",n=>n(e,t,l||i.p2.empty,c))){t.preventDefault();return}if(!l)return;t.preventDefault();let d=l?(0,o.nj)(e.state.doc,a.pos,l):a.pos;null==d&&(d=a.pos);let u=e.state.tr;if(c){let{node:e}=n;e?e.replace(u):u.deleteSelection()}let h=u.mapping.map(d),p=0==l.openStart&&0==l.openEnd&&1==l.content.childCount,f=u.doc;if(p?u.replaceRangeWith(h,h,l.content.firstChild):u.replaceRange(h,h,l),u.doc.eq(f))return;let m=u.doc.resolve(h);if(p&&r.qv.isSelectable(l.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(l.content.firstChild))u.setSelection(new r.qv(m));else{let t=u.mapping.map(d);u.mapping.maps[u.mapping.maps.length-1].forEach((e,n,r,i)=>t=i),u.setSelection(eT(e,m,u.doc.resolve(t)))}e.focus(),e.dispatch(u.setMeta("uiEvent","drop"))},eQ.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&ew(e)},20))},eQ.blur=(e,t)=>{e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},eQ.beforeinput=(e,t)=>{if(T&&P&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,v(8,"Backspace")))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}},eX)eQ[e]=eX[e];function td(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class tu{constructor(e,t){this.toDOM=e,this.spec=t||tg,this.side=this.spec.side||0}map(e,t,n,r){let{pos:i,deleted:o}=e.mapResult(t.from+r,this.side<0?-1:1);return o?null:new tf(i-n,i-n,this)}valid(){return!0}eq(e){return this==e||e instanceof tu&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&td(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class th{constructor(e,t){this.attrs=e,this.spec=t||tg}map(e,t,n,r){let i=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,o=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return i>=o?null:new tf(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof th&&td(this.attrs,e.attrs)&&td(this.spec,e.spec)}static is(e){return e.type instanceof th}destroy(){}}class tp{constructor(e,t){this.attrs=e,this.spec=t||tg}map(e,t,n,r){let i=e.mapResult(t.from+r,1);if(i.deleted)return null;let o=e.mapResult(t.to+r,-1);return o.deleted||o.pos<=i.pos?null:new tf(i.pos-n,o.pos-n,this)}valid(e,t){let{index:n,offset:r}=e.content.findIndex(t.from),i;return r==t.from&&!(i=e.child(n)).isText&&r+i.nodeSize==t.to}eq(e){return this==e||e instanceof tp&&td(this.attrs,e.attrs)&&td(this.spec,e.spec)}destroy(){}}class tf{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new tf(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new tf(e,e,new tu(t,n))}static inline(e,t,n,r){return new tf(e,t,new th(n,r))}static node(e,t,n,r){return new tf(e,t,new tp(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof th}get widget(){return this.type instanceof tu}}let tm=[],tg={};class tv{constructor(e,t){this.local=e.length?e:tm,this.children=t.length?t:tm}static create(e,t){return t.length?tS(t,e,0,tg):ty}find(e,t,n){let r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}findInner(e,t,n,r,i){for(let o=0;o<this.local.length;o++){let s=this.local[o];s.from<=t&&s.to>=e&&(!i||i(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let s=this.children[o]+1;this.children[o+2].findInner(e-s,t-s,n,r+s,i)}}map(e,t,n){return this==ty||0==e.maps.length?this:this.mapInner(e,t,0,0,n||tg)}mapInner(e,t,n,r,i){let o;for(let s=0;s<this.local.length;s++){let a=this.local[s].map(e,n,r);a&&a.type.valid(t,a)?(o||(o=[])).push(a):i.onRemove&&i.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,r,i,o,s){let a=e.slice();for(let e=0,t=o;e<n.maps.length;e++){let r=0;n.maps[e].forEach((e,n,i,o)=>{let s=o-i-(n-e);for(let i=0;i<a.length;i+=3){let o=a[i+1];if(o<0||e>o+t-r)continue;let l=a[i]+t-r;n>=l?a[i+1]=e<=l?-2:-1:e>=t&&s&&(a[i]+=s,a[i+1]+=s)}r+=s}),t=n.maps[e].map(t,-1)}let l=!1;for(let t=0;t<a.length;t+=3)if(a[t+1]<0){if(-2==a[t+1]){l=!0,a[t+1]=-1;continue}let c=n.map(e[t]+o),d=c-i;if(d<0||d>=r.content.size){l=!0;continue}let u=n.map(e[t+1]+o,-1)-i,{index:h,offset:p}=r.content.findIndex(d),f=r.maybeChild(h);if(f&&p==d&&p+f.nodeSize==u){let r=a[t+2].mapInner(n,f,c+1,e[t]+o+1,s);r!=ty?(a[t]=d,a[t+1]=u,a[t+2]=r):(a[t+1]=-2,l=!0)}else l=!0}if(l){let l=tS(function(e,t,n,r,i,o,s){for(let a=0;a<e.length;a+=3)-1==e[a+1]&&function e(t,o){for(let e=0;e<t.local.length;e++){let a=t.local[e].map(r,i,o);a?n.push(a):s.onRemove&&s.onRemove(t.local[e].spec)}for(let n=0;n<t.children.length;n+=3)e(t.children[n+2],t.children[n]+o+1)}(e[a+2],t[a]+o+1);return n}(a,e,t,n,i,o,s),r,0,s);t=l.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<l.children.length;e+=3){let n=l.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,l.children[e],l.children[e+1],l.children[e+2])}}return new tv(t.sort(tk),a)}(this.children,o||[],e,t,n,r,i):o?new tv(o.sort(tk),tm):ty}add(e,t){return t.length?this==ty?tv.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,i=0;e.forEach((e,o)=>{let s=o+n,a;if(a=tw(t,e,s)){for(r||(r=this.children.slice());i<r.length&&r[i]<o;)i+=3;r[i]==o?r[i+2]=r[i+2].addInner(e,a,s+1):r.splice(i,0,o,o+e.nodeSize,tS(a,e,s+1,tg)),i+=3}});let o=t_(i?tx(t):t,-n);for(let t=0;t<o.length;t++)o[t].type.valid(e,o[t])||o.splice(t--,1);return new tv(o.length?this.local.concat(o).sort(tk):this.local,r||this.children)}remove(e){return 0==e.length||this==ty?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let r=0;r<n.length;r+=3){let i;let o=n[r]+t,s=n[r+1]+t;for(let t=0,n;t<e.length;t++)(n=e[t])&&n.from>o&&n.to<s&&(e[t]=null,(i||(i=[])).push(n));if(!i)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(i,o+1);a!=ty?n[r+2]=a:(n.splice(r,3),r-=3)}if(r.length){for(let n=0,i;n<e.length;n++)if(i=e[n])for(let e=0;e<r.length;e++)r[e].eq(i,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1))}return n==this.children&&r==this.local?this:r.length||n.length?new tv(r,n):ty}forChild(e,t){let n,r;if(this==ty)return this;if(t.isLeaf)return tv.empty;for(let t=0;t<this.children.length;t+=3)if(this.children[t]>=e){this.children[t]==e&&(n=this.children[t+2]);break}let i=e+1,o=i+t.content.size;for(let e=0;e<this.local.length;e++){let t=this.local[e];if(t.from<o&&t.to>i&&t.type instanceof th){let e=Math.max(i,t.from)-i,n=Math.min(o,t.to)-i;e<n&&(r||(r=[])).push(t.copy(e,n))}}if(r){let e=new tv(r.sort(tk),tm);return n?new tb([e,n]):e}return n||ty}eq(e){if(this==e)return!0;if(!(e instanceof tv)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return tC(this.localsInner(e))}localsInner(e){if(this==ty)return tm;if(e.inlineContent||!this.local.some(th.is))return this.local;let t=[];for(let e=0;e<this.local.length;e++)this.local[e].type instanceof th||t.push(this.local[e]);return t}}tv.empty=new tv([],[]),tv.removeOverlap=tC;let ty=tv.empty;class tb{constructor(e){this.members=e}map(e,t){let n=this.members.map(n=>n.map(e,t,tg));return tb.from(n)}forChild(e,t){if(t.isLeaf)return tv.empty;let n=[];for(let r=0;r<this.members.length;r++){let i=this.members[r].forChild(e,t);i!=ty&&(i instanceof tb?n=n.concat(i.members):n.push(i))}return tb.from(n)}eq(e){if(!(e instanceof tb)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let i=this.members[r].localsInner(e);if(i.length){if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<i.length;e++)t.push(i[e])}else t=i}}return t?tC(n?t:t.sort(tk)):tm}static from(e){switch(e.length){case 0:return ty;case 1:return e[0];default:return new tb(e.every(e=>e instanceof tv)?e:e.reduce((e,t)=>e.concat(t instanceof tv?t:t.members),[]))}}}function t_(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let i=e[r];n.push(new tf(i.from+t,i.to+t,i.type))}return n}function tw(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,i=null;for(let t=0,o;t<e.length;t++)(o=e[t])&&o.from>n&&o.to<r&&((i||(i=[])).push(o),e[t]=null);return i}function tx(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function tS(e,t,n,r){let i=[],o=!1;t.forEach((t,s)=>{let a=tw(e,t,s+n);if(a){o=!0;let e=tS(a,t,n+s+1,r);e!=ty&&i.push(s,s+t.nodeSize,e)}});let s=t_(o?tx(e):e,-n).sort(tk);for(let e=0;e<s.length;e++)s[e].type.valid(t,s[e])||(r.onRemove&&r.onRemove(s[e].spec),s.splice(e--,1));return s.length||i.length?new tv(s,i):ty}function tk(e,t){return e.from-t.from||e.to-t.to}function tC(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let i=n+1;i<t.length;i++){let o=t[i];if(o.from==r.from){o.to!=r.to&&(t==e&&(t=e.slice()),t[i]=o.copy(o.from,r.to),tM(t,i+1,o.copy(r.to,o.to)));continue}o.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,o.from),tM(t,i,r.copy(o.from,r.to)));break}}return t}function tM(e,t,n){for(;t<e.length&&tk(n,e[t])>0;)t++;e.splice(t,0,n)}function tO(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=ty&&t.push(r)}),e.cursorWrapper&&t.push(tv.create(e.state.doc,[e.cursorWrapper.deco])),tb.from(t)}let tT={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},tA=k&&C<=11;class tN{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class tD{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new tN,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);k&&C<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),tA&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,tT)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(eA(this.view)){if(this.suppressingSelectionUpdates)return ew(this.view);if(k&&C<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&u(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,n;for(let n=e.focusNode;n;n=a(n))t.add(n);for(let r=e.anchorNode;r;r=a(r))if(t.has(r)){n=r;break}let r=n&&this.view.docView.nearestDesc(n);if(r&&r.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&eA(e)&&!this.ignoreSelectionChange(n),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let e=0;e<t.length;e++){let n=this.registerMutation(t[e],l);n&&(o=o<0?n.from:Math.min(n.from,o),s=s<0?n.to:Math.max(n.to,s),n.typeOver&&(a=!0))}if(M&&l.length){let t=l.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of t){let t=r.parentNode;t&&"LI"==t.nodeName&&(!n||function(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}(e,n)!=t)&&r.remove()}}}let c=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&g(n)&&(c=eb(e))&&c.eq(r.Y1.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,ew(e),this.currentSelection.set(n),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),tE.has(e)||(tE.set(e,null),-1===["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace))||(e.requiresGeckoHackNode=M,tI||(console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),tI=!0))),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||ew(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,i=e.nextSibling;if(k&&C<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:o}=e.addedNodes[t];(!n||0>Array.prototype.indexOf.call(e.addedNodes,n))&&(r=n),(!o||0>Array.prototype.indexOf.call(e.addedNodes,o))&&(i=o)}let o=r&&r.parentNode==e.target?s(r)+1:0,a=n.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?s(i):e.target.childNodes.length;return{from:a,to:n.localPosFromDOM(e.target,l,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let tE=new WeakMap,tI=!1;function tP(e,t){let n=t.startContainer,r=t.startOffset,i=t.endContainer,o=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return u(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function tR(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(N&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||N&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}let tB=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function tj(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:eT(e,t.resolve(n.anchor),t.resolve(n.head))}function tL(e,t,n){let r=e.depth,i=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,i++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,i++}return i}function tV(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class tF{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new e1,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(tz),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=tW(this),tq(this),this.nodeViews=tH(this),this.docView=eo(this.state.doc,tU(this),tO(this),this.dom,this),this.domObserver=new tD(this,(e,t,n,o)=>(function(e,t,n,o,s){let a,l,c,d,u,h,p=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=eb(e,t);if(n&&!e.state.selection.eq(n)){if(T&&P&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,v(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),p&&r.setMeta("composition",p),e.dispatch(r)}return}let f=e.state.doc.resolve(t),m=f.sharedDepth(n);t=f.before(m+1),n=e.state.doc.resolve(n).after(m+1);let y=e.state.selection,b=function(e,t,n){let r,{node:o,fromOffset:s,toOffset:a,from:l,to:c}=e.docView.parseRange(t,n),d=e.domSelectionRange(),u=d.anchorNode;if(u&&e.dom.contains(1==u.nodeType?u:u.parentNode)&&(r=[{node:u,offset:d.anchorOffset}],g(d)||r.push({node:d.focusNode,offset:d.focusOffset})),T&&8===e.input.lastKeyCode)for(let e=a;e>s;e--){let t=o.childNodes[e-1],n=t.pmViewDesc;if("BR"==t.nodeName&&!n){a=e;break}if(!n||n.size)break}let h=e.state.doc,p=e.someProp("domParser")||i.aw.fromSchema(e.state.schema),f=h.resolve(l),m=null,v=p.parse(o,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:s,to:a,preserveWhitespace:"pre"!=f.parent.type.whitespace||"full",findPositions:r,ruleFromNode:tR,context:f});if(r&&null!=r[0].pos){let e=r[0].pos,t=r[1]&&r[1].pos;null==t&&(t=e),m={anchor:e+l,head:t+l}}return{doc:v,sel:m,from:l,to:c}}(e,t,n),_=e.state.doc,w=_.slice(b.from,b.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(a=e.state.selection.to,l="end"):(a=e.state.selection.from,l="start"),e.input.lastKeyCode=null;let x=function(e,t,n,r,i){let o=e.findDiffStart(t,n);if(null==o)return null;let{a:s,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==i){let e=Math.max(0,o-Math.min(s,a));r-=s+e-o}if(s<o&&e.size<t.size){let e=r<=o&&r>=s?o-r:0;(o-=e)&&o<t.size&&tV(t.textBetween(o-1,o+1))&&(o+=e?1:-1),a=o+(a-s),s=o}else if(a<o){let t=r<=o&&r>=a?o-r:0;(o-=t)&&o<e.size&&tV(e.textBetween(o-1,o+1))&&(o+=t?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}(w.content,b.doc.content,b.from,a,l);if((D&&e.input.lastIOSEnter>Date.now()-225||P)&&s.some(e=>1==e.nodeType&&!tB.test(e.nodeName))&&(!x||x.endA>=x.endB)&&e.someProp("handleKeyDown",t=>t(e,v(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!x){if(o&&y instanceof r.Bs&&!y.empty&&y.$head.sameParent(y.$anchor)&&!e.composing&&!(b.sel&&b.sel.anchor!=b.sel.head))x={start:y.from,endA:y.to,endB:y.to};else{if(b.sel){let t=tj(e,e.state.doc,b.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);p&&n.setMeta("composition",p),e.dispatch(n)}}return}}e.input.domChangeCount++,e.state.selection.from<e.state.selection.to&&x.start==x.endB&&e.state.selection instanceof r.Bs&&(x.start>e.state.selection.from&&x.start<=e.state.selection.from+2&&e.state.selection.from>=b.from?x.start=e.state.selection.from:x.endA<e.state.selection.to&&x.endA>=e.state.selection.to-2&&e.state.selection.to<=b.to&&(x.endB+=e.state.selection.to-x.endA,x.endA=e.state.selection.to)),k&&C<=11&&x.endB==x.start+1&&x.endA==x.start&&x.start>b.from&&" \xa0"==b.doc.textBetween(x.start-b.from-1,x.start-b.from+1)&&(x.start--,x.endA--,x.endB--);let S=b.doc.resolveNoCache(x.start-b.from),M=b.doc.resolveNoCache(x.endB-b.from),O=_.resolve(x.start),A=S.sameParent(M)&&S.parent.inlineContent&&O.end()>=x.endA;if((D&&e.input.lastIOSEnter>Date.now()-225&&(!A||s.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!A&&S.pos<b.doc.content.size&&!S.sameParent(M)&&(c=r.Y1.findFrom(b.doc.resolve(S.pos+1),1,!0))&&c.head==M.pos)&&e.someProp("handleKeyDown",t=>t(e,v(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>x.start&&function(e,t,n,r,i){if(n-t<=i.pos-r.pos||tL(r,!0,!1)<i.pos)return!1;let o=e.resolve(t);if(!r.parent.isTextblock){let e=o.nodeAfter;return null!=e&&n==t+e.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=e.resolve(tL(o,!0,!0));return!(!s.parent.isTextblock||s.pos>n||tL(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(_,x.start,x.endA,S,M)&&e.someProp("handleKeyDown",t=>t(e,v(8,"Backspace")))){P&&T&&e.domObserver.suppressSelectionUpdates();return}T&&P&&x.endB==x.start&&(e.input.lastAndroidDelete=Date.now()),P&&!A&&S.start()!=M.start()&&0==M.parentOffset&&S.depth==M.depth&&b.sel&&b.sel.anchor==b.sel.head&&b.sel.head==x.endA&&(x.endB-=2,M=b.doc.resolveNoCache(x.endB-b.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,v(13,"Enter"))})},20));let N=x.start,E=x.endA;if(A){if(S.pos==M.pos)k&&C<=11&&0==S.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>ew(e),20)),d=e.state.tr.delete(N,E),u=_.resolve(x.start).marksAcross(_.resolve(x.endA));else if(x.endA==x.endB&&(h=function(e,t){let n=e.firstChild.marks,r=t.firstChild.marks,o=n,s=r,a,l,c;for(let e=0;e<r.length;e++)o=r[e].removeFromSet(o);for(let e=0;e<n.length;e++)s=n[e].removeFromSet(s);if(1==o.length&&0==s.length)l=o[0],a="add",c=e=>e.mark(l.addToSet(e.marks));else{if(0!=o.length||1!=s.length)return null;l=s[0],a="remove",c=e=>e.mark(l.removeFromSet(e.marks))}let d=[];for(let e=0;e<t.childCount;e++)d.push(c(t.child(e)));if(i.HY.from(d).eq(e))return{mark:l,type:a}}(S.parent.content.cut(S.parentOffset,M.parentOffset),O.parent.content.cut(O.parentOffset,x.endA-O.start()))))d=e.state.tr,"add"==h.type?d.addMark(N,E,h.mark):d.removeMark(N,E,h.mark);else if(S.parent.child(S.index()).isText&&S.index()==M.index()-(M.textOffset?0:1)){let t=S.parent.textBetween(S.parentOffset,M.parentOffset);if(e.someProp("handleTextInput",n=>n(e,N,E,t)))return;d=e.state.tr.insertText(t,N,E)}}if(d||(d=e.state.tr.replace(N,E,b.doc.slice(x.start-b.from,x.endB-b.from))),b.sel){let t=tj(e,d.doc,b.sel);t&&!(T&&P&&e.composing&&t.empty&&(x.start!=x.endB||e.input.lastAndroidDelete<Date.now()-100)&&(t.head==N||t.head==d.mapping.map(E)-1)||k&&t.empty&&t.head==N)&&d.setSelection(t)}u&&d.ensureMarks(u),p&&d.setMeta("composition",p),e.dispatch(d.scrollIntoView())})(this,e,t,n,o)),this.domObserver.start(),function(e){for(let t in eQ){let n=eQ[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||e5(e,t)||!e.editable&&t.type in eX||n(e,t)},e0[t]?{passive:!0}:void 0)}N&&e.dom.addEventListener("input",()=>null),e3(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;for(let t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&e3(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(tz),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let e in this._props)t[e]=this._props[e];for(let n in t.state=this.state,e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n,r,i;let o=this.state,a=!1,l=!1;e.storedMarks&&this.composing&&(tr(this),l=!0),this.state=e;let c=o.plugins!=e.plugins||this._props.plugins!=t.plugins;if(c||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=tH(this);(function(e,t){let n=0,r=0;for(let r in e){if(e[r]!=t[r])return!0;n++}for(let e in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,a=!0)}(c||t.handleDOMEvents!=this._props.handleDOMEvents)&&e3(this),this.editable=tW(this),tq(this);let d=tO(this),h=tU(this),p=o.plugins==e.plugins||o.doc.eq(e.doc)?e.scrollToSelection>o.scrollToSelection?"to selection":"preserve":"reset",g=a||!this.docView.matchesNode(e.doc,h,d);(g||!e.selection.eq(o.selection))&&(l=!0);let v="preserve"==p&&l&&null==this.dom.style.overflowAnchor&&function(e){let t,n,r=e.dom.getBoundingClientRect(),i=Math.max(0,r.top);for(let o=(r.left+r.right)/2,s=i+1;s<Math.min(innerHeight,r.bottom);s+=5){let r=e.root.elementFromPoint(o,s);if(!r||r==e.dom||!e.dom.contains(r))continue;let a=r.getBoundingClientRect();if(a.top>=i-20){t=r,n=a.top;break}}return{refDOM:t,refTop:n,stack:V(e.dom)}}(this);if(l){let t,n,l;this.domObserver.stop();let c=g&&(k||T)&&!this.composing&&!o.selection.empty&&!e.selection.empty&&(r=o.selection,i=e.selection,l=Math.min(r.$anchor.sharedDepth(r.head),i.$anchor.sharedDepth(i.head)),r.$anchor.start(l)!=i.$anchor.start(l));if(g){let t=T?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=function(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=f(e=e.childNodes[t-1])}else{if(!e.parentNode||m(e))return null;t=s(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||m(e))return null;t=s(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,i=e.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(!(!e||!e.isText(n.nodeValue)))return r}}return n||r}(this)),(a||!this.docView.update(e.doc,h,d,this))&&(this.docView.updateOuterDeco(h),this.docView.destroy(),this.docView=eo(e.doc,h,d,this.dom,this)),t&&!this.trackWrites&&(c=!0)}c||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&(t=this.docView.domFromPos(this.state.selection.anchor,0),n=this.domSelectionRange(),u(t.node,t.offset,n.anchorNode,n.anchorOffset)))?ew(this,c):(eM(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!o.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,o),"reset"==p?this.dom.scrollTop=0:"to selection"==p?this.scrollToSelection():v&&function({refDOM:e,refTop:t,stack:n}){let r=e?e.getBoundingClientRect().top:0;F(n,0==r?0:r-t)}(v)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof r.qv){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&L(this,t.getBoundingClientRect(),e)}else L(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(i=e)}this.dragging=new tl(e.slice,e.move,i<0?void 0:r.qv.create(this.state.doc,i))}someProp(e,t){let n=this._props&&this._props[e],r;if(null!=n&&(r=t?t(n):n))return r;for(let n=0;n<this.directPlugins.length;n++){let i=this.directPlugins[n].props[e];if(null!=i&&(r=t?t(i):i))return r}let i=this.state.plugins;if(i)for(let n=0;n<i.length;n++){let o=i[n].props[e];if(null!=o&&(r=t?t(o):o))return r}}hasFocus(){if(k){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(U)return e.focus(U);let t=V(e);e.focus(null==U?{get preventScroll(){return U={preventScroll:!0},!0}}:void 0),U||(U=!1,F(t,0))}(this.dom),ew(this),this.domObserver.start()}get root(){let e=this._root;if(null==e){for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return e||document}updateRoot(){this._root=null}posAtCoords(e){return function(e,t){var n;let r,i,o=e.dom.ownerDocument,s,l=0,d=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:r.offset}}catch(e){}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:r.startOffset}}}(o,t.left,t.top);d&&({node:s,offset:l}=d);let u=(e.root.elementFromPoint?e.root:o).elementFromPoint(t.left,t.top);if(!u||!e.dom.contains(1!=u.nodeType?u.parentNode:u)){let n=e.dom.getBoundingClientRect();if(!q(t,n)||!(u=function e(t,n,r){let i=t.childNodes.length;if(i&&r.top<r.bottom)for(let o=Math.max(0,Math.min(i-1,Math.floor(i*(n.top-r.top)/(r.bottom-r.top))-2)),s=o;;){let r=t.childNodes[s];if(1==r.nodeType){let t=r.getClientRects();for(let i=0;i<t.length;i++){let o=t[i];if(q(n,o))return e(r,n,o)}}if((s=(s+1)%i)==o)break}return t}(e.dom,t,n)))return null}if(N)for(let e=u;s&&e;e=a(e))e.draggable&&(s=void 0);if(u=(r=(n=u).parentNode)&&/^li$/i.test(r.nodeName)&&t.left<n.getBoundingClientRect().left?r:n,s){let n;if(M&&1==s.nodeType&&(l=Math.min(l,s.childNodes.length))<s.childNodes.length){let e=s.childNodes[l],n;"IMG"==e.nodeName&&(n=e.getBoundingClientRect()).right<=t.left&&n.bottom>t.top&&l++}R&&l&&1==s.nodeType&&1==(n=s.childNodes[l-1]).nodeType&&"false"==n.contentEditable&&n.getBoundingClientRect().top>=t.top&&l--,s==e.dom&&l==s.childNodes.length-1&&1==s.lastChild.nodeType&&t.top>s.lastChild.getBoundingClientRect().bottom?i=e.state.doc.content.size:(0==l||1!=s.nodeType||"BR"!=s.childNodes[l-1].nodeName)&&(i=function(e,t,n,r){let i=-1;for(let n=t,o=!1;n!=e.dom;){let t=e.docView.nearestDesc(n,!0);if(!t)return null;if(1==t.dom.nodeType&&(t.node.isBlock&&t.parent||!t.contentDOM)){let e=t.dom.getBoundingClientRect();if(t.node.isBlock&&t.parent&&(!o&&e.left>r.left||e.top>r.top?i=t.posBefore:(!o&&e.right<r.left||e.bottom<r.top)&&(i=t.posAfter),o=!0),!t.contentDOM&&i<0&&!t.node.isText)return(t.node.isBlock?r.top<(e.top+e.bottom)/2:r.left<(e.left+e.right)/2)?t.posBefore:t.posAfter}n=t.dom.parentNode}return i>-1?i:e.docView.posFromDOM(t,n,-1)}(e,s,l,t))}null==i&&(i=function(e,t,n){let{node:r,offset:i}=function e(t,n){let r,i,o,s=2e8,a,l=0,d=n.top,u=n.top;for(let e=t.firstChild,h=0;e;e=e.nextSibling,h++){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=c(e).getClientRects()}for(let c=0;c<t.length;c++){let p=t[c];if(p.top<=d&&p.bottom>=u){d=Math.max(p.bottom,d),u=Math.min(p.top,u);let t=p.left>n.left?p.left-n.left:p.right<n.left?n.left-p.right:0;if(t<s){o=e,s=t,a=t&&3==o.nodeType?{left:p.right<n.left?p.right:p.left,top:n.top}:n,1==e.nodeType&&t&&(l=h+(n.left>=(p.left+p.right)/2?1:0));continue}}else p.top>n.top&&!r&&p.left<=n.left&&p.right>=n.left&&(r=e,i={left:Math.max(p.left,Math.min(p.right,n.left)),top:p.top});!o&&(n.left>=p.right&&n.top>=p.top||n.left>=p.left&&n.top>=p.bottom)&&(l=h+1)}}return(!o&&r&&(o=r,a=i,s=0),o&&3==o.nodeType)?function(e,t){let n=e.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(e,i+1),r.setStart(e,i);let n=H(r,1);if(n.top!=n.bottom&&q(t,n))return{node:e,offset:i+(t.left>=(n.left+n.right)/2?1:0)}}return{node:e,offset:0}}(o,a):!o||s&&1==o.nodeType?{node:t,offset:l}:e(o,a)}(t,n),o=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();o=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,i,o)}(e,u,t));let h=e.docView.nearestDesc(u,!0);return{pos:i,inside:h?h.posAtStart-h.border:-1}}(this,e)}coordsAtPos(e,t=1){return Z(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let r=this.docView.posFromDOM(e,t,n);if(null==r)throw RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){var n,r,i;let o,s;return n=this,r=t||this.state,i=e,$==r&&Q==i?X:($=r,Q=i,X="up"==i||"down"==i?(o=r.selection,s="up"==i?o.$from:o.$to,K(n,r,()=>{let{node:e}=n.docView.domFromPos(s.pos,"up"==i?-1:1);for(;;){let t=n.docView.nearestDesc(e,!0);if(!t)break;if(t.node.isBlock){e=t.contentDOM||t.dom;break}e=t.dom.parentNode}let t=Z(n,s.pos,1);for(let n=e.firstChild;n;n=n.nextSibling){let e;if(1==n.nodeType)e=n.getClientRects();else{if(3!=n.nodeType)continue;e=c(n,0,n.nodeValue.length).getClientRects()}for(let n=0;n<e.length;n++){let r=e[n];if(r.bottom>r.top+1&&("up"==i?t.top-r.top>(r.bottom-t.top)*2:r.bottom-t.bottom>(t.bottom-r.top)*2))return!1}}return!0})):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=i==r.parent.content.size,s=e.domSelection();return J.test(r.parent.textContent)&&s.modify?K(e,t,()=>{let{focusNode:t,focusOffset:i,anchorNode:o,anchorOffset:a}=e.domSelectionRange(),l=s.caretBidiLevel;s.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:d,focusOffset:u}=e.domSelectionRange(),h=d&&!c.contains(1==d.nodeType?d:d.parentNode)||t==d&&i==u;try{s.collapse(o,a),t&&(t!=o||i!=a)&&s.extend&&s.extend(t,i)}catch(e){}return null!=l&&(s.caretBidiLevel=l),h}):"left"==n||"backward"==n?!i:o}(n,r,i))}pasteHTML(e,t){return ts(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return ts(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(function(e){for(let t in e.domObserver.stop(),e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],tO(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,d())}get isDestroyed(){return null==this.docView}dispatchEvent(e){e5(this,e)||!eQ[e.type]||!this.editable&&e.type in eX||eQ[e.type](this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return N&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){let n;if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return tP(e,n)}function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?tP(e,n):null}(this,e)||e}domSelection(){return this.root.getSelection()}}function tU(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[tf.node(0,e.state.doc.content.size,t)]}function tq(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:tf.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function tW(e){return!e.someProp("editable",t=>!1===t(e.state))}function tH(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function tz(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw RangeError("Plugins passed directly to the view must not have a state component")}},305971:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});var r=n(218571),i=n(21228),o=n(783222);function s(){let e=(0,o.N)();return(0,r.useMemo)(()=>new i.p(e),[e])}},125336:function(e,t,n){"use strict";n.d(t,{H:function(){return a}});var r=n(218571),i=n(396356),o=n(783222),s=n(489805);function a(e){let t=(0,o.N)(),n=(0,r.useMemo)(()=>new i.Y(t.getBackend()),[t]);return(0,s.L)(()=>(n.dropTargetOptions=e||null,n.reconnect(),()=>n.disconnectDropTarget()),[e]),n}},842934:function(e,t,n){"use strict";n.d(t,{x:function(){return s}});var r=n(457425),i=n(789801),o=n(250664);class s{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){let e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){let e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)):this.lastConnectedDragSource=e),t}reconnectDragPreview(e=!1){let t=this.dragPreview,n=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(n&&this.disconnectDragPreview(),this.handlerId){if(!t){this.lastConnectedDragPreview=t;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!(0,r.w)(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!(0,r.w)(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=(0,o.p)({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,(0,i.d)(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,(0,i.d)(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}}}]);