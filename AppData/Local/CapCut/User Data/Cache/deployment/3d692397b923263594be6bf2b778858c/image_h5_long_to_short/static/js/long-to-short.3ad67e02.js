/*!
* @ies/filter-xss v3.1.4
* (c) 2024
*/var e,t;e=this,t=function(e){"use strict";var t=function(){return(t=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function r(e,t,r){if(r||2==arguments.length)for(var i,o=0,a=t.length;o<a;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}var i=/[^a-zA-Z0-9\\_:.-]/gim,o=/</g,a=/>/g,n=/&#([a-zA-Z0-9]*);?/gim,s=/&quot;/g,l=/&colon;?/gim,c=/&newline;?/gim,u=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,d=/u\s*r\s*l\s*\(.*/gi,p=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,v=/"/g,g=function(e){return e.replace(o,"&lt;").replace(a,"&gt;")},h={indexOf:function(e,t){var r,i;for(r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return -1},forEach:function(e,t,r){var i,o;for(i=0,o=e.length;i<o;i++)t.call(r,e[i],i,e)},some:function(e,t,r){var i,o;for(i=0,o=e.length;i<o;i++)if(t.call(r,e[i],i,e))return!0;return!1},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},includes:function(e,t){if("string"==typeof e)return -1!==e.indexOf(t);for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1},uniq:function(e){for(var t={},r=[],i=0;i<e.length;i++)t[e[i]]||(r.push(e[i]),t[e[i]]=!0);return r},from:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},keys:function(e){var t=[];for(var r in e)t.push(r);return t}};function f(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]?e.substr(1,e.length-2):e}function _(e){var t,r,i,o,a,n,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",u=0;for(e=function(e){e=e.replace(/rn/g,"n");for(var t="",r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t+=String.fromCharCode(i):i>127&&i<2048?t+=String.fromCharCode(i>>6|192)+String.fromCharCode(63&i|128):t+=String.fromCharCode(i>>12|224)+String.fromCharCode(i>>6&63|128)+String.fromCharCode(63&i|128)}return t}(e);u<e.length;)o=(t=e.charCodeAt(u++))>>2,a=(3&t)<<4|(r=e.charCodeAt(u++))>>4,n=(15&r)<<2|(i=e.charCodeAt(u++))>>6,s=63&i,isNaN(r)?n=s=64:isNaN(i)&&(s=64),c=c+l.charAt(o)+l.charAt(a)+l.charAt(n)+l.charAt(s);return c}function m(e){var t,r,i,o,a,n,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");c<e.length;)t=s.indexOf(e.charAt(c++))<<2|(o=s.indexOf(e.charAt(c++)))>>4,r=(15&o)<<4|(a=s.indexOf(e.charAt(c++)))>>2,i=(3&a)<<6|(n=s.indexOf(e.charAt(c++))),l+=String.fromCharCode(t),64!==a&&(l+=String.fromCharCode(r)),64!==n&&(l+=String.fromCharCode(i));return function(e){for(var t="",r=0,i=0,o=0;r<e.length;)(i=e.charCodeAt(r))<128?(t+=String.fromCharCode(i),r++):i>191&&i<224?(t+=String.fromCharCode((31&i)<<6|63&e.charCodeAt(r+1)),r+=2):(t+=String.fromCharCode((15&i)<<12|(63&e.charCodeAt(r+1))<<6|63&e.charCodeAt(r+2)),r+=3);return t}(l)}function y(e,t,r){var i="",o=0,a=!1,n=!1,s=0,l=e.length,c="",u="";e:for(s=0;s<l;s++){var d=e.charAt(s);if(!1===a){if("<"===d){a=s;continue}}else if(!1===n){if("<"===d){i+=r(e.slice(o,s)),a=s,o=s;continue}if(">"===d||s===l-1){i+=r(e.slice(o,a)),c=function(e){var t,r=h.spaceIndex(e);return t=-1===r?e.slice(1,-1):e.slice(1,r+1),"/"===(t=h.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}(u=e.slice(a,s+1)),i+=t(a,i.length,c,u,"</"===u.slice(0,2)),o=s+1,a=!1;continue}if('"'===d||"'"===d)for(var p=1,v=e.charAt(s-p);""===v.trim()||"="===v;){if("="===v){n=d;continue e}v=e.charAt(s-++p)}}else if(d===n){n=!1;continue}}return o<l&&(i+=r(e.substr(o))),i}function b(e,t){var r=0,o=0,a=[],n=!1,s=e.length;function l(e,r){if(!((e=(e=h.trim(e)).replace(i,"").toLowerCase()).length<1)){var o=t(e,r||"");o&&a.push(o)}}for(var c=0;c<s;c++){var u=e.charAt(c),d=void 0;if(!1!==n||"="!==u){if(!1===n||c!==o){if(/\s|\n|\t/.test(u)){if(e=e.replace(/\s|\n|\t/g," "),!1===n){if(-1===(d=function(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"="===r?t:-1}return -1}(e,c))){l(h.trim(e.slice(r,c))),n=!1,r=c+1;continue}c=d-1;continue}if(-1===(d=function(e,t){for(;t>0;t--){var r=e[t];if(" "!==r)return"="===r?t:-1}return -1}(e,c-1))){l(n,f(h.trim(e.slice(r,c)))),n=!1,r=c+1;continue}}}else{if(-1===(d=e.indexOf(u,c+1)))break;l(n,h.trim(e.slice(o+1,d))),n=!1,r=(c=d)+1}}else n=e.slice(r,c),r=c+1,o='"'===e.charAt(r)||"'"===e.charAt(r)?r:function(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"'"===r||'"'===r?t:-1}return -1}(e,c+1)}return r<e.length&&(!1===n?l(e.slice(r)):l(n,f(h.trim(e.slice(r))))),h.trim(a.join(" "))}function w(e,t,r){var i,o;if(r=function(e){for(var t="",r=0,i=e.length;r<i;r++)t+=32>e.charCodeAt(r)?" ":e.charAt(r);return h.trim(t)}(r.replace(s,'"').replace(n,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))}).replace(l,":").replace(c," ")),"href"===t||"src"===t){if("#"===(r=h.trim(r)))return"#";if("http://"!==r.substr(0,7)&&"https://"!==r.substr(0,8)&&"mailto:"!==r.substr(0,7)&&"tel:"!==r.substr(0,4)&&"data:image/"!==r.substr(0,11)&&"ftp://"!==r.substr(0,6)&&"./"!==r.substr(0,2)&&"../"!==r.substr(0,3)&&"#"!==r[0]&&"/"!==r[0])return""}else if("background"===t){if(u.lastIndex=0,u.test(r))return""}else if("style"===t&&(p.lastIndex=0,p.test(r)||(d.lastIndex=0,d.test(r)&&(u.lastIndex=0,u.test(r)))))return"";return r=g(r.replace(v,"&quot;"))}var S=function(e){return"string"==typeof e?e.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},T=function(){function e(e){var t=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{});t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=function(){return""}),t.whiteList={},t.onTag=function(){},t.onTagAttr=function(){},t.onIgnoreTag=function(){},t.onIgnoreTagAttr=function(){},t.safeAttrValue=w,t.escapeHtml=g,this.options=Object.assign(t,e)}return e.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t,r,i,o,a,n=this.options,s=n.whiteList,l=n.onTag,c=n.onIgnoreTag,u=n.onTagAttr,d=n.onIgnoreTagAttr,p=n.safeAttrValue,v=n.escapeHtml;n.stripBlankChar&&(e=e.split("").filter(function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)}).join("")),n.allowCommentTag||(e=function(e){for(var t="",r=0;r<e.length;){var i=e.indexOf("<!--",r);if(-1===i){t+=e.slice(r);break}t+=e.slice(r,i);var o=e.indexOf("-->",i);if(-1===o)break;r=o+3}return t}(e));var g=!1;n.stripIgnoreTagBody&&(t=n.stripIgnoreTagBody,"function"!=typeof(r=c)&&(r=function(){}),i=!Array.isArray(t),o=[],a=!1,c=(g={onIgnoreTag:function(e,n,s){if(i||-1!==h.indexOf(t,e)){if(s.isClosing){var l=s.position+10;return o.push([!1!==a?a:s.position,l]),a=!1,"[/removed]"}return a||(a=s.position),"[removed]"}return r(e,n,s)},remove:function(e){var t="",r=0;return h.forEach(o,function(i){t+=e.slice(r,i[0]),r=i[1]}),t+=e.slice(r)}}).onIgnoreTag);var f=y(e,function(e,t,r,i,o){var a={sourcePosition:e,position:t,isClosing:o,isWhite:Object.prototype.hasOwnProperty.call(s,r)},n=l(r,i,a);if(null!=n)return n;if(a.isWhite){if(a.isClosing)return"</".concat(r,">");var g=function(e){var t=h.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=h.trim(e.slice(t+1,-1)))[e.length-1];return r&&(e=h.trim(e.slice(0,-1))),{html:e,closing:r}}(i),f=s[r],_=b(g.html,function(e,t){var i=-1!==h.indexOf(f,e),o=u(r,e,t,i);return null==o?i?(t=p(r,e,t,null))?"".concat(e,'="').concat(t,'"'):e:null==(o=d(r,e,t,i))?void 0:o:o});return i="<".concat(r),_&&(i+=" ".concat(_)),g.closing&&(i+=" /"),i+=">"}return null==(n=c(r,i,a))?v(i):n},v);return g&&(f=g.remove(f)),f},e}(),k=!0,I=function(e){return e&&e.Math==Math&&e},P=I("object"==typeof globalThis&&globalThis)||I("object"==typeof window&&window)||I("object"==typeof self&&self)||I("object"==typeof global&&global)||Function("return this")();try{!0!==(k=!!(k=String(k)).startsWith("<%=")||JSON.parse(k))&&"true"!==k||(P=Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")())}catch(e){console.log(e)}var C=new(function(){function e(){var e=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.isSetedConfig=!1,this.getSlardarBid=function(){var t,r,i="cc_web_smart_tools";if(!h.includes(i,"bid"))return i;if(e.config&&e.config.bid)return e.config.bid;var o=P;if(o&&o._xssBid)return o._xssBid;if(o&&o.slardar&&"function"==typeof o.slardar.config){var a=(o.slardar.config()||{}).bid;if(a)return a}if(o&&o.Slardar&&"function"==typeof o.Slardar.config){var n=(o.Slardar.config()||{}).bid;if(n)return n}return(null===(r=null===(t=null==o?void 0:o.Slardar)||void 0===t?void 0:t._baseParams)||void 0===r?void 0:r.bid)||"argus"},this.getConfigRegion=function(){var t,r="maliva";return h.includes(r,"region")?e.config&&e.config.region?e.config.region:((null===(t=null==P?void 0:P.gfdatav1)||void 0===t?void 0:t.region)||"cn").toLowerCase():r},this.gerReportUrl=function(){var t={cn:m("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:m("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:m("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:m("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:m("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:m("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:m("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[e.getConfigRegion()];if(t)return t+e.getSlardarBid()}}return e.prototype.setConfig=function(e){this.isSetedConfig||(this.config=e)},e.prototype.upload=function(){var e=this;if(!this.config||!this.config.isCloseSSRReport||(null==P?void 0:P.document)){var t=!1;t=String(!1);try{if((!0===(t=!t.startsWith("<%=")&&JSON.parse(t))||"true"===t)&&!(null==P?void 0:P.document))return}catch(e){console.log(e)}var r=this.gerReportUrl();!this.lock&&r&&0!==this.batchData.length&&(this.lock=!0,setTimeout(function(){var t=e.batchData.slice(0,100);e.batchData=e.batchData.slice(100),P.fetch(r,{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).catch(function(e){console.warn("xss defense report error",e)}),e.lock=!1,e.upload()},this.timeout))}},e.prototype.generateKey=function(e){return e.collectKey?[e.collectMode,e.collectKey].join("___"):""},e.prototype.push=function(e){this.batchData.push(e),this.upload()},e.prototype.report=function(e){var t=this.generateKey(e);if(P.fetch&&e.collectKey){var r="SSR";void 0!==P&&void 0!==P.location&&void 0!==P.location.href&&(r=P.location.href),e.documentUrl=r;var i={age:Math.floor(Date.now()),type:"xss",url:r,body:e,"user-agent":""};i.url="".concat(t,"___").concat(e.documentUrl),"SSR"===r&&(i.url="SSR___".concat(i.url),i.body.ssr=!0),this.push(i)}},e}());function M(e,t){return C.setConfig(t),new T(t).process(e)}var j=function(e){return -1===(e=(e=(e=(e=e.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?e.trim().toLowerCase():e.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,function(e,t,r,i){return String.fromCharCode(t?parseInt(r,16):parseInt(i))}).replace(/(\t|\n|\r)/g,"").toLowerCase()};function O(e,t){if(void 0===e&&(e=""),"string"!=typeof e)return!0;if(e=j(e),h.includes(e,"base64")&&!function(e){if(""===e||""===e.trim())return!0;try{return!h.includes(e,"data:text/html;base64")}catch(e){return!0}}(e))return t&&t("data:text/html;base64"),!1;var r=["expression(","behavior:","view-source:"];if(h.some(r,function(t){return -1!==e.indexOf(t)}))return h.forEach(r,function(r){-1!==e.indexOf(r)&&t&&t(r)}),!1;var i=["data:application","data:javascript","data:text/html","data:texthtml"];if(h.some(i,function(t){return -1!==e.indexOf(t)}))return h.forEach(i,function(r){-1!==e.indexOf(r)&&t&&t(r)}),!1;if(e.indexOf("javascript:")>0)return t&&t("javascript:"),!1;if(/^javascript:/i.test(e)){var o=e.slice(11).replace(/\s/g,"").trim();return!!h.some(["void","void(0)","void0","false","undefined",";"],function(e){return e===o})||(t&&t("javascript:"),!1)}return!0}var L=function(e,t){var r,i,o=!1;if(o=String(!1),"string"!=typeof e||(i=Number(1e4),void 0!==r&&(i=r),"NaN"!==i.toString()&&-1!==i&&e.length>=i)||O(e,t))return e;try{if(!0===(o=!o.startsWith("<%=")&&JSON.parse(o))||"true"===o){var a=new URL(e);return a.origin+a.pathname}}catch(e){return console.log(e),"#"}return"#"};function x(e,t,i){if(void 0===e&&(e=""),void 0===t&&(t=[]),"string"!=typeof e)return!0;if(!O(e=j(e)))return!1;var o,a={url:(o=e.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[])[0],scheme:o[1],slash:o[2],host:o[3],port:o[4],path:o[5],query:o[6],hash:o[7]},n=a.scheme,s=a.host;return i?!!i(e):!(!n||!s)&&(!h.includes(["http","https","file"],n)||("object"==typeof window&&window&&(t=r(r([],t,!0),[location.host],!1)),h.some(t,function(e){return!!(e instanceof RegExp&&e.test(s))||e===s})))}var E=function(e,t){for(var r={},i=0,o=h.keys(e);i<o.length;i++){var a=o[i];Array.isArray(e[a])?r[a]=h.from(e[a]):r[a]=E({},e[a])}for(var n=0,s=h.keys(t);n<s.length;n++)(a=s[n])in e?Array.isArray(e[a])?r[a]=e[a].concat(t[a]):r[a]=E(e[a],t[a]):Array.isArray(t[a])?r[a]=h.from(t[a]):r[a]=E({},t[a]);return r},R={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"],specialContentClosure:["title","style","noscript","textarea","xmp","iframe","noembed","noframes"]};try{var D={};D.blackAttrRegExps&&(D.blackAttrRegExps=D.blackAttrRegExps.map(function(e){return new RegExp(e.toString().slice(1,e.toString().length-1))}));var F="merge";h.includes(F,"override")&&(R=D),h.includes(F,"merge")&&(R=E(R,D))}catch(e){console.log(e)}var A={mode:"black",whiteList:{},blackConfig:R,collect:null,initCollect:function(){A.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var e=function(e){for(var t=0,r=function(r){Array.isArray(e[r])?0===e[r].length?delete e[r]:(e[r]=h.from(h.uniq(e[r])),t+=e[r].length):0===h.keys(e[r]).length?delete e[r]:h.keys(e[r]).forEach(function(i){e[r][i]=h.from(h.uniq(e[r][i])),t+=e[r][i].length})},i=0,o=h.keys(e);i<o.length;i++)r(o[i]);return{count:t,ret:e}}(A.collect),t=e.count,r=e.ret;return A.collect=null,{collectKey:0===t?null:JSON.stringify(r),collectMode:"black"}},onIgnoreTag:function(e,t){var r;if(!h.includes(R.blackTags,e))return y(t,function(e,t,r,i,o){if(-1!==r.indexOf("/"))return g(i);if(o)return"</".concat(r,">");var a=function(e){var t,r=(t=/\s|\n|\t/.exec(e))?t.index:-1;if(-1===r)return{html:"",closing:"/"===e[e.length-2]};var i="/"===(e=e.slice(r+1,-1).trim())[e.length-1];return i&&(e=e.slice(0,-1).trim()),{html:e,closing:i}}(i),n=b(a.html,function(e,t){var i,o,a=0;if(R.blackList[r]&&h.includes(R.blackList[r],e)&&(A.collect.blackList[r]=A.collect.blackList[r]||[],A.collect.blackList[r].push(e),a++),R.blackAttrRegExps.length&&R.blackAttrRegExps.some(function(t){return t.test(e)})&&h.forEach(R.blackAttrRegExps,function(t){t.test(e)&&(A.collect.blackAttrRegExps.push("".concat(t.toString(),"->").concat(e)),a++)}),R.blackAttrs.length&&h.includes(R.blackAttrs,e)&&(R.blackAttrs.push(e),a++),!a){if(Array.isArray(R.specialContentClosure)&&"string"==typeof t&&R.specialContentClosure.find(function(e){return t.includes("</".concat(e,">"))})){null===(i=A.collect)||void 0===i||i.filterAttrs.push(e);var n="#";return t?"".concat(e,"='").concat(n,"'"):e}return R.filterList&&R.filterList[r]&&h.includes(R.filterList[r],e)?((n=L(t,function(e){var t;null===(t=A.collect)||void 0===t||t.filterProtocol.push(e)}))!==t&&(A.collect.filterList[r]=A.collect.filterList[r]||[],A.collect.filterList[r].push(e)),t?"".concat(e,"='").concat(n,"'"):e):R.filterAttrs&&h.includes(R.filterAttrs,e)?((n=L(t,function(e){var t;null===(t=A.collect)||void 0===t||t.filterProtocol.push(e)}))!==t&&(null===(o=A.collect)||void 0===o||o.filterAttrs.push(e)),t?"".concat(e,"='").concat(n,"'"):e):t?"".concat(e,"='").concat(t,"'"):e}});return i="<".concat(r),n&&(i+=" ".concat(n)),a.closing&&(i+=" /"),i+=">"},g);null===(r=A.collect)||void 0===r||r.blackTags.push(e)}},N=function(e){var t=e.reportOnly,r=void 0===t||t,i=e.block;return r&&"all"===r?"report":("string"==typeof r&&("true"===r&&(r=!0),"false"===r&&(r=!1)),i?"enforce":r?"report":"enforce")},U=function(e){return function(r,i,o){if(!r||"string"!=typeof r)return r;var a=i;e===M&&(a=A).initCollect();var n=e(r,a);if(S(n)===S(r))return r;if(!o)return n;var s=o.logType,l=N(o),c=a.removeCollect();return C.report(t(t({type:s,disposition:l},c),{sourceText:_(r.replace(/'/g,'"')),filterText:_(n.replace(/'/g,'"'))})),"enforce"===l?n:r}},V=U(function(e,t){return void 0===t&&(t={}),t&&t.whiteList||(t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new T(t).process(e)}),W=U(M),B=function(e,t,r){var i=[],o=L(e,function(e){i.push(e)});if(o===e)return e;i=h.from(h.uniq(i));var a=t||r||{};if(!a)return o;var n=a.logType,s=N(r);return C.report({type:n,disposition:s,collectKey:i.join("___"),collectData:JSON.stringify(i),collectMode:"black",sourceText:_(e),filterText:_(o)}),"enforce"===s?o:e},Z=P._xssProject||{},G=P.xssNamespace||{},H="3.1.4",z={FilterXSS:T,version:H,webpackPluginVersion:"3.1.9",reportOnly:"all",filterXSS:V,_filterXSS:W,filterUrl:B,BlackConfig:A,project:Z,setProjectName:function(e){Z[e]=this,P._xssProjectName=e}};G["lvweb/smart-tools"]=z,P.xssNamespace=G,P.Math&&!P.Math.xssNamespace&&(P.Math.xssNamespace=G),Z[H]=z,P.globalThis=P,P.getFilterXss=function(){return void 0!==this._xssProjectName?this._xssProject[this._xssProjectName]:z},P.xss=z,P.isSafeUrl=x,P.isSafeDomain=x,P.isSafeProtocol=O,P._xssProject=Z,P._xssProjectName&&(Z[P._xssProjectName]=z);var q=z.setProjectName.bind(z);e.BlackConfig=A,e.FilterXSS=T,e._filterXSS=W,e.filterUrl=B,e.filterXSS=V,e.isSafeDomain=x,e.isSafeProtocol=O,e.isSafeUrl=x,e.project=Z,e.setProjectName=q,e.setXssNamespace=function(e){var t=e.appId,r=e.bid,i=e.region,o=e.isCloseSSRReport;G[t]=z,A.bid=r,A.region=i,A.enabled=!0,A.isCloseSSRReport=o},e.xssNamespace=G,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xss={}),(self.webpackChunksmart_tools=self.webpackChunksmart_tools||[]).push([["8500"],{674838:function(e,t,r){"use strict";r.d(t,{P:function(){return i}});var i=(0,r(218571).createContext)({prefixCls:"arco"})},293793:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(218571);t.default=function(e){var t=(0,i.useRef)();return t.current=(0,i.useMemo)(function(){return e},[e]),(0,i.useCallback)(function(){var e=t.current;return e&&e.apply(void 0,arguments)},[t])}},652447:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){var e;function t(e){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.value=!1,this.value=!!e}return e=[{key:"setTrue",value:function(){this.value=!0}},{key:"setFalse",value:function(){this.value=!1}},{key:"isFalse",value:function(){return!1===this.value}},{key:"isTrue",value:function(){return!0===this.value}}],function(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,e),t}();t.default=r},771942:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(164287)),o=n(r(816247));r(547684);var a=n(r(652447));function n(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){var i;i=r[t],t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var d=function(){var e;function t(e,r,n,s){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.options=void 0,this.requestFn=void 0,this.debounceFn=void 0,this.throttleFn=void 0,this.pollingTimer=void 0,this.count=0,this.unmountedFlag=new a.default,this.that=this,this.onChangeState=void 0,this.state={loading:!1,run:this.run.bind(this.that),data:void 0,error:void 0,isPolling:!1,unmountedFlag:this.unmountedFlag,cancel:this.cancel.bind(this.that),refresh:this.refresh.bind(this.that),refreshOptions:this.refreshOptions.bind(this.that),changeData:this.changeData.bind(this.that),unmount:this.unmount.bind(this.that),params:[]};var l=r.debounceThrottleOptions,c=r.initData,d=r.debounceInterval,p=r.throttleInterval;if(this.requestFn=e,this.options=r,this.onChangeState=n,this.state.data=c,s&&(this.state=u(u({},this.state),s)),this.pollingTimer=void 0,void 0!==d)this.debounceFn=d?(0,i.default)(this._run.bind(this.that),d):void 0;else if(void 0!==p)this.throttleFn=p?(0,o.default)(this._run.bind(this.that),p):void 0;else if(void 0!==l){var v=l.type,g=l.interval,h=l.leading,f=void 0===h?"debounce"!==v:h,_=l.trailing,m=void 0===_||_;"debounce"===v?this.debounceFn=(0,i.default)(this._run.bind(this.that),g,{leading:f,trailing:m}):"throttle"===v&&(this.throttleFn=(0,o.default)(this._run.bind(this.that),g,{leading:f,trailing:m}))}}return e=[{key:"setState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=u(u({},this.state),e),this.onChangeState&&this.onChangeState(this.state)}},{key:"cancelPolling",value:function(){void 0!==this.pollingTimer&&(window.clearTimeout(this.pollingTimer),this.pollingTimer=void 0)}},{key:"dontPolling",value:function(){this.setState({isPolling:!1})}},{key:"_run",value:function(){for(var e=this,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];this.cancelPolling(),this.count+=1;var o=this.count;return this.setState({loading:!0,params:r,isPolling:!!this.options.pollingInterval}),this.requestFn.apply(this,r).then(function(t){if(!e.unmountedFlag.isTrue()&&o===e.count){var i=e.options.formatResult?e.options.formatResult(t):t;return e.setState({loading:!1,error:void 0,data:i}),e.options.onSuccess&&e.options.onSuccess(i,r,e.dontPolling.bind(e.that)),i}}).catch(function(t){if(!e.unmountedFlag.isTrue()&&o===e.count){if(e.setState({data:void 0,error:t,loading:!1}),e.options.onError&&e.options.onError(t,r,e.dontPolling.bind(e.that)),e.options.throwOnError)throw t;return t}}).finally(function(){!e.unmountedFlag.isTrue()&&o===e.count&&e.options.pollingInterval&&e.state.isPolling&&(e.pollingTimer=window.setTimeout(function(){e._run.apply(e,r)},e.options.pollingInterval))})}},{key:"run",value:function(){var e=this.debounceFn,t=this.throttleFn;return(this.unmountedFlag.setFalse(),e)?(e.apply(void 0,arguments),Promise.resolve(null)):t?(t.apply(void 0,arguments),Promise.resolve(null)):this._run.apply(this,arguments)}},{key:"cancel",value:function(){var e=this.debounceFn,t=this.throttleFn,r=this.pollingTimer;e&&e.cancel(),t&&t.cancel(),void 0!==r&&this.cancelPolling(),this.count+=1,this.setState({loading:!1,isPolling:!1})}},{key:"unmount",value:function(){this.unmountedFlag.setTrue(),this.cancel()}},{key:"refresh",value:function(){return this.unmountedFlag.setFalse(),this.run.apply(this,s(this.state.params))}},{key:"refreshOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.options=u(u({},this.options),e),this.run.apply(this,s(this.state.params))}},{key:"changeData",value:function(e){"function"==typeof e?this.setState({data:e(this.state.data)||{}}):this.setState({data:e})}}],function(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,e),t}();t.default=d},475432:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function e(){var t=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),this.value=void 0,this.type="memory",this.changeType=function(e){t.type=e},this.getValue=function(e){switch(t.type){case"memory":default:return t.value.get(e);case"localStorage":return JSON.parse(localStorage.getItem(e)||"{}")}},this.setValue=function(e,r){switch(t.type){case"memory":default:t.value.set(e,r);break;case"localStorage":localStorage.setItem(e,JSON.stringify(r))}},this.removeItem=function(e){switch(t.type){case"memory":default:t.value.delete(e);break;case"localStorage":localStorage.removeItem(e)}},this.value=new Map}},134566:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeCacheType=t.setCache=t.getCache=void 0;var i,o=new((i=r(475432))&&i.__esModule?i:{default:i}).default;t.setCache=function(e,t,r){var i=o.getValue(e);null!=i&&i.timer&&clearTimeout(i.timer);var a=void 0;t>-1&&(a=setTimeout(function(){o.removeItem(e)},t));var n={data:r,timer:a,startTime:new Date().getTime()};o.setValue(e,n)},t.getCache=function(e){var t=o.getValue(e);return{data:null==t?void 0:t.data,startTime:null==t?void 0:t.startTime}},t.changeCacheType=function(e){o.changeType(e)}},212932:function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.default=void 0;var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=o?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(r,a,n):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}(r(218571)),a=u(r(446579)),n=u(r(110206)),s=u(r(325994)),l=u(r(661637)),c=r(816209);function u(e){return e&&e.__esModule?e:{default:e}}function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){var i;i=r[t],t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var g=o.default.createContext({});g.displayName="UseRequestConfigContext",g.Provider,t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=v(v({},(0,o.useContext)(g)),t),i=r.mode;return i===c.Mode.loadMore?(0,n.default)(e,r):i===c.Mode.pagination?(0,s.default)(e,r):i===c.Mode.search?(0,l.default)(e,r):(0,a.default)(e,r)}},816209:function(e,t){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.Mode=void 0,t.Mode=r,(i=r||(t.Mode=r={})).loadMore="loadMore",i.pagination="pagination",i.search="search"},446579:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(218571),o=c(r(776007)),a=c(r(293793)),n=r(134566),s=c(r(771942)),l=c(r(652447));function c(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||d(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){h(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f="_BYTED_HOOKS_DEFAULT_KEY_";t.default=function(e){var t,r,c,p,v,_,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},y=m.staleTime,b=void 0===y?3e5:y,w=m.auto,S=void 0!==w&&w,T=m.defaultParams,k=void 0===T?[]:T,I=m.refreshDeps,P=m.initData,C=m.ready,M=void 0===C||C,j=m.cacheKey,O=m.cacheStoreType,L=void 0===O?"memory":O,x=m.cacheTime,E=void 0===x?3e5:x,R=m.loadingCheck,D=m.errorCheck,F=m.formatResult,A=m.requestKey,N=m.onError,U=m.onSuccess,V=(0,a.default)(e),W=(0,a.default)(U),B=(0,a.default)(N),Z=F?(0,a.default)(F):void 0,G=(0,a.default)(A),H=(0,i.useCallback)(function(e,t){X(function(r){return g(g({},r),{},h({},e,t))})},[]),z=(0,i.useRef)(j);z.current=j;var q=(0,i.useRef)(M);q.current=M;var K=(0,i.useRef)(f),Q=function(){if(z.current){var e=(0,n.getCache)(z.current)||{},t=e.data,r=e.startTime,i=-1===b||new Date().getTime()-(void 0===r?0:r)<=b;if(t&&i){K.current=t.currentRequestKey;var o={};return Object.keys(t.requests).forEach(function(e){var r=t.requests[e],i=new s.default(V,g(g({},m),{},{onSuccess:W,onError:B,formatResult:Z}),H.bind(null,e),{loading:r.loading,params:r.params,data:r.data,error:r.error});o[e]=i.state}),o}}return{}},J=function(e){if(Array.isArray(e))return e}(t=(0,i.useState)(function(){return"memory"!==L&&(0,n.changeCacheType)(L),Q()}))||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],i=!0,o=!1,a=void 0;try{for(var n,s=e[Symbol.iterator]();!(i=(n=s.next()).done)&&(r.push(n.value),2!==r.length);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return r}}(t,2)||d(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),Y=J[0],X=J[1],$=(0,i.useRef)(Y);$.current=Y;var ee=(0,i.useRef)(),et=(0,i.useCallback)(function(){for(var e,t,r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];if(!M){ee.current=i;return}if(A){var a=G.apply(void 0,i);K.current=a,t=$.current[a]}else t=$.current[K.current];if(!t){var n=new s.default(V,g(g({},m),{},{onSuccess:W,onError:B,formatResult:Z}),H.bind(null,K.current)).state;return X(function(e){return g(g({},e),{},h({},K.current,n))}),n.run.apply(n,i)}return(e=t).run.apply(e,i)},[A,M]);(0,o.default)(function(){z.current&&(0,n.setCache)(z.current,E,{requests:Y,currentRequestKey:K.current})},[Y]);var er=(0,i.useCallback)(function(){Object.values($.current).forEach(function(e){e.unmount()}),K.current=f,X({}),$.current={}},[X]),ei=(0,i.useRef)(!1);(0,o.default)(function(){M&&(!ei.current&&ee.current&&et.apply(void 0,u(ee.current)),ei.current=!0)},[M]),(0,i.useEffect)(function(){return"memory"!==L&&(0,n.changeCacheType)(L),M&&S&&(Object.keys(Q()).length>0?Object.values(Y).forEach(function(e){e.refresh()}):et.apply(void 0,u(k))),function(){Object.values($.current).forEach(function(e){e.unmount()})}},[M]),(0,o.default)(function(){if(q.current&&S){var e=Q();0===Object.keys(e).length?Object.values(Y).forEach(function(e){e.refresh()}):X(e)}},u(void 0===I?[]:I));var eo=[m.debounceInterval,m.throttleInterval,null===(r=m.debounceThrottleOptions)||void 0===r?void 0:r.type,null===(c=m.debounceThrottleOptions)||void 0===c?void 0:c.interval,null===(p=m.debounceThrottleOptions)||void 0===p?void 0:p.leading,null===(v=m.debounceThrottleOptions)||void 0===v?void 0:v.trailing,m.pollingInterval];if((0,o.default)(function(){Object.values(Y).forEach(function(e){e.unmountedFlag.isTrue()||(void 0!==m.debounceInterval?e.refreshOptions({debounceInterval:m.debounceInterval,pollingInterval:m.pollingInterval}):void 0!==m.throttleInterval?e.refreshOptions({throttleInterval:m.throttleInterval,pollingInterval:m.pollingInterval}):e.refreshOptions({debounceThrottleOptions:m.debounceThrottleOptions,pollingInterval:m.pollingInterval}))})},[].concat(eo)),_=Y[K.current]?g(g({},Y[K.current]),{},{run:et,reset:er,requests:Y}):{loading:S&&M,isPolling:!1,data:P,error:void 0,unmountedFlag:new l.default,params:[],cancel:function(){},unmount:function(){},reset:function(){},refresh:function(){},refreshOptions:function(){},changeData:function(){},run:et,requests:Y},"undefined"!=typeof Proxy){var ea=!(void 0!==R&&R),en=!(void 0!==D&&D);return new Proxy(_,{get:function(e,t,r){return"data"===t&&(ea||console.warn("You need to check loading before using data"),en||console.warn("You need to check error before using data")),e[t]}})}return _}},110206:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(218571),o=n(r(776007)),a=n(r(446579));function n(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||d(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){var i;i=r[t],t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],i=!0,o=!1,a=void 0;try{for(var n,s=e[Symbol.iterator]();!(i=(n=s.next()).done)&&(r.push(n.value),!t||r.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return r}}(e,t)||d(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.ready,n=void 0===r||r,l=t.resetDeps,d=t.refreshDeps,p=t.itemKey,v=t.initPageSize,g=void 0===v?10:v,h=t.ref,f=t.threshold,_=void 0===f?100:f,m=function(e,t){if(null==e)return{};var r,i,o=function(e,t){if(null==e)return{};var r,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,["ready","resetDeps","refreshDeps","itemKey","initPageSize","ref","threshold"]),y=t.hasMoreHanlder,b=t.isNoMore,w=t.hasMoreHandler,S=t.noMoreHandler;S=S||w||y||b;var T=t.incrementSize||g,k=u((0,i.useState)(!1),2),I=k[0],P=k[1],C=u((0,i.useState)(1),2),M=C[0],j=C[1],O=(0,i.useRef)(0),L=(0,i.useRef)(new Date().getTime()),x={data:{list:[]},current:1,pageSize:g,offset:0,startTime:L.current},E="boolean"!=typeof m.auto||m.auto,R=u((0,i.useState)(),2),D=R[0],F=R[1],A=(0,a.default)(e,c(c({},m),{},{ready:n,auto:E,defaultParams:[x],requestKey:function(e){var t,r;return((null==e?void 0:null===(t=e.data)||void 0===t?void 0:null===(r=t.list)||void 0===r?void 0:r.length)||0)+L.current},onSuccess:function(){var e;null!=D&&null!==(e=D.list)&&void 0!==e&&e.length&&h&&h.current&&(h.current.scrollTop=0),F(void 0),P(!1),j(function(e){return e+1}),t.onSuccess&&t.onSuccess.apply(t,arguments)},onError:function(){P(!1),t.onError&&t.onError.apply(t,arguments)}})),N=A.data,U=A.run,V=A.error,W=A.reset,B=A.loading,Z=A.requests,G=(0,i.useMemo)(function(){var e=[],t=N||{};return Object.keys(Z).sort(function(e,t){return Number(e)-Number(t)}).forEach(function(r){var i,o,a=Z[r];null!==(i=a.data)&&void 0!==i&&i.list&&(e=e.concat(null===(o=a.data)||void 0===o?void 0:o.list)),a.loading||(t=a.data)}),c(c({},t),{},{list:e})},[Z,N]),H=!!(!B&&!I&&(S?S(N,V,G):!N||!N.list.length||N.total&&G.list.length>=N.total)),z=(0,i.useCallback)(function(){var e,t,r,i=G.list;return{data:G,current:M,pageSize:1===M?g:T,offset:i.length,id:p&&i.length>0?(e=i[i.length-1],t=i.length-1,void 0===(r="function"==typeof p?p(e,t):e[p])?t:r):void 0,startTime:L.current}},[M,g,T,G]),q=(0,i.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!0===e&&F(G),W(),j(1),L.current=new Date().getTime(),U(x)},[U,W,G]),K=(0,i.useRef)(q);K.current=q,(0,o.default)(function(){n&&E&&K.current()},[].concat(s(void 0===l?[]:l),s(void 0===d?[]:d)));var Q=(0,i.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};F(void 0),H||B||I||(P(!0),U(c(c({},z()),e)))},[H,B,I,U,G,z]);(0,i.useEffect)(function(){if(!h||!h.current)return function(){};var e=function(){h&&h.current&&(O.current<h.current.scrollTop&&h.current.scrollHeight-h.current.scrollTop<=h.current.clientHeight+_&&Q(),O.current=h.current.scrollTop)};return h.current.addEventListener("scroll",e),function(){h&&h.current&&h.current.removeEventListener("scroll",e)}},[h&&h.current,Q]);var J=(0,i.useMemo)(function(){var e;return null!=D&&null!==(e=D.list)&&void 0!==e&&e.length?D:G},[D,D,G]);return c(c({},A),{},{reset:K.current,current:M,data:J,reload:q,loading:B&&!!(null==D?void 0:D.list.length)||B&&0===G.list.length,loadMore:Q,loadingMore:I,noMore:H,hasMore:H})}},325994:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(218571),o=n(r(776007)),a=n(r(446579));function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){var i;i=r[t],t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(e){return function(e){if(Array.isArray(e))return p(e)}(e)||d(e)||u(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}}function d(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}t.default=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.defaultPageSize,s=void 0===n?10:n,p=r.initCurrent,v=void 0===p?1:p,g=r.resetFirst,h=void 0!==g&&g,f=r.resetDeps,_=r.refreshDeps,m=(r.requestKey,function(e,t){if(null==e)return{};var r,i,o=function(e,t){if(null==e)return{};var r,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(r,["defaultPageSize","initCurrent","resetFirst","resetDeps","refreshDeps","requestKey"])),y=r.pageSize,b=r.current,w="boolean"!=typeof m.auto||m.auto,S=[l({current:v,pageSize:s},(null===(t=m.defaultParams)||void 0===t?void 0:t[0])||{})].concat(c((m.defaultParams||[]).slice(1))),T=(0,a.default)(e,l(l({},m),{},{defaultParams:S,auto:w})),k=T.data,I=T.params,P=T.run,C=T.loading,M=I&&I[0]?I[0]:S[0]||{},j=M.current,O=void 0===j?v:j,L=M.pageSize,x=void 0===L?s:L,E=M.sorter,R=M.filters;y&&(x=y),b&&(O=b);var D=(0,i.useCallback)(function(e){var t=function(e){if(Array.isArray(e))return e}(I)||d(I)||u(I)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r=t[0],i=t.slice(1);return P.apply(void 0,[l(l({},r),e)].concat(c(i)))},[P,I]),F=(null==k?void 0:k.total)||0,A=(0,i.useMemo)(function(){return Math.ceil(F/x)},[x,F]),N=(0,i.useCallback)(function(e,t){var r=e<=0?1:e,i=Math.ceil(F/(t<=0?1:t));return r>i&&(r=i),D({current:e,pageSize:t})},[F,D]);(0,i.useRef)(N).current=N;var U=(0,i.useCallback)(function(e){N(e,x)},[N,x]),V=(0,i.useCallback)(function(e){N(O,e)},[N,O]),W=(0,i.useRef)(U);W.current=U,(0,o.default)(function(){w&&W.current(b||(h?1:v))},[].concat(c(void 0===f?[]:f),c(void 0===_?[]:_),[y,b]));var B=(0,i.useCallback)(function(e,t,r){return D({current:void 0===e.current?v:e.current,pageSize:e.pageSize||s,filters:t,sorter:r})},[D]),Z=(0,i.useCallback)(function(){P(S[0],S[1])},[]);return l(l({},T),{},{reset:Z,loading:C,data:k,params:I,pagination:{current:O,pageSize:x,total:F,totalPage:A,onChange:N,changeCurrent:U,changePageSize:V},tableProps:{dataSource:(null==k?void 0:k.list)||[],loading:C,onChange:B,pagination:{current:O,pageSize:x,total:F}},sorter:void 0===E?{}:E,filters:void 0===R?{}:R})}},661637:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(218571),o=n(r(446579)),a=n(r(776007));function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){var i;i=r[t],t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function d(e,t){if(null==e)return{};var r,i,o=function(e,t){if(null==e)return{};var r,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}t.default=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=n.defaultValue,p=n.refreshDeps,v=n.debounceThrottleOptions,g=d(n,["defaultValue","refreshDeps","debounceThrottleOptions"]),h="boolean"!=typeof g.auto||g.auto,f=function(e){if(Array.isArray(e))return e}(t=(0,i.useState)(s))||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],i=!0,o=!1,a=void 0;try{for(var n,s=e[Symbol.iterator]();!(i=(n=s.next()).done)&&(r.push(n.value),2!==r.length);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return r}}(t,2)||c(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),_=f[0],m=f[1],y=(0,o.default)(e,l(l({defaultParams:[s]},g),{},{debounceThrottleOptions:void 0===v?{type:"debounce",interval:300}:v,auto:!1})),b=y.run,w=d(y,["run"]);(0,a.default)(function(){h&&b(_)},function(e){if(Array.isArray(e))return u(e)}(r=void 0===p?[]:p)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(r)||c(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),(0,i.useEffect)(function(){b(_)},[_]);var S=(0,i.useCallback)(function(){return b(_)},[b,_]);return l(l({},w),{},{value:_,onChange:m,run:S})}},906505:function(){!function(){"use strict";if("object"==typeof window){if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}var e=window.document,t=[];i.prototype.THROTTLE_TIMEOUT=100,i.prototype.POLL_INTERVAL=null,i.prototype.USE_MUTATION_OBSERVER=!0,i.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!(e&&1==e.nodeType))throw Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},i.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},i.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},i.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},i.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,r){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw Error("threshold must be a number between 0 and 1 inclusively");return e!==r[t-1]})},i.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},i.prototype._monitorIntersections=function(){!this._monitoringIntersections&&(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(o(window,"resize",this._checkForIntersections,!0),o(e,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},i.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,a(window,"resize",this._checkForIntersections,!0),a(e,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},i.prototype._checkForIntersections=function(){var e=this._rootIsInDom(),t=e?this._getRootRect():s();this._observationTargets.forEach(function(i){var o=i.element,a=n(o),s=this._rootContainsTarget(o),l=i.entry,c=e&&s&&this._computeTargetAndRootIntersection(o,t),u=i.entry=new r({time:window.performance&&performance.now&&performance.now(),target:o,boundingClientRect:a,rootBounds:t,intersectionRect:c});l?e&&s?this._hasCrossedThreshold(l,u)&&this._queuedEntries.push(u):l&&l.isIntersecting&&this._queuedEntries.push(u):this._queuedEntries.push(u)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},i.prototype._computeTargetAndRootIntersection=function(t,r){if("none"!=window.getComputedStyle(t).display){for(var i=n(t),o=c(t),a=!1;!a;){var s=null,l=1==o.nodeType?window.getComputedStyle(o):{};if("none"==l.display)return;if(o==this.root||o==e?(a=!0,s=r):o!=e.body&&o!=e.documentElement&&"visible"!=l.overflow&&(s=n(o)),s&&!(i=function(e,t){var r=Math.max(e.top,t.top),i=Math.min(e.bottom,t.bottom),o=Math.max(e.left,t.left),a=Math.min(e.right,t.right),n=a-o,s=i-r;return n>=0&&s>=0&&{top:r,bottom:i,left:o,right:a,width:n,height:s}}(s,i)))break;o=c(o)}return i}},i.prototype._getRootRect=function(){var t;if(this.root)t=n(this.root);else{var r=e.documentElement,i=e.body;t={top:0,left:0,right:r.clientWidth||i.clientWidth,width:r.clientWidth||i.clientWidth,bottom:r.clientHeight||i.clientHeight,height:r.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(t)},i.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,r){return"px"==t.unit?t.value:t.value*(r%2?e.width:e.height)/100}),r={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return r.width=r.right-r.left,r.height=r.bottom-r.top,r},i.prototype._hasCrossedThreshold=function(e,t){var r=e&&e.isIntersecting?e.intersectionRatio||0:-1,i=t.isIntersecting?t.intersectionRatio||0:-1;if(r!==i)for(var o=0;o<this.thresholds.length;o++){var a=this.thresholds[o];if(a==r||a==i||a<r!=a<i)return!0}},i.prototype._rootIsInDom=function(){return!this.root||l(e,this.root)},i.prototype._rootContainsTarget=function(t){return l(this.root||e,t)},i.prototype._registerInstance=function(){0>t.indexOf(this)&&t.push(this)},i.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=i,window.IntersectionObserverEntry=r}function r(e){this.time=e.time,this.target=e.target,this.rootBounds=e.rootBounds,this.boundingClientRect=e.boundingClientRect,this.intersectionRect=e.intersectionRect||s(),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,r=t.width*t.height,i=this.intersectionRect,o=i.width*i.height;r?this.intersectionRatio=Number((o/r).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function i(e,t){var r,i,o,a=t||{};if("function"!=typeof e)throw Error("callback must be a function");if(a.root&&1!=a.root.nodeType)throw Error("root must be an Element");this._checkForIntersections=(r=this._checkForIntersections.bind(this),i=this.THROTTLE_TIMEOUT,o=null,function(){o||(o=setTimeout(function(){r(),o=null},i))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(a.rootMargin),this.thresholds=this._initThresholds(a.threshold),this.root=a.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" ")}function o(e,t,r,i){"function"==typeof e.addEventListener?e.addEventListener(t,r,i||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,r)}function a(e,t,r,i){"function"==typeof e.removeEventListener?e.removeEventListener(t,r,i||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,r)}function n(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):s()}function s(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function l(e,t){for(var r=t;r;){if(r==e)return!0;r=c(r)}return!1}function c(e){var t=e.parentNode;return t&&11==t.nodeType&&t.host?t.host:t&&t.assignedSlot?t.assignedSlot.parentNode:t}}()},164287:function(e,t,r){var i=0/0,o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,u="object"==typeof self&&self&&self.Object===Object&&self,d=c||u||Function("return this")(),p=Object.prototype.toString,v=Math.max,g=Math.min,h=function(){return d.Date.now()};function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function _(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==p.call(t))return i;if(f(e)){var t,r="function"==typeof e.valueOf?e.valueOf():e;e=f(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var c=n.test(e);return c||s.test(e)?l(e.slice(2),c?2:8):a.test(e)?i:+e}e.exports=function(e,t,r){var i,o,a,n,s,l,c=0,u=!1,d=!1,p=!0;if("function"!=typeof e)throw TypeError("Expected a function");function m(t){var r=i,a=o;return i=o=void 0,c=t,n=e.apply(a,r)}function y(e){var r=e-l,i=e-c;return void 0===l||r>=t||r<0||d&&i>=a}function b(){var e,r,i,o=h();if(y(o))return w(o);s=setTimeout(b,(e=o-l,r=o-c,i=t-e,d?g(i,a-r):i))}function w(e){return(s=void 0,p&&i)?m(e):(i=o=void 0,n)}function S(){var e,r=h(),a=y(r);if(i=arguments,o=this,l=r,a){if(void 0===s)return c=e=l,s=setTimeout(b,t),u?m(e):n;if(d)return s=setTimeout(b,t),m(l)}return void 0===s&&(s=setTimeout(b,t)),n}return t=_(t)||0,f(r)&&(u=!!r.leading,a=(d="maxWait"in r)?v(_(r.maxWait)||0,t):a,p="trailing"in r?!!r.trailing:p),S.cancel=function(){void 0!==s&&clearTimeout(s),c=0,i=l=o=s=void 0},S.flush=function(){return void 0===s?n:w(h())},S}},96304:function(e,t,r){e=r.nmd(e);var i,o,a,n="__lodash_hash_undefined__",s="[object Arguments]",l="[object Array]",c="[object Boolean]",u="[object Date]",d="[object Error]",p="[object Function]",v="[object Map]",g="[object Number]",h="[object Object]",f="[object Promise]",_="[object RegExp]",m="[object Set]",y="[object String]",b="[object WeakMap]",w="[object ArrayBuffer]",S="[object DataView]",T=/^\[object .+?Constructor\]$/,k=/^(?:0|[1-9]\d*)$/,I={};I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I[s]=I[l]=I[w]=I[c]=I[S]=I[u]=I[d]=I[p]=I[v]=I[g]=I[h]=I[_]=I[m]=I[y]=I[b]=!1;var P="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,C="object"==typeof self&&self&&self.Object===Object&&self,M=P||C||Function("return this")(),j=t&&!t.nodeType&&t,O=j&&e&&!e.nodeType&&e,L=O&&O.exports===j,x=L&&P.process,E=function(){try{return x&&x.binding&&x.binding("util")}catch(e){}}(),R=E&&E.isTypedArray;function D(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}function F(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var A=Array.prototype,N=Function.prototype,U=Object.prototype,V=M["__core-js_shared__"],W=N.toString,B=U.hasOwnProperty,Z=(i=/[^.]+$/.exec(V&&V.keys&&V.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",G=U.toString,H=RegExp("^"+W.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),z=L?M.Buffer:void 0,q=M.Symbol,K=M.Uint8Array,Q=U.propertyIsEnumerable,J=A.splice,Y=q?q.toStringTag:void 0,X=Object.getOwnPropertySymbols,$=z?z.isBuffer:void 0,ee=(o=Object.keys,a=Object,function(e){return o(a(e))}),et=eI(M,"DataView"),er=eI(M,"Map"),ei=eI(M,"Promise"),eo=eI(M,"Set"),ea=eI(M,"WeakMap"),en=eI(Object,"create"),es=eM(et),el=eM(er),ec=eM(ei),eu=eM(eo),ed=eM(ea),ep=q?q.prototype:void 0,ev=ep?ep.valueOf:void 0;function eg(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function eh(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ef(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function e_(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new ef;++t<r;)this.add(e[t])}function em(e){var t=this.__data__=new eh(e);this.size=t.size}function ey(e,t){for(var r=e.length;r--;)if(ej(e[r][0],t))return r;return -1}function eb(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Y&&Y in Object(e)?function(e){var t=B.call(e,Y),r=e[Y];try{e[Y]=void 0;var i=!0}catch(e){}var o=G.call(e);return i&&(t?e[Y]=r:delete e[Y]),o}(e):G.call(e)}function ew(e){return eF(e)&&eb(e)==s}function eS(e,t,r,i,o,a){var n=1&r,s=e.length,l=t.length;if(s!=l&&!(n&&l>s))return!1;var c=a.get(e);if(c&&a.get(t))return c==t;var u=-1,d=!0,p=2&r?new e_:void 0;for(a.set(e,t),a.set(t,e);++u<s;){var v=e[u],g=t[u];if(i)var h=n?i(g,v,u,t,e,a):i(v,g,u,e,t,a);if(void 0!==h){if(h)continue;d=!1;break}if(p){if(!function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}(t,function(e,t){if(!p.has(t)&&(v===e||o(v,e,r,i,a)))return p.push(t)})){d=!1;break}}else if(!(v===g||o(v,g,r,i,a))){d=!1;break}}return a.delete(e),a.delete(t),d}function eT(e){var t;return t=function(e){return null!=e&&eR(e.length)&&!eE(e)?function(e,t){var r,i=eL(e),o=!i&&eO(e),a=!i&&!o&&ex(e),n=!i&&!o&&!a&&eA(e),s=i||o||a||n,l=s?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],c=l.length;for(var u in e)B.call(e,u)&&!(s&&("length"==u||a&&("offset"==u||"parent"==u)||n&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||(r=null==(r=c)?9007199254740991:r)&&("number"==typeof u||k.test(u))&&u>-1&&u%1==0&&u<r))&&l.push(u);return l}(e):function(e){if(t=e&&e.constructor,e!==("function"==typeof t&&t.prototype||U))return ee(e);var t,r=[];for(var i in Object(e))B.call(e,i)&&"constructor"!=i&&r.push(i);return r}(e)}(e),eL(e)?t:function(e,t){for(var r=-1,i=t.length,o=e.length;++r<i;)e[o+r]=t[r];return e}(t,eP(e))}function ek(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function eI(e,t){var r=null==e?void 0:e[t];return!(!eD(r)||Z&&Z in r)&&(eE(r)?H:T).test(eM(r))?r:void 0}eg.prototype.clear=function(){this.__data__=en?en(null):{},this.size=0},eg.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},eg.prototype.get=function(e){var t=this.__data__;if(en){var r=t[e];return r===n?void 0:r}return B.call(t,e)?t[e]:void 0},eg.prototype.has=function(e){var t=this.__data__;return en?void 0!==t[e]:B.call(t,e)},eg.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=en&&void 0===t?n:t,this},eh.prototype.clear=function(){this.__data__=[],this.size=0},eh.prototype.delete=function(e){var t=this.__data__,r=ey(t,e);return!(r<0)&&(r==t.length-1?t.pop():J.call(t,r,1),--this.size,!0)},eh.prototype.get=function(e){var t=this.__data__,r=ey(t,e);return r<0?void 0:t[r][1]},eh.prototype.has=function(e){return ey(this.__data__,e)>-1},eh.prototype.set=function(e,t){var r=this.__data__,i=ey(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},ef.prototype.clear=function(){this.size=0,this.__data__={hash:new eg,map:new(er||eh),string:new eg}},ef.prototype.delete=function(e){var t=ek(this,e).delete(e);return this.size-=t?1:0,t},ef.prototype.get=function(e){return ek(this,e).get(e)},ef.prototype.has=function(e){return ek(this,e).has(e)},ef.prototype.set=function(e,t){var r=ek(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},e_.prototype.add=e_.prototype.push=function(e){return this.__data__.set(e,n),this},e_.prototype.has=function(e){return this.__data__.has(e)},em.prototype.clear=function(){this.__data__=new eh,this.size=0},em.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},em.prototype.get=function(e){return this.__data__.get(e)},em.prototype.has=function(e){return this.__data__.has(e)},em.prototype.set=function(e,t){var r=this.__data__;if(r instanceof eh){var i=r.__data__;if(!er||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new ef(i)}return r.set(e,t),this.size=r.size,this};var eP=X?function(e){return null==e?[]:function(e,t){for(var r=-1,i=null==e?0:e.length,o=0,a=[];++r<i;){var n=e[r];t(n,r,e)&&(a[o++]=n)}return a}(X(e=Object(e)),function(t){return Q.call(e,t)})}:function(){return[]},eC=eb;function eM(e){if(null!=e){try{return W.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ej(e,t){return e===t||e!=e&&t!=t}(et&&eC(new et(new ArrayBuffer(1)))!=S||er&&eC(new er)!=v||ei&&eC(ei.resolve())!=f||eo&&eC(new eo)!=m||ea&&eC(new ea)!=b)&&(eC=function(e){var t=eb(e),r=t==h?e.constructor:void 0,i=r?eM(r):"";if(i)switch(i){case es:return S;case el:return v;case ec:return f;case eu:return m;case ed:return b}return t});var eO=ew(function(){return arguments}())?ew:function(e){return eF(e)&&B.call(e,"callee")&&!Q.call(e,"callee")},eL=Array.isArray,ex=$||function(){return!1};function eE(e){if(!eD(e))return!1;var t=eb(e);return t==p||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eR(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function eD(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function eF(e){return null!=e&&"object"==typeof e}var eA=R?function(e){return R(e)}:function(e){return eF(e)&&eR(e.length)&&!!I[eb(e)]};e.exports=function(e,t){return function e(t,r,i,o,a){return t===r||(null!=t&&null!=r&&(eF(t)||eF(r))?function(e,t,r,i,o,a){var n=eL(e),p=eL(t),f=n?l:eC(e),b=p?l:eC(t);f=f==s?h:f,b=b==s?h:b;var T=f==h,k=b==h,I=f==b;if(I&&ex(e)){if(!ex(t))return!1;n=!0,T=!1}if(I&&!T)return a||(a=new em),n||eA(e)?eS(e,t,r,i,o,a):function(e,t,r,i,o,a,n){switch(r){case S:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case w:if(e.byteLength!=t.byteLength||!a(new K(e),new K(t)))break;return!0;case c:case u:case g:return ej(+e,+t);case d:return e.name==t.name&&e.message==t.message;case _:case y:return e==t+"";case v:var s=D;case m:var l=1&i;if(s||(s=F),e.size!=t.size&&!l)break;var p=n.get(e);if(p)return p==t;i|=2,n.set(e,t);var h=eS(s(e),s(t),i,o,a,n);return n.delete(e),h;case"[object Symbol]":if(ev)return ev.call(e)==ev.call(t)}return!1}(e,t,f,r,i,o,a);if(!(1&r)){var P=T&&B.call(e,"__wrapped__"),C=k&&B.call(t,"__wrapped__");if(P||C){var M=P?e.value():e,j=C?t.value():t;return a||(a=new em),o(M,j,r,i,a)}}return!!I&&(a||(a=new em),function(e,t,r,i,o,a){var n=1&r,s=eT(e),l=s.length;if(l!=eT(t).length&&!n)return!1;for(var c=l;c--;){var u=s[c];if(!(n?u in t:B.call(t,u)))return!1}var d=a.get(e);if(d&&a.get(t))return d==t;var p=!0;a.set(e,t),a.set(t,e);for(var v=n;++c<l;){var g=e[u=s[c]],h=t[u];if(i)var f=n?i(h,g,u,t,e,a):i(g,h,u,e,t,a);if(!(void 0===f?g===h||o(g,h,r,i,a):f)){p=!1;break}v||(v="constructor"==u)}if(p&&!v){var _=e.constructor,m=t.constructor;_!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof m&&m instanceof m)&&(p=!1)}return a.delete(e),a.delete(t),p}(e,t,r,i,o,a))}(t,r,i,o,e,a):t!=t&&r!=r)}(e,t)}},816247:function(e,t,r){var i="Expected a function",o=0/0,a=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,u="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,d="object"==typeof self&&self&&self.Object===Object&&self,p=u||d||Function("return this")(),v=Object.prototype.toString,g=Math.max,h=Math.min,f=function(){return p.Date.now()};function _(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function m(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==v.call(t))return o;if(_(e)){var t,r="function"==typeof e.valueOf?e.valueOf():e;e=_(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var i=s.test(e);return i||l.test(e)?c(e.slice(2),i?2:8):n.test(e)?o:+e}e.exports=function(e,t,r){var o=!0,a=!0;if("function"!=typeof e)throw TypeError(i);return _(r)&&(o="leading"in r?!!r.leading:o,a="trailing"in r?!!r.trailing:a),function(e,t,r){var o,a,n,s,l,c,u=0,d=!1,p=!1,v=!0;if("function"!=typeof e)throw TypeError(i);function y(t){var r=o,i=a;return o=a=void 0,u=t,s=e.apply(i,r)}function b(e){var r=e-c,i=e-u;return void 0===c||r>=t||r<0||p&&i>=n}function w(){var e,r,i,o=f();if(b(o))return S(o);l=setTimeout(w,(e=o-c,r=o-u,i=t-e,p?h(i,n-r):i))}function S(e){return(l=void 0,v&&o)?y(e):(o=a=void 0,s)}function T(){var e,r=f(),i=b(r);if(o=arguments,a=this,c=r,i){if(void 0===l)return u=e=c,l=setTimeout(w,t),d?y(e):s;if(p)return l=setTimeout(w,t),y(c)}return void 0===l&&(l=setTimeout(w,t)),s}return t=m(t)||0,_(r)&&(d=!!r.leading,n=(p="maxWait"in r)?g(m(r.maxWait)||0,t):n,v="trailing"in r?!!r.trailing:v),T.cancel=function(){void 0!==l&&clearTimeout(l),u=0,o=c=a=l=void 0},T.flush=function(){return void 0===l?s:S(f())},T}(e,t,{leading:o,maxWait:t,trailing:a})}},305974:function(e,t,r){var i=r(597563),o=r(404431),a=r(543518);function n(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new i;++t<r;)this.add(e[t])}n.prototype.add=n.prototype.push=o,n.prototype.has=a,e.exports=n},231121:function(e){e.exports=function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}},112286:function(e,t,r){var i=r(467328),o=r(10757);e.exports=function e(t,r,a,n,s){return t===r||(null!=t&&null!=r&&(o(t)||o(r))?i(t,r,a,n,e,s):t!=t&&r!=r)}},467328:function(e,t,r){var i=r(800452),o=r(147286),a=r(145660),n=r(145210),s=r(971018),l=r(783469),c=r(181818),u=r(702641),d="[object Arguments]",p="[object Array]",v="[object Object]",g=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,h,f,_){var m=l(e),y=l(t),b=m?p:s(e),w=y?p:s(t);b=b==d?v:b,w=w==d?v:w;var S=b==v,T=w==v,k=b==w;if(k&&c(e)){if(!c(t))return!1;m=!0,S=!1}if(k&&!S)return _||(_=new i),m||u(e)?o(e,t,r,h,f,_):a(e,t,b,r,h,f,_);if(!(1&r)){var I=S&&g.call(e,"__wrapped__"),P=T&&g.call(t,"__wrapped__");if(I||P){var C=I?e.value():e,M=P?t.value():t;return _||(_=new i),f(C,M,r,h,_)}}return!!k&&(_||(_=new i),n(e,t,r,h,f,_))}},768066:function(e){e.exports=function(e,t){return e.has(t)}},147286:function(e,t,r){var i=r(305974),o=r(231121),a=r(768066);e.exports=function(e,t,r,n,s,l){var c=1&r,u=e.length,d=t.length;if(u!=d&&!(c&&d>u))return!1;var p=l.get(e),v=l.get(t);if(p&&v)return p==t&&v==e;var g=-1,h=!0,f=2&r?new i:void 0;for(l.set(e,t),l.set(t,e);++g<u;){var _=e[g],m=t[g];if(n)var y=c?n(m,_,g,t,e,l):n(_,m,g,e,t,l);if(void 0!==y){if(y)continue;h=!1;break}if(f){if(!o(t,function(e,t){if(!a(f,t)&&(_===e||s(_,e,r,n,l)))return f.push(t)})){h=!1;break}}else if(!(_===m||s(_,m,r,n,l))){h=!1;break}}return l.delete(e),l.delete(t),h}},145660:function(e,t,r){var i=r(961885),o=r(185302),a=r(568922),n=r(147286),s=r(988679),l=r(303605),c=i?i.prototype:void 0,u=c?c.valueOf:void 0;e.exports=function(e,t,r,i,c,d,p){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!d(new o(e),new o(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var v=s;case"[object Set]":var g=1&i;if(v||(v=l),e.size!=t.size&&!g)break;var h=p.get(e);if(h)return h==t;i|=2,p.set(e,t);var f=n(v(e),v(t),i,c,d,p);return p.delete(e),f;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},145210:function(e,t,r){var i=r(838039),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,a,n,s){var l=1&r,c=i(e),u=c.length;if(u!=i(t).length&&!l)return!1;for(var d=u;d--;){var p=c[d];if(!(l?p in t:o.call(t,p)))return!1}var v=s.get(e),g=s.get(t);if(v&&g)return v==t&&g==e;var h=!0;s.set(e,t),s.set(t,e);for(var f=l;++d<u;){var _=e[p=c[d]],m=t[p];if(a)var y=l?a(m,_,p,t,e,s):a(_,m,p,e,t,s);if(!(void 0===y?_===m||n(_,m,r,a,s):y)){h=!1;break}f||(f="constructor"==p)}if(h&&!f){var b=e.constructor,w=t.constructor;b!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(h=!1)}return s.delete(e),s.delete(t),h}},988679:function(e){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}},404431:function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},543518:function(e){e.exports=function(e){return this.__data__.has(e)}},303605:function(e){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},766134:function(e,t,r){var i=r(112286);e.exports=function(e,t,r){var o=(r="function"==typeof r?r:void 0)?r(e,t):void 0;return void 0===o?i(e,t,void 0,r):!!o}},988717:function(e,t,r){"use strict";e.exports=r.p+"static/image/loading_fast.32a9730d.webp"},341507:function(e,t,r){"use strict";r.d(t,{Z:()=>af});let i=r("360108"),o=r("36786"),a=r("461228"),n=r("69984"),s=r("764112"),l=r("888010"),c=r("726916"),u=r("546964"),d=r("988441");var p,v,g,h,f,_,m,y,b,w,S,T,k,I,P,C,M,j,O,L,x,E,R,D,F,A,N,U,V,W,B,Z,G,H=(0,r("30276").yh)("smart-tools-feedback");let z=r("789786"),q=r("577729"),K=r("226134"),Q=r("831246"),J=r("248176"),Y=r("254845"),X=r("474520");class $ extends q.JT{get observeData(){return this._observableData}_setUserProfile(e){(0,Y.z)(()=>{this._observableData.userProfile=e})}_setWebID(e){(0,Y.z)(()=>{this._observableData.webId=e})}_setEnableReport(e){(0,Y.z)(()=>{this._observableData.enableReport=e})}constructor(e,t,r){super(),this._cookieConsentService=e,this._teaAdapterService=t,this._accountService=r,this._observableData=(0,Y.LO)({userProfile:{},webId:"",enableReport:!1}),this._setUserProfile(this._accountService.userProfile),this._accountService.onDidChangeProfile(e=>{this._setUserProfile(e)}),this._cookieConsentService.onEnableChange(e=>{this._setEnableReport(e)}),this._teaAdapterService.getWebId().then(e=>{this._setWebID(e)})}}$=(0,z.gn)([(0,z.fM)(0,X.n),(0,z.fM)(1,K.w),(0,z.fM)(2,Q.D),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===X.n?Object:X.n,void 0===K.w?Object:K.w,void 0===J.Gw?Object:J.Gw])],$);let ee=r("551551"),et=r("498007"),er=r("723394");var ei={enableWebUpload:!0,enableWebPolicy:!0,enableWebWindowInterceptor:!0,enableEmailNotify:!0,enableWebviewHide:!0},eo="Long_To_Short_PolicyAgreeKey";class ea{getPolicy(){return this.enableWebPolicy?localStorage.getItem(eo):er.S4.getComplianceAgreed().then(e=>e.data.complianceAgreed)}setPolicy(){if(this.enableWebPolicy){localStorage.setItem(eo,"hasGree");return}er.S4.setComplianceAgreed({complianceAgreed:!0})}getEnableWebUploadABTest(){return(0,a._)(function*(){try{var e="enabled",t=yield er.S4.getSettings({nodeKey:"ai_shorts_enable_web_upload",keys:[e]});if(1===t.code)return"true"===t.data.nodeKey[e];return!1}catch(e){return!1}})()}constructor(e){this._options=e;var{enableWebUpload:t,enableWebPolicy:r,enableWebWindowInterceptor:o,enableEmailNotify:a}=Object.assign({},ei,this._options);if(this.enableWebPolicy=r,this.enableWebWindowInterceptor=o,this.enableEmailNotify=a,i.FB){var{version:n}=(0,i.dU)();this.enableWebviewHide=(0,et.yC)(n,"4.1.0")>=0,this.getEnableWebUploadABTest().then(e=>{this.enableWebUpload=e})}else this.enableWebUpload=t}}(0,z.gn)([Y.LO,(0,z.w6)("design:type",Object)],ea.prototype,"enableWebUpload",void 0),(0,z.gn)([Y.LO,(0,z.w6)("design:type",Boolean)],ea.prototype,"enableWebPolicy",void 0),(0,z.gn)([Y.LO,(0,z.w6)("design:type",Boolean)],ea.prototype,"enableWebWindowInterceptor",void 0),(0,z.gn)([Y.LO,(0,z.w6)("design:type",Boolean)],ea.prototype,"enableEmailNotify",void 0),(0,z.gn)([Y.LO,(0,z.w6)("design:type",Object)],ea.prototype,"enableWebviewHide",void 0),r("349601");let en=r("781494"),es=r("216073"),el=r("797323"),ec=r("295433"),eu=r("123951");class ed{updateEncryptId(e){this.encryptId=e}updateVideoType(e){this.videoType=e}updateTTVideoInfo(e){this.ttVideoInfo=e}getTTVideoInfo(){var e=this;return(0,a._)(function*(){e.ttLoading=!0;var t=yield e._longToShortDataService.getTTRoomInfo({encrypted_id:e.encryptId,tt_appid:e.ttAppId,tt_vid_type:e.videoType});if(e.ttLoading=!1,!t.ok||!t.value){en.Z.error({id:"smart-writer-network-error",content:eu.ZP.t("web_textvideo_toast_unstable_network",{},"Connect to the internet and try again.")}),e._slardarAdapterService.captureException("get_tt_room_info_err",Error(JSON.stringify(t)));return}e.updateTTVideoInfo(t.value)})()}reset(){this.encryptId="",this.videoType=es.WY.Live,this.ttVideoInfo={title:"",coverUrl:"",playUrl:"",spriteList:[],createTime:0,endTime:0}}constructor(e,t){this._longToShortDataService=e,this._slardarAdapterService=t,this.encryptId=(0,ec.Uf)()||"",this.videoType=(0,ec.zn)()||es.WY.Live,this.ttAppId=(0,ec.Yv)(),this.ttLoading=!0,this.ttVideoInfo={title:"",coverUrl:"",playUrl:"",spriteList:[],createTime:0,endTime:0},(0,Y.rC)(this)}}(0,z.gn)([Y.LO,(0,z.w6)("design:type",String)],ed.prototype,"encryptId",void 0),(0,z.gn)([Y.LO,(0,z.w6)("design:type",void 0===es.WY?Object:es.WY)],ed.prototype,"videoType",void 0),(0,z.gn)([Y.LO,(0,z.w6)("design:type",Boolean)],ed.prototype,"ttLoading",void 0),(0,z.gn)([Y.LO,(0,z.w6)("design:type","undefined"==typeof TTPlayInfo?Object:TTPlayInfo)],ed.prototype,"ttVideoInfo",void 0),(0,z.gn)([Y.aD,(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",["undefined"==typeof TTPlayInfo?Object:TTPlayInfo]),(0,z.w6)("design:returntype",void 0)],ed.prototype,"updateTTVideoInfo",null),ed=(0,z.gn)([(0,z.fM)(0,es.Dk),(0,z.fM)(1,el.L),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===es.Dk?Object:es.Dk,void 0===el.L?Object:el.L])],ed);let ep=r("682105"),ev=r("408541");class eg{_preloadSprites(){return this._getSprites().map(e=>new Promise((t,r)=>{var i=new Image;i.crossOrigin="anonymous",i.onload=()=>{t((0,s._)((0,n._)({},e),{imgSource:i}))},i.onerror=r,i.src=globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(e.url,null,{logType:"js.href/src",mode:"black",reportOnly:"all"})}))}_drawCanvas(e,t,r){var i,{_canvas:o,_ctx:a}=this,{imageWidth:n,imageHeight:s}=null===(i=this._getSprites())||void 0===i?void 0:i[0];o.width=n,o.height=s,a.drawImage(this._spriteList[e].imgSource,t<0?0:t,r<0?0:r,n,s,0,0,n,s);var l=o.toDataURL("image/jpg");this._thumbnailArr.push({id:(0,ev.Rl)(),width:this._imgWidth,height:ep.c,src:globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(l,null,{logType:"js.href/src",mode:"black",reportOnly:"all"})})}_getSpriteSeconds(){var e=0;return this._spriteList.map(t=>{var r=this._getFps(t);return e+=r*t.spriteNum})}_getSpriteYNum(){var e=0;return this._spriteList.map(t=>e+=t.imageYNum)}_getSprites(){return this._ttLiveVideoManager.ttVideoInfo.spriteList}_getFps(e){var{spriteNum:t,fps:r}=e;if(t*r>this._videoDuration){var i=this._getSprites().reduce((e,t)=>e+t.spriteNum,0);return this._videoDuration/i}return e.fps}_getThumbnailTime(e){var t,{imageWidth:r,imageHeight:i}=null===(t=this._spriteList)||void 0===t?void 0:t[0];this._imgWidth=ep.c*(r/i),this._imgCount=Math.ceil(e/this._imgWidth);for(var o=[],a=Math.round(this._videoDuration/(this._imgCount-1)),n=1;n<this._videoDuration;n+=a)o.push(n);return o}_getPositionInSprites(e){var t=this._getSpriteSeconds(),r=[];t.forEach((t,i)=>{e<=t&&r.push(i)});var i=r.length?Math.min(...r):0,o=this._spriteList[i];if(o){var{imageXNum:a,imageWidth:n,imageHeight:s,imageYNum:l}=o,c=this._getSpriteYNum(),u=Math.floor(e/this._getFps(o)),d=Math.floor(u/a)-(c[i-1]||0),p=(u%a-1)*n,v=d*s;p>n*a||v>s*(l-1)||this._drawCanvas(i,p,v)}}getSprites(e,t){return Promise.allSettled(this._preloadSprites()).then(r=>{var i=r.filter(e=>"fulfilled"===e.status).map(e=>e.value);if(!i.length||!t)return[];if(this._spriteList=i,this._videoDuration=t,this._getThumbnailTime(e).forEach(e=>{this._getPositionInSprites(e)}),this._thumbnailArr.length<this._imgCount){for(var o=this._imgCount-this._thumbnailArr.length,a=this._thumbnailArr,l=0;l<o;l++)a.push((0,s._)((0,n._)({},this._thumbnailArr[this._thumbnailArr.length-1]),{id:(0,ev.Rl)()}));return a}return this._thumbnailArr})}constructor(e){this._ttLiveVideoManager=e,this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._thumbnailArr=[],this._spriteList=[],this._imgWidth=0,this._imgCount=0,this._videoDuration=0,(0,Y.ky)(this)}}let eh=r("461644"),ef=r("658742"),e_=r("194927"),em=r("525479"),ey=r("270967");(p=C||(C={}))[p.VipOnExport=0]="VipOnExport",p[p.VipOnSync=1]="VipOnSync",p[p.VipOnUpload=2]="VipOnUpload";class eb extends q.JT{get _isLogin(){return this._accountService.hasLogin}get isVip(){var e,t;return null!==(t=null===(e=this._accountService.userVipInfo)||void 0===e?void 0:e.flag)&&void 0!==t&&t}handleShowVipModal(e){if(this.hasPayVipAbility&&this._isLogin){var{payScene:t,pageFrom:r,reporterParams:i}=e,o=this._containerService.invokeFunction(e=>e.get(e_.n).draftWorkspaceManager.workspaceId);(0,em.T)({payinPayoutHelper:this.payinPayoutHelper,workspaceId:o,payScene:t,pageFrom:r,isUpgrade:!0,onPaySuccess:e=>{if(e){var t;null===(t=this.onPaySuccess)||void 0===t||t.call(this)}},reporterParams:i})}}_getIsSupportPay(){var e=this;return(0,a._)(function*(){if(e._isLogin){var t=e._containerService.invokeFunction(e=>e.get(e_.n).draftWorkspaceManager.workspaceId),r=yield e.payinPayoutHelper.getIsSupportPay(t);e.hasPayVipAbility=r}})()}constructor(e,t,r){super(),this._accountService=t,this._containerService=r,this.hasPayVipAbility=!1,this._onVipWorkspaceChange=this._store.add(new ef.Q),this.onVipWorkspaceChange=this._onVipWorkspaceChange.event,(0,Y.rC)(this),this._smartToolType=e,this.payinPayoutHelper=r.createInstance(ey.o),this._getIsSupportPay(),t.onDidLogin(()=>{this._getIsSupportPay()})}}(0,z.gn)([Y.LO,(0,z.w6)("design:type",Boolean)],eb.prototype,"hasPayVipAbility",void 0),(0,z.gn)([Y.Fl,(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[]),(0,z.w6)("design:returntype",void 0)],eb.prototype,"_isLogin",null),eb=(0,z.gn)([(0,z.fM)(1,J.Gw),(0,z.fM)(2,eh.t),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===d.o?Object:d.o,void 0===J.Gw?Object:J.Gw,void 0===eh.t?Object:eh.t])],eb);let ew=r("807283"),eS=r("554487");class eT extends eb{onPaySuccess(){this._quotaManager.fetchUserBenefit()}showVipModal(){super.handleShowVipModal({payScene:ew.Mm.UPGRADE,pageFrom:eS.K1.enoughTimeUpgrade,reporterParams:{toolType:"clip_shorts",reportVipInfo:{vipRightName:"clip_shorts"},pageFromExtra:JSON.stringify({vip_right_name:"clip_shorts",vip_function_id:"clip_shorts"})}})}constructor(e,t,r,i){super(e,r,i),this._quotaManager=t,this._accountService=r,this._containerService=i,(0,Y.rC)(this)}}eT=(0,z.gn)([(0,z.fM)(2,J.Gw),(0,z.fM)(3,eh.t),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===d.o?Object:d.o,"undefined"==typeof QuotaManager?Object:QuotaManager,void 0===J.Gw?Object:J.Gw,void 0===eh.t?Object:eh.t])],eT);let ek=r("47533"),eI=r("173726"),eP=r("703452"),eC=r("455828"),eM=r("658384");var ej=new class{get historyProjectList(){return[...this.localHistoryProjectList,...this.serverHistoryProjectList]}setHistoryProjectList(e){var t=e.filter(e=>e.isLocal),r=e.filter(e=>!e.isLocal);this.setLocalHistoryProjectList(t),this.setServerHistoryProjectList(r)}setServerHistoryProjectList(e){this.serverHistoryProjectList=[...e]}setLocalHistoryProjectList(e){this.localHistoryProjectList=[...e]}updateHistoryProject(e,t){this.localHistoryProjectList=this.localHistoryProjectList.map(r=>r.id!==e?r:(0,s._)((0,n._)({},r),{id:t.id,status:t.status,estimate_time:t.estimate_time,progress:t.progress,clip_count:t.clip_count,error_code:t.error_code,cover_url:t.cover_url||r.cover_url,capflow_key:t.capflow_key})),this.serverHistoryProjectList=this.serverHistoryProjectList.map(r=>r.id!==e?r:(0,s._)((0,n._)({},r),{id:t.id,status:t.status,estimate_time:t.estimate_time,progress:t.progress,clip_count:t.clip_count,error_code:t.error_code,cover_url:t.cover_url||r.cover_url,capflow_key:t.capflow_key}))}resetHistoryList(){this.serverHistoryProjectList=[],this.localHistoryProjectList=[]}setIsHistoryListFetching(e){this.isHistoryListFetching=e}constructor(){this.localHistoryProjectList=[],this.serverHistoryProjectList=[],this.isHistoryListFetching=!0,(0,Y.ky)(this)}};class eO{get historyProjectList(){return ej.historyProjectList}get isHistoryListFetching(){return ej.isHistoryListFetching}setHistoryProjectList(e){ej.setHistoryProjectList([...ej.historyProjectList,...e])}setIsUnmount(e){this.isUnmount=e}resetHistoryList(){ej.resetHistoryList()}setIsHistoryListFetching(e){ej.setIsHistoryListFetching(e)}constructor(e,t,r){this._mainLongToShortWidgetService=e,this.flowType=t,this._longToShortDataService=r,this.fetchHistoryCount=7,this.isUnmount=!1,this.startPollingUnreadyTask()}}eO=(0,z.gn)([(0,z.fM)(2,es.Dk),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===u.R?Object:u.R,"undefined"==typeof FlowType?Object:FlowType,void 0===es.Dk?Object:es.Dk])],eO),(v=M||(M={})).taskId="taskId",v.uploadId="uploadId",v.ttTranscodeId="ttTranscodeId";class eL extends eO{startPollingUnreadyTask(e){var t=this;return(0,a._)(function*(){var r,i=t.historyProjectList.filter(e=>[es.Kw.doing,es.Kw.uploading].includes(e.status)||e.status===es.Kw.success&&e.capflow_key===eI.gW.CapKeyForTT),o=[];yield Promise.all(i.map((r=(0,a._)(function*(r,i){var a,n,s=null==e?void 0:null===(a=e.find(e=>e.oldId===r.id))||void 0===a?void 0:a.newId,l={id:null!=s?s:r.id,idType:s||r.capflow_key!==eI.gW.CapKeyForTT?"taskId":"ttTranscodeId"},c=yield t._longToShortDataService.getHistoryItemInfo(l);c.ok&&c.value&&(c.value.related_id&&o.push({newId:null!==(n=c.value.related_id)&&void 0!==n?n:r.id,oldId:r.id}),[es.Kw.success,es.Kw.fail,es.Kw.uploadFail].includes(c.value.status)&&t._mainLongToShortWidgetService.quotaManager.fetchUserBenefit(),ej.updateHistoryProject(r.id,c.value))}),function(e,t){return r.apply(this,arguments)}))),yield(0,ek._)(1e4),t.startPollingUnreadyTask(o)})()}_generateUrl(e,t,r){var i=new URLSearchParams;return i.append("pageStatus",t),i.append("taskId",e),i.append("toolsEnterFrom","historyProject"),i.append("capflowKey",r||""),"".concat(location.origin).concat(eC.bZ[eM.lQ.LongToShort],"?").concat(i)}constructor(e,t,r,i){super(e,t,r),this._mainLongToShortWidgetService=e,this.flowType=t,this._longToShortDataService=r,this._commercialDataService=i,this.handleProjectClick=e=>{this._mainLongToShortWidgetService.loadingPageManager.setQueryCapflowKey(e.capflow_key),this._mainLongToShortWidgetService.loadingPageManager.importTaskId(e.id,e.status)}}}eL=(0,z.gn)([(0,z.fM)(2,es.Dk),(0,z.fM)(3,eP.h),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===u.R?Object:u.R,void 0===o.M?Object:o.M,void 0===es.Dk?Object:es.Dk,void 0===eP.h?Object:eP.h])],eL);let ex=r("980014"),eE=r("941366"),eR=r("619398");class eD{extraFrameAndCover(e){(0,ex.ZB)(this._mainLongToShortWidgetService.graphicToolkitService);var t=e.getModel(),r=(0,eE.nQ)(this._mainLongToShortWidgetService.resourceService,eR._g.UserVideo,t);(0,eE.AB)(r,this._mainLongToShortWidgetService.graphicToolkitService).then(e=>{var r,i=this._frameDataMap.get(null!==(r=t.md5)&&void 0!==r?r:"")||{},o=(0,s._)((0,n._)({},i),{sprites:e});(0,Y.z)(()=>{var e;this._frameDataMap.set(null!==(e=t.md5)&&void 0!==e?e:"",o),this._frameDataMap=new Map(this._frameDataMap)})}),(0,eE.Sx)(r).then(e=>{var r,i=this._frameDataMap.get(null!==(r=t.md5)&&void 0!==r?r:"")||{},o=(0,s._)((0,n._)({},i),{coverUrl:e.coverUrl});(0,Y.z)(()=>{var e;this._frameDataMap.set(null!==(e=t.md5)&&void 0!==e?e:"",o),this._frameDataMap=new Map(this._frameDataMap)})})}getSprites(e){var t=this;return(0,a._)(function*(){(0,ex.ZB)(t._mainLongToShortWidgetService.graphicToolkitService);var r,i,o=yield(0,eE.AB)(e,t._mainLongToShortWidgetService.graphicToolkitService),a=t._frameDataMap.get(null!==(i=null===(r=e.value)||void 0===r?void 0:r.md5)&&void 0!==i?i:"")||{};return(0,s._)((0,n._)({},a),{sprites:o})})()}get frameDataMap(){return this._frameDataMap}constructor(e,t){this._mainLongToShortWidgetService=e,this._stateManager=t,this._frameDataMap=new Map,(0,Y.ky)(this,{},{autoBind:!0})}}let eF=r("628316"),eA=r("143473"),eN=r("226603"),eU=r("963473"),eV=r("781440"),eW=r("369271");function eB(){return(eB=(0,a._)(function*(e){var t,r,i=Object.assign({},{waitForFirstRequest:!1,delay:0,retryTimes:0},e.fetchRetryOptions),o=(t=(0,a._)(function*(){var t=yield e.containerService.invokeFunction(t=>t.get(eV.b).getMaterialsByIds({workspaceId:e.fromWorkspaceId,assetIds:e.assetIds}));return t.ok&&t.value.length!==e.assetIds.length?(0,eU.wf)(-1,"found target assets failure"):t}),function(){return t.apply(this,arguments)}),n=(r=(0,a._)(function*(e){(0!==e||i.waitForFirstRequest)&&(yield(0,ek._)(i.delay));var t=yield o();return t.ok?t:e>=i.retryTimes?t:n(e+1)}),function(e){return r.apply(this,arguments)});try{var s=yield n(0);if(!s.ok)return s;var l=s.value.map(t=>(0,eW.Q)(t,{fromWorkspaceId:e.fromWorkspaceId,toWorkspaceId:e.toWorkspaceId,payinPayoutHelper:e.payinPayoutHelper,containerService:e.containerService,packageDelta:e.packageDelta}));return(0,eU.oW)(l)}catch(e){return(0,eU.wf)(-1,null==e?void 0:e.message)}})).apply(this,arguments)}let eZ=r("939051");var eG="CAPCUT_THEME",eH="smart-tools-cache";let ez=r("905141");(g=j||(j={}))[g.V2=2]="V2";class eq{save(){if((!this.stopSaving||!this._enableSave)&&(!this._mainLongToShortWidgetService.fileSelectionManager.uploadingMainMaterial||this._mainLongToShortWidgetService.fileSelectionManager.uploadingMainMaterial.status===eZ.a.Success)&&this._stateManager.pageLifeCycle!==ee.jp.DefaultEmpty){var e,t,r,i,{exportManager:o,stateManager:a,loadingPageManager:l,fileSelectionManager:c,settingPageManager:u}=this._mainLongToShortWidgetService,p={version:2,exportedVideoAsset:null==o?void 0:o.exportedVideoAsset,exportTaskId:null==o?void 0:o.exportTaskId,pageLifeCycle:a.pageLifeCycle===ee.jp.QuickEdit?ee.jp.PreviewResult:a.pageLifeCycle,taskId:l.taskId,pageStage:l.pageStage,exportFormData:(null==o?void 0:o.exportFormData)||(0,s._)((0,n._)({},ez.NT),{video_name:""}),smartToolType:d.o.LongToShort,uid:null===(e=this._accountService.userProfile)||void 0===e?void 0:e.uid,workspaceId:c.materialWorkspaceId,defaultWorkspaceId:c.getDefaultWorkspaceId(),mainMaterialId:null===(r=c.mainMaterial)||void 0===r?void 0:null===(t=r.getModel())||void 0===t?void 0:t.assetId,mainMaterialStatus:null===(i=c.mainMaterial)||void 0===i?void 0:i.status,loadingPageStoreJson:l.save(),settingPageStoreJson:u.save()};sessionStorage.setItem(eH,JSON.stringify(p))}}setStopSaving(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.stopSaving=e}restore(){if(this._enableSave){var e,t,r,i,o,a,n=(0,eN.D)(null!==(o=sessionStorage.getItem(eH))&&void 0!==o?o:"");if(n&&2===n.version&&n.pageLifeCycle!==ee.jp.DefaultEmpty){if(n.smartToolType!==d.o.LongToShort||n.defaultWorkspaceId!==(null===(e=null!==(a=null===(t=this._accountService.userProfile)||void 0===t?void 0:t.defaultSpaceInfo)&&void 0!==a?a:null===(r=this._accountService.userProfile)||void 0===r?void 0:r.spaceInfo)||void 0===e?void 0:e.workspaceId)||n.uid!==(null===(i=this._accountService.userProfile)||void 0===i?void 0:i.uid)){this.resetCache();return}var{exportManager:s,loadingPageManager:l,settingPageManager:c,previewPageManager:u}=this._mainLongToShortWidgetService;n.mainMaterialId&&this.restoreMainMaterialById(n.mainMaterialId,n.workspaceId||n.defaultWorkspaceId),this._mainLongToShortWidgetService.waitForIdleManagerInitial().then(()=>{s&&(s.exportTaskId=n.exportTaskId,s.exportedVideoAsset=n.exportedVideoAsset,s.exportFormData=n.exportFormData,[ee.jp.ExportLoading,ee.jp.Exported].includes(n.pageLifeCycle))&&s.exportFormData&&s.handleExport(s.exportFormData,{taskId:s.exportTaskId})}),l.taskId=n.taskId,l.restore(n.loadingPageStoreJson),c.restore(n.settingPageStoreJson);var{pageLifeCycle:p}=n;this.setLifeCycle(p)}}}resetCache(){sessionStorage.removeItem(eH)}setLifeCycle(e){this._stateManager.setLifeCycle(e)}ensureMaterialsTranscoded(e){return(0,a._)(function*(){var t=[];e.forEach(e=>{if(e.getModel().status===eZ.a.Transcoding){var r=new Promise((t,r)=>{e.onDidDone(()=>{t(!0)}),e.onTranscodeFailure(()=>{r(Error("failed to transcode."))})});t.push(r)}});try{return yield Promise.all(t),(0,eU.ly)()}catch(e){return(0,eU.wf)(-1,"ensure materials transcode fail",e)}})()}restoreMainMaterialById(e,t){var r=this;return(0,a._)(function*(){var[i,o]=(yield function(e){return eB.apply(this,arguments)}({assetIds:[e],fromWorkspaceId:t,toWorkspaceId:t,containerService:r._containerService})).pair();!i&&(yield r.ensureMaterialsTranscoded(o)).ok&&r._mainLongToShortWidgetService.fileSelectionManager.setMainMaterial(null==o?void 0:o[0])})()}constructor(e,t,r=!0,i,o){this._mainLongToShortWidgetService=e,this._stateManager=t,this._enableSave=r,this._accountService=i,this._containerService=o,this.stopSaving=!1}}eq=(0,z.gn)([(0,z.fM)(3,J.Gw),(0,z.fM)(4,eh.t),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",["undefined"==typeof IMainLongToShortWidgetService?Object:IMainLongToShortWidgetService,"undefined"==typeof StateManager?Object:StateManager,void 0,void 0===J.Gw?Object:J.Gw,void 0===eh.t?Object:eh.t])],eq);let eK=r("412121"),eQ=r("460198"),eJ=r("487748"),eY=r("204528");class eX{scheduleTaskPreload(e){this._taskIdSet.has(e)||(this._taskIdSet.add(e),this._taskQueue.add(()=>this.createTaskQueryTask(e)))}pausePreload(){this._taskQueue.pause()}startPreload(){this._taskQueue.start()}constructor(e){this._intelligentDataService=e,this._taskQueue=new eY.Z({concurrency:2,autoStart:!0}),this._taskIdSet=new Set;var t,r=this;this.createTaskQueryTask=(t=(0,a._)(function*(e){if(e){var t=(0,eJ.rY)((0,eJ.JN)(e));if(t)return t;yield new Promise(e=>{requestIdleCallback(e)});var i=r._intelligentDataService.createLongToShortTaskQueryTask({workspaceId:"",smartToolType:eQ.no.LongToShort,taskId:e,scene:void 0,region:void 0,hasLogin:!0,platform:void 0,assetId:void 0,reqJson:void 0});return new Promise((t,r)=>{i.onSuccess(r=>{(0,eJ.mf)((0,eJ.JN)(e),r),t(r)}),i.onError(e=>{r(e)})})}}),function(e){return t.apply(this,arguments)}),(0,Y.rC)(this)}}eX=(0,z.gn)([(0,z.fM)(0,eI.SG),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===eI.SG?Object:eI.SG])],eX);let e$=r("202659"),e0=r("548946");r("822289");let e1=r("5622");(h=O||(O={})).generatePortrait="/magic-tools/generate-portrait",h.stylizePhoto="/magic-tools/stylize-photo",h.aiRestore="/magic-tools/ai-restore",h.autocut="/editor-tools/autocut",h.longVideoToShorts="/editor-tools/long-video-to-shorts";var e2=e=>({"/magic-tools/generate-portrait":eu.oc.t("portrait_generator_not_available",{},"Portrait generator is currently not available in your country or region"),"/magic-tools/stylize-photo":eu.oc.t("image_style_transfer_not_available",{},"Image style transfer is currently not available in your country or region"),"/magic-tools/ai-restore":eu.oc.t("old_photo_restoration_not_available",{},"Old photo restoration is currently not available in your country or region"),"/editor-tools/autocut":eu.oc.t("autocut_not_available",{},"AutoCut is currently not available in your country or region"),"/editor-tools/long-video-to-shorts":eu.oc.t("long_to_shorts_not_available",{},"Long video to shorts is currently not available in your country or region")})[e]||eu.oc.t("long_to_shorts_not_available",{},"Long video to shorts is currently not available in your country or region");function e6(){if(!["/magic-tools/generate-portrait","/magic-tools/stylize-photo","/magic-tools/ai-restore","/editor-tools/autocut","/editor-tools/long-video-to-shorts"].includes(location.pathname))return!1;e1.Z.info({title:e2(location.pathname),maskClosable:!1,onOk:()=>{location.href=globalThis.xssNamespace["lvweb/smart-tools"].filterUrl("".concat(location.origin,"/").concat(location.search),null,{logType:"js.href/src",mode:"black",reportOnly:"all"})},wrapStyle:{zIndex:999999,backgroundColor:"var(--lvv-color-black-06)"},okText:eu.oc.t("web_smart_tools_btn_got_it",{},"OK"),closable:!1})}(f=L||(L={})).Free="tool_long2short_free",f.Vip="tool_long2short_vip";class e3{fetchUserBenefit(e){var t=this;return(0,a._)(function*(){t.getQuotaFailed=!1;var r,i,o,a,n,s,l,c=yield t._commercialDataService.batchGetUserBenefit({benefitCategory:["tool_long2short"]});if(!c.ok){t.getQuotaFailed=!0,t._slardarAdapterService.captureException("batch_get_user_benefit_err",Error(JSON.stringify(c)));return}var{benefit_list:u}=c.value.data;t.userBenefit=u;var d=u.find(e=>"tool_long2short_free"===e.benefit_type),p=u.find(e=>"tool_long2short_vip"===e.benefit_type),v=null!==(r=null==p?void 0:p.quota_left)&&void 0!==r?r:0,g=null!==(i=null==d?void 0:d.quota_left)&&void 0!==i?i:0;t.quotaInfo={freeMin:(null==p?void 0:p.flag)?g-v:g,freeTotal:null!==(o=null==d?void 0:d.quota_all)&&void 0!==o?o:0,proMin:(null==p?void 0:p.flag)?v:0,proTotal:null!==(a=null==p?void 0:p.quota_all)&&void 0!==a?a:0,proValidAmount:null!==(n=null==p?void 0:p.valid_amount)&&void 0!==n?n:0,freeEndTime:null!==(s=null==d?void 0:d.end_time)&&void 0!==s?s:0,proEndTime:null!==(l=null==p?void 0:p.end_time)&&void 0!==l?l:0},e&&p&&t._stateManager.updateIsVip(p.flag)})()}constructor(e,t,r,i){this._stateManager=e,this._commercialDataService=t,this._containerService=r,this._slardarAdapterService=i,this.getQuotaFailed=!1,this.quotaInfo={freeMin:0,proMin:0,freeTotal:0,proTotal:0,proValidAmount:0,freeEndTime:0,proEndTime:0},(0,Y.rC)(this),this.userBenefit=void 0}}(0,z.gn)([Y.LO,(0,z.w6)("design:type",Object)],e3.prototype,"userBenefit",void 0),(0,z.gn)([Y.LO,(0,z.w6)("design:type",Boolean)],e3.prototype,"getQuotaFailed",void 0),(0,z.gn)([Y.LO,(0,z.w6)("design:type","undefined"==typeof IQuotaInfo?Object:IQuotaInfo)],e3.prototype,"quotaInfo",void 0),e3=(0,z.gn)([(0,z.fM)(1,eP.h),(0,z.fM)(2,eh.t),(0,z.fM)(3,el.L),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===ee.O3?Object:ee.O3,void 0===eP.h?Object:eP.h,void 0===eh.t?Object:eh.t,void 0===el.L?Object:el.L])],e3);let e4=r("254128"),e9=r("649183"),e7=r("849416"),e5=r("806705"),e8=r("526599");class te{getEventParams(){return(0,n._)({},this._params)}constructor(e){this._params=e,this.eventName="long_to_short_init"}}function tt(e,t){(0,e8.K)(e,te,[t])}let tr=r("65746"),ti=r("273508");class to{getAndSetAbTestVar(){var e,t,r,i;this.enableLongToShortTrim=null!==(e=this._configurationService.abTestManager.getBooleanAbTestValue("enable_long_to_short_trim",!1))&&void 0!==e&&e,this.enableLongToShortLayout=null!==(t=this._configurationService.abTestManager.getBooleanAbTestValue("enable_long_to_short_layout",!1))&&void 0!==t&&t,this.enableLongToShortSubtitleOpt=null!==(r=this._configurationService.abTestManager.getBooleanAbTestValue("enable_long_to_short_subtitle_opt",!1))&&void 0!==r&&r,this.enableLongToShortPreviewCaptionText=null!==(i=this._configurationService.abTestManager.getBooleanAbTestValue("enable_long_to_short_preview_caption_text",!1))&&void 0!==i&&i}initIdleManager(){var e=this;return(0,a._)(function*(){try{var t=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,57661)).then(e=>e.PreviewPageManager),i=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,916371)).then(e=>e.ExportFilmTaskManager),o=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,512641)).then(e=>e.VideoDraftManager),a=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,979933)).then(e=>e.QuickEditManager),n=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,452153)).then(e=>e.ExportManager),s=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,830621)).then(e=>e.PlayerManager);yield Promise.all([t,i,o,a,n,s]),e.previewPageManager=e._containerService.createInstance((yield t)),e.exportFilmTaskManager=e._containerService.createInstance((yield i)),e.videoDraftManager=e._containerService.createInstance((yield o)),e.playerManager=e._containerService.createInstance((yield s)),e.quickEditManager=e._containerService.createInstance((yield a),e.extraFrameManager,e.materialManager,e.stateManager,e.videoDraftManager,e.previewPageManager,e.playerManager),e.exportManager=e._containerService.createInstance((yield n),e.loadingPageManager,e.previewPageManager,e.stateManager,e.quickEditManager,e.videoDraftManager),e.quickEditManager.onEditorSdkReady(t=>{var r,{renderSdk:i}=t;null===(r=e.playerManager)||void 0===r||r.setRenderSdk(i)}),e.quickEditManager.onExitEdit(t=>{var r,i;null===(r=e.playerManager)||void 0===r||r.unmount(),null===(i=e.previewPageManager)||void 0===i||i.setNeedUpdateByTaskId(t.resourceId,!0)}),e.quickEditManager.onEnterEdit(t=>{var r;null===(r=e.playerManager)||void 0===r||r.updateDuration(BigInt(t.video.duration)*BigInt(1e6))}),e.quickEditManager.onDraftLoadStageChange(t=>{if(t.stage===tr.Hv.Finished){var r,i,o,a=null===(i=e.quickEditManager)||void 0===i?void 0:null===(r=i.dataSdk)||void 0===r?void 0:r.draftView.getDuration();a&&(null===(o=e.playerManager)||void 0===o||o.updateDuration(a))}}),e.isIdleManagerInitial=!0}catch(e){throw Error("long-to-short-service: manager init error")}})()}waitForIdleManagerInitial(){var e=this;return(0,a._)(function*(){return!!e.isIdleManagerInitial||(yield(0,ek._)(100),e.waitForIdleManagerInitial())})()}resetToEmpty(){var e,t;this.fileSelectionManager.reset(),this.loadingPageManager.reset(),this.loadingPageManager.resetPageStage(),this.settingPageManager.reset(),null===(e=this.previewPageManager)||void 0===e||e.reset(),this.persistedManager.resetCache(),null===(t=this.ttLiveVideoManager)||void 0===t||t.reset(),this.stateManager.setLifeCycle(ee.jp.DefaultEmpty)}get graphicToolkitService(){return this._graphicToolkitService}get slardarAdapterService(){return this._slardarAdapterService}handleRedirect(){var e=this;return(0,a._)(function*(){var t,r=(t=(0,a._)(function*(e){try{var t=yield e.aiCheckPopup();if(t.ok)return!t.value;return!1}catch(e){return!1}}),function(e){return t.apply(this,arguments)}),i=yield r(e._aiToolDataService);return i||(e.stateManager.doNotBlockWindowClose=!0,e6()),i})()}setUploadingMainMaterial(e){this.fileSelectionManager.uploadMaterialFailed=!1,this.fileSelectionManager.setUploadingMainMaterial(e),this.stateManager.doNotBlockWindowClose=!1}handleUploadFailure(e){this.fileSelectionManager.uploadMaterialFailed=!1}afterInit(){var e,t,r,i,o,a,n,s,l,c,u=null!==(n=null===(t=performance.getEntriesByName("first-contentful-paint"))||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.startTime)&&void 0!==n?n:0,d=null!==(s=null===(i=performance.getEntriesByName("first-paint"))||void 0===i?void 0:null===(r=i[0])||void 0===r?void 0:r.startTime)&&void 0!==s?s:0,p={webReady:performance.now(),webFcp:u,webFp:d,webOrigin:performance.timeOrigin,webInitUserStart:null!==(l=null===(o=window.__smartToolsPerfTime)||void 0===o?void 0:o.webInitUserStart)&&void 0!==l?l:0,webInitUserEnd:null!==(c=null===(a=window.__smartToolsPerfTime)||void 0===a?void 0:a.webInitUserEnd)&&void 0!==c?c:0};tt(this._containerService,p),this._slardarAdapterService.sendEvent("long_to_short_init",p)}constructor(e,t,r,i,a,n){this._containerService=e,this.resourceService=t,this._aiToolDataService=i,this._slardarAdapterService=a,this._configurationService=n,this.isIdleManagerInitial=!1,this.enableLongToShortTrim=!1,this.enableLongToShortLayout=!1,this.enableLongToShortSubtitleOpt=!1,this.enableLongToShortPreviewCaptionText=!1,this.handleThirdPartyMaterialBeforeCreated=(e,t)=>{var r,i=e[0];this.settingPageManager.resetVideoCropInfo(),this.fileSelectionManager.updateCancelUploadingMaterial(),this.fileSelectionManager.setSupportQuickTranscode(!1),null===(r=this.ttLiveVideoManager)||void 0===r||r.reset(),this.fileSelectionManager.setRawMaterialInfo(void 0),this.setUploadingMainMaterial(i),this.fileSelectionManager.setSupportQuickPlay(!1),this.fileSelectionManager.setIsFromLocalFile(!1),this.stateManager.setLifeCycle(ee.jp.DefaultEmpty),this.fileSelectionManager.setMaterialImportType("click_add"),(0,e$.z)(this._containerService,{action:"import",importType:"click_add",importSource:t})},this.handleThirdPartyMaterialCreated=e=>{var{material:t}=e;t.onUploadFailure(()=>{this.handleUploadFailure(t)}),t.onResourceReady(()=>{var e;!this.fileSelectionManager.uploadingMainMaterial||this.fileSelectionManager.cancelUploadingMaterial.includes(null===(e=t.getModel())||void 0===e?void 0:e.id)||(this.setUploadingMainMaterial(void 0),this.fileSelectionManager.setMainMaterial(t))})},this.cacheManager=e.createInstance(ea,{}),this.stateManager=e.createInstance(ee.O3),this.quotaManager=e.createInstance(e3,this.stateManager),this.ttLiveVideoManager=this._containerService.createInstance(ed),this.ttVideoSpritesManager=e.createInstance(eg,this.ttLiveVideoManager),this.vipManager=e.createInstance(eT,d.o.LongToShort,this.quotaManager),this.uploadPageManager=e.createInstance(eL,this,o.M.WEB),this.extraFrameManager=e.createInstance(eD,this,this.stateManager),this.fileSelectionManager=e.createInstance(eF.dj,this,this.stateManager),this.loadingPageManager=e.createInstance(eA.Gw,this,this.quotaManager),this.persistedManager=e.createInstance(eq,this,this.stateManager,!0),this.settingPageManager=e.createInstance(ep.T),this.resultCoverLoadManager=e.createInstance(eK.l),this.materialManager=e.createInstance(e7.P,{accept:["video"],countLimit:1,currentPage:"smart_tool_page",toolType:"clip_shorts",onBeforeCreated:this.handleThirdPartyMaterialBeforeCreated,onCreated:this.handleThirdPartyMaterialCreated}),this.taskPreloadManager=e.createInstance(eX),r.getInstance(new e0._y).then(e=>{this._graphicToolkitService=e}),this.initIdleManager(),(0,eJ.Yb)(),this.getAndSetAbTestVar()}}to=(0,z.gn)([(0,z.fM)(0,eh.t),(0,z.fM)(1,e4.c),(0,z.fM)(2,e5.r),(0,z.fM)(3,e9.H),(0,z.fM)(4,el.L),(0,z.fM)(5,ti.u),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===eh.t?Object:eh.t,void 0===e4.c?Object:e4.c,void 0===e5.r?Object:e5.r,void 0===e9.H?Object:e9.H,void 0===el.L?Object:el.L,void 0===ti.u?Object:ti.u])],to);let ta=r("556625"),tn=r("707152"),ts=r("478705"),tl=r("963730"),tc=r("714269"),tu=r("656322"),td=r("602766"),tp=r("189619"),tv=r("394483"),tg=r("776938"),th=r("542631"),tf=r("182480"),t_=r("446176");(_=x||(x={}))[_.Processing=1]="Processing",_[_.Success=2]="Success",_[_.Fail=3]="Fail",_[_.NotFound=4]="NotFound";class tm extends q.JT{get error(){return this._error}get status(){return this._smartTaskStatus}get value(){return this._result}get taskParams(){return this._taskParams}_handleBenefit(){var e,t,r,i;(null===(t=this._result)||void 0===t?void 0:null===(e=t.benefitDetail)||void 0===e?void 0:e.status)===x.Fail&&(null===(r=this._result)||void 0===r?void 0:r.benefitDetail.code)&&(this._smartTaskStatus=tf.y.Failure,this._error=(0,eU.wf)(null===(i=this._result)||void 0===i?void 0:i.benefitDetail.code,"benefit task failed"),this._onError.fire(this._error,this._result))}_getTaskProgress(){var e=this;return(0,a._)(function*(){var t=yield e._intelligentRepository.getIntelligentTask({platform:e._taskParams.platform,task_id:e._taskParams.taskId,workspace_id:e._taskParams.workspaceId,tmp_id:e._taskParams.tmpId,app_id:t_.k,scene:e._taskParams.scene,region:e._taskParams.region,smart_tool_type:e._taskParams.smartToolType},e._taskParams.urlParams);if(t.ok){e._getTaskProgressErrorCount=0;var r=t.value.status;r===x.Processing?(e._smartTaskStatus=tf.y.Process,e._result={taskId:e._taskParams.taskId,speed:t.value.speed,taskDetails:[],benefitDetail:t.value.benefit_detail,resourceId:"",resourceName:"",originWorkspaceId:t.value.origin_workspace_id,originSpaceId:t.value.origin_space_id,originResourceName:t.value.origin_resource_name,estimateTime:t.value.estimate_time},e._onProgress.fire({progress:Math.min(99,t.value.speed),status:e._smartTaskStatus}),e._handleBenefit()):r===x.Success?(e._smartTaskStatus=tf.y.Success,e._setResult(t.value),e._onSuccess.fire(e._result)):(e._smartTaskStatus=tf.y.Failure,e._setResult(t.value),e._error=(0,eU.wf)(th.v.Failure,"intelligent task failed"),e._onError.fire(e._error,e._result))}else e._getTaskProgressErrorCount++;(![0,-1].includes(Number(t.code))||e._getTaskProgressErrorCount>=3)&&(e._smartTaskStatus=tf.y.Failure,e._error=(0,eU.wf)(t.code,t.msg),e._onError.fire(e._error,e._result))})()}_setResult(e){var t,r;this._result={taskId:this._taskParams.taskId,speed:e.speed,benefitDetail:e.benefit_detail,taskDetails:e.task_detail.map(e=>this._convertDetail(e)),resourceId:null===(t=e.task_detail[0])||void 0===t?void 0:t.resource_id,resourceName:null===(r=e.task_detail[0])||void 0===r?void 0:r.resource_name,originWorkspaceId:null==e?void 0:e.origin_workspace_id,originSpaceId:null==e?void 0:e.origin_space_id,originResourceName:null==e?void 0:e.origin_resource_name}}_convertDetail(e){var t,r,i,o,a,s,{recommend_info:l,event_info:c}=e;return(null===(t=this._config)||void 0===t?void 0:t.disableIntelligentCover)&&(e.preview_info.cover_url=e.preview_info.original_cover||e.preview_info.cover_url),{md5:e.md5,vid:e.resource_id,transcodeVideoInfos:null!==(o=null===(r=e.transcode_video_infos)||void 0===r?void 0:r.map(e=>({defination:e.defination,encryptId:e.encrypt_id,key:e.key,storeUri:e.store_uri,url:e.url})))&&void 0!==o?o:[],transcodePreviewInfos:e.transcodePreviewInfos,thumbInfo:e.thumbInfo,resource_name:e.resource_name,transcodeImageInfos:null!==(a=null===(i=e.transcode_image_infos)||void 0===i?void 0:i.map(e=>({defination:e.defination,encryptId:e.encrypt_id,key:e.key,storeUri:e.store_uri,url:e.url})))&&void 0!==a?a:[],taskId:e.task_id,title:e.title,draftInfo:e.draft_info,extraDraftInfo:e.extra_draft_info,previewInfo:e.preview_info,width:e.width,height:e.height,video:e.video,resourceId:e.resource_id,eventInfo:c?(0,n._)({},c,null!==(s=c.event_map)&&void 0!==s?s:{}):void 0,recommendInfo:l?{recommendationScore:l.recommendation_score,recommendationReason:l.recommendation_reason,recommendationTag:l.recommendation_tag}:void 0,track_info:e.track_info,audioText:e.audio_text}}_startPollingProgress(){var e=this;return(0,a._)(function*(){if(yield e._getTaskProgress(),e._smartTaskStatus===tf.y.Process&&!e._canceled){var t;setTimeout(()=>{e._startPollingProgress()},null!==(t=e._taskParams.pollingInterval)&&void 0!==t?t:5e3)}})()}cancel(){this._canceled||(this._canceled=!0,this._onCancel.fire(),this._onProgress.dispose(),this._onError.dispose(),this._onSuccess.dispose())}constructor(e,t,r){super(),this._intelligentRepository=e,this._taskParams=t,this._config=r,this._onProgress=this._store.add(new ef.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new ef.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new ef.Q),this.onSuccess=this._onSuccess.event,this._onCancel=this._store.add(new ef.Q),this.onCancel=this._onCancel.event,this._smartTaskStatus=tf.y.Process,this._getTaskProgressErrorCount=0,this._error=(0,eU.ly)(),this._canceled=!1,this._startPollingProgress()}}let ty=r("327736"),tb=r("243307"),tw=r("669403"),tS=r("89772"),tT=r("816752"),tk=r("618230"),tI=r("950403"),tP=r("530487"),tC=r("955406");class tM{_createTaskApi(){return"".concat(tT._L.getVar("web_domain")).concat(tI.b.CREATE_INTELLIGENT_TASK_LONG_TO_SHORT_FOR_PC)}_getTaskDetailApi(){return"".concat(tT._L.getVar("web_domain")).concat(tI.b.GET_INTELLIGENT_TASK_DETAIL_LONG_TO_SHORT_FOR_PC)}_getTTTaskDetailApi(){return"".concat(tT._L.getVar("web_domain")).concat(tI.b.GET_INTELLIGENT_TASK_DETAIL_LONG_TO_SHORT_FOR_TT)}get _networkClient(){if(!this._networkClientInstance){var e,t;this._networkClientInstance=(e=this._disabledRetry,t=new ty.yk().build({headers:{"Content-Type":"application/json"}}),(0,tb.Y)(t),(0,tw.i3)(t),(0,tS.mH)(t),e||(0,tk.V)(t),t)}return this._networkClientInstance}createIntelligentTask(e,t){var r=this;return(0,a._)(function*(){try{var i=JSON.stringify(e),o=r._cacheTaskReqMap.get(i);if(!o){var a=r._getCreateTaskPcParam(e);o=r._networkClient.post(r._createTaskApi(),(0,n._)({},a),{params:(0,n._)({region:e.region},t),withCredentials:!0}).finally(()=>{r._cacheTaskReqMap.delete(i)}),r._cacheTaskReqMap.set(i,o)}var s=yield o;if("0"!==s.ret)return(0,eU.wf)(Number(s.ret),s.errmsg);var l={data:{task_id:s.data.capflow.id},ret:s.ret,log_id:s.log_id,errmsg:s.errmsg};return(0,eU.oW)(l)}catch(e){return(0,tP.m)(e,-1,"createIntelligentTask api error.")}})()}getIntelligentTask(e,t){var r=this;return(0,a._)(function*(){try{var i=r._getQueryTaskPcParams(e),o=yield r._networkClient.post(r._getTaskDetailApi(),(0,n._)({},i),{withCredentials:!0,params:t});if("0"!==o.ret)return(0,eU.wf)(Number(o.ret),o.errmsg);var a=e.isTTTranscode?r._transTTQueryResToIntelligentData(o):r._transPcQueryResToIntelligentData(o,e);return(0,eU.oW)(a)}catch(e){return(0,tP.m)(e,-1,"getIntelligentTaskDetail api error.")}})()}_getCreateTaskPcParam(e){if(e.smart_tool_type===tC.lQ.Long2Short){var t,r,i,o,a,n,s,l,c,u=JSON.parse(null!==(s=e.params)&&void 0!==s?s:"{}");return{cap_json:{material:{duration:(null!==(l=u.source_duration)&&void 0!==l?l:0)*1e3,format:"assetID",source:null!==(c=null===(t=e.extra_map)||void 0===t?void 0:t.source)&&void 0!==c?c:"",storage:"everphoto",time_range:{end_time:(u.duration+u.start_time)*1e3,start_time:1e3*u.start_time},type:"video",video_meta_data:{asset_id:e.asset_id,duration_type:u.target_duration,material_name:u.video_name,need_delete:u.expire,uid:e.uid,workspace_id:e.workspace_id},custom_info:{resource_id:u.resource_id},extra_map:{tt_vid_type:null===(r=e.extra_map)||void 0===r?void 0:r.tt_vid_type,tt_appid:null===(i=e.extra_map)||void 0===i?void 0:i.tt_appid,upload_source:null===(o=e.extra_map)||void 0===o?void 0:o.upload_source}},scene:"video2audio",related_cap_key:null===(a=e.extra_map)||void 0===a?void 0:a.related_cap_key},cap_key:null===(n=e.extra_map)||void 0===n?void 0:n.cap_key}}return e}_getQueryTaskPcParams(e){return e.smart_tool_type===tC.lQ.Long2Short?{id:e.task_id,need_compatible_cfg:{audio_text:!0}}:e}_transTTQueryResToIntelligentData(e){var t,r,i,o,a,n,s,l,c,u,d,p,v={1:th.v.Process,2:th.v.ProgressSuccess,3:th.v.Failure},g=Number(new Date)-(null!==(p=null==e?void 0:null===(s=e.data)||void 0===s?void 0:null===(n=s.capflow)||void 0===n?void 0:n.start_time)&&void 0!==p?p:Number(new Date)),h=(null===(t=e.data.capflow)||void 0===t?void 0:t.end_time)&&(null===(i=e.data.capflow)||void 0===i?void 0:null===(r=i.resp_json)||void 0===r?void 0:r.related_capflow_id)?0:Math.max(0,null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(o=a.capflow)||void 0===o?void 0:o.forecast_cost),f=(null==e?void 0:null===(c=e.data)||void 0===c?void 0:null===(l=c.capflow)||void 0===l?void 0:l.start_time)?Math.floor(g/(g+h)*100):0;return{progress:f=f>0?Math.min(99,f):0,status:v[e.data.capflow.status]||th.v.Success,speed:f,related_capflow_id:null===(d=e.data.capflow)||void 0===d?void 0:null===(u=d.resp_json)||void 0===u?void 0:u.related_capflow_id,task_detail:[],resource_id:"",resource_name:"",origin_resource_name:"",origin_workspace_id:"",origin_space_id:"",capflow_key:e.data.capflow.key,estimate_time:this._msToSecond(h),_meta:{log_id:e.log_id}}}_transPcQueryResToIntelligentData(e,t){var r,i,o,a,n,s,l,c,u,d,p,v,g,h,f,_,m,y,b,w,S,T,k,I,P,C,M,j,O,L,x={1:th.v.Process,2:th.v.ProgressSuccess,3:th.v.Failure},E=null==e?void 0:null===(s=e.data)||void 0===s?void 0:null===(n=s.capflow)||void 0===n?void 0:n.nodes.find(e=>"pack_draft"===e.key),R=null==e?void 0:null===(c=e.data)||void 0===c?void 0:null===(l=c.capflow)||void 0===l?void 0:l.nodes.find(e=>"commerce_benefit"===e.key),D=Number(new Date)-(null!==(P=null==e?void 0:null===(d=e.data)||void 0===d?void 0:null===(u=d.capflow)||void 0===u?void 0:u.start_time)&&void 0!==P?P:Number(new Date)),F=(null==e?void 0:null===(i=e.data)||void 0===i?void 0:null===(r=i.capflow)||void 0===r?void 0:r.end_time)?0:Math.max(0,null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(o=a.capflow)||void 0===o?void 0:o.forecast_cost),A=(null==e?void 0:null===(v=e.data)||void 0===v?void 0:null===(p=v.capflow)||void 0===p?void 0:p.start_time)?Math.floor(D/(D+F)*100):0;return{progress:A=A>0?Math.min(99,A):0,status:x[e.data.capflow.status]||th.v.Success,speed:A,benefit_detail:{id:null!==(C=null==R?void 0:null===(f=R.resp_json)||void 0===f?void 0:null===(h=f.material)||void 0===h?void 0:null===(g=h.extra_map)||void 0===g?void 0:g.commerce_history_id)&&void 0!==C?C:"",status:null!==(M=null==R?void 0:R.status)&&void 0!==M?M:th.v.Success,code:null!==(j=null==R?void 0:R.code)&&void 0!==j?j:0},task_detail:(null==E?void 0:null===(_=E.resp_json)||void 0===_?void 0:_.pack_material_list.filter(e=>!!e).map(e=>{var r,i,o,a,n,s,l,c;return{transcode_audio_info:[],md5:e.video_meta_data.md5,resource_id:e.video_meta_data.md5,resource_name:e.description,task_id:t.task_id,title:e.description,draft_info:{draft_key:e.draft_meta_data.draft_key,package_id:e.draft_meta_data.package_id},extra_draft_info:e.extra_draft_meta_data?{draft_key:e.extra_draft_meta_data.draft_key,package_id:e.extra_draft_meta_data.package_id}:void 0,preview_info:{play_url:e.draft_meta_data.preview_result.preview_uri,cover_url:e.draft_meta_data.preview_result.preview_cover,original_cover:e.draft_meta_data.preview_result.original_cover},event_info:{task_language:e.extra_map.task_language,task_type:e.extra_map.task_type,video_duration:e.time_range.end_time-e.time_range.start_time,event_map:{target_duration:null===(r=JSON.parse(e.extra_map.event_info||"{}"))||void 0===r?void 0:r.target_duration,task_video_category:null===(i=JSON.parse(e.extra_map.video_content_type||"{}"))||void 0===i?void 0:i.category,task_video_subcategory:null===(o=JSON.parse(e.extra_map.video_content_type||"{}"))||void 0===o?void 0:o.sub_category,upload_source:e.extra_map.upload_source},is_change_time:e.extra_map.is_change_time?Number(e.extra_map.is_change_time):void 0,is_smart_crop:e.extra_map.is_smart_crop?Number(e.extra_map.is_smart_crop):void 0,is_human_subject:e.extra_map.is_human_subject?Number(e.extra_map.is_human_subject):void 0,material_resolution:e.extra_map.material_resolution,original_layout_style:e.extra_map.original_layout_style},video:{duration:this._msToSecond(e.time_range.end_time-e.time_range.start_time),start_time:this._msToSecond(e.time_range.start_time),end_time:this._msToSecond(e.time_range.end_time),reverse_start_time:e.time_range.reverse_start_time,reverse_end_time:e.time_range.reverse_end_time},recommend_info:{recommendation_score:null===(a=JSON.parse(e.extra_map.reco_info||"{}"))||void 0===a?void 0:a.reco_score,recommendation_reason:null===(n=JSON.parse(e.extra_map.reco_info||"{}"))||void 0===n?void 0:n.reco_reason,recommendation_tag:null===(s=JSON.parse(e.extra_map.reco_info||"{}"))||void 0===s?void 0:s.reco_tag},track_info:null===(l=e.extra_map)||void 0===l?void 0:l.track_info,audio_text:null===(c=e.audio_meta_data)||void 0===c?void 0:c.audio_text}}))||[],resource_id:null!==(O=null==E?void 0:null===(m=E.resp_json)||void 0===m?void 0:m.pack_material_list[0].video_meta_data.md5)&&void 0!==O?O:"",resource_name:null!==(L=null==E?void 0:null===(y=E.resp_json)||void 0===y?void 0:y.pack_material_list[0].description)&&void 0!==L?L:"",estimate_time:this._msToSecond(F),origin_resource_name:(null==E?void 0:null===(w=E.resp_json)||void 0===w?void 0:null===(b=w.source_material)||void 0===b?void 0:b.material_name)||"",origin_workspace_id:(null==E?void 0:null===(T=E.resp_json)||void 0===T?void 0:null===(S=T.source_material)||void 0===S?void 0:S.workspace_id)||"",origin_space_id:(null==E?void 0:null===(I=E.resp_json)||void 0===I?void 0:null===(k=I.source_material)||void 0===k?void 0:k.space_id)||"",capflow_key:e.data.capflow.key,_meta:{log_id:e.log_id}}}_msToSecond(e){return Math.floor(e/1e3)}constructor(e){this._cacheTaskReqMap=new Map,this._disabledRetry=e}}class tj extends q.JT{get error(){return this._error}get status(){return this._smartTaskStatus}get value(){return this._result}get taskParams(){return this._taskParams}_getTaskProgress(){var e=this;return(0,a._)(function*(){var t=yield e._intelligentRepository.getIntelligentTask({isTTTranscode:!0,platform:e._taskParams.platform,task_id:e._taskParams.taskId,workspace_id:e._taskParams.workspaceId,tmp_id:e._taskParams.tmpId,app_id:t_.k,scene:e._taskParams.scene,region:e._taskParams.region,smart_tool_type:e._taskParams.smartToolType},e._taskParams.urlParams);if(t.ok){e._getTaskProgressErrorCount=0;var r=t.value.status;r!==x.Processing&&(r!==x.Success||t.value.related_capflow_id)?r===x.Success&&t.value.related_capflow_id?(e._smartTaskStatus=tf.y.Success,e._setResult(t.value),e._onSuccess.fire(e._result)):(e._smartTaskStatus=tf.y.Failure,e._setResult(t.value),e._error=(0,eU.wf)(th.v.Failure,"intelligent task failed"),e._onError.fire(e._error,e._result)):(e._smartTaskStatus=tf.y.Process,e._setResult(t.value),e._onProgress.fire({progress:Math.min(99,t.value.speed),status:e._smartTaskStatus}))}else e._getTaskProgressErrorCount++;(![0,-1].includes(Number(t.code))||e._getTaskProgressErrorCount>=3)&&(e._smartTaskStatus=tf.y.Failure,e._error=(0,eU.wf)(t.code,t.msg),e._onError.fire(e._error,e._result))})()}_setResult(e){var t,r,i;this._result={estimateTime:null!==(t=e.estimate_time)&&void 0!==t?t:0,speed:e.speed,relatedCapflowId:null!==(r=e.related_capflow_id)&&void 0!==r?r:"",taskId:this._taskParams.taskId,originResourceName:null!==(i=e.origin_resource_name)&&void 0!==i?i:""}}_startPollingProgress(){var e=this;return(0,a._)(function*(){if(yield e._getTaskProgress(),e._smartTaskStatus===tf.y.Process&&!e._canceled){var t;setTimeout(()=>{e._startPollingProgress()},null!==(t=e._taskParams.pollingInterval)&&void 0!==t?t:5e3)}})()}cancel(){this._canceled||(this._canceled=!0,this._onCancel.fire(),this._onProgress.dispose(),this._onError.dispose(),this._onSuccess.dispose())}constructor(e,t){super(),this._intelligentRepository=e,this._taskParams=t,this._onProgress=this._store.add(new ef.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new ef.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new ef.Q),this.onSuccess=this._onSuccess.event,this._onCancel=this._store.add(new ef.Q),this.onCancel=this._onCancel.event,this._smartTaskStatus=tf.y.Process,this._getTaskProgressErrorCount=0,this._error=(0,eU.ly)(),this._canceled=!1,this._startPollingProgress()}}class tO extends q.JT{createLongToShortTask(e,t){var r=this;return(0,a._)(function*(){var i=yield r._intelligentRepositoryWithoutRetry.createIntelligentTask({uid:r._capcutAccountService.uniqueId,platform:e.platform,asset_id:e.assetId,workspace_id:e.workspaceId,tmp_id:e.tmpId,smart_tool_type:e.smartToolType,req_json:e.reqJson,is_from_editor:!0,params:e.params,region:r._capcutAccountService.userProfile.region,extra_map:{cap_key:e.capKey||eI.gW.CapKeyForWeb,related_cap_key:""}},t);return i.ok?(0,eU.oW)(new tm(r._intelligentRepositoryWithoutRetry,(0,s._)((0,n._)({},e),{taskId:i.value.data.task_id,region:r._capcutAccountService.userProfile.region,scene:e.scene,hasLogin:r._capcutAccountService.hasLogin,urlParams:t}),{disableIntelligentCover:r.disableIntelligentCover})):i})()}createLongToShortTaskQueryTask(e,t){return new tm(this._intelligentRepositoryWithoutRetry,(0,s._)((0,n._)({},e),{urlParams:t}),{disableIntelligentCover:this.disableIntelligentCover})}createTTTranscodeTask(e,t){var r=this;return(0,a._)(function*(){var i=yield r._intelligentRepositoryWithoutRetry.createIntelligentTask({uid:r._capcutAccountService.uniqueId,platform:e.platform,asset_id:e.assetId,workspace_id:e.workspaceId,tmp_id:e.tmpId,smart_tool_type:e.smartToolType,req_json:e.reqJson,is_from_editor:!0,params:e.params,region:r._capcutAccountService.userProfile.region,extra_map:(0,n._)({cap_key:eI.gW.CapKeyForTT,related_cap_key:eI.gW.CapKeyForWeb},e.extraMap)},t);return i.ok?(0,eU.oW)(new tj(r._intelligentRepositoryWithoutRetry,(0,s._)((0,n._)({},e),{taskId:i.value.data.task_id,region:r._capcutAccountService.userProfile.region,scene:e.scene,hasLogin:r._capcutAccountService.hasLogin,urlParams:t}))):i})()}createTTTranscodeQueryTask(e){return new tj(this._intelligentRepositoryWithoutRetry,(0,n._)({},e))}constructor(e){super(),this._capcutAccountService=e,this.disableIntelligentCover=!1,this._intelligentRepositoryWithoutRetry=new tM(!0)}}tO=(0,z.gn)([(0,z.fM)(0,J.Gw),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===J.Gw?Object:J.Gw])],tO);let tL=r("37011");var tx={GET_HISTORY_PROJECTS_FOR_PC:"/lv/v1/capflow/history_task",GET_TT_ROOM_INFO:"/lv/v1/get_tt_room_info",UPDATE_TASK_META:"/lv/v1/capflow/long2short_meta_update"},tE=()=>{var e=new ty.yk().build(ty.kk);return(0,tw.i3)(e),(0,tS.mH)(e),(0,tk.V)(e),e};class tR{get _networkClient(){var e;return null!==(e=this._networkClientInstance)&&void 0!==e?e:this._networkClientInstance=tE()}_getApi(e){return"".concat(tT._L.getVar("web_domain")).concat(e)}getHistoryProjects(e){var t=this;return(0,a._)(function*(){try{var r,i,o=yield t._networkClient.post(t._getApi(tx.GET_HISTORY_PROJECTS_FOR_PC),e,{withCredentials:!0});if("0"!==o.ret)return(0,eU.wf)(Number(o.ret),o.errmsg);var a={success:1,failed:-1,processing:0},n={next_cursor:o.data.next_cursor,has_more:o.data.has_more,tasks:(null!==(i=null===(r=o.data)||void 0===r?void 0:r.capflow_list)&&void 0!==i?i:[]).map(e=>{var t,r,i,n,s;return{id:e.capflow_id,status:null!==(r=a[e.status])&&void 0!==r?r:1,project_name:e.material_name,cover_url:e.cover_url,progress:Math.floor((null!==(i=e.progress)&&void 0!==i?i:0)*100),error_code:Number(o.ret),clip_count:null!==(n=null===(t=e.material_list)||void 0===t?void 0:t.length)&&void 0!==n?n:0,estimate_time:Math.floor((null!==(s=e.forecast_cost)&&void 0!==s?s:0)/1e3),capflow_key:e.capflow_key}})};return(0,eU.oW)(n)}catch(e){return(0,tP.m)(e,-1,"getHistoryProjects api error.")}})()}getTTRoomInfo(e){var t=this;return(0,a._)(function*(){try{var r,i,o=yield t._networkClient.post(t._getApi(tx.GET_TT_ROOM_INFO),e,{withCredentials:!0});if("0"!==o.ret)return(0,eU.wf)(Number(o.ret),o.errmsg);var a={title:o.data.title,coverUrl:o.data.cover_uri,playUrl:o.data.play_url,createTime:o.data.create_time,endTime:o.data.end_time,spriteList:(null!==(i=null===(r=o.data)||void 0===r?void 0:r.sprite_list)&&void 0!==i?i:[]).map(e=>({url:e.Uri,spriteNum:e.SpriteNum,imageXNum:e.ImageXNum,imageYNum:e.ImageYNum,imageHeight:e.ImageHeight,imageWidth:e.ImageWidth,fps:e.FPS}))};return(0,eU.oW)(a)}catch(e){return(0,tP.m)(e,-1,"getHistoryProjects api error.")}})()}updateTaskMeta(e){var t=this;return(0,a._)(function*(){var r=yield t._networkClient.post(t._getApi(tx.UPDATE_TASK_META),e,{withCredentials:!0});return"0"!==r.ret?(0,eU.wf)(Number(r.ret),r.errmsg):(0,eU.oW)(r.data)})()}}class tD{updateTaskMeta(e){var t=JSON.stringify({start_time:e.start,end_time:e.end});return this._longToShortRepository.updateTaskMeta({capflow_id:e.capflow_id,draft_key:e.draft_key,content:t,scene:e.scene})}getHistoryProjects(e){return e.cap_key||(e.cap_key=eI.gW.CapKeyForWeb),this._longToShortRepository.getHistoryProjects(e)}getHistoryItemInfo(e){return this._getHistoryItemByTaskId(e.id,e.idType)}_getHistoryItemByTaskId(e,t){var r=this;return(0,a._)(function*(){var i,o,a,n,s,l,c,u,d,p,v,g=yield r._intelligentRepositoryWithoutRetry.getIntelligentTask({smart_tool_type:eQ.no.LongToShort,task_id:e,scene:void 0,region:void 0,platform:void 0,workspace_id:"",app_id:0,isTTTranscode:t===es.Xd.ttTranscodeId});if(!g.ok||!g.value)return(0,eU.wf)(Number(g.code),g.msg);var h=r._transIGetIntelligentSmartTaskStatusToHistoryItemStatus(g.value.status,t===es.Xd.ttTranscodeId);return(0,eU.oW)({error_code:0,clip_count:null!==(u=null===(i=g.value.task_detail)||void 0===i?void 0:i.length)&&void 0!==u?u:0,estimate_time:(null!==(d=g.value.estimate_time)&&void 0!==d?d:0)>0&&null!==(p=g.value.estimate_time)&&void 0!==p?p:0,id:e,cover_url:(null===(n=g.value.task_detail)||void 0===n?void 0:null===(a=n[0])||void 0===a?void 0:null===(o=a.preview_info)||void 0===o?void 0:o.cover_url)||"",status:h,progress:g.value.progress,project_name:g.value.origin_resource_name,benefitId:null!==(v=null===(l=g.value)||void 0===l?void 0:null===(s=l.benefit_detail)||void 0===s?void 0:s.id)&&void 0!==v?v:"",related_id:null===(c=g.value)||void 0===c?void 0:c.related_capflow_id,capflow_key:g.value.capflow_key})})()}_transIGetIntelligentSmartTaskStatusToHistoryItemStatus(e,t){var r;switch(e){case th.v.Failure:r=es.Kw.fail;break;case th.v.ProgressSuccess:r=es.Kw.success;break;case th.v.Success:case th.v.Process:r=es.Kw.doing;break;default:r=es.Kw.success}return r===es.Kw.success&&t&&(r=es.Kw.doing),r}getTTRoomInfo(e){return this._longToShortRepository.getTTRoomInfo(e)}constructor(e){this._instantiationService=e,this._longToShortRepository=this._instantiationService.createInstance(tR),this._intelligentRepositoryWithoutRetry=new tM(!0)}}tD=(0,z.gn)([(0,z.fM)(0,tL.T),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===tL.T?Object:tL.T])],tD);let tF=r("156531"),tA=r("977000"),tN=r("320044"),tU=r("868874"),tV=r("922813"),tW=r("806797"),tB=r("743321"),tZ=r("610306"),tG=r("980134"),tH=r("897317");class tz extends q.JT{get _networkClient(){if(!this._networkClientInstance){var e,t;this._networkClientInstance=(e={appVersion:this._environmentService.appVersion},t=new ty.yk().build(ty.kk),(0,tk.V)(t),(0,tV.V)(t,{appVersion:e.appVersion}),t)}return this._networkClientInstance}getPackageInfo(e,t){var r=this;return(0,a._)(function*(){var{packageKey:i,spaceId:o,workspaceId:a,lang:n,fromEmail:s,password:l,captcha:c}=t,u=r._configurationService.abTestManager.getBooleanAbTestValue(tB.o.NewTransitionEffectEnabled),d=r._environmentService.isAutoTest||u?tA.Nb.New:tA.Nb.Old;try{var p,v,g,h=yield r._networkClient.post(r._api,{lang:n,package_key:i,space_id:o,workspace_id:a,region:tT._L.getVar("country_code"),app_version:r._environmentService.appVersion,sdk_version:tG.f4,cc_web_version:d,from_email:s,password:l,captcha_fp:c},{withCredentials:!0,ctx:e});if(console.log("[startup] package info response",h),(null==h?void 0:null===(p=h.data)||void 0===p?void 0:p.ret)!=="0")return(0,eU.wf)(1,null==h?void 0:null===(v=h.data)||void 0===v?void 0:v.ret,null==h?void 0:null===(g=h.data)||void 0===g?void 0:g.errmsg);return(0,eU.oW)(h.data)}catch(e){return(0,tP.m)(e,-1,"getPackageInfo api error")}})()}getPackageInfoFromJsonp(){return(0,a._)(function*(){if(!document.getElementById("GTW_DRAFT_JSONP")&&!document.getElementById("draft-detail-jsonp"))return(0,eU.wf)(-2,"packageInfoJsonp not injected");try{yield window.pPackageInfo}catch(e){return(0,tP.m)(e,-1,"getPackageInfoJsonp api error")}var e=window.__get_package_info__||window.__package_info;return e?"0"===e.ret?(0,eU.oW)(e):(0,eU.wf)(1,null==e?void 0:e.ret):(0,eU.wf)(-1,"getPackageInfoJsonp api error")})()}get _api(){return this._httpApiSettingService.getRequestURL({domainType:tH.Y.DEFAULT,path:"/lv/v1/draft/get_package_info"})}constructor(e,t,r){super(),this._configurationService=e,this._environmentService=t,this._httpApiSettingService=r,this._urlGenerator=new tN.w(tU.c)}}tz=(0,z.gn)([(0,z.fM)(0,tW.Ui),(0,z.fM)(1,tZ.Y),(0,z.fM)(2,tH.x),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===tW.Ui?Object:tW.Ui,void 0===tZ.Y?Object:tZ.Y,void 0===tH.x?Object:tH.x])],tz);let tq=r("348854");function tK(e){var t=[...e.file_url.url_list,...e.file_url.zip_url_list].filter(e=>!!e);return{key:e.file_url.uri,name:e.name,version:e.version,modelType:e.type,md5:e.file_url.uri,package:{uri:e.file_url.uri,urlList:t},status:e.status,fileType:e.file_type}}class tQ{get _networkClient(){if(!this._networkClientInstance){var e;this._networkClientInstance=(e=new ty.yk().build(ty.kk),(0,tw.i3)(e),(0,tk.V)(e),e)}return this._networkClientInstance}getModel(e){var t=this;return(0,a._)(function*(){try{var r,i=yield t._networkClient.get(t._api,t._buildRequestConfig(e)),o=Number(null!==(r=i.status_code)&&void 0!==r?r:0);if(0!==o)return(0,eU.wf)(null!=o?o:-1,"get Model error");var a=t._convertResponseToArithmeticModelData(i);return(0,eU.oW)(a)}catch(e){return(0,tP.m)(e,-1,"getModel api error")}})()}_convertResponseToArithmeticModelData(e){return{list:e.data.arithmetics.cakeCook.map(tK)}}_buildRequestConfig(e){var t,r;return{params:(0,n._)({busi_id:"501066",device_type:"capcut_web",device_platform:"mac",ve_version:null!==(t=e.veVersion)&&void 0!==t?t:"",sdk_version:null!==(r=e.veVersion)&&void 0!==r?r:"",app_version:this._environmentService.appVersion,aid:"0",app_name:"capcut",status:tT.JA?"0":"1",web_id:e.webId,device_id:e.webId,uid:this._accountService.userProfile.uid},e.modelNames?{required_model_list:this._getUniqueName(e.modelNames)}:void 0)}}_getUniqueName(e){var t=new Map;return e.forEach(e=>{t.set(e,e)}),Array.from(t.keys()).join(",")}get _api(){return"/model/api/arithmetics"}constructor(e,t){this._accountService=e,this._environmentService=t}}tQ=(0,z.gn)([(0,z.fM)(0,J.Gw),(0,z.fM)(1,tZ.Y),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===J.Gw?Object:J.Gw,void 0===tZ.Y?Object:tZ.Y])],tQ);class tJ extends q.JT{getModel(e){return this._getModelRepository.getModel(e)}constructor(e){super(),this._instantiationService=e,this._getModelRepository=this._instantiationService.createInstance(tQ)}}tJ=(0,z.gn)([(0,z.fM)(0,tL.T),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===tL.T?Object:tL.T])],tJ);let tY=r("632980"),tX=r("889650"),t$=r("779219"),t0=r("370659"),t1=r("474735");class t2 extends t$.L{get resourceType(){return eR._g.SubtitleTemplate}get resourcePanelType(){return t0.q.SubtitleTemplate}parseHeycanResponseDataToResources(e){return(0,t1.G)(e)}buildCustomRequest(e){var t;return{panel_source:"heycan",pack_optional:{need_thumb:!0,only_commercial:null!==(t=e.onlyCommercial)&&void 0!==t&&t}}}buildCustomRequestParams(){var e;return{device_type:"default",channel:null!==(e=new URLSearchParams(location.search).get("lokiChannel"))&&void 0!==e?e:"online"}}}let t6=r("370304");class t3 extends t6.B{get resourceType(){return eR._g.SubtitleTemplate}parseHeycanResponseDataToResources(e){return(0,t1.G)(e)}buildCustomRequest(e){return{category_id:Number(e.category),pack_optional:{need_thumb:!0,only_commercial:e.onlyCommercial,thumb_opt:'{"is_support_webp":1}'},panelSource:"heycan",full_count:!0}}buildCustomFilterOtherParams(e){return e.strategyFilterAppId?{strategy_filter_app_id:e.strategyFilterAppId}:{}}buildCustomRequestParams(){var e;return{device_type:"default",channel:null!==(e=new URLSearchParams(location.search).get("lokiChannel"))&&void 0!==e?e:"online"}}}let t4=r("787780"),t9=r("133963");class t7 extends t9.n{get resourceType(){return t4.g.SubtitleTemplate}parseHeycanResponseDataToResources(e){return(0,t1.G)(e)}constructor(e){super(e),this._capcutAccountService=e}}class t5 extends q.JT{getSubtitleTemplateCategories(e){var t=e instanceof tX.yt?e.config:e,r=(0,n._)({},t);return this._getSubtitleTemplateCategoriesRepository.getCategories(r)}getSubtitleTemplateByCategory(e){return this._getSubtitleTemplateByCategoryRepository.getResources(e)}getSubtitleTemplateByIds(e){return this._getSubtitleTemplateByIdsRepository.batchGetResources({resourceIds:e.ids})}constructor(e={},t,r){super(),this._options=e,this._instantiationService=t,this._configurationService=r,this._getSubtitleTemplateCategoriesRepository=this._instantiationService.createInstance(t2),this._getSubtitleTemplateByCategoryRepository=this._instantiationService.createInstance(t3),this._getSubtitleTemplateByIdsRepository=this._instantiationService.createInstance(t7),this._options.fixedRegion&&(this._getSubtitleTemplateByCategoryRepository.setFixedRegion(this._options.fixedRegion),this._getSubtitleTemplateCategoriesRepository.setFixedRegion(this._options.fixedRegion))}}t5=(0,z.gn)([(0,z.fM)(1,tL.T),(0,z.fM)(2,tW.Ui),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[Object,void 0===tL.T?Object:tL.T,void 0===tW.Ui?Object:tW.Ui])],t5);let t8=r("336103"),re=r("7141"),rt=r("898378"),rr=r("271835");class ri extends rt.L{parseDetailToResources(e){return(0,re.Ck)(e)}get resourceType(){return eR._g.TextPreset}constructor(e,t,r,i){super(e,t,r,i)}}ri=(0,z.gn)([(0,z.fM)(0,J.Gw),(0,z.fM)(1,tW.Ui),(0,z.fM)(2,rr.U),(0,z.fM)(3,tZ.Y),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===J.Gw?Object:J.Gw,void 0===tW.Ui?Object:tW.Ui,void 0===rr.U?Object:rr.U,void 0===tZ.Y?Object:tZ.Y])],ri);let ro=r("724499"),ra=r("470114"),rn=r("445358");class rs{get _networkClient(){if(!this._networkClientInstance){var e;this._networkClientInstance=(e=new ty.yk().build(ty.kk),(0,tw.i3)(e),(0,tk.V)(e),e)}return this._networkClientInstance}getCollections(e){var t=this;return(0,a._)(function*(){try{var r,i,o,a,l=e instanceof tX.yt?e.config:e,c=yield t._networkClient.post(t._getCollectionApi,t._convertParamsToRequest(e),(0,s._)((0,n._)({},(0,ra._)(null!==(i=null!==(r=t._options.fixedRegion)&&void 0!==r?r:t._accountService.userProfile.region)&&void 0!==i?i:"",eu.ZP.language,void 0,rn.AF,!!t._options.fixedRegion)),{withCredentials:!0})),u=Number(null!==(o=c.ret)&&void 0!==o?o:0),d=null!==(a=c.errmsg)&&void 0!==a?a:"";if(0!==u)return(0,eU.wf)(null!=u?u:-1,null!=d?d:"");var p=t._convertResponseToQueryToken(l,c);return(0,eU.oW)(p)}catch(e){return(0,tP.m)(e,-1,"[".concat(t.resourceType,"] getCollections api error"))}})()}addToCollection(e){var t=this;return(0,a._)(function*(){try{var r,i,o,a,l=yield t._networkClient.post(t._addCollectionApi,t._convertAddParamsToRequest(e),(0,s._)((0,n._)({},(0,ra._)(null!==(i=null!==(r=t._options.fixedRegion)&&void 0!==r?r:t._accountService.userProfile.region)&&void 0!==i?i:"",eu.ZP.language,void 0,rn.AF,!!t._options.fixedRegion)),{withCredentials:!0})),c=Number(null!==(o=l.ret)&&void 0!==o?o:0),u=null!==(a=l.errmsg)&&void 0!==a?a:"";if(0!==c)return(0,eU.wf)(null!=c?c:-1,null!=u?u:"");var d=l.data.favorite_info,p=Object.keys(d).filter(e=>0===d[e]),v=Object.keys(d).filter(e=>0!==d[e]);return(0,eU.oW)({successfulItems:p,failedItems:v})}catch(e){var g="string"==typeof e?e:"addToCollection api error";return(0,tP.m)(e,-1,g)}})()}removeFromCollection(e){var t=this;return(0,a._)(function*(){try{var r,i,o,a,l=yield t._networkClient.post(t._removeCollectionApi,t._convertRemoveParamsToRequest(e),(0,s._)((0,n._)({},(0,ra._)(null!==(i=null!==(r=t._options.fixedRegion)&&void 0!==r?r:t._accountService.userProfile.region)&&void 0!==i?i:"",eu.ZP.language,void 0,rn.AF,!!t._options.fixedRegion)),{withCredentials:!0})),c=Number(null!==(o=l.ret)&&void 0!==o?o:0),u=null!==(a=l.errmsg)&&void 0!==a?a:"";if(0!==c)return(0,eU.wf)(null!=c?c:-1,null!=u?u:"");var d=l.data.unfavorite_info,p=Object.keys(d).filter(e=>0===d[e]),v=Object.keys(d).filter(e=>0!==d[e]);return(0,eU.oW)({successfulItems:p,failedItems:v})}catch(e){var g="string"==typeof e?e:"removeFromCollection api error";return(0,tP.m)(e,-1,g)}})()}buildCustomRequest(){return{}}get defaultQueryToken(){return{offset:0,count:50}}_convertParamsToRequest(e){e instanceof tX.yt&&e.config;var t,r,i=this.buildCustomRequest(),o=(0,tX.ky)(e)?{count:null!==(t=e.config.limit)&&void 0!==t?t:50,offset:null!==(r=e.offset)&&void 0!==r?r:0}:(0,n._)({},this.defaultQueryToken,e.limit?{count:e.limit}:void 0);return(0,n._)({effect_type:this.resourceType},i,o)}_convertAddParamsToRequest(e){var{collections:t}=e,r=t.map(e=>(0,s._)((0,n._)({},e),{effect_type:this.resourceType})),i=this.buildCustomRequest();return(0,n._)({items:r},i)}_convertRemoveParamsToRequest(e){var{collections:t}=e,r=t.map(e=>(0,s._)((0,n._)({},e),{effect_type:this.resourceType})),i=this.buildCustomRequest();return(0,n._)({items:r},i)}_convertResponseToQueryToken(e,t){var r=t.data.effect_item_list.map(e=>this.parseHeycanResponseDataToResources(e)),i=t.data.next_offset,o=t.data.has_more;return(0,tX.ib)(e,{list:r},{hasMore:o,offset:i})}get _getCollectionApi(){return"".concat(tT._L.getVar("web_domain")).concat(ro.bl.GET_COLLECTIONS)}get _addCollectionApi(){return"".concat(tT._L.getVar("web_domain")).concat(ro.bl.BATCH_FAVORITE)}get _removeCollectionApi(){return"".concat(tT._L.getVar("web_domain")).concat(ro.bl.BATCH_UNFAVORITE)}constructor(e={},t){this._options=e,this._accountService=t,this._options=e}}rs=(0,z.gn)([(0,z.fM)(1,J.Gw),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",["undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===J.Gw?Object:J.Gw])],rs);let rl=r("484727");class rc extends rs{get resourceType(){return t4.g.WordArt}parseHeycanResponseDataToResources(e){return(0,rl.Q)(e)}buildCustomRequest(){return{loki_optional:{app_version:this._environmentService.appVersion,device_platform:"web"},app_id:t_.k}}constructor(e={},t,r){super(e,t),this._environmentService=r}}rc=(0,z.gn)([(0,z.fM)(1,J.Gw),(0,z.fM)(2,tZ.Y),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",["undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===J.Gw?Object:J.Gw,void 0===tZ.Y?Object:tZ.Y])],rc);let ru=r("495823"),rd=r("361223"),rp=r("111042");class rv extends ru.b{get resourceType(){return eR._g.TextPreset}parseEffectsToResources(e,t){return e.map(e=>(0,re.Ck)(e))}buildCustomRequest(e){return{only_commercial:e.onlyCommercial}}constructor(e,t,r,i,o,a){super(e,t,r,i,o,a)}}rv=(0,z.gn)([(0,z.fM)(0,J.Gw),(0,z.fM)(1,tW.Ui),(0,z.fM)(2,rr.U),(0,z.fM)(3,rp.c),(0,z.fM)(4,tZ.Y),(0,z.fM)(5,rd.c),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===J.Gw?Object:J.Gw,void 0===tW.Ui?Object:tW.Ui,void 0===rr.U?Object:rr.U,void 0===rp.c?Object:rp.c,void 0===tZ.Y?Object:tZ.Y,void 0===rd.c?Object:rd.c])],rv);let rg=r("815767");class rh extends rg.r{get resourceType(){return eR._g.TextPreset}parseEffectsToResources(e,t){return e.map(e=>(0,re.Ck)(e))}constructor(e,t,r){super(e,t,r)}}rh=(0,z.gn)([(0,z.fM)(0,J.Gw),(0,z.fM)(1,tW.Ui),(0,z.fM)(2,tZ.Y),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===J.Gw?Object:J.Gw,void 0===tW.Ui?Object:tW.Ui,void 0===tZ.Y?Object:tZ.Y])],rh);var rf="/cc/v1/workspace/web/get_brand_list",r_="99.99.99";function rm(){var e=new ty.yk().build(ty.kk);return(0,tw.i3)(e),(0,tk.V)(e),(0,tV.V)(e,{appVersion:""}),e}class ry{getResources(e){var t=this;return(0,a._)(function*(){try{var r=yield t._networkClient.post(t._url,t._convertParamsToRequest(e),{withCredentials:!0}),i=e instanceof tX.yt?e.config:e,o=t._convertResponseToQueryToken(i,r);return(0,eU.oW)(o)}catch(e){return(0,tP.m)(e)}})()}get defaultQueryToken(){return{cursor:"",count:50}}_convertParamsToRequest(e){var t,r=e instanceof tX.yt?e.config:e,i=e instanceof tX.yt?(0,s._)((0,n._)({},{count:null!==(t=e.config.limit)&&void 0!==t?t:50}),{cursor:e.offset}):(0,n._)({},this.defaultQueryToken);return{workspace_id:r.workspaceId,cursor_map:i.cursor?{[this.brandResourceType]:i.cursor}:void 0,count:i.count,resource_type_list:[String(this.brandResourceType)],effect_sdk_version:r_,app_version:tG.$U,need_depend_resource:!0,need_sub_item:!0,need_vip_tag:!0}}_convertResponseToQueryToken(e,t){var r,i,o,a,n=t.data.resource_info_list.map(e=>this.parseResponseDataToResources(e)),s=null!==(o=null!==(i=t.data.nextcursor_map[this.brandResourceType])&&void 0!==i?i:null===(r=t.data.resource_info_list[t.data.resource_info_list.length-1])||void 0===r?void 0:r.common_attr.id)&&void 0!==o?o:"",l=null!==(a=t.data.hasmore_map[this.brandResourceType])&&void 0!==a&&a;return(0,tX.ib)(e,{list:n},{hasMore:l,offset:s})}get _networkClient(){return this._networkClientInstance||(this._networkClientInstance=rm()),this._networkClientInstance}get _url(){return"".concat(tT._L.getVar("web_domain")).concat(rf)}}let rb=r("505672");class rw extends ry{get brandResourceType(){return rb.Q.TextPreset}parseResponseDataToResources(e){return(0,re.Ck)(e,!0)}}class rS{getResourcesByIds(e){var t=this;return(0,a._)(function*(){try{var r=yield t._networkClient.post(t._url,t._convertParamsToRequest(e),{withCredentials:!0}),i=t._convertResponseToResourcesData(r);return(0,eU.oW)(i)}catch(e){return(0,tP.m)(e)}})()}_convertParamsToRequest(e){return{id_list:e.ids,effect_sdk_version:r_,pack_optional:{NeedThumb:!0},need_depend_resource:!0,need_sub_item:!0,need_vip_tag:!0,app_version:tG.$U}}_convertResponseToResourcesData(e){return{list:e.data.resource_info_list.map(e=>this.parseResponseDataToResources(e))}}get _networkClient(){return this._networkClientInstance||(this._networkClientInstance=rm()),this._networkClientInstance}get _url(){return"".concat(tT._L.getVar("web_domain")).concat(rf)}}class rT extends rS{parseResponseDataToResources(e){return(0,re.Ck)(e,!0)}}class rk extends t9.n{get resourceType(){return t4.g.WordArt}parseHeycanResponseDataToResources(e){return(0,rl.Q)(e)}constructor(e){super(e),this._capcutAccountService=e}}class rI extends q.JT{getTextCategories(e){return this._getTextPresetCategoriesRepository.getCategories(e)}getTextByCategory(e){return this._getTextPresetByCategoryRepository.getResources(e)}getBrandTextPresets(e){return this._getBrandTextPresetsRepository.getResources(e)}getTextByIds(e){var t,{isFromBrand:r=!1}=e;return r?this._getBrandTextPresetsByIdsRepository.getResourcesByIds({ids:null!==(t=e.ids)&&void 0!==t?t:[]}):e.source===tA.Hw.HEYCAN?this._getHeycanTextPresetsByIdsRepository.batchGetResources({resourceIds:e.ids}):this._getTextPresetByIdsRepository.batchGetResources({ids:e.ids,enterFrom:e.enterFrom})}getCollections(e){return this._collectionTextPresetRepository.getCollections(e)}addToCollection(e){return this._collectionTextPresetRepository.addToCollection(e)}removeFromCollection(e){return this._collectionTextPresetRepository.removeFromCollection(e)}constructor(e={},t){super(),this.collectionParam=e,this._instantiationService=t,this._getTextPresetCategoriesRepository=t.createInstance(ri),this._collectionTextPresetRepository=t.createInstance(new tl.M(rc,[e],!1)),this._getTextPresetByCategoryRepository=t.createInstance(rv),this._getTextPresetByIdsRepository=t.createInstance(rh),this._getBrandTextPresetsRepository=this._instantiationService.createInstance(rw),this._getBrandTextPresetsByIdsRepository=this._instantiationService.createInstance(rT),this._getHeycanTextPresetsByIdsRepository=this._instantiationService.createInstance(rk)}}rI=(0,z.gn)([(0,z.fM)(1,tL.T),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",["undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===tL.T?Object:tL.T])],rI);let rP=r("575353"),rC=r("389198");class rM extends rg.r{get resourceType(){return eR._g.TextMotion}parseEffectsToResources(e){return e.map(e=>(0,rC.W)(e))}}class rj extends ru.b{buildCustomRequest(e){return{category:e.category}}get resourceType(){return eR._g.TextMotion}parseEffectsToResources(e,t){return e.map(e=>(0,rC.W)(e,t))}}class rO extends rt.L{get resourceType(){return eR._g.TextMotion}}class rL extends q.JT{getTextMotion(e){return this._motionRepository.getResources(e)}batchGetTextMotionsByIds(e){return this._batchGetTextMotionRepository.batchGetResources(e)}getTextMotionCategories(e){return this._getTextMotionCategoriesRepository.getCategories(e)}constructor(e){super(),this._instantiationService=e,this._motionRepository=this._instantiationService.createInstance(rj),this._batchGetTextMotionRepository=this._instantiationService.createInstance(rM),this._getTextMotionCategoriesRepository=this._instantiationService.createInstance(rO)}}rL=(0,z.gn)([(0,z.fM)(0,tL.T),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===tL.T?Object:tL.T])],rL);let rx=r("736212"),rE=r("497607");class rR extends rg.r{get resourceType(){return eR._g.Font}parseEffectsToResources(e){return e.map(e=>(0,rE.ey)(e))}}class rD extends ru.b{buildCustomRequest(e){var t,r;return{enable_album:null!==(t=e.enableAlbum)&&void 0!==t&&t,only_commercial:null!==(r=e.onlyCommercial)&&void 0!==r&&r}}get resourceType(){return eR._g.Font}parseEffectsToResources(e,t){return e.map(e=>(0,rE.ey)(e,t))}}class rF extends rt.L{get resourceType(){return eR._g.Font}}class rA extends ry{get brandResourceType(){return rb.Q.Font}parseResponseDataToResources(e){return(0,rE.ey)(e,void 0,!0)}}class rN extends rS{parseResponseDataToResources(e){return(0,rE.ey)(e,void 0,!0)}}(E||(E={})).MWEB_USER_POST="user_post_mweb_item",(R||(R={})).Loki="loki",(m=D||(D={}))[m.CN=2515]="CN",m[m.OVERSEAS=7356]="OVERSEAS";class rU extends t$.L{get resourceType(){return eR._g.Font}get resourcePanelType(){return t0.q.DreaminaFont}parseHeycanResponseDataToResources(e){return(0,rE.es)(e)}buildCustomRequest(e){var t;return{panel_source:R.Loki,app_id:null!==(t=e.appID)&&void 0!==t?t:513695,loki_opt:{loki_biz_id:D.CN}}}constructor(e,t,r,i){super(e,t,r),this._configurationService=i}}rU=(0,z.gn)([(0,z.fM)(0,Q.D),(0,z.fM)(1,rp.c),(0,z.fM)(2,rd.c),(0,z.fM)(3,tW.Ui),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===Q.D?Object:Q.D,void 0===rp.c?Object:rp.c,void 0===rd.c?Object:rd.c,void 0===tW.Ui?Object:tW.Ui])],rU);class rV extends t6.B{get resourceType(){return eR._g.Font}get getResourcesApi(){return"".concat(this._httpApiSettingService.getRequestURL({domainType:tH.Y.DEFAULT,path:ro.bl.GET_CATEGORY_RESOURCE}))}parseHeycanResponseDataToResources(e){return(0,rE.es)(e)}buildCustomFilterParams(){return Promise.resolve({})}buildCustomRequest(e){var t;return{category_key:e.category,panel:this._configurationService.resourcePanel[eR._g.Font],panel_source:R.Loki,app_id:null!==(t=e.appID)&&void 0!==t?t:513695,loki_opt:{loki_biz_id:e.lokiAppID}}}constructor(e,t,r,i,o){super(e,t,r),this._httpApiSettingService=i,this._configurationService=o}}rV=(0,z.gn)([(0,z.fM)(0,Q.D),(0,z.fM)(1,rd.c),(0,z.fM)(2,rp.c),(0,z.fM)(3,tH.x),(0,z.fM)(4,tW.Ui),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===Q.D?Object:Q.D,void 0===rd.c?Object:rd.c,void 0===rp.c?Object:rp.c,void 0===tH.x?Object:tH.x,void 0===tW.Ui?Object:tW.Ui])],rV);class rW extends q.JT{getFont(e){return this._fontRepository.getResources(e)}getBrandFonts(e){return this._getBrandFontsRepository.getResources(e)}batchGetFontsByIds(e){var{isFromBrand:t=!1}=e;return t?this._getBrandFontsByIdsRepository.getResourcesByIds(e):this._batchGetFontRepository.batchGetResources(e)}getFontCategories(e){return this._getFontCategoriesRepository.getCategories(e)}getDreaminaFontCategories(){return this._getDreaminaFontCategoriesRepository.getCategories({panelSource:R.Loki,appID:513695})}getDreaminaFonts(e){return this._getDreaminaFontsRespository.getResources(e)}constructor(e){super(),this._instantiationService=e,this._fontRepository=this._instantiationService.createInstance(rD),this._batchGetFontRepository=this._instantiationService.createInstance(rR),this._getFontCategoriesRepository=this._instantiationService.createInstance(rF),this._getBrandFontsRepository=this._instantiationService.createInstance(rA),this._getBrandFontsByIdsRepository=this._instantiationService.createInstance(rN),this._getDreaminaFontCategoriesRepository=this._instantiationService.createInstance(rU),this._getDreaminaFontsRespository=this._instantiationService.createInstance(rV)}}rW=(0,z.gn)([(0,z.fM)(0,tL.T),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===tL.T?Object:tL.T])],rW);let rB=r("961180"),rZ=r("966210"),rG=r("47583"),rH=r("892222"),rz=r("171389"),rq=r("219382"),rK=r("340201"),rQ=r("496006"),rJ=r("192031"),rY=r("816152"),rX=r("633180"),r$=r("264176"),r0=r("772322"),r1=r("570126"),r2=r("47525"),r6=r("218571"),r3=r("523474"),r4=r("565523"),r9=r("718179"),r7=r("655371"),r5=r("429188"),r8=r("454445"),ie=r("980509"),it=r("235137");r("459360"),r("463844"),r("387346");let ir=r("401725"),ii=r("279134"),io=r("221489"),ia=r("659179"),is=r("247130"),il=r("389253"),ic=r("554269"),iu=r("208282"),id=r("585025"),ip=r("898449"),iv=r("939453");r("188506"),r("889662"),r("445175"),r("306822"),r("873221"),r("529114");let ig=r("948106"),ih=r("359878"),i_=r("429907"),im=r("489837"),iy=r("911169"),ib=r("595051"),iw=r("152155"),iS=r.n(iw),iT=r("457215");r("733501");let ik=r("921195"),iI=r("157418"),iP=r("91933"),iC=r("691716"),iM=r("710799");var ij={baseURL:"/lv/v1",method:"POST",headers:{loc:iP.yM.CHANNEL,lan:eu.ZP.language||iP.yM.LAN,pf:iP.yM.APP_PF,appvr:iP.yM.VERSION,tdid:"","sign-ver":1,"app-sdk-version":iP.yM.APP_SDK_VERSION}},iO=iC.ZP.createAxios(ij);iO.interceptors.request.use(e=>{var{pf:t,appvr:r,tdid:i}=ij.headers;return Object.assign(e.headers,(0,iM.O)({url:"".concat(e.baseURL).concat(e.url),pf:t,appvr:r,tdid:i})),e}),iO.interceptors.response.use(e=>{if(200!==e.status)return Promise.reject(e);var t=e.data;return"0"===t.ret?Promise.resolve(t):Promise.reject(e)});var iL=e=>(0,a._)(function*(){return yield iO({url:"/upload_sign",data:e})})();let ix=r("521179");class iE extends ix.g{init(){var e=this;return(0,a._)(function*(){var{secret_access_key:t,access_key_id:r,session_token:i,space_name:o,current_time:a,expired_time:n}=(yield iL({biz:"feedback",key_version:"v5"})).data;e.stsToken={CurrentTime:a,ExpiredTime:n,SessionToken:i,AccessKeyId:r,SecretAccessKey:t},e.ak=r,e.sk=t,e.config.userId=Math.floor(1e12*Math.random()),e.config.videoConfig.spaceName=o})()}getStsToken(){return this.stsToken}getAkToken(){return this.ak}getSkToken(){return this.sk}getConfig(){return this.config}constructor(...e){super(...e),this.config={getSliceFunc:()=>2097152,uploadSliceCount:3,region:"us",appId:iP.yM.APP_ID,videoConfig:{spaceName:""}}}}(y=F||(F={})).Image="image",y.Video="video",(b=A||(A={})).PICTURE_OVER_MB="picture_over_mb",b.UPLOAD_FAILED_CLICK_RETRY="upload_failed_click_retry";let iR=r6.memo(e=>{var{form:t,count:r,data:i,setVideoData:o}=e,[l,c]=(0,r6.useState)(),u={getValue:()=>t.getFieldValue("imgList"),setValue:e=>t.setFieldValue("imgList",e),setVideoValue:e=>{o({isUploading:e.isUploading,[iv.e$.VIDEO_PLAY_URL]:e[iv.e$.VIDEO_PLAY_URL],[iv.e$.VIDEO_COVER_URL]:e[iv.e$.VIDEO_COVER_URL],[iv.e$.VIDEO_COVER_WIDTH]:e[iv.e$.VIDEO_COVER_WIDTH],[iv.e$.VIDEO_COVER_HEIGHT]:e[iv.e$.VIDEO_COVER_HEIGHT]})},deleteVideo:()=>{o(void 0)}};return(0,r0.jsxs)("div",{className:"upload-section",children:[i.map((e,t)=>(0,r0.jsxs)("div",{className:"upload-img",children:[(0,r0.jsx)("img",{src:globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(e.url,null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),crossOrigin:"anonymous"}),"finished"===e.status?(0,r0.jsx)("div",{className:"del_icon-wrapper",children:(0,r0.jsx)(ia.ybY,{className:"icons icons--del",onClick:()=>{if("finished"===e.status){var r=u.getValue().slice(0);r.splice(t,1),u.setValue(r)}}})}):(0,r0.jsx)(ik.Z,{webp:!0})]},e.key)),l&&(0,r0.jsxs)("div",{className:"upload-img",children:[(0,r0.jsx)("video",{src:globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(l.url,null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),crossOrigin:"anonymous"}),"finished"===l.status?(0,r0.jsx)("div",{className:"del_icon-wrapper",children:(0,r0.jsx)(ia.ybY,{className:"icons icons--del",onClick:()=>{"finished"===l.status&&(c(void 0),u.deleteVideo())}})}):(0,r0.jsx)(ik.Z,{webp:!0})]},l.key),i.length+(l?1:0)<r&&(0,r0.jsx)(ir.Z,{position:"tl",content:eu.ZP.t("web_support_file",{},"Support uploading videos and pictures"),children:(0,r0.jsxs)("label",{htmlFor:"upload-input",className:"upload-button",children:[(0,r0.jsx)("input",{type:"file",className:"upload-input",id:"upload-input",onChange:e=>{var t,o=e.target.files;if(o&&i.length+o.length>r){en.Z.error(eu.ZP.t("picture_over_4")),e.target.value="";return}var d=(e,t)=>{var r={image:()=>{var r=u.getValue();u.setValue(r.slice(0).concat({key:e,url:window.URL.createObjectURL(t),status:"unfinished"}))},video:()=>{c({key:e,url:window.URL.createObjectURL(t),status:"unfinished"})}};Object.keys(r).forEach(e=>{var i;(null==t?void 0:null===(i=t.type)||void 0===i?void 0:i.includes(e))&&r[e]()})},p=(e,t)=>{var r=u.getValue();if("image"===e){var{key:i,ImageHeight:o,ImageUri:a,ImageWidth:l}=t,d=r.slice(0),p=d.findIndex(e=>e.key===i);d[p]&&(d[p]=(0,s._)((0,n._)({},d[p]),{status:"finished",ImageUri:a,ImageWidth:l,ImageHeight:o})),u.setValue(d)}else{var{VideoMeta:{Height:v,Width:g,Uri:h}}=t;c(e=>(0,s._)((0,n._)({},e),{status:"finished"})),u.setVideoValue({isUploading:!1,video_play_url:h,video_cover_url:"",video_cover_width:g,video_cover_height:v})}},v=e=>{var t={picture_over_mb:eu.ZP.t("picture_over_mb",{},"Image size cannot exceed 1 MB"),upload_failed_click_retry:eu.ZP.t("upload_failed_click_retry",{},"Couldn't upload, click Retry")};(null==t?void 0:t[e.error])&&en.Z.error(t[e.error])},g=(t=(0,a._)(function*(e,t){if(e.size>1048576)return v({key:t,error:"picture_over_mb"});d(t,e);try{var r,i,o=yield(0,iv.rA)(e);p("image",{key:t,ImageUri:null==o?void 0:null===(i=o.data)||void 0===i?void 0:null===(r=i.data)||void 0===r?void 0:r.web_uri,ImageWidth:o.data.data.width,ImageHeight:o.data.data.height})}catch(e){v({key:t,error:e})}}),function(e,r){return t.apply(this,arguments)}),h=(e,t)=>{l?en.Z.normal(eu.ZP.t("web_support_file1",{},"You can upload only one video. You can continue uploading photos.")):(d(t,e),u.setVideoValue({isUploading:!0}),new iI.Q(new iE).upload({file:e,type:"video",onSuccess:e=>{p("video",(0,s._)((0,n._)({},e),{key:t}))},onError:()=>{c(void 0),en.Z.normal(eu.ZP.t("web_videos_failure",{},"Couldn\u2019t upload video"))}}))};if(o)for(var f of o){var _=Date.now().toString(),m=f.type.includes("image")?"image":"video";"image"===m?g(f,_):"video"===m&&h(f,_)}e.target.value=""},accept:"image/*,video/mp4,video/webm"}),(0,r0.jsx)(ia.Zc2,{className:"icon-add-img",size:20})]})}),(0,r0.jsxs)("div",{className:"img-count",children:[i.length+(l?1:0),"/",r]})]})}),iD=r("212932"),iF=r("539");(w=N||(N={})).VIDEO="Video editor",w.TEMPLATE="Template",w.MAGIC_TOOLS="Magic tools",w.ACCOUNT="Account&Subscription",w.SPACE="Space&Collaboration",w.GRAPHIC="Image editor",w.CREATIVE="Editing",w.ECO_COLLABORATION="Collaboration",w.CAPCUT_PRO="CapCut_Pro",w.OTHERS="Others";var iA=()=>{var[e,t]=(0,r6.useState)([]),[r,i]=(0,r6.useState)(void 0),[o,a]=(0,r6.useState)(),[n,s]=(0,r6.useState)(),l={"Video editor":[{key:"Recording",value:eu.ZP.t("web_feedback_button_video_recording",{},"Recording"),defaultValue:eu.ZP.t("web_Performance_Problems1",{},"Black screen/freeze/video lagging/import/export/network/download...")},{key:"Import material failed",value:eu.ZP.t("web_feedback_button_video_import",{},"Import material failed"),defaultValue:eu.ZP.t("web_Editing_function_bugs1",{},"Video/text/audio/play/video quality/algorithm/timeline/project management/material management...")},{key:"Editing Performance",value:eu.ZP.t("web_feedback_button_video_performance",{},"Editing Performance"),defaultValue:eu.ZP.t("web_Other_function_bugs1",{},"Beginner tutorial/cloud space/share/3rd-party import/create new folder...")},{key:"Commercial Materials",value:eu.ZP.t("web_feedback_button_video_commercial",{},"Commercial Materials"),defaultValue:eu.ZP.t("web_Product_Suggestions1",{},"Video quality/material quality/features...")},{key:"Others",value:eu.ZP.t("web_feedback_button_video_others",{},"Others"),defaultValue:eu.ZP.t("web_Missing_material",{},"Lack of category")}],Template:[{key:"Template Creator Issues",value:eu.ZP.t("web_feedback_button_template_creator",{},"Template Creator Issues"),defaultValue:eu.ZP.t("web_Account_problems1",{},"Account deletion/account synchronization on multiple devices")},{key:"Template Searching",value:eu.ZP.t("web_feedback_button_template_searching",{},"Template Searching"),defaultValue:eu.ZP.t("web_Shared_Collaboration1",{},"Collaboration conflict/editing loss")},{key:"Template Editing",value:eu.ZP.t("web_feedback_button_template_editing",{},"Template Editing"),defaultValue:eu.ZP.t("web_Website_Suggestions1",{},"Feature/file management/user flow/interface appearance...")},{key:"Commercial Materials",value:eu.ZP.t("web_feedback_button_template_materials",{},"Commercial Materials"),defaultValue:eu.ZP.t("web_Product_Suggestions1",{},"Video quality/material quality/features...")},{key:"Others",value:eu.ZP.t("web_feedback_button_template_others",{},"Others"),defaultValue:eu.ZP.t("web_Missing_material",{},"Lack of category")}],"Magic tools":[{key:"Video Tools",value:eu.ZP.t("web_feedback_button_magic_video",{},"Video Tools"),defaultValue:""},{key:"Image Tools",value:eu.ZP.t("web_feedback_button_magic_image",{},"Image Tools"),defaultValue:eu.ZP.t("web_Eco_Collaboration3",{},"Collaboration with other websites or marketing")},{key:"Ads Tools",value:eu.ZP.t("web_feedback_button_magic_ads",{},"Ads Tools"),defaultValue:eu.ZP.t("web_Eco_Collaboration3",{},"Collaboration with other websites or marketing")},{key:"Others",value:eu.ZP.t("web_feedback_button_magic_others",{},"Others"),defaultValue:eu.ZP.t("web_Missing_material",{},"Lack of category")}],"Image editor":[{key:"Editing Performance",value:eu.ZP.t("web_feedback_button_image_performance",{},"Editing Performance"),defaultValue:""},{key:"Downloading and sharing",value:eu.ZP.t("web_feedback_button_image_downloading",{},"Downloading and sharing"),defaultValue:""},{key:"Commercial Materials",value:eu.ZP.t("web_feedback_button_image_templates",{},"Commercial Materials"),defaultValue:""},{key:"Others",value:eu.ZP.t("web_feedback_button_image_others",{},"Others"),defaultValue:eu.ZP.t("web_Missing_material",{},"Lack of category")}],"Account&Subscription":[{key:"Account",value:eu.ZP.t("web_feedback_button_account_account",{},"Account"),defaultValue:eu.ZP.t("web_Account_problems1",{},"Account deletion/account synchronization on multiple devices")},{key:"Subscription Issues",value:eu.ZP.t("web_feedback_button_account_subscription_issue",{},"Subscription Issues"),defaultValue:eu.ZP.t("web_Missing_material",{},"Lack of category")}],"Space&Collaboration":[{key:"Upload",value:eu.ZP.t("web_feedback_button_space_upload",{},"Upload"),defaultValue:""},{key:"Download",value:eu.ZP.t("web_feedback_button_space_donwload",{},"Download"),defaultValue:eu.ZP.t("web_Eco_Collaboration3",{},"Collaboration with other websites or marketing")},{key:"Invite members",value:eu.ZP.t("web_feedback_button_space_invite",{},"Invite members"),defaultValue:eu.ZP.t("web_Eco_Collaboration3",{},"Collaboration with other websites or marketing")},{key:"Create or join Space",value:eu.ZP.t("web_feedback_button_space_create",{},"Create or join Space"),defaultValue:""},{key:"Transfer editing rights",value:eu.ZP.t("web_feedback_button_space_transfer",{},"Transfer editing rights"),defaultValue:eu.ZP.t("web_Eco_Collaboration3",{},"Collaboration with other websites or marketing")},{key:"Draft lost",value:eu.ZP.t("web_feedback_button_space_draft_lost",{},"Draft lost"),defaultValue:""},{key:"Others",value:eu.ZP.t("web_feedback_button_space_others",{},"Others"),defaultValue:eu.ZP.t("web_Missing_material",{},"Lack of category")}],Others:[{key:"Suggestions",value:eu.ZP.t("web_feedback_button_other_suggestion",{},"Suggestions"),defaultValue:eu.ZP.t("web_Account_problems1",{},"Account deletion/account synchronization on multiple devices")},{key:"Feature Quests",value:eu.ZP.t("web_feedback_button_other_request",{},"Feature Qequests"),defaultValue:""},{key:"Other",value:eu.ZP.t("web_feedback_button_other_others",{},"Other"),defaultValue:""}],Editing:[{key:"Performance",value:eu.ZP.t("web_Performance_Problems",{},"Performance"),defaultValue:eu.ZP.t("web_Performance_Problems1",{},"Black screen/freeze/video lagging/import/export/network/download...")},{key:"Editing",value:eu.ZP.t("web_Editing_function_bugs",{},"Editing"),defaultValue:eu.ZP.t("web_Editing_function_bugs1",{},"Video/text/audio/play/video quality/algorithm/timeline/project management/material management...")},{key:"Other features",value:eu.ZP.t("web_Other_function_bugs",{},"Other features"),defaultValue:eu.ZP.t("web_Other_function_bugs1",{},"Beginner tutorial/cloud space/share/3rd-party import/create new folder...")},{key:"Suggestions for the app",value:eu.ZP.t("web_Product_Suggestions",{},"Suggestions for the app"),defaultValue:eu.ZP.t("web_Product_Suggestions1",{},"Video quality/material quality/features...")},{key:"Material",value:eu.ZP.t("web_Material_problems",{},"Material"),defaultValue:eu.ZP.t("web_Missing_material",{},"Lack of category")}],Collaboration:[{key:"Material collaboration",value:eu.ZP.t("web_Eco_Collaboration1",{},"Material collaboration"),defaultValue:""},{key:"Brand collaboration",value:eu.ZP.t("web_Eco_Collaboration2",{},"Brand collaboration"),defaultValue:eu.ZP.t("web_Eco_Collaboration3",{},"Collaboration with other websites or marketing")}],CapCut_Pro:[]};return(0,r6.useEffect)(()=>{i(void 0),t(o?null==l?void 0:l[o]:null)},[o]),(0,r6.useEffect)(()=>{if(r){var e,t;s(o?null==l?void 0:null===(t=l[o])||void 0===t?void 0:null===(e=t.find(e=>e.key===r))||void 0===e?void 0:e.defaultValue:void 0)}},[r]),{selectorOption:r,setSelectorOption:i,selectorOptions:e,feedbackType:o,setFeedbackType:a,textAreaContent:n,setTextAreaContent:s}},{Option:iN}=ig.Z;(S=U||(U={})).PC="pc",S.MOBILE="mobile",S.WEB="web";let iU=e=>{var{initialValues:t,maxContent:r,onSubmit:i}=e,[o]=iy.Z.useForm(),[a,s]=(0,r6.useState)(),l=function(){var{data:e}=(0,iD.default)(iv.Ts,{auto:!0,cacheKey:iF.g.THIRTPARTY_FEEDBACK});return e}(),[c,u]=(0,r6.useState)(()=>{let e;return(e=t.fromPlatform,Object.values(U).includes(e))?t.fromPlatform:void 0}),{selectorOption:d,setSelectorOption:p,selectorOptions:v,feedbackType:g,setFeedbackType:h}=iA(),f=()=>{var e,t=(null===(e=(0,iT.d)())||void 0===e?void 0:e.getCurrentLocale()).slice(0,2);i(Object.assign(o.getFieldsValue(),(0,n._)({detailType:d,fromPlatform:c,currentLanguage:t},a)))},_={className:"feedback-form-item-label",span:24,md:{span:6},sm:{span:24},xs:{span:24}},m={span:24,md:{span:18},sm:{span:24},xs:{span:24}},y=[{icon:e=>(0,r0.jsx)(ia.Tp6,{className:iS()({"icon-select":e})}),name:eu.ZP.t("web_capcut_web",{},"CapCut Web"),key:"web"},{icon:e=>(0,r0.jsx)(ia.rjC,{className:iS()({"icon-select":e})}),name:eu.ZP.t("web_capcut_pc",{},"CapCut PC"),key:"pc"},{icon:e=>(0,r0.jsx)(ia.QaL,{className:iS()({"icon-select":e})}),name:eu.ZP.t("web_capcut_app",{},"CapCut App"),key:"mobile"}],b=[{key:N.VIDEO,value:eu.ZP.t("web_feedback_button_video_editor",{},"Video editor"),from:["web"]},{key:N.GRAPHIC,value:eu.ZP.t("web_feedback_button_image_editor",{},"Image editor"),from:["web"]},{key:N.TEMPLATE,value:eu.ZP.t("web_feedback_button_template",{},"Template"),from:["web"]},{key:N.MAGIC_TOOLS,value:eu.ZP.t("web_feedback_button_magic_tools",{},"Magic tools"),from:["web"]},{key:N.ACCOUNT,value:eu.ZP.t("web_feedback_button_account",{},"Account&Subscription"),from:["web"]},{key:N.SPACE,value:eu.ZP.t("web_feedback_button_space",{},"Space&Collaboration"),from:["web"]},{key:N.CREATIVE,value:eu.ZP.t("web_Creative_Experience",{},"Editing"),from:["mobile","pc"]},{key:N.ECO_COLLABORATION,value:eu.ZP.t("web_Eco_Collaboration",{},"Collaboration"),from:["mobile","pc"]},{key:N.CAPCUT_PRO,value:eu.ZP.t("web_feedback_capcut_pro",{},"CapCut Pro"),from:["mobile","pc"]},{key:N.OTHERS,value:eu.ZP.t("web_feedback_button_other",{},"Other"),from:["mobile","pc","web"]}];(0,r6.useEffect)(()=>{if(g&&c){var e,t=b.find(e=>e.key===g);(null==t?void 0:null===(e=t.from)||void 0===e?void 0:e.indexOf(c))===-1&&(p(void 0),h(void 0))}},[c]);var w="feedback-from-item-name",S="feedback-from-item",T=Array.from(document.getElementsByClassName(w)),k=0;return T.forEach(e=>{var t=e.clientWidth;k=Math.max(k,t)}),Array.from(document.getElementsByClassName(S)).forEach(e=>{e.style.width="".concat(k+32,"px")}),(0,r0.jsxs)(iy.Z,{initialValues:t,className:"feedback-form",form:o,requiredSymbol:{position:"end"},labelAlign:"left",validateTrigger:"onSubmit",children:[(0,r0.jsx)("div",{className:"feedback-modal-header",children:eu.ZP.t("feedback",{},"Feedback")}),(0,r0.jsxs)("div",{className:"feedback-container",children:[(0,r0.jsx)(iy.Z.Item,{wrapperCol:m,labelCol:_,label:eu.ZP.t("web_from",{},"From"),rules:[{required:!0}],children:(0,r0.jsx)(im.Z.Group,{className:"feedback-from",defaultValue:c,onChange:e=>{u(e),h(void 0),o.setFieldValue("feedType",void 0)},children:y.map(e=>(0,r0.jsx)(im.Z,{value:e.key,children:t=>{var{checked:r}=t;return(0,r0.jsxs)("div",{className:iS()(S,{checkItemBg:r}),children:[(0,r0.jsx)("div",{className:"feedback-from-item-icon",children:e.icon(r)}),(0,r0.jsx)("div",{className:iS()(w,{checkItemName:r}),children:e.name})]})}},e.key))})}),(0,r0.jsx)(iy.Z.Item,{wrapperCol:m,shouldUpdate:!0,labelCol:_,label:eu.ZP.t("feedback_type",{},"Type"),field:"feedType",rules:[{required:!0}],children:(0,r0.jsx)(im.Z.Group,{className:"feedback-type",onChange:e=>h(e),children:b.filter(e=>!c||-1!==e.from.indexOf(c)).map(e=>(0,r0.jsx)(im.Z,{value:e.key,children:()=>(0,r0.jsx)("span",{children:e.value})},e.key))})}),(0,r0.jsx)(iy.Z.Item,{wrapperCol:m,labelCol:_,shouldUpdate:!0,label:eu.ZP.t("web_Category_Details",{},"Subcategory"),rules:[{required:!(g&&!(null==v?void 0:v.length))}],className:iS()({"disable-title":!(null==v?void 0:v.length)}),children:(0,r0.jsx)("div",{onClick:()=>!(null==v?void 0:v.length)&&!g&&en.Z.normal({content:eu.ZP.t("web_types",{},"You need to select a category first")}),children:(0,r0.jsx)(ig.Z,{placeholder:eu.ZP.t("web_feedback_text_select_type",{},"You need to select a subcategory first"),value:d,disabled:!(null==v?void 0:v.length),onChange:e=>p(e),className:"feedback-select-detail",arrowIcon:(0,r0.jsx)(ia.FVw,{size:12,color:"#111A2CB2"}),children:null==v?void 0:v.map(e=>(0,r0.jsx)(iN,{value:e.key,children:(0,r0.jsx)("div",{className:"detail-type-option",children:(0,r0.jsx)("div",{className:"detail-type-option-value",children:e.value})})},"defailType-".concat(e.key)))})})}),(0,r0.jsx)(iy.Z.Item,{wrapperCol:m,labelCol:_,label:eu.ZP.t("feedback_problem_description",{},"Description"),field:"content",rules:[{required:!0}],children:(0,r0.jsx)(i_.Z.TextArea,{className:"feedback-content",placeholder:eu.ZP.t("web_feedback_text_describe",{},"Please describe your problem or suggestion"),maxLength:{length:r,errorOnly:!0},showWordLimit:!0})}),(0,r0.jsx)(iy.Z.Item,{wrapperCol:m,labelCol:_,label:eu.ZP.t("web_feedback_upload_screenshots",{},"Upload files"),field:"imgList",children:e=>(0,r0.jsx)(iR,{form:o,count:4,data:e.imgList,setVideoData:s})}),(0,r0.jsx)(iy.Z.Item,{wrapperCol:m,labelCol:_,label:eu.ZP.t("email",{},"Email"),field:"contact",children:(0,r0.jsx)(i_.Z,{className:"feedback-input",maxLength:100,placeholder:eu.ZP.t("web_feedback_text_leave_email",{},"Enter your email so we can reach out to you")})}),l&&(0,r0.jsx)(iy.Z.Item,{wrapperCol:m,labelCol:_,className:"--last_input_field",label:eu.ZP.t("join_cc_wa",{},"WhatsApp group"),children:(0,r0.jsx)(ih.Z,{href:globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(l.whatsapp.link,null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),target:"_blank",style:{padding:0},children:eu.ZP.t("join_cc_fan_club",{},"Submit your feedback directly to CapCut web admin")})})]}),(0,r0.jsx)(iy.Z.Item,{wrapperCol:{span:24},className:"feedback-actions",shouldUpdate:!0,children:e=>{var t;return(0,r0.jsx)(ib.Z,{className:"feedback-confirm",type:"primary",htmlType:"submit",disabled:!c||!e.feedType||(!e.feedType||null!=v&&!!v.length)&&!d||!e.content||e.content.length>r||0===e.content.trim().length||(null===(t=e.imgList)||void 0===t?void 0:t.findIndex(e=>"finished"!==e.status))>-1||(null==a?void 0:a.isUploading)||!g,onClick:f,children:eu.ZP.t("web_confirm",{},"confirm")})}})]})},iV=r("793967"),iW=r("416013");class iB{report(e){this.reporter.report("click_submit_feedback",e)}constructor(){this.reporter=(0,ic.y)()}}let iZ=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o={fromPlatform:i,feedType:null,defailType:null,content:"",imgList:[],contact:""};return new Promise(i=>{var l,c=!1,u=null,d=new iB,p=(l=(0,a._)(function*(o){if(!c)try{var a,l,p,v,g,h,f,_,m,y,b=null!==(_=null===(a=window)||void 0===a?void 0:a._currentBranch)&&void 0!==_?_:"",w=JSON.parse(null!==(m=window.__userInfoStringify)&&void 0!==m?m:"{}").data,S=null==w?void 0:null===(l=w.subscribe_info)||void 0===l?void 0:l.flag,T=null===(p=(0,iV.F)(location.pathname))||void 0===p?void 0:p.channelName;c=!0;var k=t?t():{},I=yield(0,iv.oO)((0,s._)((0,n._)((0,s._)((0,n._)({},o),{appVersion:b,isVip:S,channel:T}),k),{extra_params:(0,n._)({url:(null===(h=window)||void 0===h?void 0:null===(g=h.location)||void 0===g?void 0:null===(v=g.toString)||void 0===v?void 0:v.call(g))||""},null!==(y=null==k?void 0:k.extra_params)&&void 0!==y?y:{})}),e||(yield(0,ic.y)().getToken()).web_id);null==r||r(I.data.feedback_id),en.Z.success(eu.ZP.t("feedback_submit",{},"Feedback has already been submitted")),c=!1,i(void 0),u.close(),d.report({app:o.fromPlatform,type:o.feedType,description:o.content,is_screenshot:(null===(f=o.imgList)||void 0===f?void 0:f.length)?"true":"false"})}catch(e){c=!1,iW.W.error("FeedbackModal-SubmitFeedback",e),en.Z.error(2===e.err_code?eu.ZP.t("feedback_submit_refresh",{},"Couldn't submit feedback. Refresh the page."):eu.ZP.t("web_network_error"))}}),function(e){return l.apply(this,arguments)});u=e1.Z.confirm({wrapClassName:"feedback-modal-container",title:null,footer:null,icon:null,closable:!0,closeIcon:(0,r0.jsx)("div",{className:"closeIcon",children:(0,r0.jsx)(ia.bMz,{size:20})}),maskClosable:!1,content:(0,r0.jsx)(iU,{initialValues:o,maxContent:1e3,onSubmit:p})})})};var iG={baseURL:"/lv/v1/common",method:"POST",headers:{loc:iP.yM.CHANNEL,lan:iP.yM.LAN,pf:iP.yM.APP_PF,appvr:iP.yM.VERSION,tdid:"","sign-ver":1,"app-sdk-version":iP.yM.APP_SDK_VERSION}},iH=iC.ZP.createAxios(iG);iH.interceptors.request.use(e=>{var{pf:t,appvr:r,tdid:i}=iG.headers;return Object.assign(e.headers,(0,iM.O)({url:"".concat(e.baseURL).concat(e.url),pf:t,appvr:r,tdid:i})),e}),iH.interceptors.response.use(e=>{if(200!==e.status)return Promise.reject(e);var t=e.data;return"0"===t.ret?Promise.resolve(t):Promise.reject(e)});var iz={getHelpPageUrl:e=>(0,a._)(function*(){return yield iH({url:"/get_help_page_url",data:e})})()},iq={};let iK=e=>{var{isLogin:t,webID:r,disabled:i,onBeforeSubmit:o,onSubmited:l,assignFeedbackReport:c,spaceSize:u="-4px",layoutSize:d="40px",cookieConsent:p,enableReport:v=!1,customIcon:g,fromPlatform:h=U.WEB,tooltipProps:f=iq,customRender:_,currentPage:m,isMaterialOwner:y,onClickReport:b,doLogin:w}=e,S=(0,id._)();function T(){return(T=(0,a._)(function*(){i||(new il.H().report(Object.assign({target:"feedback",currentPage:m,position:il.q.HEADER},c)),yield iZ(r,o,l,h))})).apply(this,arguments)}var k=(0,r6.useCallback)(()=>{var e=null!=m?m:null==c?void 0:c.current_page;new il.H().report({target:"tutorial",current_page:e,position:il.q.HEADER}),window.open(S(iu.l.TUTORIAL.PATH,{from_page:e,enter_from:"tutorial"}),"_blank")},[m,c]),[I,P]=(0,r6.useState)(!1),C=function(e,t){var[r,i]=(0,r6.useState)({}),{data:o}=(0,iD.default)(iv.am,{auto:!0,cacheKey:iF.g.CC_WEB_IM_CONFIG}),a=(0,r6.useMemo)(()=>null==o?void 0:o.map(e=>e.countryCode),[o]);return(0,r6.useEffect)(()=>{if(t){var r,o=function(){try{var e="__userInfoStringify",t=void 0!==window[e]?JSON.parse(window[e]):void 0;if(t&&"0"===t.ret)return t.data;return}catch(e){return}}();if(!(null==o?void 0:null===(r=o.subscribe_info)||void 0===r?void 0:r.flag)){i({isEnable:!1});return}var n=function(){if("undefined"!=typeof window){var e=window.ip_location_info;if("object"==typeof e){var{Country:t,TimeZone:r}=e;if((null==t?void 0:t.Code)&&r)return{code:null==t?void 0:t.Code,timezone:r}}}}(),{code:s,timezone:l}=null!=n?n:{};if(s&&l&&(null==a?void 0:a.includes(s))){if(!e){i({isEnable:!0});return}iz.getHelpPageUrl({country_code:s,local_timezone:l}).then(e=>{var t;i({isEnable:!0,imUrl:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.url})})}}},[a,e,t]),r}(t,I);(0,r6.useEffect)(()=>{(0,ip.a)()},[]),(0,r6.useEffect)(()=>{p&&p.onChange(e=>{var{firstPartyAnalytics:t}=e;t&&(0,ic.y)().start()})},[p]),(0,r6.useEffect)(()=>{v&&(0,ic.y)().start()},[v]);var M=(0,r6.useCallback)(()=>{if(new il.H().report(Object.assign({target:"im_entrance_web",currentPage:m,position:il.q.HEADER},c)),!t){null==w||w();return}C.imUrl&&window.open(C.imUrl,"_blank")},[C]),j=[];C.isEnable&&j.push({key:"online_support",label:eu.ZP.t("im_get_support_button",{},"Online Support"),icon:(0,r0.jsx)(is.kIV,{size:20}),onClick:M}),j.push({key:"feedback",label:eu.ZP.t("feedback",{},"Feedback"),icon:(0,r0.jsx)(is.v0C,{size:20}),onClick:function(){return T.apply(this,arguments)}},{key:"join_creator_community",label:eu.ZP.t("web_join_creator_community",{},"Join Creator Community"),icon:(0,r0.jsx)(is.Ys3,{size:20}),onClick:function(){new il.H().report(Object.assign({target:"community",currentPage:m,position:il.q.HEADER},c)),window.open("https://www.facebook.com/groups/capcutweb/")}}),j.push({key:"tutorial",label:eu.ZP.t("web_start_btn_tutorials",{},"Tutorials"),icon:(0,r0.jsx)(is.Cg1,{size:20}),onClick:k}),"editor"!==m||y||j.push({key:"report",label:eu.ZP.t("web_sharereview_button_report",{},"Report"),icon:(0,r0.jsx)(is.yGN,{size:20}),onClick:()=>{null==b||b()}});var O=eu.ZP.t("workspace_feedbackwe",{},"Help");return"function"==typeof _?_({menuItems:j,menuTooltip:O}):(0,r0.jsx)(ir.Z,(0,s._)((0,n._)({content:O},f),{disabled:I,children:(0,r0.jsx)(io.Z,{position:"br",trigger:"click",onVisibleChange:e=>{P(e)},focusLock:!0,droplist:(0,r0.jsxs)(ii.Z,{className:"feedback-menu",style:{marginTop:u},children:[(0,r0.jsx)(ii.Z.Item,{className:"feedback-menu-help",disabled:!0,children:O},O),j.map(e=>(0,r0.jsxs)(ii.Z.Item,{onClick:e.onClick,children:[(0,r0.jsx)("span",{className:"feedback-menu-item-icon",children:e.icon}),e.label]},e.key))]}),children:(0,r0.jsx)("div",{className:"lv_feedback",style:{width:d,height:d},children:null!=g?g:(0,r0.jsx)(ia.KTU,{className:"lv_feedback-icon"})})})}))},iQ=r("239534");var iJ=e=>{if(!e)return!1;var t=new Date(1e3*e),r=t.getFullYear(),i=t.getMonth(),o=t.getDay(),a=new Date,n=a.getFullYear(),s=a.getMonth(),l=a.getDay();return n===r&&s===i&&l===o},iY=()=>{var e=(0,r4.G)(H),{userProfile:t,webId:r,enableReport:i}=(0,it.k)(e,e=>e.observeData),{region:o,create_time:a,uid:n}=t,s={url:location.href,templateJson:"",hasVeCrash:!1};return(0,r0.jsx)("div",{className:"feedbackContainer-vm6P3K",children:(0,r0.jsx)(iK,{cookieConsent:iQ.g,isLogin:!!n,userID:null!=n?n:"",webID:r,countryCode:null!=o?o:"",isNewUser:iJ(a),assignFeedbackReport:{current_page:"batch"},onBeforeSubmit:()=>s,onSubmited:()=>{},spaceSize:"2px",layoutSize:"32px",fromPlatform:"batch",tooltipProps:{},customRender:void 0})})};let iX=r("397221"),i$=r("580031"),i0=r("428271"),i1=r("982465"),i2=r("813727");r("936039");let i6=r("802406"),i3=r("105789"),i4=r.n(i3),i9=r("638432");var i7=e=>(0,r0.jsxs)("svg",(0,s._)((0,n._)({xmlns:"http://www.w3.org/2000/svg",width:21,height:21,fill:"none",viewBox:"0 0 21 21"},e),{children:[(0,r0.jsx)("path",{fill:"#FF303D",d:"M6.931 7.402a.5.5 0 0 0 0 .707l2.39 2.39-2.39 2.39a.5.5 0 0 0 0 .708l.472.471a.5.5 0 0 0 .707 0l2.39-2.39 2.39 2.39a.5.5 0 0 0 .708 0l.471-.471a.5.5 0 0 0 0-.707l-2.39-2.39 2.39-2.391a.5.5 0 0 0 0-.707l-.471-.472a.5.5 0 0 0-.707 0L10.5 9.32 8.11 6.93a.5.5 0 0 0-.707 0z"}),(0,r0.jsx)("path",{fill:"#FF303D",fillRule:"evenodd",d:"M18.834 10.5a8.333 8.333 0 1 1-16.667 0 8.333 8.333 0 0 1 16.667 0m-1.667 0a6.667 6.667 0 1 1-13.333 0 6.667 6.667 0 0 1 13.333 0",clipRule:"evenodd"})]}));let i5=r("988717"),i8=r("598152"),oe={"lts-history-project-list-wrapper":"lts-history-project-list-wrapper-KtoiOr","lts-history-project-list-title":"lts-history-project-list-title-rlSm7u","list-flex-wrapper":"list-flex-wrapper-z0N1sX","lts-history-project-list-item":"lts-history-project-list-item-WpCsKI","list-item-cover-wrapper":"list-item-cover-wrapper-gwQO6H","image-container":"image-container-gUwZjY","image-container__portrait":"image-container__portrait-PglALp","short-count":"short-count-Sn3Nfd","blur-black-mask":"blur-black-mask-II6B04","tips-container":"tips-container-WzyLIr","text-wrapper":"text-wrapper-KfcJwi","tip-uploading-spin":"tip-uploading-spin-kKZnCU","tip-uploading-text":"tip-uploading-text-p_u7bv","list-item-title":"list-item-title-Exe_oD","mock-data-wrapper":"mock-data-wrapper-rM2Eop","list-item-mock-title":"list-item-mock-title-Z_O8f1",breath:"breath-iRF6ev","lts-history-project-list-item-without-intro":"lts-history-project-list-item-without-intro-D8FxCH","lts-history-empty-wrapper":"lts-history-empty-wrapper-V3bezb"};(0,r("888298").p)(i5);var ot={[es.Kw.doing]:"waiting",[es.Kw.fail]:"fail",[es.Kw.success]:"success",[es.Kw.uploading]:"uploading",[es.Kw.uploadFail]:"uploadFail"},or=e=>{var{item:t,onHistoryItemClick:r,withoutIntro:i}=e,{i18n:o}=(0,i2.$)(),{id:n,status:s,project_name:l,estimate_time:c,cover_url:u,clip_count:d,progress:p,capflow_key:v}=t,{loaded:g,isPortrait:h}=function(e,t){var r=(0,i9.default)(!1),i=(0,i9.default)(!1),[o,n]=(0,r6.useState)({width:0,height:0});return(0,r6.useEffect)(()=>{var o;(o=(0,a._)(function*(){r.setFalse(),i.setFalse();var o=new Image;o.src=globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(e,null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),t&&(o.crossOrigin=t),yield o.decode(),r.setTrue(),o.width<o.height&&i.setTrue(),n({width:o.width,height:o.height})}),function(){return o.apply(this,arguments)})()},[e]),{size:o,loaded:r.state,isLandscape:!i.state,isPortrait:i.state}}(u,"anonymous");return(0,r0.jsxs)("div",{className:i4()(oe["lts-history-project-list-item"],{[oe["lts-history-project-list-item-without-intro"]]:i}),onClick:()=>{r(t)},children:[(0,r0.jsxs)("div",{className:oe["list-item-cover-wrapper"],children:[(0,r0.jsxs)("div",{className:i4()(oe["image-container"],{[oe["image-container__portrait"]]:h}),children:[[es.Kw.doing,es.Kw.fail,es.Kw.uploading,es.Kw.uploadFail].includes(s)?(0,r0.jsx)("div",{className:oe["blur-black-mask"]}):null,g?(0,r0.jsx)("img",{src:globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(u,null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),crossOrigin:"anonymous"}):null]}),s===es.Kw.success?(0,r0.jsx)("div",{className:oe["short-count"],children:(0,r0.jsx)("span",{children:d>0?o.t("web_ai_clip_shorts_text_numberx_shorts",{number0:d,num:d},"{number0} shorts"):o.t("web_shorts_waiting_less_than_one_min",{},"< 1 min left")})}):null,[es.Kw.fail,es.Kw.uploadFail].includes(s)?(0,r0.jsxs)("div",{className:oe["tips-container"],children:[(0,r0.jsx)(i7,{}),(0,r0.jsx)("span",{className:oe["text-wrapper"],children:(0,r0.jsx)(i6.Z.Text,{ellipsis:{rows:2},style:{color:"var(--lvv-color-text-content-primary)",wordBreak:"break-word"},children:o.t("web_ai_clip_shorts_toast_failure",{},"Couldn\u2019t create shorts")})})]}):null,s===es.Kw.doing&&v!==eI.gW.CapKeyForTT?(0,r0.jsxs)("div",{className:oe["tips-container"],children:[(0,r0.jsx)(ik.Z,{style:{width:20,height:20},spinColor:"white"}),(0,r0.jsx)("span",{className:oe["text-wrapper"],children:(0,r0.jsx)("span",{children:o.t("web_ai_clip_shorts_text_waiting_numberx",{number0:Math.floor(c/60)},"About {number0}min")})})]}):null,[es.Kw.doing,es.Kw.success].includes(s)&&v===eI.gW.CapKeyForTT?(0,r0.jsxs)("div",{className:oe["tips-container"],children:[(0,r0.jsx)(ik.Z,{style:{width:20,height:20},spinColor:"white"}),(0,r0.jsx)("span",{className:oe["text-wrapper"],children:(0,r0.jsx)("span",{children:o.t("web_shorts_transcoding",{number0:p},"Transcoding...{number0}%")})})]}):null,s===es.Kw.uploading?(0,r0.jsxs)("div",{className:oe["tips-container"],children:[(0,r0.jsx)("img",{className:oe["tip-uploading-spin"],src:globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(i5,null,{logType:"js.href/src",mode:"black",reportOnly:"all"})}),(0,r0.jsxs)("div",{className:"".concat(oe["text-wrapper"]," ").concat(oe["tip-uploading-text"]),children:[eu.ZP.t("uploading",{},"Uploading"),p,"%"]})]}):null]}),(0,r0.jsx)(ir.Z,{checkOverflow:!0,content:l,children:(0,r0.jsx)("span",{className:oe["list-item-title"],children:l})})]},n)},oi=(0,r5.Pi)(e=>{var{withoutIntro:t}=e,r=(0,r4.G)(u.R),i=(0,r4.G)(eh.t),{supportQuickPlay:o}=r.fileSelectionManager,{historyProjectList:a,isHistoryListFetching:n,handleProjectClick:s}=r.uploadPageManager,l=(0,r6.useRef)([]),{i18n:c}=(0,i2.$)(),d=e=>{(0,i8.m)(i,{action:"click",clip_shorts_page:o?"default":"normal_material_import",status:ot[e.status],task_id:e.id,tool_type:"clip_shorts"}),s(e)};(0,r6.useEffect)(()=>{a&&a.length>0&&a.filter(e=>!l.current.includes(e.id)).forEach(e=>{(0,i8.m)(i,{action:"show",clip_shorts_page:o?"default":"normal_material_import",status:ot[e.status],task_id:e.id,tool_type:"clip_shorts"}),l.current.push(e.id)})},[a,l.current]);var p=!(null==a?void 0:a.length)&&!n;return(0,r0.jsxs)("div",{className:oe["lts-history-project-list-wrapper"],style:{visibility:p?"hidden":"initial"},children:[(0,r0.jsx)("div",{className:oe["lts-history-project-list-title"],children:c.t("web_ai_clip_shorts_tittle_historical_project",{},"History projects")}),(0,r0.jsx)("div",{className:oe["list-flex-wrapper"],children:n?Array(t?4:6).fill(1).map(()=>(0,r0.jsxs)("div",{className:i4()(oe["lts-history-project-list-item"],{[oe["mock-data-wrapper"]]:!0,[oe["lts-history-project-list-item-without-intro"]]:t}),children:[(0,r0.jsx)("div",{className:i4()(oe["list-item-cover-wrapper"],oe.breath)}),(0,r0.jsx)("div",{className:i4()(oe["list-item-mock-title"],oe.breath)})]})):a.length?a.map(e=>(0,r0.jsx)(or,{withoutIntro:t,item:e,onHistoryItemClick:d},e.id)):(0,r0.jsx)("div",{className:oe["lts-history-empty-wrapper"],style:{visibility:"hidden"},children:(0,r0.jsxs)("div",{children:[" ",c.t("xx",{},"no project yet")]})})})]})});let oo={"upload-page-wrapper":"upload-page-wrapper-b_EPU5","upload-area":"upload-area-pIa2JF","duration-tip":"duration-tip-EFWeEs","duration-left":"duration-left-Y8kiwz","upload-field-wrapper":"upload-field-wrapper-bQyS18","upload-area-without-intro":"upload-area-without-intro-OcO8sS","task-area":"task-area-czlTC4","task-area-without-intro":"task-area-without-intro-TgQIrF","smart-tools-long-to-short-upload-scroll-container":"smart-tools-long-to-short-upload-scroll-container-W0G3PM"},oa=r("215317"),on=r("932119");function os(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var[i,o]=(0,on.default)(...t),a=t[0];return[i,o,()=>{var e=i.current;if(a&&(e="function"==typeof a?a():a),e){var t=e.getBoundingClientRect();return{width:t.width,height:t.height}}return o}]}var ol=e=>{var{children:t,loading:r,onLoadMore:i,onScroll:o,classNames:a,hasMore:n}=e,[s,l]=(0,oa.default)(),[,c]=os(()=>s.current),[u,d]=os();return(0,r6.useEffect)(()=>{null==o||o(l.scrolling)},[l.scrolling]),(0,r6.useEffect)(()=>{if(!r&&n){var e=c.height,t=d.height;l.offset.y+e>t-80&&(null==i||i())}},[r,n,l.offset.y,c.height,d.height,u,s]),(0,r0.jsx)("div",{className:i4()("at-load-more-scroller-F3dbfr",a,{"is-scrolling-DZ5Cuq":l.scrolling}),ref:s,children:(0,r0.jsx)("div",{className:"at-load-more-scroller__container-rX2Lzi",ref:u,children:t})})};let oc=r("418345"),ou=r("924846"),od=r("629364"),op=r("640712"),ov=r("292146"),og=r("765610"),oh=r("215135"),of=r("823981");var o_=e=>{var{multiple:t,accept:r,onChange:i,onClick:o}=e,a=(0,r4.G)(J.Gw),n=(0,i2.$)(),[s,l]=(0,r6.useState)(!1);return(0,r0.jsxs)("div",{className:i4()("local-file-selector",{"drop-active":s}),children:[(0,r0.jsxs)("div",{className:"file-selector-content",children:[(0,r0.jsx)(is._qK,{size:28}),(0,r0.jsx)("div",{className:"file-selector-tips",children:n.t("web_ai_clip_shorts_text_drag_and_drop",{},"Drag and drop file here")})]}),(0,r0.jsx)("input",{className:"file-selector-input",type:"file",title:"",multiple:t,accept:r,onChange:e=>{i(e,s),l(!1)},onClick:o,onDragEnter:e=>{l(!0)},onDragOver:e=>{e.preventDefault()},onDragLeave:e=>{l(!1)},onDrop:()=>{a.hasLogin||a.login()}})]})};(T=V||(V={}))[T.GoogleDrive=0]="GoogleDrive",T[T.DropBox=1]="DropBox",T[T.Cloud=2]="Cloud",T[T.FilePicker=3]="FilePicker",T[T.Drag=4]="Drag",T[T.Shopify=5]="Shopify";var om=(0,r5.Pi)((0,r6.forwardRef)(function(e,t){var r,i,o,{multiple:n=!1,onExecuteAction:s,children:l,accept:c,validFile:u,uploadOptions:d,beforeUpload:p,onSelectCloudAsset:v,validCloudAsset:g,onPickCloud:h,onPickLocal:f,onPickThirdParty:_,uploadMeta:m,materialManager:y,fileSelectionManager:b,selectFile:w,useWebUpload:S=!0,callbacks:T,countLimit:k,allowedSources:I=[2],uploadMaxSize:P,resetAfterClose:C,uploadMaxDuration:M,uploadMinDuration:j,pickCloudFileBtnText:O,pickCloudFileTitle:L,toolType:x}=e,E=(0,i2.$)(),[R,D]=(0,r6.useState)([]),[F,A]=(0,r6.useState)(!1),N=(0,r4.G)(J.Gw),U=(0,r4.G)(tL.T),V=(0,r6.useCallback)(()=>{en.Z.error(E.t("web_magicTools_toast_reselect_material",{},"Couldn\u2019t process material. Try another one."))},[E]),{pickThirdFile:W,pickLocalFile:B,onCancel:Z,onRetry:G}=(0,od.Vn)({multiple:n,accept:c,uploadMaxSize:P,uploadMaxDuration:M,uploadMinDuration:j,beforeUpload:e=>"image/gif"!==e.type||(V(),!1),countLimit:null!=k?k:16,materialManager:y,uploadMeta:m,callbacks:T,toolType:x}),H=(0,r6.useMemo)(()=>{var e=op.NF.video,t=op.NF.image,r="";return(null==c?void 0:c.includes("video"))&&"object"==typeof e&&(r+=(0,ov.d)("".concat(null==e?void 0:e.accept,","))),(null==c?void 0:c.includes("image"))&&"object"==typeof t&&(r+=(0,ov.d)("".concat(null==t?void 0:t.accept,","))),r},[c]),z=(0,r6.useRef)(null),q=(0,r6.useCallback)(()=>{if(!N.hasLogin)return[];var e,t=null===(e=y.materials)||void 0===e?void 0:e.materials;return null==t?void 0:t.filter(e=>{var t=e.mime;if("image/gif"===t)return!1;if(!c)return!0;var r=null!=c&&!!c.includes("video")&&(null==t?void 0:t.startsWith("video")),i=null!=c&&!!c.includes("audio")&&(null==t?void 0:t.startsWith("audio")),o=null!=c&&!!c.includes("image")&&(null==t?void 0:t.startsWith("image"));return r||i||o})},[c]),K=(0,r6.useCallback)(e=>{var t=q();return e.map(e=>null==t?void 0:t.find(t=>t.md5===e)).filter(e=>e)||[]},[q]),Q=(0,r6.useCallback)(()=>{if(null==R?void 0:R.length){var e,t=q(),r=R.filter(e=>null==t?void 0:t.find(t=>t.md5===e)),i=K(r);if(r.length){var o=(n?i:[i[0]]).map(e=>{var t;return y.buildUserMaterialLifecycleAndAddBind(e,null!==(t=y.currentWorkspaceId)&&void 0!==t?t:"")});(!g||g(n?o:o[0]))&&(A(!0),null==v||v(n?o:o[0]),null===(e=z.current)||void 0===e||e.close(),A(!1),C&&D([]))}}},[R,q]),X=(0,r6.useCallback)(()=>{var e,t,r,i;if(!N.hasLogin){N.login();return}null==h||h(),null===(i=z.current)||void 0===i||i.open({multiple:n,title:E.t("web_tool_Select_file",{},"Select file"),data:null===(e=y.currentSpaceDirectoryFiles)||void 0===e?void 0:e.filter(e=>"folder"!==e.type).map(e=>{var t,r;return null===(r=y.materials)||void 0===r?void 0:null===(t=r.materials)||void 0===t?void 0:t.find(t=>t.md5===e.md5)}),globalData:y.globalMaterials,value:R,folder:null===(t=y.currentSpaceDirectoryFiles)||void 0===t?void 0:t.filter(e=>"folder"===e.type),onConfirm:Q,supportFileType:c,onValueOrderChange:e=>{D([...e])},onSelect:e=>{(0,of.Z)(e)?D([...e]):D([e])},loading:null===(r=y.materials)||void 0===r?void 0:r.loading,onDirectorySelect:e=>{var{assetId:t,sourcePath:r,name:i}=e;y.setSpaceDirectoryAssetId({assetId:t,sourcePath:r,name:i})},onCancel:()=>{D([])},sourcePath:y.directoryPath,showSpaceSelector:!0,defaultWorkspace:y.currentWorkspaceId,workspaceList:y.workspaceList,confirmButtonLoading:!1,onWorkspaceChange:e=>{y.setCurrentWorkspaceId(e),y.setSpaceDirectoryMap("-1",{}),y.setSpaceDirectoryAssetId({assetId:"-1",name:y.currentWorkspaceName||""}),q()},status:y.spaceLoadingStatus,onRetry:y.getCurrentSpaceDirectoryFiles.bind(y)})},[E,c,n,h,R,q,Q,F,U,L,O,y,y.globalMaterials,y.directoryPath,y.currentSpaceDirectoryFiles,y.currentWorkspaceName,y.spaceLoadingStatus]);(0,r6.useEffect)(()=>(0,Y.EH)(()=>{var e,t,r,i,o=z.current;null==o||null===(i=o.update)||void 0===i||i.call(o,{data:null===(e=y.currentSpaceDirectoryFiles)||void 0===e?void 0:e.filter(e=>"folder"!==e.type).map(e=>{var t,r;return null===(r=y.materials)||void 0===r?void 0:null===(t=r.materials)||void 0===t?void 0:t.find(t=>t.md5===e.md5)}),value:R,globalData:y.globalMaterials,onConfirm:Q,folder:null===(t=y.currentSpaceDirectoryFiles)||void 0===t?void 0:t.filter(e=>"folder"===e.type),loading:null===(r=y.materials)||void 0===r?void 0:r.loading,sourcePath:y.directoryPath,status:y.spaceLoadingStatus})}),[R,q,H,Q,F,E,U,O,y,y.globalMaterials,null===(o=y.materials)||void 0===o?void 0:o.materials,y.currentWorkspaceId,y.currentSpaceDirectoryFiles,y.directoryPath,y.currentWorkspaceName,y.spaceLoadingStatus]);var $=e=>e?new Promise(t=>{var r={},i=URL.createObjectURL(e),o=document.createElement("video");o.addEventListener("canplay",()=>{r.duration=o.duration,r.resolution="".concat(o.videoWidth,"x").concat(o.videoHeight),URL.revokeObjectURL(o.src),t(r)}),o.src=globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(i,null,{logType:"js.href/src",mode:"black",reportOnly:"all"})}):{},ee=(0,r6.useCallback)((e,t)=>{var r=$(null==t?void 0:t[0]);switch(e){case 2:X();break;case 3:t&&B({fileList:t,action:"click_add",importOptions:d,uploadReportParams:r});break;case 4:t&&B({fileList:t,action:"drag_to_panel",importOptions:d,uploadReportParams:r})}null==s||s()},[B,X,d]),et=(0,r6.useCallback)((r=(0,a._)(function*(e,t){if(!u||(yield u(e))){for(var r of(null==p||p(e,t),Array.from(e||[])))if(!(0,op.J5)({file:r,accepts:c})){en.Z.error(E.t("web_not_supported_material_type",{},"Material format not supported."));return}ee(t,e)}}),function(e,t){return r.apply(this,arguments)}),[c,u,E,ee,p]);(0,r6.useImperativeHandle)(t,()=>({handleFileList:et,onCancel:Z,onRetry:G}));var er=(i=(0,a._)(function*(e){null==_||_(e);var t,r=yield W({pageEnterFrom:e,workspaceId:d.toWorkspaceId});(null==r?void 0:r.ok)&&(e===ou.O9.GOOGLE_DRIVE?t=oh.b.GOOGLE_DRIVE:e===ou.O9.DROP_BOX?t=oh.b.DROPBOX:e===ou.O9.SHOPIFY&&(t=oh.b.SHOPIFY),t&&r.value.show(t))}),function(e){return i.apply(this,arguments)});return(0,r0.jsxs)("div",{className:"upload-field",children:[(0,r0.jsx)(o_,{multiple:n,accept:H,onClick:e=>{if(!N.hasLogin){N.login(),e.preventDefault();return}null==f||f(),S||(e.preventDefault(),null==w||w())},onChange:(e,t)=>{if(!N.hasLogin){e.target.value=null;return}S?(b.resetUploadCollection(),et(Array.from(e.target.files),t?4:3),e.target.value=null):null==w||w(t)}}),(0,r0.jsxs)("div",{className:"upload-sources",children:[I.includes(0)&&(0,r0.jsx)(ib.Z,{long:!0,className:"upload-source-btn",icon:(0,r0.jsx)(ia.YTE,{size:24}),onClick:()=>er(ou.O9.GOOGLE_DRIVE),children:E.t("web_tool_Google_Drived",{},"Google Drive")}),I.includes(1)&&(0,r0.jsx)(ib.Z,{long:!0,className:"upload-source-btn",icon:(0,r0.jsx)(ia.v__,{size:24}),onClick:()=>er(ou.O9.DROP_BOX),children:E.t("web_tool_Dropbox",{},"Dropbox")}),(0,r0.jsx)(ib.Z,{long:!0,className:"upload-source-btn",icon:(0,r0.jsx)(ia.NqL,{size:24}),onClick:X,children:E.t("cloud_web",{},"Space")})]}),(0,r0.jsx)("div",{className:"upload-field-footer",children:l}),(0,r0.jsx)(r9.$U,{instantiationService:U,children:(0,r0.jsx)(og.S,{ref:z})})]})}));let oy={intro:"intro-hXAZXb",title:"title-cp4hj6",desc:"desc-I2g1Ci","join-pro-highlight":"join-pro-highlight-Fk2WlF",joinProHighlight:"join-pro-highlight-Fk2WlF",video:"video-s8x1Du"};r("448782"),r("585499");let ob=r("881991"),ow=r("701823");var oS=(0,r5.Pi)(()=>{var{i18n:e}=(0,i2.$)(),t=(0,r4.G)(u.R),r=(0,r4.G)(eh.t),{quotaManager:i,vipManager:o}=t,{quotaInfo:a}=i,n=()=>{(0,ob.H)(r,{action:"vip_click",source:(0,ow.F)("from_page"),currentPage:"smart_tool_page",entranceType:"text",toolType:"clip_shorts",position:"upload_page"}),o.showVipModal()};return(0,r6.useEffect)(()=>{(0,ob.H)(r,{action:"vip_show",source:(0,ow.F)("from_page"),currentPage:"smart_tool_page",entranceType:"text",toolType:"clip_shorts",position:"upload_page"})},[r,o.hasPayVipAbility]),(0,r0.jsxs)("div",{className:oy.intro,children:[(0,r0.jsx)("div",{className:oy.title,children:e.t("web_long_shorten_1long_viral",{},"1 long, multiple shorts: Viral videos in a snap.")}),(0,r0.jsx)("div",{className:oy.desc,children:o.hasPayVipAbility?e.t("web_m10n_shorts_desc_minutes",{number0:a.freeTotal,number1:a.proTotal,action0:e=>(0,r0.jsx)("span",{className:oy["join-pro-highlight"],onClick:n,children:e})},"You can convert {number0} minutes of long videos to shorts for free every month. <action0>Join Pro</action0> get {number1} extra minutes per month."):e.t("web_long_shorten_text_free",{num:a.freeTotal,number0:a.freeTotal,strong0:e=>(0,r0.jsx)("span",{className:oy["desc-highlight"],children:e})},"You can convert {number0} minutes of long videos to shorts <strong0>for free</strong0> every month.")}),(0,r0.jsx)("div",{className:oy.video,children:(0,r0.jsx)("div",{id:"lv-lts-intro-page-xg-player-el",className:"xgplayer xgplayer-pc no-controls xgplayer-playing xgplayer-inactive",children:(0,r0.jsx)("video",{muted:!0,playsInline:!0,controls:!1,disablePictureInPicture:!0,disableRemotePlayback:!0,crossOrigin:"anonymous",src:globalThis.xssNamespace["lvweb/smart-tools"].filterUrl("https://lf16-web-buz.capcut.com/obj/capcut-web-buz-us/capcut-web-buz-us/ies.lvve-os.editor.oversea/static/media/long2short_upload_intro.mp4",null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),autoPlay:!0,preload:"auto",loop:!0})})})]})});r("272470");let oT=r("282081");var ok=e=>(0,r0.jsxs)("svg",(0,s._)((0,n._)({xmlns:"http://www.w3.org/2000/svg",width:57,height:57,fill:"none",viewBox:"0 0 57 57"},e),{children:[(0,r0.jsx)("path",{fill:"#00CAE0",fillOpacity:.2,d:"M15.067 35.323a4.73 4.73 0 0 1 0-4.732l7.915-13.709a4.73 4.73 0 0 1 4.098-2.366h15.83c1.69 0 3.252.902 4.097 2.366l7.915 13.709a4.73 4.73 0 0 1 0 4.732L47.007 49.03a4.73 4.73 0 0 1-4.098 2.366H27.08a4.73 4.73 0 0 1-4.097-2.366z"}),(0,r0.jsx)("path",{fill:"#090C14",fillRule:"evenodd",d:"m39.043 42.795 6.366-11.026a5.52 5.52 0 0 0 0-5.52l-6.366-11.026a5.52 5.52 0 0 0-4.78-2.76H21.53a5.52 5.52 0 0 0-4.781 2.76l-6.366 11.026a5.52 5.52 0 0 0 0 5.52l6.366 11.026a5.52 5.52 0 0 0 4.78 2.76h12.732a5.52 5.52 0 0 0 4.781-2.76m9.78-9.054a9.46 9.46 0 0 0 0-9.464l-6.365-11.026a9.46 9.46 0 0 0-8.196-4.731H21.531a9.46 9.46 0 0 0-8.196 4.731L6.969 24.277a9.46 9.46 0 0 0 0 9.464l6.366 11.026a9.46 9.46 0 0 0 8.196 4.732h12.731a9.46 9.46 0 0 0 8.196-4.732zM24.886 19.542a3.014 3.014 0 1 1 6.023 0l-.538 11.835a2.476 2.476 0 0 1-4.947 0zm3.011 22.874a3.155 3.155 0 1 1 0-6.31 3.155 3.155 0 0 1 0 6.31",clipRule:"evenodd"})]}));let oI=r("152846"),oP=r("629558"),oC=r("115411"),oM=r("206729");(k=W||(W={})).uploading="uploading",k.success="success",k.failed="failed";var oj=(0,r5.Pi)(()=>{var e,t,{i18n:r}=(0,i2.$)(),i=(0,r4.G)(u.R),o=(0,r4.G)(eh.t),[a,n]=(0,r6.useState)(oI.a7.unknown),{fileSelectionManager:s,stateManager:l,materialManager:c}=i,{mainMaterial:d,uploadingMainMaterial:p,uploadPageLifeCycle:v,preMainMaterial:g,materialImportType:h,supportQuickPlay:f,rawMaterialInfo:_,mainMaterialInfo:m,isFromLocalFile:y,materialImportPlatformType:b}=s,{uploadStatus:w,uploadingAsset:S,modelDuration:T,mergedProgress:k}=(0,oI.NW)({mainMaterial:d,uploadingMainMaterial:p,statusChangeCallBack:(e,t)=>{t===oI.a7.retrying&&"failed"===e&&(null==n||n(oI.a7.failed))},retryStatus:a}),I=()=>{v===ee.jp.Setting&&g?(s.setMainMaterial(g),l.setLifeCycle(v)):l.setLifeCycle(ee.jp.DefaultEmpty)};return(0,r2.default)(()=>{(0,oM.e)(o,{clip_shorts_page:f?"fast_material_import":"normal_material_import",action:"show",is_fast_upload:f?1:0,import_source:s.materialImportPlatformType})}),(0,r6.useEffect)(()=>{a===oI.a7.failed&&"failed"===w&&(n(oI.a7.unknown),en.Z.error(eu.ZP.t("web_ai_clip_shorts_text_not_support",{},"Couldn\u2019t upload. The video format is not supported.")))},[w,a]),(0,r6.useEffect)(()=>{var e,t;(T||"success"===w)&&((null==_?void 0:_.url)||(null==m?void 0:null===(t=m.material)||void 0===t?void 0:null===(e=t.playInfo)||void 0===e?void 0:e.url)||b!==eF.mh.Space)&&l.setLifeCycle(ee.jp.Setting)},[T,w,null==_?void 0:_.url,null==m?void 0:null===(t=m.material)||void 0===t?void 0:null===(e=t.playInfo)||void 0===e?void 0:e.url]),(0,r0.jsxs)("div",{className:"lts-uploading-material-wrapper",children:["uploading"===w?(0,r0.jsxs)(r0.Fragment,{children:[(0,r0.jsxs)("div",{className:"lts-uploading-progress",children:[r.t("web_ai_clip_shorts_text_upload_progress",{number0:k.toFixed(1)},"Video uploading {number0}%"),(0,r0.jsx)(oT.Z,{percent:k,showText:!1})]}),(0,r0.jsx)(ib.Z,{className:"upload-button",size:"large",onClick:()=>{y?(0,oC.I)(o,{action_type:s.materialImportPlatformType===eF.mh.Local?h:s.materialImportPlatformType,status:"cancel",tool_type:"clip_shorts"}):(0,e$.z)(o,{action:"upload_cancel",toolType:"clip_shorts"}),S&&c.cancelUploadMaterial(S),s.setSupportQuickPlay(!0),s.resetUploadInfo(),I()},children:r.t("web_tool_cancel",{},"Cancel")})]}):null,"failed"===w?(0,r0.jsxs)(r0.Fragment,{children:[(0,r0.jsx)(ok,{className:"fail-svg-element"}),(0,r0.jsx)("div",{className:"loading-desc-wrapper",children:r.t("web_failed",{},"Failed")}),(0,r0.jsxs)("div",{children:[(0,r0.jsx)(ib.Z,{size:"large",style:{marginRight:"8px",width:"96px"},onClick:()=>{(0,e$.z)(o,{action:"back_to_select",toolType:"clip_shorts"}),s.setSupportQuickPlay(!0),s.resetUploadInfo(),I()},children:r.t("web_ai_clip_shorts_button_back",{},"Go back")}),(0,r0.jsx)(oP.K,{size:"large",onClick:()=>{(0,e$.z)(o,{action:"retry",toolType:"clip_shorts"}),S?(c.retryUploadMaterial(S),n(oI.a7.retrying)):(s.resetUploadInfo(),l.setLifeCycle(ee.jp.DefaultEmpty))},style:{width:"96px"},children:r.t("web_ai_clip_shorts_button_retry",{},"Retry")})]})]}):null]})});let oO=r("827952"),oL=r("222209");var ox=e=>"".concat("LOCAL_AGREE_LONG_TO1_SHORTS_REDUCED","_").concat(d.o.LongToShort,"_").concat(e),oE=(0,r5.Pi)(e=>{var t,r,o,n,s,l,c,d,p,v,{handleXgPlayerCanPlay:g}=e,h=(0,r4.G)(u.R),f=(0,r4.G)(es.Dk),_=(0,r4.G)(J.Gw),m=(0,r4.G)(eh.t),{i18n:y}=(0,i2.$)(),b=(0,r6.useRef)(null),{uploadPageManager:w,fileSelectionManager:S,loadingPageManager:T,quotaManager:k,stateManager:I}=h,{hasSuccessTasks:P}=T,{historyProjectList:C}=w,{supportQuickPlay:M}=S,[j,O]=(0,r6.useState)(!0),[L,x]=(0,r6.useState)(!1),E=(0,r6.useRef)(null),[R,D]=(0,r6.useState)(!1),F=(0,r6.useRef)(0);w.isUnmount&&w.setIsUnmount(!1);var A=w.fetchHistoryCount||7,N=(0,r6.useCallback)((t=(0,a._)(function*(e){if(j&&!L&&_.hasLogin){x(!0);try{var t=yield f.getHistoryProjects(e);if(w.isUnmount)return;if(!t.ok){O(!1);return}var{value:r}=t,{has_more:i,next_cursor:o,tasks:a}=r;w.setHistoryProjectList(a),F.current=o,O(i),w.setIsHistoryListFetching(!1)}catch(e){O(!1)}finally{x(!1)}}}),function(e){return t.apply(this,arguments)}),[]);(0,r2.default)(()=>{_.hasLogin||_.onDidLogin(()=>{N({count:A,cursor:F.current})}),(0,oM.e)(m,{clip_shorts_page:"default",action:"show"})}),(0,i1.default)(()=>{w.setIsHistoryListFetching(!0),w.resetHistoryList(),w.setIsUnmount(!0)});var U=(0,r6.useMemo)(()=>{if(P)return!1;var e="is_new_clip_user";if(!_.hasLogin&&!i.FB)return!0;if(I.hasChangeToLogin&&C.length)return localStorage.setItem(e,"0"),!1;var t=window.is_new_clip_user;return void 0!==t?t:"0"!==localStorage.getItem(e)&&(!C.length||(localStorage.setItem(e,"0"),!1))},[C,P,I.hasChangeToLogin]);(0,r6.useEffect)(()=>{var e,t,r,i=null===(e=_.userProfile)||void 0===e?void 0:e.uid,o=null===(t=k.quotaInfo)||void 0===t?void 0:t.freeTotal,a=new Date(2024,5,1).getTime(),n=new Date().getTime();if(i&&o&&!(n>a)){var s="not_first_time_enter_clip_shorts".concat(null===(r=_.userProfile)||void 0===r?void 0:r.uid),l=window.localStorage.getItem(s),c=ox(i);window.localStorage.getItem(c)||180===k.quotaInfo.freeTotal||U||l||D(!0),localStorage.setItem(s,"1")}},[null===(o=_.userProfile)||void 0===o?void 0:o.uid,k.quotaInfo.freeTotal,U]);var V=(r=(0,a._)(function*(e){return(0,oL.W$)(e)?yield(0,oL.rS)(e,m):(en.Z.error("".concat(y.t("current_import_format_not_supported",{},"Current import format is not supported"))),!1)}),function(e){return r.apply(this,arguments)}),W=()=>{var e,t=ox(null===(e=_.userProfile)||void 0===e?void 0:e.uid);window.localStorage.setItem(t,"true"),D(!1)};return(0,r0.jsxs)(r0.Fragment,{children:[(0,r0.jsx)(ol,{hasMore:j,classNames:oo["smart-tools-long-to-short-upload-scroll-container"],loading:L,onLoadMore:()=>{N({count:A,cursor:F.current})},children:(0,r0.jsxs)("div",{className:oo["upload-page-wrapper"],children:[(0,r0.jsxs)("div",{className:i4()(oo["upload-area"],{[oo["upload-area-without-intro"]]:!U}),children:[U&&(0,r0.jsx)(oS,{}),M?(0,r0.jsx)("div",{className:oo["upload-field-wrapper"],children:(0,r0.jsx)(om,{accept:["video"],ref:E,uploadOptions:{fromWorkspaceId:null!==(d=null===(n=null!==(c=_.userProfile.defaultSpaceInfo)&&void 0!==c?c:_.userProfile.spaceInfo)||void 0===n?void 0:n.workspaceId)&&void 0!==d?d:"",toWorkspaceId:null!==(v=null===(s=null!==(p=_.userProfile.defaultSpaceInfo)&&void 0!==p?p:_.userProfile.spaceInfo)||void 0===s?void 0:s.workspaceId)&&void 0!==v?v:"",uploadParams:{uploadFlag:24,autoPromote:!0,isMultiDefTranscode:!0,transcodeTemplateType:1}},allowedSources:[oc.uD.GoogleDrive,oc.uD.DropBox],validFile:V,validCloudAsset:e=>(0,oL.qW)(Array.isArray(e)?null==e?void 0:e[0]:e,m),materialManager:h.materialManager,fileSelectionManager:h.fileSelectionManager,selectFile:e=>{var t;null===(t=h.nativeFileSelectionManager)||void 0===t||t.selectFile({targetState:ee.jp.Setting},e).then(t=>{var r,i;(null==t?void 0:t.length)&&(0,e$.z)(m,{action:"import",importType:e?"drag_to_panel":"click_add",importSource:"my_device",size:t.reduce((e,t)=>e+Number(t.size),0),format:null!==(i=null===(r=t[0])||void 0===r?void 0:r.type)&&void 0!==i?i:"",toolType:"clip_shorts"})})},callbacks:{showExpandOnUploadShow:()=>null,handleUploadFailure:()=>{h.fileSelectionManager.resetUploadCollection()},handleUploadSuccess:(e,t)=>{var r;!S.uploadingMainMaterial&&!S.rawMaterialInfo&&!S.mainMaterial||S.cancelUploadingMaterial.includes(null===(r=e.getModel())||void 0===r?void 0:r.id)||(S.setMainMaterial(e),S.setUploadingMainMaterial(void 0),S.setUploadLifeCycle(ee.jp.Setting),S.setIsFromLocalFile(!0),S.setMaterialImportType(null!=t?t:"click_add"),h.stateManager.pageLifeCycle===ee.jp.DefaultEmpty&&h.stateManager.setLifeCycle(ee.jp.Setting))},handleUploadStart:(e,t)=>{S.updateCancelUploadingMaterial(),S.filePreUploadCost[1]=Number(new Date),h.setUploadingMainMaterial(e),S.setIsFromLocalFile(!0),S.setMaterialImportType(null!=t?t:"click_add");var r,i=null==e?void 0:null===(r=e.getModel().uploading)||void 0===r?void 0:r.file;if(i){var o={url:URL.createObjectURL(i),key:void 0};S.materialImportPlatformType===eF.mh.Local&&(null==g||g(o))}},beginImportCallBack:()=>{h.fileSelectionManager.filePreUploadCost[0]=Number(new Date)}},onSelectCloudAsset:e=>{(0,e$.z)(m,{action:"import",importType:"click_add",importSource:"my_space"}),S.updateCancelUploadingMaterial(),S.setMainMaterial(Array.isArray(e)?null==e?void 0:e[0]:e),S.setUploadLifeCycle(ee.jp.Setting),S.setIsFromLocalFile(!1),S.reportImportMaterialFormCloud(Array.isArray(e)?null==e?void 0:e[0]:e),S.setSupportQuickPlay(!1)},useWebUpload:null===(l=h.cacheManager)||void 0===l?void 0:l.enableWebUpload,pickCloudFileTitle:y.t("web_long_shorten_text_select_file",{},"Select video"),pickCloudFileBtnText:y.t("web_shorts_btn_select_video",{},"Select"),toolType:"clip_shorts",uploadMeta:{showLocalUploadSuccessToast:!1},onPickLocal:()=>{S.setMaterialImportPlatformType(eF.mh.Local),(0,e$.z)(m,{action:"select_material"})},onPickCloud:()=>{S.setMaterialImportPlatformType(eF.mh.Space),(0,e$.z)(m,{action:"my_space"})},onPickThirdParty:e=>{S.setMaterialImportPlatformType(e),(0,e$.z)(m,{action:e})},children:(0,r0.jsx)(r0.Fragment,{children:(0,r0.jsxs)("div",{className:oo["duration-tip"],children:[(0,r0.jsxs)("div",{className:oo["duration-left"],children:[(0,r0.jsx)("span",{children:y.t("web_m10n_shorts_desc_consumption",{},"Time consumed = duration of uploaded video")}),(0,r0.jsx)(oO.n,{})]}),(0,r0.jsx)("div",{children:y.t("web_shorts_text_time_limit",{number0:3,number1:10},"Upload a video under {number0} hours and {number1} GB.")}),(0,r0.jsxs)("div",{children:[(0,r0.jsx)("div",{children:y.t("web_long_shorten_text_multi_lauguage",{},"This feature supports more than 24 languages.")}),(0,r0.jsx)(ir.Z,{content:y.t("web_long_shorten_text_en_cn_",{},"English (US), English (UK), Chinese, Japanese, Korean, Portuguese, Spanish, Russian, Indonesian, Turkish, German, French, Italian, Dutch, Vietnamese, Thai, Malay, Romanian, Polish, Arabic, Filipino, Burmese, Bengali, Kazakh"),children:(0,r0.jsx)(ia.Qwj,{})})]})]})})})}):(0,r0.jsx)("div",{className:oo["upload-field-wrapper"],children:(0,r0.jsx)(oj,{})})]}),_.hasLogin?(0,r0.jsx)("div",{className:i4()(oo["task-area"],{[oo["task-area-without-intro"]]:!U}),children:(0,r0.jsx)(oi,{withoutIntro:!U})}):null]})}),(0,r0.jsx)("div",{style:{width:0,height:0,opacity:0},children:(0,r0.jsx)("div",{ref:b,id:"lv-lts-setting-page-xg-player-el"})}),(0,r0.jsx)(e1.Z,{visible:R,title:eu.ZP.t("web_m10n_shorts_popup_title_time_reduced",{},"Conversion time reduced"),onCancel:W,footer:(0,r0.jsx)(ib.Z,{type:"primary",onClick:()=>W(),children:eu.ZP.t("web_m10n_shorts_popup_btn_ok",{},"OK")}),children:eu.ZP.t("web_m10n_shorts_popup_desc_time_reduced",{number0:k.quotaInfo.proTotal,number1:k.quotaInfo.freeTotal},"You can now upgrade to get {number0} minutes of conversion time every month. Your monthly free conversion time has been changed to {number1}.")})]})});let oR=r("636183"),oD=r("173006"),oF=r("293793"),oA=r("495860"),oN=r("574496"),oU=r("85993"),oV=r("592693"),oW=r("626173");var oB=()=>({dataLoaded:!1,seeking:!1,waiting:!0,paused:!0,currentTime:0,duration:0,everCanPlay:!1,error:null,ended:!1,bufferedRange:[0,0],isFullscreen:!1,volume:0,muted:!1,playUrl:"",complete:!1,loadStart:!1}),oZ=e=>(0,s._)((0,n._)({},e),{get progress(){return 0!==this.duration?this.currentTime/this.duration:0},get buffering(){return this.seeking||this.waiting},get bufferProgress(){var t,r;return 0!==this.duration?(null!==(r=null===(t=this.bufferedRange)||void 0===t?void 0:t[1])&&void 0!==r?r:0)/this.duration:0}}),oG=oZ(oB()),oH=e=>{var t=(0,r4.G)(el.L),{config:r,version:i,needRetry:o=!0,reInitCnt:l}=e||{},{seekToFirstFrame:c=!0}=r||{},[u,d]=(0,r6.useState)(),[p,v]=(0,oN.default)(oB()),[g,h]=(0,r6.useState)(""),[f,_]=(0,r6.useState)(),m=(0,oD.default)(0),y=m.state>=3,b=(0,r6.useMemo)(()=>(0,s._)((0,n._)({},f),{_retry:m.state}),[f,m.state]);(0,oA.default)(()=>{_(r),m.reset()},[r,i]);var w=(0,oF.default)(()=>{(null==r?void 0:r.url)&&(p.error&&t.captureException("xgplayer",Error(JSON.stringify(p.error)),{retryCnt:String(m.state)}),!y&&o&&(console.error("xgplayer video error! retry now. (".concat(m.state,") src: ").concat(null==r?void 0:r.url)),m.inc()))});(0,oU.default)((0,a._)(function*(){if(v(oB()),!(null==f?void 0:f.url)){d(void 0),h("");return}v({playUrl:f.url});var{player:e,Events:t}=yield(0,oV.up)(f);return d(e),h(f.url),e.on(t.COMPLETE,()=>v((0,n._)({complete:!0},(0,oW.Z)(e,"volume","muted")))),e.on(t.LOAD_START,()=>{v({dataLoaded:!1,loadStart:!0})}),e.on(t.LOADED_DATA,e=>{v({dataLoaded:!0,duration:e.duration,loadStart:!1})}),e.on(t.ERROR,e=>{v({error:e}),w()}),e.on(t.WAITING,()=>{v({waiting:!0})}),e.on(t.CANPLAY,()=>{v({waiting:!1,everCanPlay:!0})}),e.on(t.PAUSE,()=>v({paused:!0})),e.on(t.PLAY,()=>v({paused:!1})),e.on(t.SEEKING,()=>v({seeking:!0})),e.on(t.SEEKED,()=>v({seeking:!1})),e.on(t.TIME_UPDATE,()=>v({currentTime:e.currentTime,bufferedRange:e.getBufferedRange()})),e.on(t.PROGRESS,()=>v({bufferedRange:e.getBufferedRange()})),e.on(t.ENDED,()=>{v({ended:!0})}),e.on(t.FULLSCREEN_CHANGE,e=>v({isFullscreen:e})),e.on(t.VOLUME_CHANGE,()=>v((0,n._)({},(0,oW.Z)(e,"volume","muted")))),e.on(t.DEFINITION_CHANGE,e=>{var{to:t}=e;return v({playUrl:t.url})}),Object.values(t).forEach(r=>{var i=[t.TIME_UPDATE,t.PROGRESS,t.PLAYER_BLUR,t.PLAYER_FOCUS];e.on(r,t=>{i.includes(r)||console.info("xgplayer event:",r,"networkState:",e.networkState,"readyState:",e.readyState,t),e.currentTime<e.duration&&v({ended:!1})})}),()=>{e.destroy()}}),[b,l]),(0,r6.useEffect)(()=>{p.ended&&c&&(null==u||u.seek(0))},[u,p.ended,c]),(0,r6.useEffect)(()=>{if(null==u?void 0:u.video){var e,t;null===(e=(t=u.video).setAttribute)||void 0===e||e.call(t,"preload","auto")}},[null==u?void 0:u.video,p.dataLoaded]);var S=(0,r6.useMemo)(()=>{var e=y?p.error:null;return oZ((0,s._)((0,n._)({},p),{error:o?e:p.error}))},[p,y]);return g!==(null==r?void 0:r.url)?{playerIns:void 0,playerState:oG}:{playerIns:u,playerState:S}};let oz=r("355997"),oq=r("702844"),oK=r("214547"),oQ=r("813072"),oJ=r("810381");var oY=()=>{var e,t,[r,i]=(0,r6.useState)({url:"",id:"lv-lts-setting-page-xg-player-el",decryptKey:"",volume:.4,seekToFirstFrame:!1,withCredentials:!1,plugins:[]}),o=(0,r4.G)(oJ.m),{rawSupportHls:a,hlsPluginSupported:l}=(0,oV.g4)(o),c=!a&&l,[d,p]=(0,r6.useState)({url:""}),{fileSelectionManager:v,stateManager:g,ttLiveVideoManager:h}=(0,r4.G)(u.R),{rawMaterialInfo:f}=v,{ttVideoInfo:_,encryptId:m,videoType:y}=h,{pageLifeCycle:b}=g,[w,S]=(0,r6.useState)(null),T=(0,oD.default)(0),k=(0,r6.useMemo)(()=>{if(b===ee.jp.Setting&&v.mainMaterialInfo&&(![eF.mh.DROPBOX,eF.mh.GOOGLE_DRIVE].includes(v.materialImportPlatformType)||v.videoTranscodeInfo||!v.supportQuickTranscode))return v.mainMaterialInfo},[b,b===ee.jp.Setting?v.mainMaterialInfo:void 0]),{playerIns:I,playerState:P}=oH({config:r,needRetry:(0,r6.useMemo)(()=>!v.isFromLocalFile||b!==ee.jp.DefaultEmpty,[v.isFromLocalFile,b]),reInitCnt:T.state}),C=e=>{var t,i=c&&_.playUrl&&h.encryptId&&y===es.WY.Live&&e===_.playUrl,o=i&&!oq.Z.isHevcSupported()&&oK.Z.isSupported()?{mediaType:"xg-video"}:{};o.mediaType&&oK.Z.init({h265Url:"https://lf16-web-buz.capcut.com/obj/capcut-web-buz-us/ies.lvve-smart-toolbox-os.editor.oversea/static/js/hevc.decoder.js"});var a=i?{plugins:[...r.plugins,oz.$],isLive:!1}:{plugins:null==r?void 0:null===(t=r.plugins)||void 0===t?void 0:t.filter(e=>(null==e?void 0:e.pluginName)!=="hls")};return(0,n._)({},a,o)};(0,r6.useEffect)(()=>{if(!v.isFromLocalFile||!v.supportQuickPlay||!P.dataLoaded){var e=(()=>{if(f)return f.url;var e,t=null==k?void 0:k.material;return(null==t?void 0:null===(e=t.playInfo)||void 0===e?void 0:e.url)||_.playUrl||""})(),t=(()=>{if(!f&&(null==k?void 0:k.material)){var e;return(null===(e=(null==k?void 0:k.material).playInfo)||void 0===e?void 0:e.key)||""}return""})(),o=(0,n._)((0,s._)((0,n._)({},r),{decryptKey:t,url:e}),C());(0,oQ.Z)(o,r)&&v.materialImportPlatformType===eF.mh.Space&&T.inc(),e&&i(r=>(0,n._)((0,s._)((0,n._)({},r),{decryptKey:t,url:e}),C(e)))}},[null==k?void 0:k.material,m,f,_,m?b:void 0]);var M=()=>{S(document.getElementById("lv-lts-setting-page-xg-player-el"))};return(0,r6.useEffect)(()=>{P.complete&&!v.isFromLocalFile&&b===ee.jp.DefaultEmpty&&M()},[P.complete]),(0,r6.useEffect)(()=>{if(v.isFromLocalFile&&(null==d?void 0:d.url)&&v.uploadingMainMaterial){var e,t,r=null==I?void 0:null===(e=I.video)||void 0===e?void 0:e.videoHeight,i=null==I?void 0:null===(t=I.video)||void 0===t?void 0:t.videoWidth;r&&i&&P.complete&&(M(),v.supportQuickPlay&&v.setRawMaterialInfo((0,s._)((0,n._)({},d),{width:i,height:r})),v.setSupportQuickPlay(!0),g.setLifeCycle(ee.jp.Setting)),r&&i||!P.error||(v.setRawMaterialInfo(void 0),v.setSupportQuickPlay(!1),g.setLifeCycle(ee.jp.DefaultEmpty))}},[null==I?void 0:null===(e=I.video)||void 0===e?void 0:e.videoHeight,null==I?void 0:null===(t=I.video)||void 0===t?void 0:t.videoWidth,P.error,P.complete]),{playerIns:I,playerState:P,xgConfig:r,handleXgPlayerCanPlay:e=>{var t={decryptKey:"",withCredentials:!1,url:e.url};p(e),i(e=>(0,n._)({},e,C(),t))},currentVideoEle:w,reInitCnt:T}};let oX={"long-to-short-container":"long-to-short-container-SnrMOx","preview-and-edit-page-container":"preview-and-edit-page-container-VB1Zw3"};var o$=r6.lazy(()=>Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,639835)).then(e=>({default:e.FilmTaskList}))),o0=r6.lazy(()=>Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,597730)).then(e=>({default:e.PreviewPage}))),o1=r6.lazy(()=>Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,859896)).then(e=>({default:e.SettingPage}))),o2=r6.lazy(()=>Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,428327)).then(e=>({default:e.QuickEditPage}))),o6=(0,r5.Pi)(e=>{var t,{containerService:r}=e,o=(0,r4.G)(r3.S),l=(0,r4.G)(u.R),{stateManager:c,persistedManager:p,quotaManager:v,ttLiveVideoManager:g,cacheManager:h,fileSelectionManager:f}=l,{pageLifeCycle:_}=c,m=(0,r4.G)(i0.E),y=(0,r4.G)(J.Gw),[b,w]=(0,r6.useState)(!1),{expandModalInstance:S}=m.storageExpandManager,T=i.FB?{fixedTheme:oR.Q.Dark}:{},k=oY(),{handleXgPlayerCanPlay:I,reInitCnt:P}=k;i.FB?(y.hasLogin||y.login({showLoginDialog:!1}),document.body.setAttribute("lv-theme","dark")):(t={manager:c},(0,r6.useLayoutEffect)(()=>{var e,r,i,o;return e={onThemeChange:e=>t.manager.updateTheme(e)},r=window.matchMedia("(prefers-color-scheme: dark)"),i=t=>{e.onThemeChange(t.matches?oR.Q.Dark:oR.Q.Light)},r.addListener(i),o=t=>{var{key:r,newValue:i,oldValue:o}=t;r===eG&&o!==i&&i&&e.onThemeChange(i)},window.addEventListener("storage",o),()=>{r.removeListener(i),window.removeEventListener("storage",o)}},[]),(0,r6.useLayoutEffect)(()=>{var e=window.localStorage.getItem(eG),r=e&&e===oR.Q.Dark?oR.Q.Dark:oR.Q.Light;t.manager.updateTheme(r),(0,Y.U5)(()=>t.manager.theme,e=>{e===oR.Q.Dark?(document.body.setAttribute("lv-theme","dark"),document.body.setAttribute("arco-theme","dark")):(document.body.removeAttribute("lv-theme"),document.body.removeAttribute("arco-theme")),window.localStorage.setItem(eG,e)},{fireImmediately:!0})},[])),(0,r2.default)(()=>{(0,ec.w3)();var e=new URLSearchParams(location.search),t=e.get("taskId");e.delete("pageStatus"),e.delete("taskId"),e.delete("uploadId"),e.delete("capflowKey");var i=e.toString(),{pathname:o}=window.location,a="".concat(o,"?").concat(i);window.history.replaceState(null,"",a);var{encryptId:n}=g;t||p.restore(),n&&(f.setMaterialImportType("click_add"),c.pageLifeCycle===ee.jp.DefaultEmpty&&c.setLifeCycle(ee.jp.Setting),f.setMaterialImportPlatformType("tt_live")),(0,e$.z)(r,{action:"show"})}),(0,r2.default)(()=>{setInterval(()=>{g.encryptId&&c.pageLifeCycle===ee.jp.Setting||p.save()},5e3)}),(0,r2.default)(()=>{y.hasLogin||y.onDidLogin((0,a._)(function*(){if(v.fetchUserBenefit(),c.updateHasChangeToLogin(!0),!i.FB){var e=yield l.handleRedirect();c.updateNeedRedirect(!e)}}))}),(0,r6.useEffect)(()=>{function e(e){return c.doNotBlockWindowClose?void 0:(h.enableWebWindowInterceptor&&(e.preventDefault(),e.returnValue=""),g.encryptId&&c.pageLifeCycle===ee.jp.Setting||p.save(),"")}return l.handleRedirect(),y.hasLogin&&v.fetchUserBenefit(),window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]),(0,r6.useEffect)(()=>{var e;null===(e=l.afterInit)||void 0===e||e.call(l),l.waitForIdleManagerInitial().then(()=>{w(!0)})},[]);var C=e=>b?e:(0,r0.jsx)(r0.Fragment,{});return(0,r0.jsxs)(r7.x,(0,s._)((0,n._)({service:o.dangerUsedUserMachineService},T),{children:[(0,r0.jsxs)(r8.W,{className:i4()(oX["long-to-short-container"],"smart-tools-contaner"),children:[!i.FB&&(0,r0.jsx)(ie.h,{smartToolType:eM.lQ.LongToShort,handleBackHome:()=>{p.setStopSaving(!0)},rightSlot:()=>(0,r0.jsxs)(r0.Fragment,{children:[(0,r0.jsx)(iY,{}),C((0,r0.jsx)(r6.Suspense,{children:(0,r0.jsx)(o$,{})})),(0,r0.jsx)(iX.J,{expandModalInstance:S,smartToolType:eM.lQ.LongToShort,onAfterModalClose:()=>null})]})}),_===ee.jp.DefaultEmpty?(0,r0.jsx)(oE,{handleXgPlayerCanPlay:I}):null,_===ee.jp.Setting?C((0,r0.jsx)(r6.Suspense,{children:(0,r0.jsx)(o1,(0,n._)({},k))})):null,[ee.jp.CreateLoading,ee.jp.PreviewResult,ee.jp.QuickEdit,ee.jp.TaskFail].includes(_)?(0,r0.jsxs)("div",{className:oX["preview-and-edit-page-container"],style:i.FB?{height:"100%"}:{},children:[C((0,r0.jsx)(r6.Suspense,{children:(0,r0.jsx)(o0,{isCreating:[ee.jp.CreateLoading,ee.jp.TaskFail].includes(_),isTaskFail:ee.jp.TaskFail===_,pageType:_===ee.jp.QuickEdit?tr.pq.QuickEdit:tr.pq.PlayVideo,goBackCall:()=>{P.inc()}})})),_===ee.jp.QuickEdit?C((0,r0.jsx)(r6.Suspense,{children:(0,r0.jsx)(o2,{})})):null]}):null]}),(0,r0.jsx)(i$.X,{toolType:d.o.LongToShort,show:!!g.encryptId,playerConfig:{autoplay:!0,autoplayMuted:!0}})]}))}),o3=e=>{var{containerService:t}=e;return(0,r0.jsx)(r9.$U,{instantiationService:t,children:(0,r0.jsx)(o6,{containerService:t})})},o4=e=>{var t=document.getElementById("root");r1.createRoot(t).render((0,r0.jsx)(o3,{containerService:e}))};let o9=r("787384");class o7 extends o9.c{_getModule(){return(0,a._)(function*(){return(yield Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,569204))).GraphicToolkitService})()}}let o5=r("797644");class o8 extends l.x{getTeaConfig(){return(0,n._)({},rn.zd)}getSlardarConfig(){return{bid:rn.Cz.bid}}getStarlingConfig(){var e,t,{localesMap:r,pI18nResult:i,__lng:o}=window;return r&&i&&o&&(e={lng:o,resources:(0,a._)(function*(){try{if(yield i,window.__lngResource)return{[o]:{translation:window.__lngResource}};return}catch(e){return}})()}),{namespace:rn.Xw.namespace,injectI18nResource:e,specifyLocale:null!==(t=new URLSearchParams(window.location.search).get("lang"))&&void 0!==t?t:void 0}}registerAppService(e,t){return(0,a._)(function*(){e.register(tu.q,td.P),yield(0,o5.Cv)(e,(0,s._)((0,n._)({},t),{databaseSchemas:[tp.g,tv.P]}));var r=(0,o5.NS)();e.registerInstance(c.i,r)})()}registerUserService(e,t,r){(0,o5.Hy)(e,t,r)}bindDev(e){globalThis.__debugger=e.invokeFunction(e=>{var t=e.get(u.R),r=e.get(c.i);return{mainLongToShortWidgetService:t,quickEditManager:t.quickEditManager,environmentService:r}})}constructor(...e){super(...e),this.toolType=d.o.LongToShort,this.restoreSessionData=e=>{e.invokeFunction(e=>{var t=e.get(u.R);t.loadingPageManager.taskId||t.ttLiveVideoManager.encryptId||t.persistedManager.restore()})},this.beforeRender=e=>{},this.preloadResource=()=>{},this.renderApp=e=>{o4(e)},this.registerBusinessService=e=>{(0,r$.l)(e,{}),e.register(H,$),e.register(rQ.D,rJ.e),e.register(u.R,to),e.register(tg.uJ,tg.Vl),e.register(eI.SG,tO),e.register(es.Dk,tD),e.register(tF.j,tz),e.register(tq.o,tJ),e.register(tY.B,new tl.M(t5,[],!1)),e.register(t8.J,new tl.M(rI,[],!1)),e.register(rP.j,rL),e.register(rx.H,rW),e.register(rp.c,rB.s),e.register(rZ._,rG.s),e.register(rH.Q,rz.W),e.register(e4.c,rq.z),e.register(e5.r,(0,tc.l)(o7)),e.register(ta.K,tn.A),e.register(rY.x,rX.b),e.register(eP.h,rK.D),e.register(tW.Ui,new tl.M(ts.a,[{appConfiguration:{export:{useExportV3:!1},forcePageV2:!0}}]))}}}class ae{setConfig(e){}getTeaConfig(){return{}}reportPv(e){}setCustomParams(e){}getCustomParams(){return{}}setCommonEventParams(e){}getCommonEventParams(){return{}}track(e,t,r){}ensureTrack(e,t,r){}getABConfig(){return Promise.resolve()}getABTestVar(e,t){return Promise.resolve(t)}getWebId(){return Promise.resolve("")}getSessionId(){return""}}class at{_createInterceptor(){try{var e,t;this._origin=null===(e=window[this._key])||void 0===e?void 0:e.bind(window),(null===(t=this._origin)||void 0===t?void 0:t.isIntercepted)||(window[this._key]=this.init.bind(window)),window[this._key]&&(window[this._key].isIntercepted=!0)}catch(e){}}init(){}dispose(){window[this._key]=this._origin}constructor(){this._key="",this._jsBridge=er.S4}}class ar extends at{constructor(){super(),this._key="open",this.init=(e,t,r)=>{if(!e)return null;var i=0,o=0;if(r){var a=r.split(",").map(e=>e.split("=")).reduce((e,t)=>(e[t[0]]=t[1],e),{width:0,height:0});i=Number(a.width),o=Number(a.height)}return t?this._jsBridge.openWebPage({schema:"".concat("string"==typeof e?e:e.href),width:i||800,height:o||600,title:"",injectJsb:!0}):this._jsBridge.push({schema:"".concat("string"==typeof e?e:e.href),useSysBrowser:!1,viewType:"2"}),null},this._createInterceptor()}}class ai{_initInterceptors(){this._interceptorInstances=this._interceptors.map(e=>new e)}clear(){this._interceptorInstances.forEach(e=>e.dispose())}constructor(e){this._interceptors=e,this._interceptorInstances=[],this._initInterceptors()}}(I=B||(B={}))[I.NoStart=0]="NoStart",I[I.Cliping=1]="Cliping",I[I.Uploading=2]="Uploading",I[I.Analyzing=3]="Analyzing",I[I.Downloading=4]="Downloading",I[I.Successed=5]="Successed",I[I.Failed=6]="Failed",I[I.Cacneled=7]="Cacneled";var ao=()=>{var e=new ty.yk().build(ty.kk);return(0,tw.i3)(e),(0,tS.mH)(e),(0,tk.V)(e),e};class aa{get _networkClient(){var e;return null!==(e=this._networkClientInstance)&&void 0!==e?e:this._networkClientInstance=ao()}_getApi(e){return"".concat(tT._L.getVar("web_domain")).concat(e)}getHistoryProjects(e){var t=this;return(0,a._)(function*(){try{var r,i,o=yield t._networkClient.post(t._getApi(tx.GET_HISTORY_PROJECTS_FOR_PC),e,{withCredentials:!0});if("0"!==o.ret)return(0,eU.wf)(Number(o.ret),o.errmsg);var a={success:1,failed:-1,processing:0},n=(null!==(i=null===(r=o.data)||void 0===r?void 0:r.capflow_list)&&void 0!==i?i:[]).map(e=>{var t,r,i,n,s;return{id:e.capflow_id,status:null!==(r=a[e.status])&&void 0!==r?r:1,project_name:e.material_name,cover_url:e.cover_url,progress:Math.floor((null!==(i=e.progress)&&void 0!==i?i:0)*100),error_code:Number(o.ret),clip_count:null!==(n=null===(t=e.material_list)||void 0===t?void 0:t.length)&&void 0!==n?n:0,estimate_time:Math.floor((null!==(s=e.forecast_cost)&&void 0!==s?s:0)/1e3)}}),s=(yield t._getLocalHistoryProjects()).filter(e=>!n.find(t=>e.id===t.id)),l={next_cursor:o.data.next_cursor,has_more:o.data.has_more,tasks:[...s,...n]};return(0,eU.oW)(l)}catch(e){return(0,tP.m)(e,-1,"getHistoryProjects api error.")}})()}_getLocalHistoryProjects(){return(0,a._)(function*(){var e,t=(yield er.S4.getTaskProgress({})).data;return console.log("[test]: localProjects",t),(null!==(e=null==t?void 0:t.tasks)&&void 0!==e?e:[]).filter(e=>{var t=e.status;return[B.NoStart,B.Uploading,B.Cliping].includes(t)||B.Failed===t&&!e.capflowId}).map(e=>{var t=es.Kw.uploading;return e.status===B.Failed&&(t=es.Kw.uploadFail),{id:e.uploadId,cover_url:e.cover,status:t,progress:Math.floor(e.progress),project_name:e.projectName,isLocal:!0}})})()}updateTaskMeta(e){var t=this;return(0,a._)(function*(){var r=yield t._networkClient.post(t._getApi(tx.UPDATE_TASK_META),e,{withCredentials:!0});return"0"!==r.ret?(0,eU.wf)(Number(r.ret),r.errmsg):(0,eU.oW)(r.data)})()}}class an{updateTaskMeta(e){var t=JSON.stringify({start_time:e.start,end_time:e.end});return this._longToShortRepository.updateTaskMeta({capflow_id:e.capflow_id,draft_key:e.draft_key,content:t,scene:e.scene})}getHistoryProjects(e){return e.cap_key||(e.cap_key=eI.gW.CapKeyForPc),this._longToShortRepository.getHistoryProjects(e)}getHistoryItemInfo(e){return e.idType===es.Xd.uploadId?this._getHistoryItemByUploadId(e.id):this._getHistoryItemByTaskId(e.id)}getTTRoomInfo(e){(0,ex.ss)()}_getHistoryItemByUploadId(e){var t=this;return(0,a._)(function*(){var r,i,o=(yield er.S4.getTaskProgress({})).data,a=null!==(i=(null!==(r=null==o?void 0:o.tasks)&&void 0!==r?r:[]).find(t=>t.uploadId===e))&&void 0!==i?i:null;if(!a)return(0,eU.oW)(null);if(a.capflowId)return t._getHistoryItemByTaskId(a.capflowId,!0);var n=t._transUploadTaskStatusToHistoryItemStatus(a.status);return(0,eU.oW)({error_code:0,clip_count:0,estimate_time:0,id:a.uploadId,cover_url:a.cover,status:n,progress:Math.floor(a.progress),project_name:a.projectName,isLocal:!0})})()}_getHistoryItemByTaskId(e,t){var r=this;return(0,a._)(function*(){var i,o,a,n,s,l,c,u,d,p,v=yield r._intelligentRepositoryWithoutRetry.getIntelligentTask({smart_tool_type:eQ.no.LongToShort,task_id:e,scene:void 0,region:void 0,platform:void 0,workspace_id:"",app_id:0});return v.ok&&v.value?(0,eU.oW)({error_code:0,clip_count:null!==(c=null===(i=v.value.task_detail)||void 0===i?void 0:i.length)&&void 0!==c?c:0,estimate_time:(null!==(u=v.value.estimate_time)&&void 0!==u?u:0)>0&&null!==(d=v.value.estimate_time)&&void 0!==d?d:0,id:e,cover_url:(null===(n=v.value.task_detail)||void 0===n?void 0:null===(a=n[0])||void 0===a?void 0:null===(o=a.preview_info)||void 0===o?void 0:o.cover_url)||"",status:r._transIGetIntelligentSmartTaskStatusToHistoryItemStatus(v.value.status),progress:0,project_name:v.value.origin_resource_name,isLocal:!!t,benefitId:null!==(p=null===(l=v.value)||void 0===l?void 0:null===(s=l.benefit_detail)||void 0===s?void 0:s.id)&&void 0!==p?p:""}):(0,eU.wf)(Number(v.code),v.msg)})()}_transUploadTaskStatusToHistoryItemStatus(e){var t;switch(e){case B.Cacneled:case B.Failed:t=es.Kw.fail;break;case B.Successed:t=es.Kw.success;break;case B.NoStart:case B.Cliping:case B.Uploading:t=es.Kw.uploading;break;case B.Downloading:case B.Analyzing:t=es.Kw.doing;break;default:t=es.Kw.success}return t}_transIGetIntelligentSmartTaskStatusToHistoryItemStatus(e){var t;switch(e){case th.v.Failure:t=es.Kw.fail;break;case th.v.ProgressSuccess:t=es.Kw.success;break;case th.v.Success:case th.v.Process:t=es.Kw.doing;break;default:t=es.Kw.success}return t}constructor(e){this._instantiationService=e,this._longToShortRepository=this._instantiationService.createInstance(aa),this._intelligentRepositoryWithoutRetry=new tM(!0)}}an=(0,z.gn)([(0,z.fM)(0,tL.T),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===tL.T?Object:tL.T])],an);let as=r("879565"),al=r("620967");class ac extends eT{onPaySuccess(){this._quotaManager.fetchUserBenefit(!0)}getIsSupportPay(){var e=this;return(0,a._)(function*(){var t=yield(0,et.Gh)();if(void 0===t||"1"===t){e.hasPayVipAbility=!0;return}e.hasPayVipAbility=!1})()}showVipModal(){er.S4.showSubscriptionDialog({type:"personal_vip",enter_from:"smart_tool_page",edit_page_positon:"",feature_datas:[{feature_id:"clip_shorts",feature_name:"clip_shorts"}]});var e=er.S4.purchaseStateChanged(t=>{t.data.isBuyVipSuccess&&this.onPaySuccess(),e.remove()})}constructor(e,t,r,i){super(e,t,r,i),this._quotaManager=t,this._accountService=r,this._containerService=i,(0,Y.rC)(this)}}ac=(0,z.gn)([(0,z.fM)(2,J.Gw),(0,z.fM)(3,eh.t),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===d.o?Object:d.o,"undefined"==typeof QuotaManager?Object:QuotaManager,void 0===J.Gw?Object:J.Gw,void 0===eh.t?Object:eh.t])],ac);let au=r("810925");class ad{selectFile(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return(0,a._)(function*(){var{accept:i="video",multiple:o=!1,targetState:a}=e;try{var n,s=t?(yield r._setDroppedVideoFile()).data:(yield r._openFileSelector({accept:i,multiple:o})).data;if((null==s?void 0:s.status)===au.zq.SUCCESS)r._onSelectFileSuccess.fire(null!==(l=null==s?void 0:s.files)&&void 0!==l?l:[],a);else{(null==s?void 0:s.status)===au.zq.UN_SUPPORT_EXT&&(0,oL.Id)();var l,c,u,d=null!==(u=null==s?void 0:null===(c=s.files)||void 0===c?void 0:c.reduce((e,t)=>{var r;return e+(null!==(r=t.duration)&&void 0!==r?r:0)},0))&&void 0!==u?u:0;(null==s?void 0:s.status)===au.zq.UN_SUPPORT_LEN&&(0,oL.tk)(d,r._containerService),(null==s?void 0:s.status)===au.zq.UN_SUPPORT_SIZE&&(0,oL.vh)(d,r._containerService)}return null!==(n=null==s?void 0:s.files)&&void 0!==n?n:[]}catch(e){return[]}})()}_openFileSelector(e){return er.S4.openFileSelector(e)}_setDroppedVideoFile(){return er.S4.setDroppedVideoFile()}constructor(e){this._containerService=e,this._onSelectFileSuccess=new ef.Q,this.onSelectFileSuccess=this._onSelectFileSuccess.event,(0,Y.rC)(this)}}ad=(0,z.gn)([(0,z.fM)(0,eh.t),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===eh.t?Object:eh.t])],ad);class ap{push(e){var{schema:t="",useSysBrowser:r=!1,viewType:i="1",extraData:o}=e;er.S4.push({schema:t,useSysBrowser:r,viewType:i,extraData:o})}pop(){er.S4.pop()}pushToSetting(e){this.push({schema:"setVideoPage",viewType:"1",extraData:JSON.stringify({files:e})})}closeCurrentWindow(){er.S4.close()}confirmWindowClose(e){er.S4.setWebviewCloseAlert({enable:e})}setWindowHideDuringUpload(e){er.S4.setHideWebViewWhenClose({hideWebViewWhenClose:e}),er.S4.setUploadCloseAlert({hasUploadTask:e})}constructor(e){this._stateManager=e}}(P=Z||(Z={})).taskId="taskId",P.uploadId="uploadId";class av extends eO{setHistoryProjectList(e){var t=ej.localHistoryProjectList,r=this.historyProjectList.filter(e=>!e.isLocal),i=e.filter(e=>e.isLocal&&!t.find(t=>t.id===e.id)),o=e.filter(e=>!e.isLocal&&!r.find(t=>t.id===e.id)&&!t.find(t=>t.id===e.id));ej.setLocalHistoryProjectList([...t,...i]),ej.setServerHistoryProjectList([...r,...o])}_generateUrl(e,t,r){return"".concat(location.origin).concat(eC.bZ[eM.lQ.LongToShort],"?pageStatus=").concat(t,"&").concat(r,"=").concat(e,"&toolsEnterFrom=historyProject&flowType=pc")}startPollingUnreadyTask(){var e=this;return(0,a._)(function*(){var t,r=e.historyProjectList.filter(e=>[es.Kw.doing,es.Kw.uploading].includes(e.status));yield Promise.all(r.map((t=(0,a._)(function*(t){var r={id:t.id,idType:t.status===es.Kw.uploading?"uploadId":"taskId"},i=yield e._longToShortDataService.getHistoryItemInfo(r);i.ok&&i.value&&([es.Kw.success,es.Kw.fail,es.Kw.uploadFail].includes(i.value.status)&&e._mainLongToShortWidgetService.quotaManager.fetchUserBenefit(),ej.updateHistoryProject(t.id,i.value))}),function(e){return t.apply(this,arguments)}))),yield(0,ek._)(1e4),e.startPollingUnreadyTask()})()}constructor(e,t,r,i){super(e,t,r),this._mainLongToShortWidgetService=e,this.flowType=t,this._longToShortDataService=r,this._commercialDataService=i,this.fetchHistoryCount=7,this.handleProjectClick=e=>{var t;ee.jp.CreateLoading,[es.Kw.uploading,es.Kw.uploadFail].includes(e.status)?null===(t=this._mainLongToShortWidgetService.nativeTaskManager)||void 0===t||t.importUploadId(e.id):(ee.jp.PreviewResult,this._mainLongToShortWidgetService.loadingPageManager.importTaskId(e.id,e.status))}}}av=(0,z.gn)([(0,z.fM)(2,es.Dk),(0,z.fM)(3,eP.h),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===u.R?Object:u.R,void 0===o.M?Object:o.M,void 0===es.Dk?Object:es.Dk,void 0===eP.h?Object:eP.h])],av);class ag{getAndSetAbTestVar(){var e=this;return(0,a._)(function*(){try{var t="enable_long_to_short_trim",r="enable_long_to_short_layout",i=yield er.S4.getSettings({nodeKey:"ai_shorts_clip_layout",keys:[t,r]});1===i.code&&(e.enableLongToShortTrim="true"===i.data.nodeKey[t],e.enableLongToShortLayout="true"===i.data.nodeKey[r]);var o=yield er.S4.getSettings({nodeKey:"enable_long_to_short_subtitle_opt",keys:["enable"]});1===o.code&&(e.enableLongToShortSubtitleOpt="true"===o.data.nodeKey.enable);var a=yield er.S4.getSettings({nodeKey:"long_to_short_preview_caption_text",keys:["enable"]});return 1===a.code&&(e.enableLongToShortPreviewCaptionText="true"===a.data.nodeKey.enable),!1}catch(e){return!1}})()}initIdleManager(){var e=this;return(0,a._)(function*(){try{var t=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,57661)).then(e=>e.PreviewPageManager),i=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,916371)).then(e=>e.ExportFilmTaskManager),o=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,512641)).then(e=>e.VideoDraftManager),a=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,673706)).then(e=>e.NativeTaskManager),n=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,979933)).then(e=>e.QuickEditManagerForPc),s=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,452153)).then(e=>e.ExportManagerForPc),l=Promise.all([r.e("8583"),r.e("3173"),r.e("7716"),r.e("9680")]).then(r.bind(r,830621)).then(e=>e.PlayerManager);yield Promise.all([t,i,o,n,s,l,a]),e.previewPageManager=e._containerService.createInstance((yield t)),e.exportFilmTaskManager=e._containerService.createInstance((yield i)),e.videoDraftManager=e._containerService.createInstance((yield o)),e.nativeTaskManager=e._containerService.createInstance((yield a),e.loadingPageManager,e.stateManager),e.playerManager=e._containerService.createInstance((yield l)),e.quickEditManager=e._containerService.createInstance((yield n),e.extraFrameManager,e.materialManager,e.stateManager,e.videoDraftManager,e.previewPageManager,e.playerManager),e.exportManager=e._containerService.createInstance((yield s),e.loadingPageManager,e.previewPageManager,e.stateManager,e.quickEditManager,e.videoDraftManager),e.quickEditManager.onEditorSdkReady(t=>{var r,{renderSdk:i}=t;null===(r=e.playerManager)||void 0===r||r.setRenderSdk(i)}),e.quickEditManager.onExitEdit(t=>{var r,i;null===(r=e.playerManager)||void 0===r||r.unmount(),null===(i=e.previewPageManager)||void 0===i||i.setNeedUpdateByTaskId(t.resourceId,!0)}),e.quickEditManager.onEnterEdit(t=>{var r;null===(r=e.playerManager)||void 0===r||r.updateDuration(BigInt(t.video.duration)*BigInt(1e6))}),e.quickEditManager.onDraftLoadStageChange(t=>{if(t.stage===tr.Hv.Finished){var r,i,o,a=null===(i=e.quickEditManager)||void 0===i?void 0:null===(r=i.dataSdk)||void 0===r?void 0:r.draftView.getDuration();a&&(null===(o=e.playerManager)||void 0===o||o.updateDuration(a))}}),e.isIdleManagerInitial=!0}catch(e){throw Error("long-to-short-service: manager init error")}})()}waitForIdleManagerInitial(){var e=this;return(0,a._)(function*(){return!!e.isIdleManagerInitial||(yield(0,ek._)(100),e.waitForIdleManagerInitial())})()}resetToEmpty(){var e,t,r;this.fileSelectionManager.reset(),this.loadingPageManager.reset(),this.loadingPageManager.resetPageStage(),this.settingPageManager.reset(),null===(e=this.previewPageManager)||void 0===e||e.reset(),this.persistedManager.resetCache(),null===(t=this.ttLiveVideoManager)||void 0===t||t.reset(),this.stateManager.setLifeCycle(ee.jp.DefaultEmpty),null===(r=this.nativeTaskManager)||void 0===r||r.reset()}get graphicToolkitService(){return this._graphicToolkitService}get slardarAdapterService(){return this._slardarAdapterService}handleRedirect(){var e=this;return(0,a._)(function*(){var t,r=(t=(0,a._)(function*(e){try{var t=yield e.aiCheckPopup();if(t.ok)return!t.value;return!1}catch(e){return!1}}),function(e){return t.apply(this,arguments)}),i=yield r(e._aiToolDataService);return i||(e.stateManager.doNotBlockWindowClose=!0,e6()),i})()}setUploadingMainMaterial(e){this.fileSelectionManager.uploadMaterialFailed=!1,this.fileSelectionManager.setUploadingMainMaterial(e),this.stateManager.doNotBlockWindowClose=!1}handleUploadFailure(e){this.fileSelectionManager.uploadMaterialFailed=!1}_initWindowCloseConfirm(){var e,t,{version:r}=(0,i.dU)();if(!(0>=(0,et.yC)(r,"3.9.0"))){var o=null===(e=this.nativeRouteManager)||void 0===e?void 0:e.confirmWindowClose;this.cacheManager.enableWebviewHide&&(o=null===(t=this.nativeRouteManager)||void 0===t?void 0:t.setWindowHideDuringUpload),null==o||o(!1),window.addEventListener("beforeunload",()=>{null==o||o(!1)}),this.fileSelectionManager.onUploadMaterialStart(()=>{null==o||o(!0)}),this.fileSelectionManager.onUploadMaterialEnd(()=>{null==o||o(!1)})}}afterInit(){try{null===(e=document.getElementById("preload-csr-root"))||void 0===e||e.remove(),setTimeout(()=>{er.S4.firstFrameRendered()},33);var e,t,r,i,o,a,l,c,u,d,p=null!==(l=null===(r=performance.getEntriesByName("first-contentful-paint"))||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.startTime)&&void 0!==l?l:0,v=null!==(c=null===(o=performance.getEntriesByName("first-paint"))||void 0===o?void 0:null===(i=o[0])||void 0===i?void 0:i.startTime)&&void 0!==c?c:0,g=performance.now(),h=null!==(u=null===(a=window.__smartToolsPerfTime)||void 0===a?void 0:a.webFirstFrameRendered)&&void 0!==u?u:p,f=performance.timeOrigin;window.__smartToolsPerfTime=(0,s._)((0,n._)({},null!==(d=window.__smartToolsPerfTime)&&void 0!==d?d:{}),{webReady:g,webFcp:p,webFp:v,webOrigin:f}),er.S4.bridge.call("getPerfTime",{},e=>{var t,r,i,o,a,{data:l}=e;window.__smartToolsPerfTime=(0,s._)((0,n._)({},null!==(i=window.__smartToolsPerfTime)&&void 0!==i?i:{}),{naBrowserLoadEnd:l.browserLoadEndTime,naWindowShow:l.windowShowTime,naFirstFrameRendered:l.firstFrameRenderedTime,duration:{naDuration:f-l.windowShowTime,webFirstFrameRenderDuration:h,webReadyDuration:g-h,firstSceneTime:f-l.windowShowTime+h,allTime:g+f-l.windowShowTime}});var c={webReady:g,webFp:v,webFcp:p,webOrigin:f,webFirstFrameRendered:h,webInitUserStart:null!==(o=null===(t=window.__smartToolsPerfTime)||void 0===t?void 0:t.webInitUserStart)&&void 0!==o?o:0,webInitUserEnd:null!==(a=null===(r=window.__smartToolsPerfTime)||void 0===r?void 0:r.webInitUserEnd)&&void 0!==a?a:0,naBrowserLoadEnd:l.browserLoadEndTime,naWindowShow:l.windowShowTime,naFirstFrameRendered:l.firstFrameRenderedTime,naDuration:f-l.windowShowTime,webFirstFrameRenderDuration:h,webReadyDuration:g-h,allTimeDuration:g+f-l.windowShowTime};tt(this._containerService,c),this._slardarAdapterService.sendEvent("long_to_short_init",c)})}catch(e){console.error("long-to-short-service error",e);var _,m,y,b,w,S,T,k,I,P,C,M,j=null!==(k=null===(m=performance.getEntriesByName("first-contentful-paint"))||void 0===m?void 0:null===(_=m[0])||void 0===_?void 0:_.startTime)&&void 0!==k?k:0,O=performance.now(),L=null!==(I=null===(y=window.__smartToolsPerfTime)||void 0===y?void 0:y.webFirstFrameRendered)&&void 0!==I?I:j,x={webReady:O,webFcp:j,webFp:null!==(P=null===(w=performance.getEntriesByName("first-paint"))||void 0===w?void 0:null===(b=w[0])||void 0===b?void 0:b.startTime)&&void 0!==P?P:0,webOrigin:performance.timeOrigin,webFirstFrameRendered:L,webInitUserStart:null!==(C=null===(S=window.__smartToolsPerfTime)||void 0===S?void 0:S.webInitUserStart)&&void 0!==C?C:0,webInitUserEnd:null!==(M=null===(T=window.__smartToolsPerfTime)||void 0===T?void 0:T.webInitUserEnd)&&void 0!==M?M:0};tt(this._containerService,x),this._slardarAdapterService.sendEvent("long_to_short_init",x)}}constructor(e,t,r,i,a,n){this._containerService=e,this.resourceService=t,this._aiToolDataService=i,this._slardarAdapterService=a,this._configurationService=n,this.isIdleManagerInitial=!1,this.enableLongToShortTrim=!1,this.enableLongToShortLayout=!1,this.enableLongToShortSubtitleOpt=!1,this.enableLongToShortPreviewCaptionText=!1,this.handleThirdPartyMaterialBeforeCreated=(e,t)=>{var r=e[0];this.settingPageManager.resetVideoCropInfo(),this.fileSelectionManager.setSupportQuickTranscode(!1),this.fileSelectionManager.updateCancelUploadingMaterial(),this.fileSelectionManager.setRawMaterialInfo(void 0),this.setUploadingMainMaterial(r),this.fileSelectionManager.setSupportQuickPlay(!1),this.fileSelectionManager.setIsFromLocalFile(!1),this.stateManager.setLifeCycle(ee.jp.DefaultEmpty),this.fileSelectionManager.setMaterialImportType("click_add"),(0,e$.z)(this._containerService,{action:"import",importType:"click_add",importSource:t})},this.handleThirdPartyMaterialCreated=e=>{var{material:t}=e;t.onUploadFailure(()=>{this.handleUploadFailure(t)}),t.onResourceReady(()=>{var e;!this.fileSelectionManager.uploadingMainMaterial||this.fileSelectionManager.cancelUploadingMaterial.includes(null===(e=t.getModel())||void 0===e?void 0:e.id)||(this.setUploadingMainMaterial(void 0),this.fileSelectionManager.setMainMaterial(t))})},this.cacheManager=e.createInstance(ea,{enableWebPolicy:!1,enableWebWindowInterceptor:!1,enableEmailNotify:!1}),this.stateManager=e.createInstance(ee.O3),this.quotaManager=e.createInstance(e3,this.stateManager),this.ttLiveVideoManager=this._containerService.createInstance(ed),this.ttVideoSpritesManager=e.createInstance(eg,this.ttLiveVideoManager),this.vipManager=e.createInstance(ac,d.o.LongToShort,this.quotaManager),this.extraFrameManager=e.createInstance(eD,this,this.stateManager),this.resultCoverLoadManager=e.createInstance(eK.l),this.fileSelectionManager=e.createInstance(eF.dj,this,this.stateManager),this.nativeFileSelectionManager=e.createInstance(ad),this.nativeRouteManager=e.createInstance(ap,this.stateManager),this.loadingPageManager=e.createInstance(eA.Gw,this,this.quotaManager),this.persistedManager=e.createInstance(eq,this,this.stateManager,!1),this.uploadPageManager=e.createInstance(av,this,o.M.PC),this.settingPageManager=e.createInstance(ep.T),this.materialManager=e.createInstance(e7.P,{accept:["video"],countLimit:1,currentPage:"smart_tool_page",toolType:"clip_shorts",onBeforeCreated:this.handleThirdPartyMaterialBeforeCreated,onCreated:this.handleThirdPartyMaterialCreated}),this.taskPreloadManager=e.createInstance(eX),r.getInstance(new e0._y).then(e=>{this._graphicToolkitService=e}),this.nativeFileSelectionManager.onSelectFileSuccess((e,t)=>{if(t===ee.jp.Setting){var r;null===(r=this.nativeRouteManager)||void 0===r||r.pushToSetting(e)}}),this._initWindowCloseConfirm(),this.initIdleManager(),this.getAndSetAbTestVar(),(0,eJ.Yb)()}}ag=(0,z.gn)([(0,z.fM)(0,eh.t),(0,z.fM)(1,e4.c),(0,z.fM)(2,e5.r),(0,z.fM)(3,e9.H),(0,z.fM)(4,el.L),(0,z.fM)(5,ti.u),(0,z.w6)("design:type",Function),(0,z.w6)("design:paramtypes",[void 0===eh.t?Object:eh.t,void 0===e4.c?Object:e4.c,void 0===e5.r?Object:e5.r,void 0===e9.H?Object:e9.H,void 0===el.L?Object:el.L,void 0===ti.u?Object:ti.u])],ag);let ah=r("912061");switch((0,i.dU)().flowType||""){case o.M.PC:G=new class extends o8{registerAppService(e,t){return(0,a._)(function*(){e.register(tu.q,td.P),yield(0,o5.it)(e,(0,s._)((0,n._)({},t),{databaseSchemas:[tp.g,tv.P]}));var r=(0,o5.NS)();e.registerInstance(c.i,r)})()}initTeaAdapter(){return new ae}getStarlingConfig(){var e,t,{localesMap:r,pI18nResult:i,__lng:o}=window;return r&&i&&o&&(e={lng:o,resources:(0,a._)(function*(){try{if(yield i,window.__lngResource)return{[o]:{translation:window.__lngResource}};return}catch(e){return}})()}),{namespace:rn.Xw.namespace,specifyLocale:null!==(t=new URLSearchParams(window.location.search).get("lang"))&&void 0!==t?t:"en",injectI18nResource:e}}registerUserService(e,t,r){(0,o5.uY)(e,t,r)}bindDev(e){super.bindDev(e),this._initInterceptors(e)}_initInterceptors(e){e.createInstance(ai,[ar])}setSlardarConfig(e){(0,ah.b)(e,{commonParams:{flowType:o.M.PC,version:(0,i.dU)().version}})}afterRender(e,t){var r;(null===(r=window)||void 0===r?void 0:r.pcCsrPreloadError)&&e.invokeFunction(e=>{var t,r,i=e.get(el.L);null==i||i.captureException("longToShortCsrPreloadError",null!==(r=null===(t=window)||void 0===t?void 0:t.pcCsrPreloadError)&&void 0!==r?r:Error())})}constructor(...e){super(...e),this.registerBusinessService=e=>{(0,r$.l)(e,{}),e.register(as.c,new tl.M(al.b,[d.o.LongToShort])),e.register(H,$),e.register(rQ.D,rJ.e),e.register(tg.uJ,tg.dP),e.register(u.R,ag),e.register(eI.SG,tO),e.register(es.Dk,an),e.register(tF.j,tz),e.register(tq.o,tJ),e.register(tY.B,new tl.M(t5,[],!1)),e.register(t8.J,new tl.M(rI,[])),e.register(rP.j,rL),e.register(rx.H,rW),e.register(rp.c,rB.s),e.register(rZ._,rG.s),e.register(rH.Q,rz.W),e.register(e4.c,rq.z),e.register(e5.r,(0,tc.l)(o7)),e.register(ta.K,tn.A),e.register(rY.x,rX.b),e.register(eP.h,rK.D),e.register(tW.Ui,new tl.M(ts.a,[{appConfiguration:{export:{useExportV3:!1},forcePageV2:!0}}]))}}};break;case o.M.WEB:G=new o8;break;case o.M.PRELOAD:G={startLifeCycle:()=>{var e=()=>{er.S4.loadResourceFinished({loadFinish:!0}),window.removeEventListener("load",e)};window.addEventListener("load",e)}};break;default:G=new o8}G.startLifeCycle();let af=()=>null},941514:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}}),console.log("long-to-short ===>");let i=()=>{}},63579:function(e,t,r){"use strict";r.d(t,{W:function(){return c}});var i=r(461228),o=r(91933),a=r(691716),n=r(710799),s={baseURL:"/lv/v1",method:"POST",headers:{loc:o.yM.CHANNEL,lan:o.yM.LAN,pf:o.yM.APP_PF,appvr:o.yM.VERSION,tdid:"","sign-ver":1,"app-sdk-version":o.yM.APP_SDK_VERSION}},l=a.ZP.createAxios(s);l.interceptors.request.use(e=>{var{pf:t,appvr:r,tdid:i}=s.headers;return Object.assign(e.headers,(0,n.O)({url:"".concat(e.baseURL).concat(e.url),pf:t,appvr:r,tdid:i})),e}),l.interceptors.response.use(e=>{if(200!==e.status)return Promise.reject(e);var t=e.data;return"0"===t.ret?Promise.resolve(t):Promise.reject(e)});var c={getTrendingTools:()=>(0,i._)(function*(){return yield l({url:"/intelligence/trending_tools"})})(),getRecentUseTools:()=>(0,i._)(function*(){return yield l({url:"/intelligence/recent_use_tools"})})(),checkPopup:()=>(0,i._)(function*(){return yield l({url:"/intelligence/check_popup"})})(),getAppIsInvalidInCurrentRegion:e=>l({method:"post",data:{app_id:e},url:"/lite/config/check_region",withCredentials:!0})}},778544:function(e,t,r){"use strict";r.d(t,{S:function(){return o},z:function(){return l}});var i,o,a=r(625656),n=r(174800);(i=o||(o={})).common="common",i.beauty="beauty",i.autoCut="autoCut",i.voiceClone="voiceClone",i.tts="tts",i.avTranslator="avTranslator",i.urlToVideo="urlToVideo",i.utvDontDialog="utvDontDialog",i.textToVideo="textToVideo",i.aigcVideo="aigcVideo",i.long2Short="long2Short",i.digitalHuman="digitalHuman";var s=[a.yp.US,a.yp.GB,a.yp.CA,a.yp.AU,a.yp.NZ],l={common:[{common:{test:!0}}],beauty:[{countryBL:[6254930,294640],cityBL:[4896861],curRegionOutList:[a.yp.IL,a.yp.PS]}],autoCut:[{cityBL:[4896861]}],voiceClone:[{cityBL:[4896861],curRegionInList:[a.yp.TW,a.yp.HK,a.yp.MO,a.yp.US,a.yp.GB,a.yp.CA,a.yp.AU,a.yp.NZ]}],tts:[{abTestSync:{name:"enable_workspace_tts_smart_tools_entry"}}],avTranslator:[{checkRegion:{appId:581541},abTestSync:{name:"enable_workspace_video_translator_smart_tools_entry"}}],urlToVideo:[{language:{langs:["en"]},notSensitiveInGateway:!0},{i18n:{langs:[n.zE.English.key]},notSensitiveInGateway:!0},{curRegionInList:s,notSensitiveInGateway:!0}],utvDontDialog:[{isSensitiveInGateway:!0},{curRegionInList:s},{language:{langs:["en"]}},{i18n:{langs:[n.zE.English.key]}}],textToVideo:[{i18n:{langs:[n.zE.English.key]}}],aigcVideo:[{abTestSync:{name:"enable_workspace_aigc_smart_tools_entry"}}],long2Short:[{checkPopup:!0}],digitalHuman:[{i18n:{langs:[n.zE.English.key]}}]}},464830:function(e,t,r){"use strict";r.d(t,{Y:function(){return c},_:function(){return u}});var i=r(461228),o=r(123951),a=r(554269),n=r(652189),s=r(63579),l=r(778544);class c{_getGeoNameIdFromGateWay(){var e=window.ip_location_info,{Country:t,Subdivisions:r}=null!=e?e:{};return{countryGeoNameId:null==t?void 0:t.GeoNameID,cityGeoNameId:(null==r?void 0:r.length)&&r[0].GeoNameID}}_common(){return(0,i._)(function*(){var{vip_entrance:e}=yield n.k.getEntrances();return null==e?void 0:e.enable})()}_abTest(e){return(0,a.y)().getABTestConfig(e,!1)}_abTestSync(e){return(0,a.y)().getABTestConfigSync(e,!1)}_checkRegion(e){return(0,i._)(function*(){var t,r;return!(null===(r=yield s.W.getAppIsInvalidInCurrentRegion(e))||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.invalid)})()}_checkPopup(){return(0,i._)(function*(){var e,t;return!(null===(t=yield s.W.checkPopup())||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.need_check)})()}_i18n(e){return e.includes(o.ZP.language)}_isNotSensitiveInGateway(){return!window.is_sensitive_region}_language(e){return e.some(e=>{var t,r;return!!(null===(r=window.navigator)||void 0===r?void 0:null===(t=r.language)||void 0===t?void 0:t.startsWith(e))})}_isCountryInWL(e){var{countryGeoNameId:t}=this._getGeoNameIdFromGateWay();return t&&e.includes(t)}_isCityInWL(e){var{cityGeoNameId:t}=this._getGeoNameIdFromGateWay();return t&&e.includes(t)}_isCountryNotInBL(e){var{countryGeoNameId:t}=this._getGeoNameIdFromGateWay();return!(t&&e.includes(t))}_isCityNotInBL(e){var{cityGeoNameId:t}=this._getGeoNameIdFromGateWay();return!(t&&e.includes(t))}_isCurRegionInList(e){var t,r,i;return e.includes(null!==(i=null===(r=this._currentZone)||void 0===r?void 0:null===(t=r.region)||void 0===t?void 0:t.toUpperCase())&&void 0!==i?i:"")}_doStrategies(e,t){var r=this;return(0,i._)(function*(){try{switch(e){case"abTest":return yield r._abTest(t.name);case"checkRegion":return yield r._checkRegion(t.appId);case"checkPopup":return t&&(yield r._checkPopup());case"common":return t.test&&(yield r._common());default:return r._doStrategiesSync(e,t)}}catch(e){return console.error("_doStrategies error:",e),!1}})()}_doStrategiesSync(e,t){switch(e){case"abTestSync":return this._abTestSync(t.name);case"i18n":return this._i18n(t.langs);case"language":return this._language(t.langs);case"isSensitiveInGateway":return t&&!this._isNotSensitiveInGateway();case"notSensitiveInGateway":return t&&this._isNotSensitiveInGateway();case"countryWL":return this._isCountryInWL(t);case"cityWL":return this._isCityInWL(t);case"countryBL":return this._isCountryNotInBL(t);case"cityBL":return this._isCityNotInBL(t);case"curRegionInList":return this._isCurRegionInList(t);case"curRegionOutList":return!this._isCurRegionInList(t);default:return!1}}assembleStrategies(e){var t=this;return(0,i._)(function*(){var r;return(yield Promise.all(e.map((r=(0,i._)(function*(e){return(yield Promise.all(Object.keys(e).map(r=>t._doStrategies(r,e[r])))).every(e=>e)}),function(e){return r.apply(this,arguments)})))).some(e=>e)})()}assembleStrategiesSync(e){return e.some(e=>Object.keys(e).every(t=>this._doStrategiesSync(t,e[t])))}isAllow(e){var t,{scene:r,isWhiteUser:i}=e;return i?Promise.resolve(!0):this.assembleStrategies(null!==(t=l.z[r])&&void 0!==t?t:[])}isAllowSync(e){var t,{scene:r,isWhiteUser:i}=e;return!!i||this.assembleStrategiesSync(null!==(t=l.z[r])&&void 0!==t?t:[])}updateCurrentZone(e){this._currentZone=e}}var u=new c},898449:function(e,t,r){"use strict";r.d(t,{a:function(){return l}});var i,o=r(461228),a=r(285617),n=r(691716),s=r(804815);(0,o._)(function*(){try{if("undefined"==typeof __locationInfo){var{data:e}=yield a.U.getLocation();window.__locationCountryCode=e.code,window.__locationInfo=e,n.ZP.updateRequestDomain({domain:e.domain})}}catch(e){console.log("injectLocationBeforeRender function Error ".concat(e,", auto inject default value"));var t=(0,s.hF)();window.__locationCountryCode="US",window.__locationInfo={city:"",code:"US",country_name:"",domain:t,region:"",web_idc:"useast2a"}}});var l=(i=(0,o._)(function*(){var e,t=null===(e=window)||void 0===e?void 0:e.__locationInfo;if(!t){var{data:r}=yield a.U.getLocation();t=r}n.ZP.updateRequestDomain({domain:t.domain})}),function(){return i.apply(this,arguments)})},91087:function(e,t,r){"use strict";r.d(t,{J:function(){return c}});var i=r(461228);r(349601);var o=r(781494),a=r(818351),n=r(889650),s=r(123951),l=r(254845);class c{get isInitializing(){if(this._observableData.isInitialized)return!1;if(this._observableData.loading)return!0;var e,t,r=this._observableData.categories.list[0];return!this._observableData.loadingFailure&&(!r||null===(t=null===(e=this._observableData.materialsByCategory[r.id])||void 0===e?void 0:e.loading)||void 0===t||t)}get isInitializeFail(){if(this._observableData.loadingFailure)return!0;var e,t,r=this._observableData.categories.list[0];return!!r&&null!==(t=null===(e=this._observableData.materialsByCategory[r.id])||void 0===e?void 0:e.loadingFailure)&&void 0!==t&&t}get isInitialized(){return this._observableData.isInitialized}get isLoading(){return this._observableData.loading}get activeCategory(){return this._observableData.activeCategory}get categories(){return this._observableData.categories}get materialsByCategory(){return this._observableData.materialsByCategory}get loadingPolyCategories(){return this._observableData.loadingPolyCategories}loadMore(e){this.fetchListByCategory(e,!0)}retryInitialize(){this._observableData.loadingFailure&&!this._observableData.loading?this.bootstrap():this._prefetchListByCategories()}switchActiveCategory(e){var t;(0,l.z)(()=>{this._observableData.activeCategory=null==e?void 0:e.id}),!e||(null===(t=this._observableData.materialsByCategory[e.id])||void 0===t?void 0:t.isInitialized)||this.fetchListByCategory(e)}refreshWhenFilterChange(e){(0,l.z)(()=>{Object.assign(this._observableData,{loading:!0,loadingFailure:!1,activeCategory:e,categories:{list:[],details:{}},materialsByCategory:{},loadingPolyCategories:!1}),this._listMapStore.clear(),this.bootstrap(!1)})}getNextMaterialByCategory(){if(this._props.materialUsePoly){this._getNextBatchOfCategoriesForCombine();return}var e=this._observableData.categories.list.find(e=>{var t=this._observableData.materialsByCategory[e.id];return!t||!t.isInitialized});if(e){var t=this._observableData.materialsByCategory[e.id];(null==t?void 0:t.loading)||this.fetchListByCategory(e)}}fetchListByCategory(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=this;return(0,i._)(function*(){var i,u,d=c._listMapStore.get(e.id);if(!d){var p,v,g,h,f,_=null!==(f=null===(g=(h=c._props).getMaterialQueryToken)||void 0===g?void 0:g.call(h,e))&&void 0!==f?f:{};d={locker:new a.L,queryToken:(0,n.ib)(_,[])},c._listMapStore.set(e.id,d)}var{locker:m}=d;if((null===(p=c._observableData.materialsByCategory[e.id])||void 0===p||!p.loading)&&m.tryLock()){var y=null!==(i=null===(v=c._observableData.materialsByCategory[e.id])||void 0===v?void 0:v.list.length)&&void 0!==i?i:0,b=!1;try{(0,l.z)(()=>{var r=c._observableData.materialsByCategory[e.id];r?r.loading=!t:(r={isInitialized:!1,loading:!t,loadingFailure:!1,hasMore:!1,isEmpty:!1,list:[]},c._observableData.materialsByCategory[e.id]=r)});var w=yield c._props.getMaterialByCategory(d.queryToken);if(!w.ok){(0,l.z)(()=>{var t=c._observableData.materialsByCategory[e.id];t.loadingFailure=!0,t.loading=!1}),o.Z.warning(s.ZP.t("network_unavailable__please_try_again_later",{},"Network error. Try again later."));return}b=!0,d.queryToken=w.value,(0,l.z)(()=>{var r=c._observableData.materialsByCategory[e.id];r.isInitialized=!0,r.loading=!1,r.loadingFailure=!1,r.hasMore=w.value.hasMore,r.list=t?r.list.concat(w.value.value):w.value.value,w.value.value.length||(r.isEmpty=!0)})}catch(t){(0,l.z)(()=>{var t=c._observableData.materialsByCategory[e.id];t.loadingFailure=!0,t.loading=!1}),o.Z.warning(s.ZP.t("network_unavailable__please_try_again_later",{},"Network error. Try again later."))}finally{m.unLock()}var{hasMore:S,list:T}=null!==(u=c._observableData.materialsByCategory[e.id])&&void 0!==u?u:{hasMore:!1,list:[]};b&&r&&y===T.length&&(S?c.fetchListByCategory(e,t,r):c.getNextMaterialByCategory())}})()}bootstrap(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=this;return(0,i._)(function*(){if(t._bootstrapMutex.tryLock()){(0,l.z)(()=>{e&&(t._observableData.isInitialized=!1),t._observableData.loadingFailure=!1,t._observableData.loading=!0});try{var r=yield t._props.getCategories();if(!r.ok){(0,l.z)(()=>{t._observableData.loadingFailure=!0,t._observableData.loading=!1}),o.Z.warning(s.ZP.t("network_unavailable__please_try_again_later",{},"Network error. Try again later."));return}(0,l.z)(()=>{e&&(t._observableData.isInitialized=!0),t._observableData.loading=!1,t._observableData.categories=r.value.value}),t._props.materialUsePoly?t._initCategoriesFromDetailInfo():t._prefetchListByCategories()}catch(e){(0,l.z)(()=>{t._observableData.loadingFailure=!0,t._observableData.loading=!1}),o.Z.warning(s.ZP.t("network_unavailable__please_try_again_later",{},"Network error. Try again later."))}finally{t._bootstrapMutex.unLock()}}})()}_prefetchListByCategories(){for(var e,t=Math.min(this._observableData.categories.list.length,null!==(e=this._props.prefetchFirstOfCategoryCount)&&void 0!==e?e:1),r=0;r<t;r++){var i=this._observableData.categories.list[r];this.fetchListByCategory(i)}}_getNextBatchOfCategoriesForCombine(){var e=this;return(0,i._)(function*(){var{categoryCount:t}=e._props,r=null!=t?t:1,i=[];e._observableData.categories.list.forEach(t=>{var o=e._observableData.materialsByCategory[t.id];r<=0||null!=o&&o.list.length||null!=o&&o.isEmpty||(r--,i.push(e.fetchListByCategory(t)))}),i.length&&((0,l.z)(()=>{e._observableData.loadingPolyCategories=!0}),yield Promise.all(i),(0,l.z)(()=>{e._observableData.loadingPolyCategories=!1}))})()}_initCategoriesFromDetailInfo(){var{categories:{list:e,details:t}}=this._observableData;e.forEach(e=>{(0,l.z)(()=>{var r,i,o,a;this._observableData.materialsByCategory[e.id]={isInitialized:!1,loading:!1,loadingFailure:!1,isEmpty:!1,hasMore:null===(o=null==t?void 0:null===(r=t[e.id])||void 0===r?void 0:r.hasMore)||void 0===o||o,list:null!==(a=null==t?void 0:null===(i=t[e.id])||void 0===i?void 0:i.list)&&void 0!==a?a:[]}})})}constructor(e){this._props=e,this._bootstrapMutex=new a.L,this._listMapStore=new Map,this._observableData=(0,l.LO)({isInitialized:!1,loading:!0,firstLoading:!1,loadingFailure:!1,activeCategory:void 0,categories:{list:[],details:{}},materialsByCategory:{},loadingPolyCategories:!1}),e.disableBootstrap||this.bootstrap()}}},941366:function(e,t,r){"use strict";r.d(t,{AB:function(){return g},Sx:function(){return _},nQ:function(){return d}});var i,o=r(461228),a=r(997428),n=r(619398),s=r(39769),l=r(791647),c=r(806705),u=r(980014);function d(e,t,r){var i,o=(i=[n._g.UserAudio,n._g.UserFile,n._g.UserPhoto,n._g.UserVideo,n._g.UserFile].includes(t)?(0,a.G)(r,t):(0,s.l)(t,r),e.add(i.key,i.resource),i);return e.get(o.key,t)}var p=(i=(0,o._)(function*(e,t){var r=[],i=[],o=new Map;for(var a of e){var n=function(e){i.push(createImageBitmap(e.graphic).then(t=>(o.set(e,t),t)))},{buffer:s,mimeType:l,frameCount:d,imageWidth:p,imageHeight:v,singleFrameHeight:g,singleFrameWidth:h}=a,f=yield t.converter.bufferToImage(s,l);f.ok&&f.value||(0,u.ss)("[TimelineResource] split sprites error");var _=t.sprite.split({graphic:f.value,xCount:p/h,yCount:v/g,totalCount:d,compress:{height:100}},c.O.Canvas);for(var m of _)n(m);r.push(..._)}try{yield Promise.all(i)}catch(e){}return r.map(e=>{var t;return{image:null!==(t=o.get(e))&&void 0!==t?t:e.graphic,x:e.x,y:e.y,width:e.width,height:e.height,timestamp:0n}})}),function(e,t){return i.apply(this,arguments)});function v(){return(v=(0,o._)(function*(e){var t=yield e.getThumbResourceTokens();try{yield Promise.all(t.map(e=>(0,l.x)(e)))}catch(e){throw e}var r=[];for(var i of t){(0,u.ZB)(i.value);var{buffer:o,contentType:a,frameCount:n,imageHeight:s,imageWidth:c,singleFrameHeight:d,singleFrameWidth:p}=i.value;r.push({buffer:o,mimeType:a,frameCount:n,imageHeight:s,imageWidth:c,singleFrameHeight:d,singleFrameWidth:p})}return r})).apply(this,arguments)}function g(e,t){return h.apply(this,arguments)}function h(){return(h=(0,o._)(function*(e,t){return p((yield function(e){return v.apply(this,arguments)}(e)),t)})).apply(this,arguments)}function f(){return(f=(0,o._)(function*(e,t,r){var{attrs:i}=t,{compress:o}=r;return function(e,t){var r,i,{compress:o}=t;return"number"==typeof(null==o?void 0:o.width)&&o.width>0?i=(r=o.width)*e.naturalHeight/e.naturalWidth:"number"==typeof(null==o?void 0:o.height)&&o.height>0?r=(i=o.height)*e.naturalWidth/e.naturalHeight:(r=e.naturalWidth,i=e.naturalHeight),createImageBitmap(e,{resizeWidth:r,resizeHeight:i})}((yield function(e){var{attrs:t={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((r,i)=>{var o=new Image;for(var[a,n]of Object.entries(t))o[a]=n;o.onload=()=>r(o),o.onerror=(e,t,r,o,a)=>{i(a)},o.src=globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(e,null,{logType:"js.href/src",mode:"black",reportOnly:"all"})})}(e,{attrs:i})),{compress:o})})).apply(this,arguments)}function _(e){var t=e.getCoverResourceToken();return t.startImmediately(),new Promise((e,r)=>{(0,l.x)(t).then(t=>{if(!t.ok)throw Error(t.msg);var{value:r}=t;if(r.buffer){var i,o=(i=new Blob([r.buffer]),URL.createObjectURL(i));(function(e,t,r){return f.apply(this,arguments)})(o,{attrs:{crossOrigin:"anonymous"}},{compress:{height:102}}).then(t=>{e({image:t,width:t.width,height:t.height,coverUrl:o,timestamp:0n})})}})})}},997428:function(e,t,r){"use strict";r.d(t,{G:function(){return s}});var i=r(69984),o=r(764112),a=r(374609),n=r(39769);function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{onModelUpdate:s,onResourceReady:l}=e;return(0,n.l)(t,(0,o._)((0,i._)({},e),{onProgress:s,onReady:l}),r||(0,a.f)(e))}},629558:function(e,t,r){"use strict";r.d(t,{K:()=>l});let i=r("69984"),o=r("764112"),a=r("574451"),n=r("772322");r("529114");let s=r("595051");var l=e=>{var{children:t}=e,r=(0,a._)(e,["children"]);return(0,n.jsx)(s.Z,(0,o._)((0,i._)({type:"primary",className:"lts-primary-button"},r),{children:t}))}},827952:function(e,t,r){"use strict";r.d(t,{n:()=>y});let i=r("772322");r("459360");let o=r("401725"),a=r("429188"),n=r("659179"),s=r("565523"),l=r("546964"),c=r("123951"),u=r("41723"),d=r.n(u),p=r("105789"),v=r.n(p),g=r("461644"),h=r("248176"),f=r("881991"),_=r("598966"),m=r("701823");var y=(0,a.Pi)(()=>{var e=(0,s.G)(l.R),t=(0,s.G)(g.t),r=(0,s.G)(h.Gw),{quotaManager:a,vipManager:u,stateManager:p}=e,{quotaInfo:y}=a,b=()=>{(0,f.H)(t,{action:"vip_click",source:(0,m.F)("from_page"),currentPage:"smart_tool_page",entranceType:"icon",toolType:"clip_shorts",position:"hover"}),u.showVipModal()};return(0,i.jsxs)("div",{className:"time-left-inner",children:[(0,i.jsx)("span",{className:"time-left-line"}),(0,i.jsx)("span",{className:"time-left-tips",children:c.ZP.t("web_m10n_shorts_time_left",{},"Time left")}),(0,i.jsx)("div",{className:v()("time-left-wrapper",{"time-left-grey-icon":!p.isVip&&u.hasPayVipAbility,"time-left-no-icon":!p.isVip&&!u.hasPayVipAbility}),children:(0,i.jsxs)(o.Z,{onVisibleChange:e=>{e&&(u.hasPayVipAbility&&(0,f.H)(t,{action:"vip_show",source:(0,m.F)("from_page"),currentPage:"smart_tool_page",entranceType:"icon",toolType:"clip_shorts",position:"hover"}),(0,_.d)(t,{action:"show",type:"time_left",time:"".concat(y.freeMin+y.proMin),isVip:p.isVip?1:0}))},content:r.hasLogin?(0,i.jsxs)("div",{className:"time-left-tip-content",children:[(0,i.jsx)("span",{className:"time-left-txt",children:c.ZP.t("web_m10n_shorts_hover_free_time",{num:y.freeMin,number0:y.freeMin,string1:d()(1e3*y.freeEndTime).format("YYYY/MM/DD"),action0:e=>(0,i.jsxs)("span",{className:"txt-hight-light",children:[" ",e]})},"Free: <action0>{number0} </action0> minutes (renews on {string1})")}),(0,i.jsx)("span",{className:"time-left-txt",children:p.isVip?c.ZP.t("web_m10n_shorts_hover_pro_time",{num:y.proMin,number0:y.proMin,string1:d()(1e3*y.proEndTime).format("YYYY/MM/DD"),action0:e=>(0,i.jsx)("span",{className:"txt-hight-light",children:e})},"Pro: <action0>{number0} </action0>minutes (renews on {string1})"):u.hasPayVipAbility?c.ZP.t("web_m10n_shorts_hover_upgrade",{action0:e=>(0,i.jsx)("span",{className:"join-pro-text-btn",onClick:b,children:e}),number0:y.proTotal,num:y.proTotal,action1:e=>(0,i.jsx)("span",{className:"txt-hight-light",children:e})},"<action0>Join Pro</action0> to get <action1>{number0} </action1> min/month"):null}),(0,i.jsx)("span",{children:c.ZP.t("web_m10n_shorts_hover_consumption_order",{},"Prioritize the use of time that is about to expire")})]}):c.ZP.t("web_shorts_remaining_time_pop_login",{},"please login to view the remaining time available"),children:[(0,i.jsx)(n.lDB,{}),(0,i.jsx)("span",{children:r.hasLogin?"".concat((null==y?void 0:y.freeMin)+(null==y?void 0:y.proMin)).concat(c.ZP.t("web_m10n_shorts_abbr_min",{},"m")):c.ZP.t("web_shorts_remaining_time_unknown",{},"unknown")}),u.hasPayVipAbility||p.isVip?(0,i.jsx)("span",{onClick:b,className:"pro-icon"}):null]})})]})})},252735:function(e,t,r){"use strict";r.d(t,{E:function(){return n},N:function(){return o}});var i,o,a=r(123951);(i=o||(o={})).TaskFail="-4",i.transcodeFail="-3",i.uploadFileError="-2",i.CommonError="-1",i.SubmitTaskError="203111",i.ParseError="203123",i.AnalyzeError="203113",i.AnalyzeNoEn="203114",i.DismantlingError="203115",i.CropError="203116",i.MainLockError="203117",i.CaptionCalcError="203118",i.GenerateDraftTemplateJsonError="203124",i.GeneratePackageError="203120",i.AccessLimit="203107",i.TooLargeAudio="203122",i.QuotaNotEnough="5000010",i.TTTranscodeError="203999";var n=e=>{var t=a.oc.t("web_m10n_shorts_toast_convert_fail_time_returned",{},"Couldn\u2019t convert your long video to shorts. Conversion time has be returned."),r=a.oc.t("web_m10n_shorts_toast_something_wrong_time_returned",{},"Something went wrong. Conversion time has be returned. Try again later."),i=a.oc.t("web_shorts_text_went_wrong_video",{},"Something went wrong. Try another video. No time will be deducted from your account."),o=a.oc.t("web_ai_clip_shorts_text_online_retry",{},"Connect to the internet and try again.");return({"-2":a.oc.t("web_ai_clip_shorts_text_cloud_failed",{},"Your video is not uploaded. Connect to the internet and try again."),"-3":a.oc.t("web_shorts_text_change_video_try",{},"Couldn\u2019t upload your video. Try another one."),"-1":r,203111:i,203123:i,203113:a.oc.t("web_ai_clip_shorts_text_content_refunded",{},"The submitted long video information is insufficient, and the AI cannot complete the analysis. Please try again after changing the material. The experience time deducted this time will be returned."),203114:a.oc.t("web_ai_clip_shorts_text_english_refunded",{},"The submitted long video is not in English and cannot be analyzed at this stage. Please try again after changing the material. The experience time deducted this time will be returned."),203115:t,203116:t,203117:t,203118:t,203124:t,203120:t,"-4":t,203107:r,203122:a.oc.t("web_shorts_text_went_wrong_audio",{},"Something went wrong. Try another video. No time will be deducted from your account."),5000010:a.oc.t("web_m10n_shorts_popup_title_time_not_enough",{},"Not enough time left"),203999:a.oc.t("web_shorts_could_not_transcode",{},"Couldn\u2019t transcode your video. Go back to TikTok LIVE Center and try again.")})[e]||o}},65746:function(e,t,r){"use strict";var i,o,a,n,s,l,c,u;r.d(t,{Hv:function(){return a},nI:function(){return o},pq:function(){return i},yD:function(){return n}}),(s=i||(i={})).PlayVideo="play_video",s.QuickEdit="quick_edit",(l=o||(o={})).Recommend="recommend",l.Time="time",(c=a||(a={})).Start="start",c.FetchPackage="fetch_package",c.InitializeSdk="initialize_sdk",c.EnsureResources="ensure_resources",c.RecoveryData="recovery_data",c.FirstFrameRender="first_frame_render",c.FirstFrameRenderTimeout="first_frame_render_timeout",c.Finished="finished",(u=n||(n={}))[u.AUTO=0]="AUTO",u[u.BETWEEN_0_60=1]="BETWEEN_0_60",u[u.BETWEEN_60_90=2]="BETWEEN_60_90",u[u.BETWEEN_90_180=3]="BETWEEN_90_180",u[u.SELECTED_LENGTH=4]="SELECTED_LENGTH"},152846:function(e,t,r){"use strict";r.d(t,{NW:function(){return h},a7:function(){return n},fu:function(){return a}});var i,o,a,n,s=r(218571),l=r(939051),c=r(810925),u=r(565523),d=r(546964),p=r(628316),v=r(52533);(i=a||(a={})).uploading="uploading",i.success="success",i.failed="failed",(o=n||(n={})).unknown="unknown",o.retrying="retrying",o.success="success",o.failed="failed";var g=e=>{if((0,v.Z)(e))return"uploading";var t=[l.a.Transcoding,l.a.Uploading,l.a.Syncing2UserMaterial,l.a.Preparing,l.a.WaitingUpload,c.KV.NoStart,c.KV.Cliping,c.KV.Uploading,c.KV.Analyzing],r=[l.a.TranscodeFailure,l.a.UploadFailure,l.a.Sync2UserMaterialFailure,l.a.PrepareFailure,c.KV.Failed];return t.includes(e)?"uploading":r.includes(e)?"failed":"success"},h=e=>{var t,{uploadingMainMaterial:r,mainMaterial:i,uploadTask:o,initialStatus:a,statusChangeCallBack:n,retryStatus:c}=e,v=(0,s.useCallback)(()=>r?r.status:i?i.status:o?o.status:null,[i,r,o]),[h,f]=(0,s.useState)(0),[_,m]=(0,s.useState)(0),[y,b]=(0,s.useState)(0),{fileSelectionManager:w}=(0,u.G)(d.R),S=r||i,[T,k]=(0,s.useState)(a||(null!==(t=g(v()))&&void 0!==t?t:"uploading"));(0,s.useEffect)(()=>{var e=()=>{k(a||g(v()))};e();var t=null==i?void 0:i.onModelUpdate(e),o=null==r?void 0:r.onModelUpdate(e);return()=>{null==t||t.dispose(),null==o||o.dispose()}},[i,r,v,a]),(0,s.useEffect)(()=>{w.setTranscodeStartTime(0);var e=null==S?void 0:S.onModelUpdate(e=>{var t,r,i,o;null==n||n(g(e.status),c),b(e.duration),e.status===l.a.Transcoding?(f(100),m((null!==(r=null===(t=e.transcoding)||void 0===t?void 0:t.progress)&&void 0!==r?r:0)*100),w.transcodeStartTime||w.setTranscodeStartTime(performance.now()),(null==e?void 0:e.videoTranscodeInfo)&&[p.mh.DROPBOX,p.mh.GOOGLE_DRIVE].includes(w.materialImportPlatformType)&&(w.setVideoTranscodeInfo(null==e?void 0:e.videoTranscodeInfo),w.setRawMaterialInfo(void 0))):e.status===l.a.Uploading&&((null==e?void 0:e.videoTranscodeInfo)&&w.setSupportQuickTranscode(!0),m(0),f((null!==(o=null===(i=e.uploading)||void 0===i?void 0:i.progress)&&void 0!==o?o:0)*100))});return()=>{null==e||e.dispose()}},[S,f,m,c]),(0,s.useEffect)(()=>{if((null==o?void 0:o.progress)&&"uploading"===T){var e=o.progress<=80?o.progress/.8:100,t=o.progress<=80?0:(o.progress-80)/.2;f(e),m(t)}},[o,T]);var I=(0,s.useMemo)(()=>Math.min(.8*h+.2*_,99.9),[h,_]);return{uploadStatus:T,projectAsset:S,uploadingAsset:r,uploadProgress:h,transcodeProgress:_,modelDuration:y,mergedProgress:I,getOriginUploadStatus:v}}},222209:function(e,t,r){"use strict";r.d(t,{qW:()=>I,rS:()=>T,W$:()=>k,vh:()=>b,Id:()=>m,tk:()=>y});let i=r("461228");r("822289"),r("349601");let o=r("5622"),a=r("781494");var n,s,l=e=>{var t=document.createElement("video");return t.preload="metadata",t.src=globalThis.xssNamespace["lvweb/smart-tools"].filterUrl(URL.createObjectURL(e),null,{logType:"js.href/src",mode:"black",reportOnly:"all"}),new Promise(e=>{t.onloadedmetadata=function(){window.URL.revokeObjectURL(t.src),e(t)},t.onerror=()=>{e(void 0)}})};let c=r("64864"),u=r("123951"),d=r("69984"),p=r("526599");class v{getEventParams(){return(0,d._)({current_page:"smart_tool_page"},this._params)}constructor(e){this._params=e,this.eventName="clip_shorts_popup"}}function g(e,t){(0,p.K)(e,v,[t])}let h=r("640712"),f=r("89240");var _=e=>e>c.Pp&&e<c.c_,m=()=>{a.Z.error("".concat(u.oc.t("current_import_format_not_supported",{},"Current import format is not supported")))},y=(e,t)=>{var r=e<c.Pp?"too_small":"too_large";g(t,{action:"show",error_type:r,video_duration:e,tool_type:"clip_shorts"}),o.Z.warning({title:u.oc.t("web_ai_clip_shorts_tittle_not_support_one",{},"Couldn\u2019t upload"),content:u.oc.t("web_shorts_text_choose_again",{number0:3},"You can only upload a video that is under {number0} hours. Try another one."),okText:u.oc.t("web_ai_clip_shorts_button_replacement",{},"OK"),onConfirm:()=>{g(t,{action:"replace_materials",error_type:r,video_duration:e,tool_type:"clip_shorts"})}})},b=(e,t)=>{var r="over_10gb";g(t,{action:"show",error_type:r,video_duration:e,tool_type:"clip_shorts"}),o.Z.warning({title:u.oc.t("web_ai_clip_shorts_tittle_not_support_one",{},"Couldn\u2019t upload"),content:u.oc.t("web_long_shorten_desc_video_size_limit",{},"You can only upload a video that is no larger than 10 GB. Try another one."),okText:u.oc.t("web_ai_clip_shorts_button_replacement",{},"OK"),onConfirm:()=>{g(t,{action:"replace_materials",error_type:r,video_duration:e,tool_type:"clip_shorts"})}})},w=(e,t)=>{var r=10*f.lc*f.lc*f.lc;return e.size<r},S=(n=(0,i._)(function*(e,t){var r,i=yield l(e);if(!w(e,t))return b(null!==(r=null==i?void 0:i.duration)&&void 0!==r?r:0,t),!1;if(!i)return!0;var{duration:o}=i;return!!_(o)||(y(o,t),!1)}),function(e,t){return n.apply(this,arguments)}),T=(s=(0,i._)(function*(e,t){for(var r of e)if(!(yield S(r,t)))return!1;return!0}),function(e,t){return s.apply(this,arguments)}),k=e=>{for(var t of e)if(!(0,h.J5)({file:t,accepts:["video"]}))return!1;return!0},I=(e,t)=>{var{duration:r}=e.getModel();return!!r&&(!!_(r)||(y(r,t),!1))}},701823:function(e,t,r){"use strict";r.d(t,{F:function(){return i}});var i=e=>{for(var[t,r]of new URLSearchParams(location.search))if(t===e)return r;return""}},64864:function(e,t,r){"use strict";r.d(t,{Pp:function(){return i},c_:function(){return o},n1:function(){return a},nf:function(){return n}});var i=0,o=10800,a=5e3,n=108e5},636183:function(e,t,r){"use strict";var i,o;r.d(t,{Q:function(){return i}}),(o=i||(i={})).Light="light",o.Dark="dark"},487748:function(e,t,r){"use strict";r.d(t,{JN:function(){return o},Yb:function(){return s},mf:function(){return l},rY:function(){return n}});var i=r(460198),o=e=>"".concat(i.no.LongToShort,"-").concat(e),a="cacheExpireMap-long2short",n=e=>{try{if(!e)return null;var t,r=(JSON.parse(null!==(t=localStorage.getItem(a))&&void 0!==t?t:"{}")||{})[e];if(!r||r<Number(new Date))return null;var i=localStorage.getItem(e);if(!i)return null;return JSON.parse(i)}catch(e){return null}};function s(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{for(var t,r=JSON.parse(null!==(t=localStorage.getItem(a))&&void 0!==t?t:"{}")||{},o=0;o<localStorage.length;o++){var n=localStorage.key(o);if(null==n?void 0:n.startsWith("".concat(i.no.LongToShort,"-"))){if(e){localStorage.removeItem(n),delete r[n];continue}var s=r[n];(!s||s<Number(new Date))&&(localStorage.removeItem(n),delete r[n])}}localStorage.setItem(a,JSON.stringify(r))}catch(e){}}var l=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36e5;try{if(!e)return;localStorage.setItem(e,JSON.stringify(t));var i,o=JSON.parse(null!==(i=localStorage.getItem(a))&&void 0!==i?i:"{}")||{};o[e]=Number(new Date)+r,localStorage.setItem(a,JSON.stringify(o))}catch(e){s(!0)}}},628316:function(e,t,r){"use strict";r.d(t,{dj:()=>S,mh:()=>w});let i=r("69984"),o=r("789786"),a=r("939051"),n=r("461644"),s=r("248176"),l=r("797323"),c=r("813072"),u=r("551551"),d=r("254845"),p=r("115411"),v=r("526599");class g{getEventParams(){return(0,i._)({},this._params)}constructor(e){this._params=e,this.eventName="ai_shorts_task"}}class h{getEventParams(){var{time:e,fileSize:t,fileDuration:r,hasSubmit:i,importType:o,transcodeTime:a}=this._params;return{time:e,file_size:t,file_duration:r,has_submit:i,import_type:o,transcode_time:a}}constructor(e){this._params=e,this.eventName="clip_shorts_submit_to_upload_time"}}let f=r("658742");(_=y||(y={})).Local="my_device",_.Space="my_space",(m=b||(b={})).GOOGLE_DRIVE="google_drive",m.DROPBOX="dropbox",m.TTLIVE="tt_live";var _,m,y,b,w=(0,i._)({},b,y);class S{getDefaultWorkspace(){var e,t=null===(e=this._capcutAccountService)||void 0===e?void 0:e.userProfile;return(null==t?void 0:t.region)&&(null==t?void 0:t.uid)&&(null==t?void 0:t.defaultSpaceInfo)?t.defaultSpaceInfo:t.spaceInfo}getDefaultWorkspaceId(){var e=this.getDefaultWorkspace();return(null==e?void 0:e.workspaceId)||""}setSupportQuickPlay(e){this.supportQuickPlay=e}setSupportQuickTranscode(e){this.supportQuickTranscode=e}updateCancelUploadingMaterial(){if(this.uploadingMainMaterial){var e,t,r=null===(t=this.uploadingMainMaterial)||void 0===t?void 0:null===(e=t.getModel())||void 0===e?void 0:e.id;this.cancelUploadingMaterial.push(r)}}resetUploadInfo(){this.preMainMaterial=this.mainMaterial,this.rawMaterialInfo=void 0,this.setUploadingMainMaterial(void 0),this.mainMaterial=void 0,this.uploadMaterialFailed=!1,this.setSupportQuickPlay(!0),this.resetUploadCollection()}reset(){var{uploadingMainMaterial:e}=this;e&&this._mainLongToShortWidgetService.materialManager.cancelUploadMaterial(e),this.resetUploadInfo()}setUploadLifeCycle(e){this.uploadPageLifeCycle=e}setMaterialImportType(e){this.materialImportType=e}setMaterialImportPlatformType(e){this.materialImportPlatformType=e}setMaterialWorkspaceId(e){this.materialWorkspaceId=e}setVideoTranscodeInfo(e){this.videoTranscodeInfo=e}setUploadingMainMaterial(e){var t=this.uploadingMainMaterial;e?((null==t?void 0:t.canCancelUpload())&&t.cancelUpload(),null==t||t.cancelSync2UserMaterial(),this._onUploadMaterialStart.fire(e)):(this.uploadingMainMaterial&&this._onUploadMaterialEnd.fire(this.uploadingMainMaterial),this.setVideoTranscodeInfo(void 0)),this.uploadingMainMaterial=e;var r=performance.now(),o=t=>{var o=null==e?void 0:e.getModel();this.reportUploadMaterial((0,i._)({startTime:r,actionType:this.materialImportPlatformType===w.Local?this.materialImportType:this.materialImportPlatformType,materialSource:this.materialImportPlatformType||""},t),o)};null==e||e.onResourceReady(()=>{this.setMaterialWorkspaceId(this.getDefaultWorkspaceId()),o({status:"success"}),this.reportWebUploadMaterial(e);var t=null==e?void 0:e.getModel();this.handleSubmitToUploadTimeReport(t)}),null==e||e.onUploadFailure(e=>{var t;o({status:"fail",failReason:"".concat(null!==(t=null==e?void 0:e.msg)&&void 0!==t?t:"upload failed","-from FileSelectionManager.setUploadingMainMaterial")})}),null==e||e.onTranscodeFailure(e=>{var t;o({status:"fail",failReason:"".concat(null!==(t=null==e?void 0:e.msg)&&void 0!==t?t:"transcode failed","-from FileSelectionManager.setUploadingMainMaterial")})})}getWorkspaceList(){return this._mainLongToShortWidgetService.materialManager.workspaceList}getSpaceInfoForTea(){var e=this.getWorkspaceList().find(e=>e.workspace_id===this.getDefaultWorkspaceId());return{space_id:null==e?void 0:e.space_id,raw_space_type:null==e?void 0:e.raw_space_type,space_type:null==e?void 0:e.space_type,space_user_cnt:null==e?void 0:e.member_cnt}}setPreMainMaterial(e){this.preMainMaterial=e}setTranscodeStartTime(e){this.transcodeStartTime=e}setMainMaterial(e){this.mainMaterial=e,e&&this._mainLongToShortWidgetService.extraFrameManager.extraFrameAndCover(e)}handleSubmitToUploadTimeReport(e){var t,{stateManager:r,settingPageManager:i}=this._mainLongToShortWidgetService,o=r.pageLifeCycle!==u.jp.Setting,a=o?Math.floor(performance.now()-i.submitTime):0,n=Math.floor(performance.now()-this.transcodeStartTime),s={hasSubmit:"".concat(o),fileSize:null==e?void 0:e.size,fileDuration:(null==e?void 0:e.duration)*1e3||0,importType:this.materialImportPlatformType,transcodeTime:n>a?a:n,time:a};t=this._containerService,(0,v.K)(t,h,[s]),this._slardarAdapterService.sendEvent("clip_shorts_submit_to_upload_time",s)}reportImportMaterialFormCloud(e){var t=performance.now(),r=r=>{var o=null==e?void 0:e.getModel();this.reportUploadMaterial((0,i._)({startTime:t,actionType:"my_space",materialSource:"my_space"},r),o)};null==e||e.onResourceReady(()=>{this.setMaterialWorkspaceId((null==e?void 0:e.toWorkspaceId)||(null==e?void 0:e.fromWorkspaceId)||this.getDefaultWorkspaceId()),r({status:"success"});var t=null==e?void 0:e.getModel();this.handleSubmitToUploadTimeReport(t)}),null==e||e.onUploadFailure(e=>{r({status:"fail",failReason:null==e?void 0:e.msg})}),null==e||e.onTranscodeFailure(e=>{r({status:"fail",failReason:null==e?void 0:e.msg})})}reportUploadMaterial(e,t){var r,o,{status:a,actionType:n,materialSource:s,startTime:l,failReason:c}=e;(0,p.I)(this._containerService,(0,i._)({status:a,action_type:n,material_duration:(null==t?void 0:t.duration)*1e3||0,material_format:(null==t?void 0:null===(o=t.mime)||void 0===o?void 0:null===(r=o.split("/"))||void 0===r?void 0:r[1])||(null==t?void 0:t.mime),material_name:null==t?void 0:t.filename,material_resolution:"".concat(null==t?void 0:t.width," * ").concat(null==t?void 0:t.height),material_size:"".concat(null==t?void 0:t.size),material_source:"my_device"===s?"local":s,material_type:null==t?void 0:t.fileType,tool_type:"clip_shorts",import_time:Math.floor(0!==l?performance.now()-l:0),isLogin:1,fail_reason:c,is_fast_import:this.supportQuickPlay?1:0},null===this||void 0===this?void 0:this.getSpaceInfoForTea()))}reportWebUploadMaterial(e){var t,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null==e?void 0:e.getModel(),s=this.getSpaceInfoForTea(),{uid:l}=null===(r=this._capcutAccountService)||void 0===r?void 0:r.userProfile,[c,u]=this.filePreUploadCost,[d,p]=this.fileUploadCost,[h,f]=this.fileTranscodeCost,{videoCropInfo:_,selectShortDuration:m}=this._mainLongToShortWidgetService.settingPageManager,y=(0,i._)({space_id:s.space_id,workspace_id:this.getDefaultWorkspaceId(),asset_id:null==n?void 0:n.id,upload_cost:d===1/0?0:p-d,asset_detail_cost:h===1/0?0:f-h,is_pre_upload:"true",pre_upload_cost:u>d?d-c:u-c,is_pre_upload_finished:String(u<d),range_type:m,is_retry:String(this.isRetryUpload),clip_duration:_.activeDuration,src_duration:Math.trunc(null==n?void 0:n.duration)||0,is_cliped:String(Math.trunc(null==n?void 0:n.duration)!==Math.trunc(_.sourceDuration/1e3)),width:null==n?void 0:n.width,height:null==n?void 0:n.height,size:null==n?void 0:n.size,resolution:"".concat(null==n?void 0:n.width," * ").concat(null==n?void 0:n.height),url:null==n?void 0:n.url,result:(null==n?void 0:n.status)===a.a.Success?"success":"failed",uid:l},o);t=this._containerService,(0,v.K)(t,g,[y]),this.resetUploadCollection()}resetUploadCollection(){this.filePreUploadCost=[1/0],this.fileUploadCost=[1/0],this.fileTranscodeCost=[1/0]}setRawMaterialInfo(e){(0,c.Z)(this.rawMaterialInfo,e)||(this.rawMaterialInfo=e)}setIsFromLocalFile(e){this.isFromLocalFile=e}getFileName(){var e;return this.uploadingMainMaterial?this.uploadingMainMaterial.getModel().filename:(null===(e=this.mainMaterial)||void 0===e?void 0:e.getModel().filename)||this._mainLongToShortWidgetService.ttLiveVideoManager.ttVideoInfo.title}getCoverInfo(){var e,t,r;return this.uploadingMainMaterial?null===(r=this.uploadingMainMaterial.getModel())||void 0===r?void 0:r.cover:null===(t=this.mainMaterial)||void 0===t?void 0:null===(e=t.getModel())||void 0===e?void 0:e.cover}get mainMaterialInfo(){var e,t=this.uploadingMainMaterial||this.mainMaterial;if(t){var r=this._mainLongToShortWidgetService.extraFrameManager.frameDataMap.get(null!==(e=t.getModel().md5)&&void 0!==e?e:""),i=t.getModel(),o=this.videoTranscodeInfo||(null==i?void 0:i.videoTranscodeInfo),a=["720p","480p","360p"].find(e=>null==o?void 0:o[e]),n=null==o?void 0:o[a||"origin"];return{material:{playInfo:{key:null==n?void 0:n.key,url:null==n?void 0:n.url},spriteData:null==r?void 0:r.sprites,coverUrl:null==r?void 0:r.coverUrl}}}}constructor(e,t,r,i,o){this._mainLongToShortWidgetService=e,this._stateManager=t,this._containerService=r,this._capcutAccountService=i,this._slardarAdapterService=o,this.mainMaterial=void 0,this.uploadingMainMaterial=void 0,this.videoTranscodeInfo=void 0,this.cancelUploadingMaterial=[],this.preMainMaterial=void 0,this.rawMaterialInfo=void 0,this.supportQuickPlay=!0,this.supportQuickTranscode=!1,this.uploadMaterialFailed=!1,this.isFromLocalFile=!1,this.materialWorkspaceId="",this.transcodeStartTime=0,this.filePreUploadCost=[1/0],this.fileUploadCost=[1/0],this.fileTranscodeCost=[1/0],this.isRetryUpload=!1,this.materialImportType="click_add",this.materialImportPlatformType=w.Local,this.uploadPageLifeCycle=u.jp.DefaultEmpty,this._onUploadMaterialStart=new f.Q,this.onUploadMaterialStart=this._onUploadMaterialStart.event,this._onUploadMaterialEnd=new f.Q,this.onUploadMaterialEnd=this._onUploadMaterialEnd.event,(0,d.rC)(this,{mainMaterial:d.LO,preMainMaterial:d.LO,rawMaterialInfo:d.LO,supportQuickPlay:d.LO,uploadMaterialFailed:d.LO,isFromLocalFile:d.LO,uploadingMainMaterial:d.LO,videoTranscodeInfo:d.LO,filePreUploadCost:d.LO,fileUploadCost:d.LO,fileTranscodeCost:d.LO,isRetryUpload:d.LO,materialImportType:d.LO,materialImportPlatformType:d.LO,uploadPageLifeCycle:d.LO,materialWorkspaceId:d.LO,setSupportQuickPlay:d.aD,resetUploadInfo:d.aD,setUploadLifeCycle:d.aD,setMaterialImportType:d.aD,setMaterialImportPlatformType:d.aD,setUploadingMainMaterial:d.aD,setPreMainMaterial:d.aD,setMainMaterial:d.aD,setRawMaterialInfo:d.aD,setIsFromLocalFile:d.aD,setVideoTranscodeInfo:d.aD,mainMaterialInfo:d.Fl})}}S=(0,o.gn)([(0,o.fM)(2,n.t),(0,o.fM)(3,s.Gw),(0,o.fM)(4,l.L),(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",["undefined"==typeof IMainLongToShortWidgetService?Object:IMainLongToShortWidgetService,void 0===u.O3?Object:u.O3,void 0===n.t?Object:n.t,void 0===s.Gw?Object:s.Gw,void 0===l.L?Object:l.L])],S)},143473:function(e,t,r){"use strict";r.d(t,{Gu:function(){return a},Gw:function(){return M}});var i,o,a,n,s=r(461228),l=r(789786),c=r(254845),u=r(295433),d=r(569179),p=r(216073),v=r(173726),g=r(460198),h=r(810381),f=r(248176),_=r(703452),m=r(461644),y=r(226603),b=r(658742),w=r(551551),S=r(487748),T=r(252735),k=r(360108),I=r(115411),P=r(202659);(i=a||(a={}))[i.uploading=0]="uploading",i[i.transcribing=1]="transcribing",i[i.analyzing=2]="analyzing",i[i.success=3]="success",i[i.ttTranscoding=4]="ttTranscoding";var C={scenario:"video_editor",feature_key:"longvideo_to_shorts",feature_entrance:(0,d.b1)(),feature_entrance_detail:"".concat((0,d.b1)(),"-longvideo_to_shorts")};(o=n||(n={}))[o.preview=0]="preview",o[o.loading=1]="loading";class M{_initSmartTask(e,t){this.task=e,e.onProgress(t=>{t.progress>=25&&1===this.pageStage&&this.setPageStage(2),this.taskInfo=e.value}),e.onSuccess(e=>{this.isLoading=!1,this.handleQuerySuccess(e,t)}),e.onError((e,t)=>{this.isLoading=!1,this._reportService.reportDevError("long-to-short-query-task",e);var r,i,o,a=e.code;(null==t?void 0:null===(i=t.benefitDetail)||void 0===i?void 0:null===(r=i.code)||void 0===r?void 0:r.toString())===T.N.QuotaNotEnough&&(a=null==t?void 0:null===(o=t.benefitDetail)||void 0===o?void 0:o.code),this._onGetTaskDetailFailed.fire(this.taskId),this.handleQueryFail(a.toString())})}_initTranscodeTask(e){this.task=e;var t=performance.now();e.onProgress(t=>{this.setPageStage(4),this.taskInfo=e.value}),e.onSuccess(e=>{this.taskId=e.relatedCapflowId;var r,i,o,{ttLiveVideoManager:a}=this._mainLongToShortWidgetService;a.updateEncryptId(""),this.setPageStage(1),this.queryTaskResult(!1,{babi_param:JSON.stringify(C)}),(0,I.I)(this._containerService,{action_type:"tt_live",import_time:Math.floor(0!==t?performance.now()-t:0),is_fast_import:0,material_duration:a.ttVideoInfo.endTime-a.ttVideoInfo.createTime,material_format:"mp4",material_name:null!==(o=a.ttVideoInfo.title)&&void 0!==o?o:"",material_resolution:"".concat(null===(r=a.ttVideoInfo.spriteList)||void 0===r?void 0:r[0].imageWidth," * ").concat(null===(i=a.ttVideoInfo.spriteList)||void 0===i?void 0:i[0].imageHeight),material_size:"0",material_source:"tt_live",material_type:"video",tool_type:"clip_shorts",isLogin:1,status:"success"})}),e.onError(e=>{this.isLoading=!1,this._reportService.reportDevError("long-to-short-query-task",e),this._onGetTaskDetailFailed.fire(this.taskId),this.handleQueryFail(T.N.TTTranscodeError,!0);var r,i,o,{ttLiveVideoManager:a}=this._mainLongToShortWidgetService;(0,I.I)(this._containerService,{action_type:"tt_live",import_time:Math.floor(0!==t?performance.now()-t:0),is_fast_import:0,material_duration:a.ttVideoInfo.endTime-a.ttVideoInfo.createTime,material_format:"mp4",material_name:null!==(o=a.ttVideoInfo.title)&&void 0!==o?o:"",material_resolution:"".concat(null===(r=a.ttVideoInfo.spriteList)||void 0===r?void 0:r[0].imageWidth," * ").concat(null===(i=a.ttVideoInfo.spriteList)||void 0===i?void 0:i[0].imageHeight),material_size:"0",material_source:"tt_live",material_type:"video",tool_type:"clip_shorts",isLogin:1,status:"fail",fail_reason:null==e?void 0:e.msg})})}setPageStage(e){this.pageStage=e}setQueryCapflowKey(e){e&&(this.queryCapflowKey=e)}reset(){this.cancelTask(),this.taskId=null,this.taskInfo=null,this._queryTimer&&window.clearTimeout(this._queryTimer),this.successTaskInfo=null,this.setFailCode(null)}cancelTask(){var e;null===(e=this.task)||void 0===e||e.cancel()}resetPageStage(){this.pageStage=0}setFailCode(e){null!==e&&this._mainLongToShortWidgetService.fileSelectionManager.reportWebUploadMaterial(void 0,{error_code:e}),this.failCode=e}getTaskCacheKey(){return this.taskId?(0,S.JN)(this.taskId):null}save(){return JSON.stringify({pageStage:this.pageStage,failCode:this.failCode,taskInfo:this.taskInfo,taskId:this.taskId})}restore(e){var t=(0,y.D)(e);if(t){var{pageStage:r,failCode:i,taskInfo:o,taskId:a}=t;this.setFailCode(i),this.setPageStage(r),this.taskInfo=o,this.taskId=a}}retry(){this.taskInfo=null,this.failCode=null,this._queryTimer&&window.clearInterval(this._queryTimer);var{ttLiveVideoManager:e}=this._mainLongToShortWidgetService;if(e.encryptId){this.createTTTranscodeTask();return}this.createLongToShortTask()}importTaskId(e,t,r){var i=w.jp.PreviewResult;switch(t){case p.Kw.success:i=w.jp.PreviewResult,this.setPageStage(3),this.queryCapflowKey===v.gW.CapKeyForTT&&(i=w.jp.CreateLoading);break;case p.Kw.fail:i=w.jp.TaskFail,this.failCode=T.N.TaskFail,this.setPageStage(2);break;case p.Kw.uploadFail:i=w.jp.TaskFail,this.failCode=T.N.uploadFileError;break;default:i=w.jp.CreateLoading,this.setPageStage(2)}this._mainLongToShortWidgetService.stateManager.setLifeCycle(i),this.taskId=e,this.queryTaskResult(r)}constructor(e,t,r,i,o,a,n){this._mainLongToShortWidgetService=e,this._quotaManager=t,this._intelligentDataService=r,this._reportService=i,this._accountService=o,this._commercialDataService=a,this._containerService=n,this.pageStage=0,this.taskId=(0,u.xF)()||null,this.queryCapflowKey=(0,u.z)()||null,this.failCode=(0,u._A)(),this.taskInfo=null,this.successTaskInfo=null,this.processStartTime=0,this.isLoading=!1,this.hasSuccessTasks=!1,this._queryTimer=0,this._onGenerateTaskSuccess=new b.Q,this.onGenerateTaskSuccess=this._onGenerateTaskSuccess.event,this._onGenerateTaskFailed=new b.Q,this.onGenerateTaskFailed=this._onGenerateTaskFailed.event,this._onGetTaskDetailFailed=new b.Q,this.onGetTaskDetailFailed=this._onGetTaskDetailFailed.event;var l=this;this.createLongToShortTask=(0,s._)(function*(){l.reset();var{fileSelectionManager:e,settingPageManager:t,enableLongToShortSubtitleOpt:r}=l._mainLongToShortWidgetService,i=null===(o=e.mainMaterial)||void 0===o?void 0:o.getModel();try{var o,a,n,s,c,u,d=yield l._intelligentDataService.createLongToShortTask({workspaceId:(null===(a=e.mainMaterial)||void 0===a?void 0:a.fromWorkspaceId)||"",assetId:null!==(s=null==i?void 0:i.assetId)&&void 0!==s?s:"",smartToolType:g.no.LongToShort,platform:3,reqJson:"",scene:void 0,extraMap:{upload_source:e.materialImportPlatformType},params:JSON.stringify({source_duration:Math.floor(t.videoCropInfo.sourceDuration/1e3),video_name:null!==(c=null==i?void 0:i.filename)&&void 0!==c?c:"",duration:Math.floor(t.videoCropInfo.activeDuration/1e3),start_time:Math.floor(t.videoCropInfo.activeStart/1e3),expire:e.isFromLocalFile,target_duration:t.selectShortDuration,resource_id:r?t.submitSubtitleTemplateId:void 0}),capKey:k.FB?v.gW.CapKeyForPc:v.gW.CapKeyForWeb},{babi_param:JSON.stringify(C)});if(!d.ok){l._reportService.reportDevError("long-to-short-create-task",d);var p=String(d.code);l._onGenerateTaskFailed.fire(p),l.handleQueryFail(p);return}l.taskId=null!==(u=null===(n=d.value.taskParams)||void 0===n?void 0:n.taskId)&&void 0!==u?u:null,l._onGenerateTaskSuccess.fire(l.taskId),l._initSmartTask(d.value,!0)}catch(e){l._reportService.reportDevError("long-to-short-create-task",e);var h,f=(null==e?void 0:null===(h=e.data)||void 0===h?void 0:h.ret)||"-1";l._onGenerateTaskFailed.fire(f),l.handleQueryFail(f)}});var d=this;this.createTTTranscodeTask=(0,s._)(function*(){d.reset();var{fileSelectionManager:e,ttLiveVideoManager:t,settingPageManager:r}=d._mainLongToShortWidgetService;try{var i,o,a,n=yield d._intelligentDataService.createTTTranscodeTask({workspaceId:e.getDefaultWorkspaceId()||"",assetId:"",smartToolType:g.no.LongToShort,platform:3,reqJson:"",scene:void 0,extraMap:{tt_vid_type:"".concat(t.videoType),source:t.encryptId,tt_appid:t.ttAppId,upload_source:e.materialImportPlatformType},params:JSON.stringify({source_duration:Math.floor(r.videoCropInfo.sourceDuration/1e3),video_name:null!==(o=t.ttVideoInfo.title)&&void 0!==o?o:"",duration:Math.floor(r.videoCropInfo.activeDuration/1e3),start_time:Math.floor(r.videoCropInfo.activeStart/1e3),expire:!1,target_duration:r.selectShortDuration})},{babi_param:JSON.stringify(C)});if(!n.ok){d._reportService.reportDevError("long-to-short-create-task",n),d._onGenerateTaskFailed.fire(String(n.code)),d.handleQueryFail(T.N.TTTranscodeError,!0);return}(0,P.z)(d._containerService,{action:"import",importType:"click_add",importSource:"tt_live",toolType:"clip_shorts"}),d.taskId=null!==(a=null===(i=n.value.taskParams)||void 0===i?void 0:i.taskId)&&void 0!==a?a:null,d._initTranscodeTask(n.value)}catch(e){d._reportService.reportDevError("long-to-short-create-task",e);var s,l=(null==e?void 0:null===(s=e.data)||void 0===s?void 0:s.ret)||T.N.TTTranscodeError;d._onGenerateTaskFailed.fire(l),d.handleQueryFail(l,!0)}}),this.queryTaskResult=(e,t)=>{if(this.taskId){var r,i,{enableLongToShortPreviewCaptionText:o}=this._mainLongToShortWidgetService;o&&!this._intelligentDataService.disableIntelligentCover&&(this._intelligentDataService.disableIntelligentCover=!0),null===(r=this.task)||void 0===r||r.cancel();var{fileSelectionManager:a}=this._mainLongToShortWidgetService;this.processStartTime=performance.now(),this.isLoading=!0;var n=null,s={workspaceId:(null===(i=a.mainMaterial)||void 0===i?void 0:i.fromWorkspaceId)||a.getDefaultWorkspaceId()||"",smartToolType:g.no.LongToShort,taskId:this.taskId,scene:void 0,region:void 0,hasLogin:!0,platform:void 0,assetId:void 0,reqJson:void 0};return 4===this.pageStage?(n=this._intelligentDataService.createTTTranscodeQueryTask(s),this._initTranscodeTask(n)):(n=this._intelligentDataService.createLongToShortTaskQueryTask(s,t),this._initSmartTask(n,e)),n}},this.handleQuerySuccess=(e,t)=>{this.setPageStage(3),this.successTaskInfo=e,this.hasSuccessTasks=e.taskDetails.length>0;var r=this._mainLongToShortWidgetService.stateManager.pageLifeCycle;setTimeout(()=>{r===this._mainLongToShortWidgetService.stateManager.pageLifeCycle&&this._mainLongToShortWidgetService.stateManager.setLifeCycle(w.jp.PreviewResult),this.taskInfo=null},1e3),t&&this._mainLongToShortWidgetService.quotaManager.fetchUserBenefit()},this.handleQueryFail=(e,t)=>{this.reset(),this.setFailCode(e),t||this._quotaManager.fetchUserBenefit()},(0,c.rC)(this)}}(0,l.gn)([c.LO,(0,l.w6)("design:type",Number)],M.prototype,"pageStage",void 0),(0,l.gn)([c.LO,(0,l.w6)("design:type",Object)],M.prototype,"taskId",void 0),(0,l.gn)([c.LO,(0,l.w6)("design:type",Object)],M.prototype,"queryCapflowKey",void 0),(0,l.gn)([c.LO,(0,l.w6)("design:type",Object)],M.prototype,"task",void 0),(0,l.gn)([c.LO,(0,l.w6)("design:type",Object)],M.prototype,"failCode",void 0),(0,l.gn)([c.LO,(0,l.w6)("design:type",Object)],M.prototype,"taskInfo",void 0),(0,l.gn)([c.LO,(0,l.w6)("design:type",Object)],M.prototype,"successTaskInfo",void 0),(0,l.gn)([c.LO,(0,l.w6)("design:type",Number)],M.prototype,"processStartTime",void 0),(0,l.gn)([c.LO,(0,l.w6)("design:type",Boolean)],M.prototype,"isLoading",void 0),(0,l.gn)([c.LO,(0,l.w6)("design:type",Boolean)],M.prototype,"hasSuccessTasks",void 0),M=(0,l.gn)([(0,l.fM)(2,v.SG),(0,l.fM)(3,h.m),(0,l.fM)(4,f.Gw),(0,l.fM)(5,_.h),(0,l.fM)(6,m.t),(0,l.w6)("design:type",Function),(0,l.w6)("design:paramtypes",["undefined"==typeof IMainLongToShortWidgetService?Object:IMainLongToShortWidgetService,"undefined"==typeof QuotaManager?Object:QuotaManager,void 0===v.SG?Object:v.SG,void 0===h.m?Object:h.m,void 0===f.Gw?Object:f.Gw,void 0===_.h?Object:_.h,void 0===m.t?Object:m.t])],M)},412121:function(e,t,r){"use strict";r.d(t,{l:function(){return c},o:function(){return o}});var i,o,a=r(69984),n=r(764112),s=r(789786),l=r(254845);(i=o||(o={}))[i.Waiting=0]="Waiting",i[i.Loading=1]="Loading",i[i.Loaded=2]="Loaded";class c{initImages(e){this.imageDetails=e.map(e=>(0,n._)((0,a._)({},e),{status:this._initStatus()}))}_initStatus(){return this._currentRunningCount<this._maxLoadCount?(this._currentRunningCount++,1):0}handleLoaded(e){var t,r=null===(t=this.imageDetails.find(e=>0===e.status))||void 0===t?void 0:t.resourceId;this._currentRunningCount--,this.imageDetails=this.imageDetails.map(t=>t.resourceId===e?(0,n._)((0,a._)({},t),{status:2}):t.resourceId===r?(0,n._)((0,a._)({},t),{status:1}):t)}constructor(){this._maxLoadCount=6,this._currentRunningCount=0,this.imageDetails=[],(0,l.rC)(this)}}(0,s.gn)([l.LO,(0,s.w6)("design:type",Array)],c.prototype,"imageDetails",void 0)},682105:function(e,t,r){"use strict";r.d(t,{T:function(){return _},c:function(){return f}});var i=r(461228),o=r(69984),a=r(789786),n=r(254845),s=r(626173),l=r(226603),c=r(963473),u=r(65746),d=r(889650),p=r(461644),v=r(632980),g=r(91087),h={activeStart:0,activeDuration:0,sourceStart:0,sourceDuration:0,duration:0,videoPlay:!0},f=40;class _{setSelectShortDuration(e){this.selectShortDuration=e}setSubmitTime(e){this.submitTime=e}setVideoCropInfo(e){var t=(0,o._)({},this.videoCropInfo,e);this.videoCropInfo=t}resetVideoCropInfo(){this.videoCropInfo=h}reset(){this.selectShortDuration=0,this.resetVideoCropInfo()}save(){return JSON.stringify((0,s.Z)(this,["videoCropInfo","selectShortDuration"]))}restore(e){var t=(0,l.D)(e);if(t){var{videoCropInfo:r,selectShortDuration:i}=t;this.videoCropInfo=r,this.selectShortDuration=i}}setSubmitSubtitleTemplateId(e){this.submitSubtitleTemplateId=e}_createGetListByCategoryManager(e){var t,r=this,o=this;return this._containerService.createInstance(g.J,{disableBootstrap:e.disableBootstrap,prefetchFirstOfCategoryCount:1,getCategories:(0,i._)(function*(){var t,i={onlyCommercial:e.onlyCommercial},o=yield r._subtitleTemplateDataService.getSubtitleTemplateCategories(i);if(!o.ok)return o;var a=o.value,n=o.value.value.list,s=null!==(t=n.find(e=>{var t;return null===(t=e.tags)||void 0===t?void 0:t.includes("caption")}))&&void 0!==t?t:n[0];return a.value.list=n.length>0?[s]:n,(0,c.oW)((0,d.ib)(o.value.config,a.value,{hasMore:a.hasMore,offset:a.offset}))}),getMaterialQueryToken:t=>({category:t.id,onlyCommercial:e.onlyCommercial,sdkVersion:this.sdkVersion,strategyFilterAppId:3006,limit:2e3}),getMaterialByCategory:(t=(0,i._)(function*(e){var t=yield o._subtitleTemplateDataService.getSubtitleTemplateByCategory(e);if(!t.ok)return t;var r=t.value,{list:i}=r.value;return(0,c.oW)((0,d.ib)(t.value.config,i,{hasMore:r.hasMore,offset:r.offset}))}),function(e){return t.apply(this,arguments)})})}constructor(e,t){this._containerService=e,this._subtitleTemplateDataService=t,this.selectShortDuration=u.yD.AUTO,this.videoCropInfo=h,this.submitTime=0,this.submitSubtitleTemplateId="",this.subtitleList=[],this.dataManager=void 0,this.dataManager=this._createGetListByCategoryManager({onlyCommercial:!1,disableBootstrap:!1}),(0,n.rC)(this,{submitSubtitleTemplateId:n.LO,selectShortDuration:n.LO,videoCropInfo:n.LO,submitTime:n.LO,setSelectShortDuration:n.aD,setSubmitTime:n.aD,setVideoCropInfo:n.aD,setSubmitSubtitleTemplateId:n.aD,resetVideoCropInfo:n.aD,reset:n.aD,save:n.aD,restore:n.aD})}}_=(0,a.gn)([(0,a.fM)(0,p.t),(0,a.fM)(1,v.B),(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[void 0===p.t?Object:p.t,void 0===v.B?Object:v.B])],_)},551551:function(e,t,r){"use strict";r.d(t,{O3:function(){return u},jp:function(){return o}});var i,o,a=r(789786),n=r(295433),s=r(254845),l=r(248176),c=r(636183);(i=o||(o={})).DefaultEmpty="DefaultEmpty",i.Setting="Setting",i.CreateLoading="CreateLoading",i.PreviewResult="PreviewResult",i.QuickEdit="QuickEdit",i.ExportLoading="ExportLoading",i.Exported="Exported",i.TaskFail="TaskFail";class u{get userId(){var e;return null===(e=this._accountService.userProfile)||void 0===e?void 0:e.uid}updateIsVip(e){this.isVip=e}updateTheme(e){this.theme=e}updateNeedRedirect(e){this.needRedirect=e}updateHasChangeToLogin(e){this.hasChangeToLogin=e}setLifeCycle(e){this.pageLifeCycle=e}constructor(e){var t,r;this._accountService=e,this.pageLifeCycle=(0,n.lJ)()||"DefaultEmpty",this.theme=c.Q.Light,this.doNotBlockWindowClose=!1,this.isVip=!1,this.needRedirect=!1,this.hasChangeToLogin=!1,(0,s.ky)(this),this.isVip=null!==(r=null===(t=e.userVipInfo)||void 0===t?void 0:t.flag)&&void 0!==r&&r,e.onDidChangeVipInfo(e=>{var t;this.isVip=null!==(t=null==e?void 0:e.flag)&&void 0!==t&&t})}}(0,a.gn)([s.LO],u.prototype,"isVip",void 0),(0,a.gn)([s.aD,(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[Boolean]),(0,a.w6)("design:returntype",void 0)],u.prototype,"updateIsVip",null),u=(0,a.gn)([(0,a.fM)(0,l.Gw),(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[void 0===l.Gw?Object:l.Gw])],u)},206729:function(e,t,r){"use strict";r.d(t,{e:function(){return s}});var i=r(69984),o=r(526599),a=r(295433);class n{getEventParams(){return(0,i._)({enter_from:(0,a.iE)()},this._params)}constructor(e){this._params=e,this.eventName="clip_shorts_processing"}}function s(e,t){(0,o.K)(e,n,[t])}},598152:function(e,t,r){"use strict";r.d(t,{m:function(){return n}});var i=r(69984),o=r(526599);class a{getEventParams(){return(0,i._)({},this._params)}constructor(e){this._params=e,this.eventName="generated_clip_project"}}function n(e,t){(0,o.K)(e,a,[t])}},115411:function(e,t,r){"use strict";r.d(t,{I:function(){return s}});var i=r(69984),o=r(526599),a=r(230759);class n{getEventParams(){return(0,i._)({},(0,a.f)(),this._params)}constructor(e){this._params=e,this.eventName="import_material"}}function s(e,t){(0,o.K)(e,n,[t])}},598966:function(e,t,r){"use strict";r.d(t,{d:function(){return a}});var i=r(526599);class o{getEventParams(){var{action:e,type:t,isVip:r,time:i}=this._params;return{action:e,type:t,is_vip:r,time:i}}constructor(e){this._params=e,this.eventName="clip_shorts_time_hover"}}function a(e,t){(0,i.K)(e,o,[t])}},881991:function(e,t,r){"use strict";r.d(t,{H:function(){return a}});var i=r(526599);class o{getEventParams(){var{action:e,source:t,currentPage:r,entranceType:i,toolType:o,position:a}=this._params;return{action:e,source:t,current_page:r,entrance_type:i,tool_type:o,position:a}}constructor(e){this._params=e,this.eventName="vip_guide_entrance"}}function a(e,t){(0,i.K)(e,o,[t])}},726916:function(e,t,r){"use strict";r.d(t,{i:function(){return o}});var i=r(610306),o=(0,r(30276).LO)(i.Y)},546964:function(e,t,r){"use strict";r.d(t,{R:function(){return i}});var i=(0,r(30276).yh)("main-long-to-short-widget-service")},270967:function(e,t,r){"use strict";r.d(t,{o:function(){return c}});var i=r(789786),o=r(935548),a=r(199297),n=r(111954),s=r(806797),l=r(461644);class c extends o.W{constructor(e,t,r,i){super(e,t,r),this.payinPayoutService=e,this._workspaceService=t,this._configurationService=r,this._contaienrService=i,this._currentPage="smart_tool_page"}}c=(0,i.gn)([(0,i.fM)(0,a.sX),(0,i.fM)(1,n.W),(0,i.fM)(2,s.Ui),(0,i.fM)(3,l.t),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===a.sX?Object:a.sX,void 0===n.W?Object:n.W,void 0===s.Ui?Object:s.Ui,void 0===l.t?Object:l.t])],c)},498007:function(e,t,r){"use strict";r.d(t,{Gh:function(){return u},_7:function(){return c},yC:function(){return l}});var i,o=r(461228),a=r(723394),n=r(980134);function s(e){return e.split(".")}function l(e,t){return Number(s(e).join(""))-Number(s(t).join(""))}var c=(0,o._)(function*(){if(i)return i;var e,t,r,o=(yield a.S4.getAppInfo()).data;i=n.f4;var s=null==o?void 0:null===(r=o.data)||void 0===r?void 0:null===(t=r.veSDKVersion)||void 0===t?void 0:null===(e=t.split("-"))||void 0===e?void 0:e[0];return s&&0>l(s,n.f4)&&(i=s),i}),u=(0,o._)(function*(){var e,t=(yield a.S4.getAppInfo()).data;return null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.vipPurchaseEnable})},295433:function(e,t,r){"use strict";r.d(t,{Uf:function(){return u},Yv:function(){return p},_A:function(){return l},iE:function(){return g},lJ:function(){return n},w3:function(){return v},xF:function(){return a},z:function(){return s},zn:function(){return d}});var i,o=r(216073),a=()=>new URLSearchParams(location.search).get("taskId"),n=()=>new URLSearchParams(location.search).get("pageStatus"),s=()=>new URLSearchParams(location.search).get("capflowKey"),l=()=>new URLSearchParams(location.search).get("failCode"),c=()=>new URLSearchParams(location.search).get("uploadId")||"",u=()=>{var e=new URLSearchParams(location.search),t=e.get("room_id"),r=e.get("high_light_id"),i=e.get("edit_id"),o=t;return r?o=r:i&&(o=i),o},d=()=>{var e=new URLSearchParams(location.search),t=e.get("high_light_id"),r=e.get("edit_id"),i=o.WY.Live;return t?i=o.WY.HightLight:r&&(i=o.WY.Edit),i},p=()=>{var e=new URLSearchParams(location.search).get("app_id");return null!=e?e:""},v=(i="",()=>i||(i=c())),g=()=>{var e;return null!==(e=new URLSearchParams(location.search).get("enter_from"))&&void 0!==e?e:""}},806705:function(e,t,r){"use strict";r.d(t,{O:function(){return o},r:function(){return n}});var i,o,a=r(30276);(i=o||(o={}))[i.Canvas=0]="Canvas",i[i.Image=1]="Image";var n=(0,a.yh)("graphic-toolkit")},13146:function(e,t,r){"use strict";var i,o;r.d(t,{r:function(){return i}}),(o=i||(i={}))[o.Unknown=1]="Unknown",o[o.Cancel=2]="Cancel",o[o.Insufficient=20113]="Insufficient",o[o.Mismatch=200601]="Mismatch",o[o.AuthenticationFailed=200602]="AuthenticationFailed"},348854:function(e,t,r){"use strict";r.d(t,{o:function(){return i}});var i=(0,r(30276).yh)("get-arithmetic-model-data-service")},156531:function(e,t,r){"use strict";r.d(t,{j:function(){return i}});var i=(0,r(30276).yh)("package-info")},505672:function(e,t,r){"use strict";var i,o;r.d(t,{Q:function(){return i}}),(o=i||(i={}))[o.Logo=1]="Logo",o[o.Sticker=2]="Sticker",o[o.Background=3]="Background",o[o.Video=4]="Video",o[o.Audio=5]="Audio",o[o.Font=6]="Font",o[o.Color=7]="Color",o[o.TextPreset=8]="TextPreset",o[o.AdjustmentPreset=9]="AdjustmentPreset",o[o.TextTemplatePreset=10]="TextTemplatePreset",o[o.TextGlow=11]="TextGlow"},497607:function(e,t,r){"use strict";r.d(t,{es:function(){return p},ey:function(){return d}});var i=r(69984),o=r(764112),a=r(764699),n=r(619398),s=r(977e3),l=r(808637),c=r(306226),u=r(980134);function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r?function(e){var{common_attr:t,font_icon:r}=e,i=t.item_url||t.download_info.url,o=(null==r?void 0:r.ImageUrl)||t.cover_url.small;return{key:t.id,resourceId:t.id,effectId:t.id,md5:t.md5||t.id,name:t.title,isBusiness:!1,isVip:!1,package:{uri:(0,c.s)(i),urlList:[i]},icon:{uri:(0,c.s)(t.cover_url.small),urlList:[t.cover_url.small]},isFromBrand:!0,source:s.Hw.BRAND,sdkVersion:u.f4,previewUrl:o,isDefault:e.IsDefault,userId:t.user_id,createTime:t.create_time,isPrefab:!1}}(e):function(e,t){var r,{common:s,extra:l,urlPrefix:c}=(0,a.s)(n._g.Font,e,t),u=l.light_icon;return r=u?{uri:u,urlList:["".concat(c).concat(u)]}:{uri:"".concat(s.effectId,".svg"),urlList:["https://lf16-web-buz.capcut.com/obj/capcut-web-buz-us/loki-font-svg/".concat(s.effectId,".svg")]},(0,o._)((0,i._)({},s),{icon:r})}(e,t)}var p=e=>{var t,r,i,{id:o,effect_id:a,title:n,extra:c,md5:d,item_urls:p,cover_url:v}=e.common_attr,g=(0,l.D)(c),h=/^(https?:\/\/.*\/)(.*)/g.exec(null!==(t=null==p?void 0:p[0])&&void 0!==t?t:""),f=null!==(r=null==h?void 0:h[1])&&void 0!==r?r:"";return{key:o,resourceId:o,effectId:a,md5:d,name:n,isBusiness:!1,isVip:!1,package:{uri:(null==p?void 0:p.length)?p[0].split(f)[1]:"",urlList:p},icon:{uri:v.small.split(f)[1],urlList:[v.small]},isFromBrand:!1,source:s.Hw.LOKI,sdkVersion:u.f4,previewUrl:g.web_icon?"".concat(f).concat(g.web_icon):"",sourceFrom:"dreamina",isArtFont:null!==(i=g.is_ai_artist)&&void 0!==i&&i}}},216073:function(e,t,r){"use strict";r.d(t,{Dk:function(){return p},Kw:function(){return u},WY:function(){return l},Xd:function(){return c}});var i,o,a,n,s,l,c,u,d=r(30276);(i=s||(s={})).transcodeFail="-3",i.uploadFileError="-2",i.CommonError="-1",i.SubmitTaskError="203111",i.ParseError="203123",i.AnalyzeError="203113",i.AnalyzeNoEn="203114",i.DismantlingError="203115",i.CropError="203116",i.MainLockError="203117",i.CaptionCalcError="203118",i.GenerateDraftTemplateJsonError="203124",i.GeneratePackageError="203120",i.AccessLimit="203107",i.TooLargeAudio="203122",(o=l||(l={}))[o.Live=1]="Live",o[o.HightLight=2]="HightLight",o[o.Edit=3]="Edit",(a=c||(c={})).uploadId="uploadId",a.taskId="taskId",a.ttTranscodeId="ttTranscodeId",(n=u||(u={}))[n.doing=0]="doing",n[n.success=1]="success",n[n.fail=-1]="fail",n[n.uploading=2]="uploading",n[n.uploadFail=3]="uploadFail";var p=(0,d.yh)("long-to-short-data-service")},173726:function(e,t,r){"use strict";r.d(t,{SG:function(){return l},gW:function(){return a}});var i,o,a,n,s=r(30276);(i=a||(a={})).CapKeyForPc="capflow_long2short_mix",i.CapKeyForWeb="capflow_long2short_web",i.CapKeyForTT="capflow_tt_transcode",(o=n||(n={}))[o.Trending=0]="Trending",o[o.Hook=1]="Hook",o[o.Engaging=2]="Engaging",o[o.WellStructure=3]="WellStructure",o[o.OnTopic=4]="OnTopic",o[o.Highlight=5]="Highlight";var l=(0,s.yh)("intelligent-data-service")},474735:function(e,t,r){"use strict";r.d(t,{G:function(){return a}});var i=r(619398),o=r(377128);function a(e){var t,r,a,n,s=(0,o.E)(e,i._g.SubtitleTemplate),l=null!==(n=null===(r=e.subtitle_template)||void 0===r?void 0:r.depend_resource_list.map(e=>({type:e.type,resourceId:e.resource_id,source:e.source})))&&void 0!==n?n:[],c=e=>{var t,r=e.match(/^(http:.+\/)[0-9a-z]+$/g);return null!==(t=null==r?void 0:r[0])&&void 0!==t?t:e};return{key:(t=s.resourceId,"".concat(i._g.SubtitleTemplate,"_").concat(t)),resourceId:s.resourceId,effectId:s.effectId,md5:s.md5,source:s.source,dependentResources:l,name:s.title,isVip:s.isVip,isBusiness:s.isBusiness,icon:{uri:c(s.coverUrl),urlList:[s.coverUrl]},previewUrl:s.coverUrl,package:{uri:c(s.originUrl),urlList:[s.originUrl]},sdkVersion:"",scriptTemplateVersion:null===(a=e.subtitle_template)||void 0===a?void 0:a.script_template_version,isPrefab:!1}}},389198:function(e,t,r){"use strict";r.d(t,{W:function(){return s}});var i=r(69984),o=r(764112),a=r(764699),n=r(619398);function s(e,t){var r,{common:s,extra:l}=(0,a.s)(n._g.TextMotion,e,t);return(0,o._)((0,i._)({},s),{isKtv:"true"===l.is_ktv,ktvColor:null!==(r=l.ktv_color)&&void 0!==r?r:""})}},484727:function(e,t,r){"use strict";r.d(t,{Q:function(){return n}});var i=r(619398),o=r(977e3),a=r(377128);function n(e){var t,r=(0,a.E)(e,i._g.TextPreset),n=e=>{var t,r=e.match(/^(http:.+\/)[0-9a-z]+$/g);return null!==(t=null==r?void 0:r[0])&&void 0!==t?t:e};return{key:"".concat(i._g.TextPreset,"_").concat(r.resourceId),resourceId:r.resourceId,effectId:r.effectId,md5:r.md5,aspectRatio:1,source:o.Hw.LOKI,isFavorite:null!==(t=r.isFavorite)&&void 0!==t&&t,name:r.title,isVip:r.isVip,isBusiness:r.isBusiness,icon:{uri:n(r.coverUrl),urlList:[r.coverUrl]},previewUrl:r.coverUrl,package:{uri:n(r.originUrl),urlList:[r.originUrl]},sdkVersion:"",isPrefab:!1}}},7141:function(e,t,r){"use strict";r.d(t,{Ck:function(){return h}});var i=r(69984),o=r(764112),a=r(764699),n=r(619398),s=r(977e3),l=r(505672),c=r(306226),u=r(226603),d=r(980014),p=r(980134),v=r(497607),g=r(202919);function h(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?function(e){try{var t,r,a,h,f,_,m,y,b,{common_attr:w}=e;e.sub_item_list=null===(t=e.sub_item_list)||void 0===t?void 0:t.filter(e=>!!e);var S=null===(r=e.sub_item_list)||void 0===r?void 0:r.find(e=>Number(e.common_attr.resource_type)===l.Q.TextPreset),T=(0,u.D)(w.file_extra);try{f=null===(_=e.sub_item_list)||void 0===_?void 0:_.map(t=>{var r,a,{common_attr:u}=t;switch(Number(t.common_attr.resource_type)){case l.Q.Font:var h,f,_,m=null===(f=null!==(_=e.depend_resource_list)&&void 0!==_?_:T.depend_resource_list)||void 0===f?void 0:null===(h=f.find(e=>e.resource_id===t.common_attr.id))||void 0===h?void 0:h.source_platform,y=(0,v.ey)(t,void 0,!0);return(0,o._)((0,i._)({},y),{isFromBrand:m===g.$.brand||y.package.urlList[0].includes("brand")});case l.Q.TextPreset:return{key:u.id,resourceId:u.id,effectId:u.id,md5:u.md5||u.id,name:u.title,isBusiness:!1,isVip:u.is_vip,package:{uri:(0,c.s)(null!==(r=u.item_url)&&void 0!==r?r:u.download_info.url),urlList:[null!==(a=u.item_url)&&void 0!==a?a:u.download_info.url]},icon:{uri:(0,c.s)(u.cover_url.small),urlList:[u.cover_url.small]},aspectRatio:1,source:s.Hw.LOKI,sdkVersion:p.f4,previewUrl:u.cover_url.small,isFavorite:!1,isDefault:!1,userId:u.user_id,createTime:u.create_time,isPrefab:!1};case l.Q.Background:case l.Q.TextGlow:return{key:"".concat(n._g.TextGlow,"_").concat(u.id,"_").concat(u.id),md5:u.md5,resourceId:u.id,isVip:u.is_vip,effectId:u.id};default:(0,d.bP)(t.common_attr.resource_type)}})}catch(e){f=[]}var k=null!==(m=(null==S?void 0:S.common_attr.item_url)||(null==S?void 0:S.common_attr.download_info.url))&&void 0!==m?m:"",I=null!==(y=null===(a=e.sub_item_list)||void 0===a?void 0:a.some(e=>e.common_attr.is_vip))&&void 0!==y?y:e.common_attr.is_vip,P=null===(h=null!==(b=e.depend_resource_list)&&void 0!==b?b:T.depend_resource_list)||void 0===h?void 0:h.some(t=>{var r;return(null===(r=e.sub_item_list)||void 0===r?void 0:r.find(e=>e.common_attr.id===t.resource_id))===void 0});return{key:w.id,resourceId:w.id,effectId:w.id,md5:w.md5||w.id,name:w.title,isBusiness:!1,isVip:I,package:{uri:(0,c.s)(k),urlList:[k]},icon:{uri:(0,c.s)(w.cover_url.small),urlList:[w.cover_url.small]},presetSchemaUrl:w.item_url,aspectRatio:1,isFromBrand:!0,source:s.Hw.BRAND,sdkVersion:p.f4,previewUrl:w.cover_url.small,isFavorite:!1,isDefault:e.IsDefault,userId:w.user_id,createTime:w.create_time,brandExtraInfo:{funcs:T.funcs,textPresetType:T.text_preset_type,styleName:T.style_name,extra_info:T.extra_info},brandSubItemList:f,isPrefab:!1,isBrandTextLostDependencies:P}}catch(e){throw e}}(e):function(e){var{common:t}=(0,a.s)(n._g.TextPreset,e);return(0,o._)((0,i._)({},t),{isFavorite:e.IsFavorite,source:s.Hw.LOKI,aspectRatio:1})}(e)}},202919:function(e,t,r){"use strict";var i,o;r.d(t,{$:function(){return i}}),(o=i||(i={}))[o.artist=0]="artist",o[o.loki=1]="loki",o[o.brand=6]="brand"},810925:function(e,t,r){"use strict";r.d(t,{KV:function(){return l},zq:function(){return s}});var i,o,a,n,s,l,c=r(30276);(i=n||(n={}))[i.SUCCESS=1]="SUCCESS",i[i.CANCEL=-7]="CANCEL",(0,c.yh)("js-bridge-adapter-service"),(o=s||(s={}))[o.SUCCESS=0]="SUCCESS",o[o.UN_SUPPORT_EXT=1]="UN_SUPPORT_EXT",o[o.UN_SUPPORT_LEN=2]="UN_SUPPORT_LEN",o[o.UN_SUPPORT_SIZE=3]="UN_SUPPORT_SIZE",(a=l||(l={}))[a.NoStart=0]="NoStart",a[a.Cliping=1]="Cliping",a[a.Uploading=2]="Uploading",a[a.Analyzing=3]="Analyzing",a[a.Downloading=4]="Downloading",a[a.Successed=5]="Successed",a[a.Failed=6]="Failed",a[a.Cacneled=7]="Cacneled",(0,c.yh)("js-bridge-service")},39769:function(e,t,r){"use strict";r.d(t,{l:function(){return o}});var i=r(466477);function o(e,t){var r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=Object.assign({},{type:e},t);return r&&(0,i.K)(o),{key:o.key,resource:o}}}},function(e){var t=function(t){return e(e.s=t)};e.O(0,["1279","1423","1509","1618","1891","1917","2126","2137","2173","2370","2394","2707","2725","2925","2998","302","3646","4229","4665","4729","4742","5018","5085","5245","5369","5923","5931","6054","6179","6227","640","6421","6903","8017","8054","81","8100","8192","8377","8405","8851","902","9028","9109","929","9426","9845"],function(){return t("658683"),t("520825"),t("428651"),t("651056")}),e.O()}]);