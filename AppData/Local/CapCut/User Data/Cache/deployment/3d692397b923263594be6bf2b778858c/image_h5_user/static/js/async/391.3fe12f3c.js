"use strict";(self.webpackChunkartist_op_web=self.webpackChunkartist_op_web||[]).push([[391],{49314:function(e,t,n){n.d(t,{y:function(){return u}});var i=n(30001),r=n(50959),a=n(35273),s=n(70995),c=n(11527),o=function(e){var t=(0,r.useRef)(!1),n=e.id,o=e.placeholder,u=e.maxLength,l=e.value,d=e.onChange,p=e.onCompositionEnd,f=e.onCompositionStart,m=(0,r.useCallback)((function(e){t.current=!0,null==f||f(e)}),[f]),v=(0,r.useCallback)((function(e){if(null==p||p(e),"string"==typeof l&&void 0!==u){var n="";l.split("").forEach((function(e){(0,s.O1)(n)+(0,s.O1)(e)<=2*u&&(n="".concat(n).concat(e))})),null==d||d(n,e)}t.current=!1}),[p,d,u,l]),h=(0,r.useCallback)((function(e,n){if(void 0!==d)if(void 0!==u)if(t.current)d(e,n);else{var i="";e.split("").forEach((function(e){(0,s.O1)(i)+(0,s.O1)(e)<=2*u&&(i="".concat(i).concat(e))})),d(i,n)}else d(e,n)}),[d,u]),g=(0,r.useMemo)((function(){if(void 0===u||"number"==typeof l)return null;var e=l||"";return(0,c.jsx)("span",{style:{marginRight:6,color:"var(--color-text-2)"},children:Math.max(0,u-(0,s.VO)(e))})}),[u,l]),x=(0,a.tL)(n).error,_=(0,r.useMemo)((function(){return void 0===n||void 0===x?o:x}),[x,n,o]);return(0,c.jsx)(a.II,(0,i.Z)((0,i.Z)({},e),{},{autoComplete:"off",maxLength:void 0,suffix:g,placeholder:_,onChange:h,onCompositionStart:m,onCompositionEnd:v}))},u=(0,a.Q2)(o)},30036:function(e,t,n){n.d(t,{V:function(){return k}});var i=n(30001),r=n(261),a=n(50959),s=n(35273),c=n(53644),o=n(78794),u=n(84875),l=n.n(u),d=n(32662),p=n(74505),f=n(64721),m=n(70311),v="sSvgw",h="ki3E1",g="wfojK",x=n(11527),_=function(e){var t=(0,a.useState)([]),n=(0,r.Z)(t,2),u=n[0],_=n[1],k=(0,o.$)().t,Z=e.itemType,b=e.className,y=e.checkboxCls,j=(0,f.ZP)(f.Qt.UseHasAgree,p.$.userInfo.uid),N=j.get,L=j.set,w=(0,m.ZP)({handleBtnText:k("pc_i_see"),needReview:!1,protocal:m.MO.Origin,onOk:function(){if(p.$.userInfo.uid){L("add",[m.MO.Origin]);var e=N();_(e)}}}).showModal;return(0,a.useEffect)((function(){if(p.$.userInfo.uid){var e=N();_(e)}}),[p.$.userInfo.uid]),(0,x.jsx)("div",{className:l()([v,b]),children:(0,x.jsxs)("div",{className:h,children:[(0,x.jsx)(s.XZ,(0,i.Z)((0,i.Z)({},e),{},{className:y,onChange:function(t){var n;t.target.checked&&(u.includes(m.MO.Origin)||w()),null==e||null===(n=e.onChange)||void 0===n||n.call(e,t.target.checked)},children:d.XH[Z]})),(0,x.jsx)(c.Sus,{className:g,onClick:w})]})})},k=(0,s.Q2)(_)},23339:function(e,t,n){n.d(t,{u:function(){return P}});var i=n(85770),r=n(19058),a=n(58054),s=n(261),c=n(50959),o=n(35273),u=n(15547),l=n(78794),d=n(21551),p=n(98069),f=n(74505),m=n(64721),v=n(70995),h=n(84875),g=n.n(h),x="smxie",_="aqS4C",k="IyBLd",Z="QuFv_",b="ukrQO",y="YUHwh",j=n(11527),N=function(e){var t=e.className,n=e.title,i=e.loading,r=e.loadingText,a=e.value,s=e.options,u=e.onSelect,l=(0,c.useCallback)((function(e){return a.includes(e)}),[a]);return(0,j.jsxs)("div",{className:g()([x,t]),children:[(0,j.jsx)("p",{className:_,children:n}),(0,j.jsx)("div",{className:k,children:i?(0,j.jsxs)("div",{className:Z,children:[(0,j.jsx)("span",{className:b,children:r}),(0,j.jsx)(o.yC,{size:"small"})]}):s.map((function(e){return(0,j.jsx)(o.Vp,{className:y,color:l(e)?"cyan":void 0,onClick:function(){return u(e)},children:e},e)}))})]})},L=(0,d.Pi)((function(e){var t=e.value,n=e.onSelect,i=(0,c.useState)([]),r=(0,s.Z)(i,2),a=r[0],o=r[1],u=(0,m.ZP)(m.Qt.TagEachUser,f.$.userInfo.uid).get,d=(0,l.$)().t;return(0,c.useEffect)((function(){var e=u();o(e)}),[f.$.userInfo.uid]),(0,j.jsx)(N,{title:d("pc_recently_used"),value:t,options:a,onSelect:n})})),w=((0,d.Pi)((function(e){var t=e.title,n=e.uri,o=e.value,d=e.itemType,f=e.onSelect,m=(0,c.useState)([]),v=(0,s.Z)(m,2),h=v[0],g=v[1],x=(0,c.useState)([]),_=(0,s.Z)(x,2),k=_[0],Z=_[1],b=(0,c.useState)(!1),y=(0,s.Z)(b,2),L=y[0],w=y[1],S=(0,c.useRef)({}),P=(0,l.$)().t,C=(0,c.useMemo)((function(){return[].concat((0,i.Z)(k),(0,i.Z)(h))}),[h,k]),I=(0,c.useCallback)((0,a.Z)((0,r.Z)().mark((function e(){var i,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,w(!0),e.next=4,Promise.all([((null===(i=S.current)||void 0===i?void 0:i.cvid)&&t||n&&t)&&(0,p.Uz)(null!==(a=S.current)&&void 0!==a&&a.cvid?{cvid:null===(s=S.current)||void 0===s?void 0:s.cvid,title:t}:{image_uri:n,title:t}).then((function(e){Z(e.cv_tags),S.current.cvid=e.cvid})),!S.current.selfConfigTagsReady&&(0,p.On)({effect_type:d}).then((function(e){g(e.rec_tags),S.current.selfConfigTagsReady=!0}))]);case 4:return e.prev=4,w(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[0,,4,7]])}))),[t,n,d]);return(0,u.Z)(I,500,[I]),(0,c.useEffect)((function(){I()}),[]),(0,j.jsx)(N,{title:P("recommend_signature"),loading:L,loadingText:P("loading"),value:o,options:C,onSelect:f})})),"KEPqc"),S=(0,d.Pi)((function(e){e.recommendConfig;var t=e.value,n=e.itemType,d=(e.disableRecommend,e.disableLatest),h=e.onChange,g=(0,c.useMemo)((function(){return t||[]}),[t]),x=(0,c.useState)(""),_=(0,s.Z)(x,2),k=_[0],Z=_[1],b=(0,c.useState)([]),y=(0,s.Z)(b,2),N=y[0],S=y[1],P=(0,l.$)().t,C=(0,m.ZP)(m.Qt.TagEachUser,f.$.userInfo.uid).set;(0,u.Z)((0,a.Z)((0,r.Z)().mark((function e(){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(k){e.next=5;break}return S([]),e.abrupt("return");case 5:return e.next=7,(0,p.je)({query:k,count:10,effect_type:n});case 7:t=e.sent,i=((null==t?void 0:t.sug_words)||[]).map((function(e){return e.words})),S(i);case 10:case"end":return e.stop()}}),e)}))),500,[k,n]);var I=(0,c.useCallback)((function(e){if(g&&h){var t=g.indexOf(e);if(-1===t)return h([].concat((0,i.Z)(g),[e])),void Z("");var n=(0,i.Z)(g);n.splice(t,1),h(n),Z("")}}),[g,h]);return(0,j.jsxs)("div",{className:w,children:[(0,j.jsx)(o.Lt,{position:"topLeft",render:(0,j.jsx)(o.Lt.Menu,{children:N.map((function(e){return(0,j.jsx)(o.Lt.Item,{onClick:function(){return I(e)},children:e},e)}))}),children:(0,j.jsx)(o.EG,{inputValue:k,onInputChange:function(e){return function(e){(0,v.O1)(e)<=30&&Z(e)}(e)},value:t,placeholder:P("please_enter_the_label_enter_key_to_confirm_the_input"),onChange:h,onAdd:function(e){return C("add",e)}})}),!1,!d&&(0,j.jsx)(L,{value:g,onSelect:I})]})})),P=(0,o.Q2)(S)},39391:function(e,t,n){n.r(t),n.d(t,{default:function(){return Zt}});var i=n(50959),r=n(35273),a=n(21551),s=n(78794),c=n(49726),o=n(96164),u=n(84875),l=n.n(u),d=n(30001),p=n(39427),f=n(58745),m=n(46922),v=n(98069),h=function(e){return e.CYCLE="cycle",e.SINGLE="single",e}({}),g=n(85770),x=n(19058),_=n(58054),k=n(49765),Z=n(18513),b=n(19198),y=n(573),j=n(51949),N=n(74505),L=n(47662),w=n(82581),S=n(33673),P=n(82921),C=n(24738),I=w.oc.t,T=function(e,t,n){var i=e.filter((function(e){return"validateFail"===e.status||"remove"===n})),r=e.filter((function(e){return"validateFail"!==e.status&&"remove"!==n})),a=t.filter((function(e){return!i.find((function(t){return t.uid===e.uid}))}));return r.forEach((function(e){var t=a.findIndex((function(t){return t.uid===e.uid}));t>-1?a[t]=(0,d.Z)((0,d.Z)({},a[t]),e):a.push(e)})),a},E=function(){var e=(0,_.Z)((0,x.Z)().mark((function e(t,n){var i,r,a,s,c,o,u,l,d;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(i=n||{}).width,a=void 0===r?S.$7:r,s=i.height,c=void 0===s?S.R$:s,o=i.bgColor,u=void 0===o?S.N3:o,l=0,d=[],5,e.next=6,Promise.all(new Array(5).fill("").map(function(){var e=(0,_.Z)((0,x.Z)().mark((function e(n){var i,r,s,o,p,f,m,g,_;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(l>=t.length)){e.next=2;break}return e.abrupt("return");case 2:return o=l++,p=t[o],f=p.fpsSetting,m=p.cycleSetting,g=p.response,e.next=6,(0,v.PU)({file_uri:(null==g||null===(i=g.uploadResult)||void 0===i||null===(r=i.ObjectMeta)||void 0===r?void 0:r.Uri)||(null==g||null===(s=g.uploadResult)||void 0===s?void 0:s.Uri),fps:f,loop:m===h.CYCLE,gen_size:0,gif_gen_opts:[{bg_color:u||"",width:a,height:c,padding:0},{bg_color:"",width:0,height:0,padding:0}]});case 6:_=e.sent,d[o]=_;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return e.abrupt("return",d);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),F=function(e,t){return Promise.all(e.map(function(){var e=(0,_.Z)((0,x.Z)().mark((function e(n,i){var r,a,s,c,o,u,l,d,p;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=null==n||null===(r=n.response)||void 0===r?void 0:r.uploadResult,p=t[i],e.abrupt("return",{payload:{imgUrl:null===(a=p.gif_infos)||void 0===a||null===(s=a[1])||void 0===s?void 0:s.url,type:v.Ic.Dynamic},effect_type:C.qG.Sticker,is_vip:!1,common_data:{title:n.name.slice(0,30),icon:{image_uri:null==p||null===(c=p.gif_infos)||void 0===c||null===(o=c[0])||void 0===o?void 0:o.uri},file:{file_uri:null==p?void 0:p.file_uri,file_md5:null==p?void 0:p.file_md5,size:null==p?void 0:p.file_size},sdk_version:"1.0.0",source:v.r0.UserPostPcSequence,tags:[],is_original:!1,is_business:!1,web_extra:""},sticker:{large_image:{image_uri:null==p||null===(u=p.gif_infos)||void 0===u||null===(l=u[1])||void 0===l?void 0:l.uri},sticker_type:1===(null==d?void 0:d.FrameCnt)?v.Ic.Static:v.Ic.Dynamic,no_multi_sticker:!1,package_size:0}});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()))},O=function(e,t){return e.map((function(e){var n,i=e.common_data.icon.image_uri,r=(null===(n=t.iconBlankData.find((function(e){return e.sourceUri===i})))||void 0===n?void 0:n.uri)||i,a=t.iconBlank?r:i,s=null!=t&&t.highPro?"".concat(e.common_data.source,"_without_review"):e.common_data.source;return(0,d.Z)((0,d.Z)({},e),{},{common_data:(0,d.Z)((0,d.Z)({},e.common_data),{},{icon:{image_uri:a},description:e.common_data.description||e.common_data.title,source:s}),sticker:(0,d.Z)((0,d.Z)({},e.sticker),{},{no_multi_sticker:t.packOne,package_size:t.packOne?800:0}),payload:void 0})}))},M=function(){var e=(0,_.Z)((0,x.Z)().mark((function e(t){var n,i,r,a,s,c,o,u,l,d,p,f,m,v,h,g;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.src,i=t.imgWidth,r=t.imgHeight,a=t.width,s=void 0===a?320:a,c=t.height,o=void 0===c?320:c,u=t.backgroundColor,l=void 0===u?"transparent":u,d=document.createElement("canvas"),p=d.getContext("2d"),d.width=s,d.height=o,"transparent"!==l&&(p.fillStyle=l,p.fillRect(0,0,d.width,d.height)),.8,i>r?m=(f=.8*s)*r/i:f=(m=.8*o)*i/r,v=(s-f)/2,h=(o-m)/2,e.next=12,new Promise((function(e){var t=new Image;t.onload=function(){p.drawImage(t,v,h,f,m),e("")},t.crossOrigin="anonymous",t.src=n}));case 12:return e.next=14,new Promise((function(e,t){d.toBlob((function(n){if(n){var i=(0,P.y8)(n);e({blob:n,url:i})}else t(new Error(I("operation_failful")))}))}));case 14:return g=e.sent,e.abrupt("return",g);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=n(56873),U=n(86305),D=n(15671),$=n(41255),A=n.n($),R=n(31223),z=n.n(R),V=function(){function e(){(0,U.Z)(this,e),(0,o.Z)(this,"timeoutHandle",null)}return(0,D.Z)(e,[{key:"timeout",value:function(e){var t=this;return this.cancel(),new Promise((function(n){t.timeoutHandle=setTimeout((function(){t.timeoutHandle=null,n()}),e)}))}},{key:"cancel",value:function(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null)}},{key:"hasTimeout",value:function(){return null!==this.timeoutHandle}}]),e}(),q=n(21640),H=function(){function e(){(0,U.Z)(this,e),(0,o.Z)(this,"itemMap",new Map)}var t,n,i,r,a;return(0,D.Z)(e,[{key:"getPublishInfo",value:function(e){return this.itemMap.get(e)}},{key:"batchPublish",value:(a=(0,_.Z)((0,x.Z)().mark((function e(t){var n,i,r,a,s,c=this;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],i=(0,B.Z)(A()(t,10)),e.prev=2,i.s();case 4:if((r=i.n()).done){e.next=12;break}return a=r.value,e.next=8,Promise.all(a.map((function(e){return c.publish(e)})));case 8:s=e.sent,n.push.apply(n,(0,g.Z)(s));case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),i.e(e.t0);case 17:return e.prev=17,i.f(),e.finish(17);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])}))),function(e){return a.apply(this,arguments)})},{key:"publish",value:(r=(0,_.Z)((0,x.Z)().mark((function e(t){var n,i,r,a,s;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,i=t.onResult,r=JSON.parse(JSON.stringify(t.req)),!(a=this.itemMap.get(n))){e.next=18;break}if(!a.promise||!z()(a.req,r)){e.next=14;break}return e.prev=5,e.next=8,a.promise;case 8:return e.abrupt("return",e.sent);case 11:e.prev=11,e.t0=e.catch(5),null===(s=y.Z.sendLog)||void 0===s||s.call(y.Z,{level:"info",content:"[MaterialPublishService] publish failed, start to retry",extra:{id:n}});case 14:a.req=r,a.onResult=i,e.next=20;break;case 18:a={promise:null,id:n,req:r,onResult:i},this.itemMap.set(n,a);case 20:return a.promise||(a.promise=this.publishImpl(a)),e.abrupt("return",a.promise);case 22:case"end":return e.stop()}}),e,this,[[5,11]])}))),function(e){return r.apply(this,arguments)})},{key:"getErrorText",value:function(e){return e?e.message||JSON.stringify(e):""}},{key:"publishImpl",value:(i=(0,_.Z)((0,x.Z)().mark((function e(t){var n,i,r,a=this;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=performance.now(),i=function(){var e=(0,_.Z)((0,x.Z)().mark((function e(i,r){var s,c;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(s=t.onResult)||void 0===s?void 0:s.call(t,{req:t.req,error:i,errorText:a.getErrorText(i),time:Math.round(performance.now()-n),resourceId:r});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),(0,y.Z)("captureException",e.t0),null===(c=y.Z.sendLog)||void 0===c||c.call(y.Z,{level:"error",content:"[MaterialPublishService] callOnResult failed"});case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}(),e.prev=2,e.next=5,(0,v.TT)(t.req);case 5:r=e.sent,e.next=13;break;case 8:throw e.prev=8,e.t0=e.catch(2),t.promise=null,i(e.t0,""),e.t0;case 13:return e.next=15,i(null,r.resource_id);case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,null,[[2,8]])}))),function(e){return i.apply(this,arguments)})},{key:"pollUntilAllInEffectList",value:(n=(0,_.Z)((0,x.Z)().mark((function e(t){var n;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.race([this.pollUntilAllInEffectListImpl(t),(new V).timeout(5e3)]);case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),(0,y.Z)("captureException",e.t0),null===(n=y.Z.sendLog)||void 0===n||n.call(y.Z,{level:"error",content:"[MaterialPublishService] pollUntilAllInEffectList failed"});case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e){return n.apply(this,arguments)})},{key:"pollUntilAllInEffectListImpl",value:(t=(0,_.Z)((0,x.Z)().mark((function e(t){var n,i,r,a,s,c,o;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.ids,i=t.types,r=performance.now(),a=new V,s={count:50,effect_types:i,uid:N.$.userInfo.uid,cursor:0},c=(0,x.Z)().mark((function e(){var t,i;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,q.OE)(s).catch((function(){return null}));case 2:if(null==(t=e.sent)||!t.effect_item_list){e.next=7;break}if(i=new Set(t.effect_item_list.map((function(e){return e.common_attr.id}))),!n.every((function(e){return i.has(e)}))){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:return e.next=9,a.timeout(500);case 9:case"end":return e.stop()}}),e)}));case 5:if(!(performance.now()-r<5e3)){e.next=12;break}return e.delegateYield(c(),"t0",7);case 7:if("object"!=typeof(o=e.t0)){e.next=10;break}return e.abrupt("return",o.v);case 10:e.next=5;break;case 12:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}();var Y=(0,i.createContext)(null),Q=function(){return(0,i.useContext)(Y)},X=h.CYCLE,G=w.oc.t,W={acceptFileTypes:["image/jpeg","image/png","image/gif"],acceptFileTypeStr:"jpeg/png/gif",dragMainText:G("click_to_upload_or_drag_and_drop_files_here"),dragSubText:["".concat(G("supported_file_types")," jpeg/png/gif")]},K={acceptFileTypes:["image/png"],acceptFileTypeStr:"png",dragMainText:G("click_to_upload_or_drag_and_drop_files_here"),dragSubText:[G("pc_stickers_prompt_max_{X}_min_{Y}_only_{Z}_format",{X:"49",Y:"1080*1080",Z:"PNG"})]},J="I90Ej",ee=n(11527),te=["mainText","subText","btnClassName","className","value","onChange"],ne=(0,a.Pi)((function(e){var t=e.mainText,n=e.subText,i=e.btnClassName,a=e.className,s=(e.value,e.onChange,(0,p.Z)(e,te)),c=Q();return(0,ee.jsx)(m.Z,(0,d.Z)((0,d.Z)({},s),{},{className:l()([J,a]),fileValidate:{maxHeight:1080,maxWidth:1080,maxFps:49,minFps:2},limit:c.maxPublishNum,fileList:c.frameList,isGenGif:!1,onChange:function(e){c.changeList(e.map((function(e){var t="validating"===e.status&&0===e.percent,n={cycleSetting:X,fpsSetting:16};return(0,d.Z)((0,d.Z)({},t?n:{}),e)})),v.Ic.Dynamic)},onError:function(e){var t,n=null===(t=e[0])||void 0===t?void 0:t.validateMessage;n&&r.FN.error(n)},children:(0,ee.jsx)(f.Z,{mainText:t,subText:n,btnClassName:i})}))})),ie=n(261),re=n(90740),ae="gjAp6",se=["mainText","subText","btnClassName","className","value","onChange"],ce=(0,a.Pi)((function(e){var t=e.mainText,n=e.subText,a=e.btnClassName,c=e.className,o=e.value,u=e.onChange,m=(0,p.Z)(e,se),v=(0,s.$)().t,h=Q(),g=(0,i.useState)(o||[]),x=(0,ie.Z)(g,2),_=x[0],k=x[1];(0,i.useEffect)((function(){k(_.filter((function(e){return h.staticList.find((function(t){return t.uid===e.uid}))})))}),[h.staticList.length]);var Z=(0,i.useCallback)((function(){r.FN.error(v("up_to_{X}",{X:h.maxPublishNum}))}),[h.maxPublishNum]);return(0,ee.jsx)(re.ZP,(0,d.Z)((0,d.Z)({},m),{},{multiple:!0,draggable:!0,autoRemove:!1,className:l()([ae,c]),fileList:_,showUploadList:!1,limit:h.maxPublishNum,onExceed:Z,onChange:function(e){var t=e.currentFile,n=e.fileList;(null==_?void 0:_.length)>h.maxPublishNum?Z():(t.doneValidate&&"validateFail"!==t.status&&(null==u||u({currentFile:t,fileList:n.filter((function(e){return e.doneValidate&&"validateFail"!==e.status}))})),k(n.filter((function(e){return"validateFail"!==e.status}))))},children:(0,ee.jsx)(f.Z,{mainText:t,subText:n,btnClassName:a})}))})),oe=n(76285),ue=n(53644),le="guT5O",de="oUzZS",pe="loyVb",fe="Rchec",me="OpE2d",ve="_NU83",he="cdOdh",ge="v4uIW",xe="O9aS5",_e="JOEvc",ke="PAdTo",Ze="yzrAM",be="c1T5Y",ye="BUcvB",je="tTePR",Ne="QF4KK",Le=(0,a.Pi)((function(e){var t=(0,s.$)().t,n=e.url,a=e.name,c=e.size,u=e.status,d=void 0===u?"wait":u,p=e.event,f=void 0===p?"":p,m=e.percent,v=e.validateMessage,h=e.removeFileItem,g=e.retryFileItem,x=e.frameExtra,_=(0,i.useMemo)((function(){return["wait","success"].includes(d)?null:"uploadFail"===d?(0,ee.jsxs)("div",{className:ye,children:[(0,ee.jsxs)("span",{className:je,children:[(0,ee.jsx)(ue.Ldj,{size:"small",style:{marginRight:2}}),t("upload_failed")]}),(0,ee.jsx)("span",{className:Ne,onClick:function(){return g(e)},children:t("retry_pc")})]}):"validateFail"===d?(0,ee.jsx)("div",{className:ye,children:(0,ee.jsxs)("span",{className:je,children:[(0,ee.jsx)(ue.Ldj,{size:"small",style:{marginRight:2}}),v]})}):"validating"===d?(0,ee.jsxs)("div",{className:ke,children:[(0,ee.jsx)(r.yC,{size:"small"}),(0,ee.jsxs)("span",{children:[t("checking_pc_stickers"),"..."]})]}):"uploading"===d?(0,ee.jsxs)("div",{className:Ze,children:[(0,ee.jsx)(r.Ex,{className:be,stroke:"var(--semi-color-primary)",percent:m,type:"line",size:"small"}),m,"%"]}):void 0}),[d,f,m]),k=l()(le,(0,o.Z)({},de,"uploadFail"===d||"validateFail"===d));return(0,ee.jsxs)("div",{className:k,children:[(0,ee.jsxs)("div",{className:pe,children:[(0,ee.jsx)("div",{className:fe,children:(0,ee.jsx)("img",{src:n,alt:""})}),(0,ee.jsxs)("div",{className:me,children:[(0,ee.jsxs)("div",{className:ve,children:[(0,ee.jsx)("span",{className:he,children:a}),(0,ee.jsx)("span",{className:ge,children:c})]}),_&&(0,ee.jsx)("div",{className:_e,children:_})]}),(0,ee.jsx)(r.zx,{className:xe,type:"tertiary",theme:"borderless",icon:(0,ee.jsx)(ue.bMz,{}),size:"small",onClick:function(){return h(e)}})]}),x]})})),we="i3Dfe",Se="BfmRD",Pe="Su8e0",Ce="igaTL",Ie="BFlSw",Te="T8ZrP",Ee="xq070",Fe="oemUE",Oe="qEFTL",Me=(0,a.Pi)((function(){var e,t,n=Q(),i=(0,s.$)().t,a=function(e){n.changeList([e],v.Ic.Static,"remove")},c=function(e){n.changeList([e],v.Ic.Dynamic,"remove")},o=function(){var e=(0,_.Z)((0,x.Z)().mark((function e(t,i){var r;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.changeList([(0,d.Z)((0,d.Z)({},t),{},{percent:0,status:"uploading"})],i),e.next=3,(0,oe.ws)({file:t.fileInstance,onProgress:function(e){e.total;var r=e.loaded;n.changeList([(0,d.Z)((0,d.Z)({},t),{},{percent:r,status:"uploading"})],i)},onSuccess:function(e){console.log("onSuccess",e),n.changeList([(0,d.Z)((0,d.Z)({},t),{},{response:e,status:"success"})],i)},onError:function(e){console.log("onError",e),n.changeList([(0,d.Z)((0,d.Z)({},t),{},{status:"uploadFail"})],i)}});case 3:return r=e.sent,console.log({res:r}),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(e){n.changeList(n.frameList.map((function(t){return(0,d.Z)((0,d.Z)({},t),e)})),v.Ic.Dynamic)};return(0,ee.jsxs)("div",{children:[(null===(e=n.staticList)||void 0===e?void 0:e.length)>0&&(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("div",{className:we,children:i("ordinary_stickers")}),(0,ee.jsx)("div",{className:Se,children:n.staticList.map((function(e){return(0,ee.jsx)("div",{className:Pe,children:(0,ee.jsx)(Le,(0,d.Z)((0,d.Z)({},e),{},{removeFileItem:a,retryFileItem:function(e){return o(e,v.Ic.Static)}}))},e.uid)}))})]}),(null===(t=n.frameList)||void 0===t?void 0:t.length)>0&&(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("div",{className:we,children:i("sequence_frame_stickers")}),(0,ee.jsx)("div",{className:Se,children:n.frameList.map((function(e){return(0,ee.jsx)("div",{className:Pe,children:(0,ee.jsx)(Le,(0,d.Z)((0,d.Z)({},e),{},{removeFileItem:c,retryFileItem:function(e){return o(e,v.Ic.Dynamic)},frameExtra:(0,ee.jsxs)("div",{className:Ce,children:[(0,ee.jsxs)("div",{className:Ie,children:[(0,ee.jsx)("span",{className:Te,children:i("fps_settings_pc_stickers")}),(0,ee.jsxs)("div",{className:Fe,children:[(0,ee.jsx)(r.Rn,{className:Ee,hideButtons:!0,style:{width:48},formatter:function(e){return"".concat(e).replace(/\D/g,"")},min:1,max:49,defaultValue:16,value:e.fpsSetting,validateStatus:null!=e&&e.fpsSetting&&e.fpsSetting>=1&&e.fpsSetting<=49?"default":"error",onChange:function(t){return n.changeList([(0,d.Z)((0,d.Z)({},e),{},{fpsSetting:t})],v.Ic.Dynamic)}}),(0,ee.jsx)("span",{className:Te,children:"FPS"})]}),(0,ee.jsx)(r.zx,{className:Oe,theme:"solid",type:"secondary",onClick:function(){return u({fpsSetting:e.fpsSetting})},children:i("apply_to_all_stickers")})]}),(0,ee.jsxs)("div",{className:Ie,children:[(0,ee.jsxs)("span",{className:Te,children:[" ",i("cycle_settings_stickers")]}),(0,ee.jsx)("div",{className:Fe,children:(0,ee.jsxs)(r.FX,{onChange:function(t){n.changeList([(0,d.Z)((0,d.Z)({},e),{},{cycleSetting:t.target.value})],v.Ic.Dynamic)},value:e.cycleSetting,children:[(0,ee.jsx)(r.Y8,{value:h.CYCLE,children:i("loop_stickers_pc")}),(0,ee.jsx)(r.Y8,{value:h.SINGLE,children:i("one_time_play")})]})}),(0,ee.jsx)(r.zx,{className:Oe,theme:"solid",type:"secondary",onClick:function(){return u({cycleSetting:e.cycleSetting})},children:i("apply_to_all_stickers")})]})]})}))},e.uid)}))})]})]})})),Be="c6IDV",Ue="wfC_b",De="Qnv0m",$e="ahmVs",Ae="BfgTg",Re="I8v4r",ze="PUjTy",Ve="PxgUC",qe="PaUFE",He=function(e){var t=e.num,n=e.limit,i=(0,s.$)().t;return(0,ee.jsx)("span",{className:qe,children:i("pc_stickers_upload_{X}_max_{Y}",{X:t,Y:n})})},Ye=(0,a.Pi)((function(){var e=Q(),t=(0,s.$)().t,n=e.staticList,r=e.frameList,a=(0,i.useMemo)((function(){return n.length+r.length>0}),[n,r]),c=(0,i.useMemo)((function(){return(0,ee.jsx)(He,{num:n.length,limit:e.maxPublishNum})}),[n,e.maxPublishNum]),u=(0,i.useMemo)((function(){return(0,ee.jsx)(He,{num:r.length,limit:e.maxPublishNum})}),[r,e.maxPublishNum]);return(0,ee.jsxs)("div",{className:Be,children:[(0,ee.jsxs)("div",{className:Ue,children:[(0,ee.jsxs)("div",{className:De,children:[(0,ee.jsx)("div",{className:$e,children:t("ordinary_stickers")}),(0,ee.jsx)(ce,{multiple:!0,accept:W.acceptFileTypes.join(","),className:l()(ze,(0,o.Z)({},Ve,a)),btnClassName:l()(Ae,(0,o.Z)({},Re,a)),value:n,prompt:c,mainText:W.dragMainText,subText:W.dragSubText,onChange:function(t){var n=t.currentFile;t.fileList;e.changeList([n],v.Ic.Static)}})]}),(0,ee.jsxs)("div",{className:De,children:[(0,ee.jsx)("div",{className:$e,children:t("sequence_frame_stickers")}),(0,ee.jsx)(ne,{accept:K.acceptFileTypes.join(","),className:l()(ze,(0,o.Z)({},Ve,a)),btnClassName:l()(Ae,(0,o.Z)({},Re,a)),prompt:u,mainText:K.dragMainText,subText:K.dragSubText})]})]}),(0,ee.jsx)("div",{children:(0,ee.jsx)(Me,{})})]})})),Qe=n(23339),Xe=n(49314),Ge=n(70995),We=n(30036),Ke="hMr14",Je="iSKwY",et="N2D_a",tt="KKeDq",nt="zXUQS",it="JWxAl",rt="Qgr7W",at=(0,a.Pi)((function(e){var t=e.prefix,n=e.onRemove,a=Q(),c=(0,s.$)().t,o=(0,r.tL)("".concat(t,".payload.imgUrl")).value,u=(0,r.tL)("".concat(t,".common_data.icon.image_uri")).value,l=(0,r.tL)("".concat(t,".common_data.title")).value,p=(0,r.tL)("".concat(t,".common_data.icon.image_uri")).value,f=(0,r.tL)("".concat(t,".effect_type")).value,m=(0,i.useMemo)((function(){var e;return a.packOptions.iconBlank&&(null===(e=a.iconBlankData.find((function(e){return e.sourceUri===u})))||void 0===e?void 0:e.url)||o}),[o,a.packOptions.iconBlank,a.iconBlankData,u]),v=function(e,t){var n=a.formApi.getValue(e),i=a.formApi.getValue("list");switch(t){case"title":a.formApi.setValues({list:i.map((function(e){return(0,d.Z)((0,d.Z)({},e),{},{common_data:(0,d.Z)((0,d.Z)({},e.common_data),{},{title:n})})}))},{isOverride:!0});var r=a.formApi.getError("list");return void(n&&a.formApi.setError("list",null==r?void 0:r.map((function(e){return(0,d.Z)((0,d.Z)({},e),{},{common_data:(0,d.Z)((0,d.Z)({},e.common_data),{},{title:void 0})})}))));case"tags":return void a.formApi.setValues({list:i.map((function(e){return(0,d.Z)((0,d.Z)({},e),{},{common_data:(0,d.Z)((0,d.Z)({},e.common_data),{},{tags:n})})}))},{isOverride:!0});default:return}};return(0,ee.jsxs)("div",{className:Ke,children:[(0,ee.jsx)("div",{className:Je,children:(0,ee.jsx)(ue.Fzz,{style:{color:"#ADB0B2"},size:"large",onClick:n})}),(0,ee.jsx)("div",{className:et,children:(0,ee.jsx)("img",{src:m,alt:""})}),(0,ee.jsxs)("div",{className:tt,children:[(0,ee.jsxs)("div",{className:nt,children:[(0,ee.jsx)(Xe.y,{label:c("name_setting_pc"),field:"".concat(t,".common_data.title"),maxLength:30,noErrorMessage:!0,placeholder:c("name_setting_pc"),rules:[{required:!0,message:c("pc_stickers_hint_name_setting")},{validator:function(e,t){return(0,Ge.VO)(t)<=30},message:c("word_count_too_long")}]}),(0,ee.jsx)(r.zx,{className:it,theme:"solid",type:"secondary",onClick:function(){return v("".concat(t,".common_data.title"),"title")},children:c("apply_to_all_stickers")})]}),(0,ee.jsxs)("div",{className:nt,children:[(0,ee.jsx)(Qe.u,{label:c("label_settings_sticker"),field:"".concat(t,".common_data.tags"),itemType:f,noErrorMessage:!0,recommendConfig:{title:l,uri:p},rules:[{required:!0,message:c("please_enter_the_label_enter_key_to_confirm_the_input")}]}),(0,ee.jsx)(r.zx,{className:it,theme:"solid",type:"secondary",onClick:function(){return v("".concat(t,".common_data.tags"),"tags")},children:c("apply_to_all_stickers")})]}),(0,ee.jsxs)("div",{className:rt,children:[(0,ee.jsx)(We.V,{noLabel:!0,field:"".concat(t,".common_data.is_original"),itemType:f}),a.field.canBusiness&&(0,ee.jsx)(r.l0.Checkbox,{noLabel:!0,field:"".concat(t,".common_data.is_business"),children:c("commercial_stickers_pc")}),a.field.canVip&&(0,ee.jsx)(r.l0.Checkbox,{noLabel:!0,field:"".concat(t,".is_vip"),children:c("to_pay_for_stickers")})]})]})]})})),st=(0,a.Pi)((function(){return(0,ee.jsx)(r.OF,{field:"list",children:function(e){e.add;var t=e.arrayFields;e.addWithInitValue;return(0,ee.jsx)(i.Fragment,{children:t.map((function(e,t){var n=e.field,i=e.key,r=e.remove;return(0,ee.jsx)(at,{prefix:n,onRemove:r},i)}))})}})})),ct=n(14261),ot=n(54010),ut=n(97554),lt="xboIz",dt="_4yae",pt="cWJiB",ft=(0,a.Pi)((function(){var e=(0,s.$)().t,t=Q(),n=function(){var n=(0,_.Z)((0,x.Z)().mark((function n(i){var a,s,c,o;return(0,x.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i.target.checked){n.next=4;break}return t.setPackOptions({iconBlank:i.target.checked}),n.abrupt("return");case 4:return a=t.formApi.getValues(),s=a.list,c=s.filter((function(e){var t,n;return(null==e||null===(t=e.sticker)||void 0===t?void 0:t.sticker_type)===v.Ic.Static&&(null==e||null===(n=e.payload)||void 0===n?void 0:n.type)===v.Ic.Static})),r.FN.success(e("pc_stickers_toast_icon_gif")),n.prev=7,n.next=10,Promise.all(c.map(function(){var e=(0,_.Z)((0,x.Z)().mark((function e(n){var i,r,a,s,c,o,u,l,d,p,f,m;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=null===(i=n.common_data)||void 0===i||null===(r=i.icon)||void 0===r?void 0:r.image_uri,!(o=t.iconBlankData.find((function(e){return e.sourceUri===c&&e.uri})))){e.next=4;break}return e.abrupt("return",o);case 4:return e.next=6,(0,ut.iE)(null===(a=n.payload)||void 0===a?void 0:a.imgUrl);case 6:return u=e.sent,l=u.width,d=u.height,e.next=11,M({src:null===(s=n.payload)||void 0===s?void 0:s.imgUrl,imgWidth:l,imgHeight:d});case 11:return p=e.sent,f=p.blob,e.next=15,(0,oe.ws)({file:(0,P.hl)(f,"".concat(n.common_data.title,".png"),{type:"image/png"})});case 15:return m=e.sent,e.t0=m.uploadResult.Uri,e.t1=n.common_data.icon.image_uri,e.next=20,(0,P.w8)(f);case 20:return e.t2=e.sent,e.abrupt("return",{uri:e.t0,sourceUri:e.t1,url:e.t2});case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:o=n.sent,t.setIconBlankData(o),t.setPackOptions({iconBlank:i.target.checked}),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(7),(0,y.Z)("captureException",n.t0),r.FN.error(null===n.t0||void 0===n.t0?void 0:n.t0.message);case 19:case"end":return n.stop()}}),n,null,[[7,15]])})));return function(e){return n.apply(this,arguments)}}();return(0,ee.jsx)("div",{className:lt,children:(0,ee.jsxs)("div",{className:dt,children:[t.field.canPackOne&&(0,ee.jsx)(ot.Z,{className:pt,value:t.packOptions.packOne,onChange:function(e){return t.setPackOptions({packOne:e.target.checked})},children:e("pc_stickers_hint_name_source_only")}),t.field.canIconBlank&&(0,ee.jsx)(ot.Z,{className:pt,value:t.packOptions.iconBlank,onChange:n,children:e("enable_icon_blank")}),t.field.canHighPro&&(0,ee.jsx)(ot.Z,{className:pt,value:t.packOptions.highPro,onChange:function(e){return t.setPackOptions({highPro:e.target.checked})},children:e("enable_premium_publishing")})]})})})),mt=ft,vt=(0,a.Pi)((function(){var e=Q(),t=(0,s.$)().t,n=(0,j.Z)().jumpUser,a=(0,r.cl)().values,o=(0,i.useMemo)((function(){return 1===e.step?[t("cancel"),t("next_step_stickers")]:[t("previous_step_stickers"),t("release_post_pc")]}),[e.step]),u=(0,ie.Z)(o,2),l=u[0],d=u[1],p=function(){var e,t=null==a||null===(e=a.list)||void 0===e?void 0:e.find((function(e){var t,n,i=(0,Ge.VO)((null==e||null===(t=e.common_data)||void 0===t?void 0:t.title)||"")||0;return 0===i||i>30||(null==e||null===(n=e.common_data.tags)||void 0===n||!n.length)}));return Boolean(t)},f=(0,i.useMemo)((function(){if(1===e.step){var t;if(e.packing||e.frameList.length+(null===(t=e.staticList)||void 0===t?void 0:t.length)===0)return!0;var n=[].concat((0,g.Z)(e.staticList),(0,g.Z)(e.frameList)).find((function(e){return"uploading"===e.status})),i=[].concat((0,g.Z)(e.staticList),(0,g.Z)(e.frameList)).find((function(e){return"success"===e.status}));return Boolean(n)||!i}return 2===e.step&&p()}),[e.packing,e.staticList,e.frameList,p]),m=(0,i.useCallback)((function(){1!==e.step?e.goToStep(1):n()}),[e.goToStep,n]),v=(0,i.useCallback)((0,_.Z)((0,x.Z)().mark((function t(){return(0,x.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:1===e.step&&e.renderForm(),2===e.step&&e.publish();case 2:case"end":return t.stop()}}),t)}))),[e.frameList,e.staticList]);return(0,i.useEffect)((function(){e.formApi&&2===e.step&&e.formApi.setValues(e.publishList,{isOverride:!0})}),[e.step,e.publishList,e.formApi]),(0,c.Z)(t("stickers_one")),(0,ee.jsx)(ct.Z,{hideProtocal:1===e.step,checkProtocal:2===e.step,prevText:l,nextText:d,disabledNext:f,onPrev:m,onNext:v,children:2===e.step&&(0,ee.jsx)(mt,{})})})),ht=vt,gt="j6fFZ",xt="RUIFp",_t="EmGq8",kt=(0,a.Pi)((function(){var e=function(){(0,b.s0)();var e=(0,s.$)().t,t=(0,j.Z)().jumpUser,n=(0,k.fv)((function(){return{step:1,loading:!1,packing:!1,staticList:[],frameList:[],formApi:null,publishList:null,packOptions:{packOne:!1,iconBlank:!1,highPro:!1},iconBlankData:[],get permissions(){return N.$.permissions},get maxPublishNum(){return n.permissions.includes(N.v.EffectBatchMore)?50:20},get field(){return{canBusiness:N.$.permissions.includes(N.v.EffectSetBusiness),canVip:N.$.permissions.includes(N.v.EffectSetVip),canIconBlank:N.$.permissions.includes(N.v.EffectIconBlank),canHighPro:N.$.permissions.includes(N.v.EffectHighPrio),canPackOne:N.$.permissions.includes(N.v.StickerOnePackage)}},goToStep:(0,Z.aD)((function(e){n.step=e})),setLoading:(0,Z.aD)((function(e){return n.loading=e})),setPacking:(0,Z.aD)((function(e){return n.packing=e})),setIconBlankData:(0,Z.aD)((function(e){return n.iconBlankData=e})),setPublishList:(0,Z.aD)((function(e){return n.publishList=e})),setStaticlist:(0,Z.aD)((function(e){return n.staticList=e})),setFrameList:(0,Z.aD)((function(e){return n.frameList=e})),setFormApi:(0,Z.aD)((function(e){return n.formApi=e})),setPackOptions:(0,Z.aD)((function(e){return n.packOptions=(0,d.Z)((0,d.Z)({},n.packOptions),e)})),changeList:function(e,t,i){if(t===v.Ic.Static){var r=T(e,n.staticList,i);n.setStaticlist(r)}else{var a=T(e,n.frameList,i);n.setFrameList(a)}},renderForm:(a=(0,_.Z)((0,x.Z)().mark((function t(){var i,a,s,c,o;return(0,x.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.setLoading(!0),n.setPacking(!0),n.changeList(n.staticList.filter((function(e){return"success"!==e.status})),v.Ic.Static,"remove"),t.next=6,Promise.all(n.staticList.map(function(){var e=(0,_.Z)((0,x.Z)().mark((function e(t){var n;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,P.sT)(t.fileInstance);case 2:return n=e.sent,e.abrupt("return",(0,d.Z)((0,d.Z)({},t),{},{url:n}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return a=t.sent,n.changeList(a,v.Ic.Static),t.next=10,u=n.staticList,Promise.all(u.map(function(){var e=(0,_.Z)((0,x.Z)().mark((function e(t){var n,i,r,a,s;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null==t||null===(n=t.response)||void 0===n?void 0:n.uploadResult,e.next=3,(0,P.sT)(t.fileInstance);case 3:return s=e.sent,e.abrupt("return",{payload:{imgUrl:s,type:(null==t||null===(i=t.response)||void 0===i||null===(r=i.uploadResult)||void 0===r?void 0:r.FrameCnt)>1?v.Ic.Dynamic:v.Ic.Static},effect_type:C.qG.Sticker,is_vip:!1,common_data:{title:t.name.slice(0,30),icon:{image_uri:null==a?void 0:a.ImageUri},sdk_version:"1.0.0",source:v.r0.UserPostPc,tags:[],is_original:!1,is_business:!1,web_extra:""},sticker:{large_image:{image_uri:null==a?void 0:a.Uri},sticker_type:1===(null==a?void 0:a.FrameCnt)?v.Ic.Static:v.Ic.Dynamic,no_multi_sticker:!1,package_size:0}});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:if(s=t.sent,c=[],n.changeList(n.frameList.filter((function(e){return"success"!==e.status})),v.Ic.Dynamic,"remove"),null===(i=n.frameList)||void 0===i||!i.length){t.next=21;break}return r.FN.success(e("pc_stickers_toast_package")),t.next=17,E(n.frameList);case 17:return o=t.sent,t.next=20,F(n.frameList,o);case 20:c=t.sent;case 21:n.setPublishList({list:[].concat((0,g.Z)(s),(0,g.Z)(c))}),n.goToStep(2),t.next=29;break;case 25:t.prev=25,t.t0=t.catch(0),(0,y.Z)("captureException",t.t0),r.FN.error(e("something_went_wrong,_please_try_again"));case 29:return t.prev=29,n.setPacking(!1),n.setLoading(!1),t.finish(29);case 33:case"end":return t.stop()}var u}),t,null,[[0,25,29,33]])}))),function(){return a.apply(this,arguments)}),pubServ:new H,publish:(i=(0,_.Z)((0,x.Z)().mark((function i(){var a,s,c,o,u;return(0,x.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,n.setLoading(!0),i.next=4,n.formApi.validate();case 4:return a=i.sent,s=a.list,c=O(s,(0,d.Z)((0,d.Z)({},n.packOptions),{},{iconBlankData:n.iconBlankData})),o=new Set,u=c.map((function(e,t){var n="id_".concat(e.common_data.icon.image_uri,"_").concat(e.common_data.title);return o.has(n)&&(n="index_".concat(t)),o.add(n),{id:n,req:e}})),i.next=11,n.pubServ.batchPublish(u);case 11:r.FN.success(e("published_successfully_jump_to_the_personal_homepage")),(0,L.ZM)({effect_type:c[0].effect_type}),setTimeout((function(){t()}),1e3),i.next=21;break;case 16:i.prev=16,i.t0=i.catch(0),console.log(i.t0),(0,y.Z)("captureException",i.t0),r.FN.error(e("something_went_wrong,_please_try_again"));case 21:return i.prev=21,n.setLoading(!1),i.finish(21);case 24:case"end":return i.stop()}}),i,null,[[0,16,21,24]])}))),function(){return i.apply(this,arguments)})};var i,a}));return n}(),t=(0,s.$)().t;return(0,i.useEffect)((function(){e.formApi&&2===e.step&&e.formApi.setValues(e.publishList,{isOverride:!0})}),[e.step,e.publishList,e.formApi]),(0,c.Z)(t("stickers_one")),(0,ee.jsx)(Y.Provider,{value:e,children:(0,ee.jsx)(r.yC,{spinning:e.loading,children:(0,ee.jsxs)("div",{className:gt,children:[1===e.step&&(0,ee.jsx)(Ye,{}),(0,ee.jsxs)(r.l0,{layout:"vertical",getFormApi:e.setFormApi,children:[(0,ee.jsx)("div",{className:_t,style:{display:2===e.step?"block":"none"},children:(0,ee.jsx)(st,{})}),(0,ee.jsx)("div",{className:xt,children:(0,ee.jsx)(ht,{})})]})]})})})})),Zt=kt},21640:function(e,t,n){n.d(t,{OE:function(){return a},oL:function(){return r},th:function(){return c},uj:function(){return s}});var i=n(68252),r=function(e){return(0,i.v_)("https://feed-api.capcut.com/lv/v1/homepage/profile",e)},a=function(e){return(0,i.v_)("https://api-heycan-pc-va.capcut.com/artist/v1/homepage/get_effect_list?version_name=2.0.5",e)},s=function(e){return(0,i.v_)("https://api-heycan-pc-va.capcut.com/artist/v1/effect/delete",e)},c=function(e){return(0,i.v_)("https://api-heycan-pc-va.capcut.com/artist/v1/effect/mget_artist_item",e)}},70995:function(e,t,n){n.d(t,{O1:function(){return r},Rp:function(){return a},VO:function(){return i}});n(38023);var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Math.ceil(e.split("").reduce((function(e,t){return e+(/^[\u4e00-\u9fa5]$/.test(t)?2:1)}),0)/2)},r=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("").reduce((function(e,t){return e+(/^[\u4e00-\u9fa5]$/.test(t)?2:1)}),0)};function a(e,t,n){var i=e.slice();return i.splice(n<0?i.length+n:n,0,i.splice(t,1)[0]),i}}}]);