"use strict";(self.webpackChunkartist_op_web=self.webpackChunkartist_op_web||[]).push([[778],{46309:(e,t,n)=>{n.d(t,{BN:()=>s,Gw:()=>m,Nt:()=>c,Td:()=>i,Yo:()=>d,ZM:()=>l,bG:()=>a,c0:()=>u,qx:()=>p,zY:()=>r});var o=n(98052);const s=()=>(0,o.mu)("getAppInfo").then((e=>e.data?e.data:e)),r=()=>(0,o.mu)("getDebugInfo").then((e=>e.data)),a=()=>(0,o.mu)("getUserInfo"),i=e=>(0,o.mu)("setTitle",e),c=e=>o.Jn.call("publishEvent",{eventName:"JumpToPersonalHome",data:e}),l=e=>o.Jn.call("publishEvent",{eventName:"WebPublishSuccess",data:e}),u=e=>(0,o.mu)("setNeedConfirmModalOnClose",e),d=e=>o.Jn.call("openUrl",e),p=e=>o.Jn.call("reportAppLog",e);const m=e=>(0,o.mu)("getSettings",e)},44704:(e,t,n)=>{n.d(t,{i:()=>o.Z});var o=n(16613)},40509:(e,t,n)=>{n.d(t,{S1:()=>r.Wq,ZP:()=>c,vc:()=>i.v});var o=n(50959),s=n(49340),r=n(82725),a=(n(43982),n(11527)),i=n(5777);const c=()=>((0,o.useEffect)((()=>{(0,r.ZP)()}),[]),(0,a.jsx)(s.j3,{}))},66564:(e,t,n)=>{n.d(t,{G:()=>r});var o=n(8129),s=n(46309);async function r(e,t){try{return(await(0,s.Gw)({nodeKey:e,keys:t})).nodeKey}catch(n){(0,o.RF)("[getSettings] error",n,{nodeKey:e,keys:t})}return{}}},5777:(e,t,n)=>{n.d(t,{v:()=>r,w:()=>s});let o={};function s(e){o=e}const r=()=>({intl:{clientOptions:{getOverrideOptions:()=>o}}})},62262:(e,t,n)=>{n.d(t,{w:()=>s});var o=n(59787);class s extends Error{constructor(e,t){super(e),this.context=t,(0,o.Z)(this,"name","HeycanError")}}},98052:(e,t,n)=>{n.d(t,{Jn:()=>o.ZP,mu:()=>u});var o=n(38508),s=n(97373),r=n(77508),a=n(41503),i=n(76896),c=n(2555);o.ZP.use(new a.Z);class l extends Error{constructor(e,t,n){super(t),this.code=e,this.msg=t,this.error=n}}o.ZP.use(new class extends s.b{name(){return"HeycanPlugin"}async beforeCall({event:e}){if((0,i.c)()&&!window.window.webkit.messageHandlers[e])throw new l(r.GL.NOT_FOUND,`bridge not found, bridgeName=${e}`)}async trigger(e){e.triggerLocal()}});const u=async(e,t)=>{const{timeout_ms:n=3e3,...s}=t||{},a=new c.B;return Promise.race([o.ZP.call(e,s).finally((()=>a.cancel())),new Promise(((t,o)=>{if(!n)return;const s=new l(r.GL.TIMEOUT,`timed out by fe, bridgeName=${e}, timeout=${n}`);a.timeout(n).then((()=>o(s)))}))])}},76896:(e,t,n)=>{n.d(t,{c:()=>r});var o=n(22310);const{userAgent:s}=navigator,r=(0,o.Z)((()=>/macintosh/i.test(s)&&!/(ipod|iphone|ipad)/i.test(s)));(0,o.Z)((()=>/windows/i.test(s)))},82725:(e,t,n)=>{n.d(t,{Wq:()=>l,ZP:()=>u,cb:()=>c});n(84781);var o=n(44704),s=n(54847),r=n(25807),a=n(76896),i=n(8129);async function c(e){try{await s.appModel.initAppInfo(),await r.$.initUserInfo(),s.appModel.setInited()}catch(t){if((0,i.RF)("initAppAndUserInfo failed",t),s.appModel.setInitFailed(),null!=e&&e.throwOnError)throw t}}async function l(){try{await s.appModel.initAppInfo()}catch(e){(0,i.RF)("tryInitCoreAppInfo failed",e),s.appModel.setInitFailed()}}function u(){document.oncontextmenu=()=>!1,document.ondragover=e=>e.preventDefault(),document.ondrop=e=>e.preventDefault(),document.addEventListener("keydown",(e=>{("w"===e.key&&e.metaKey||"w"===e.key&&e.ctrlKey)&&e.preventDefault()}));const e=(0,a.c)()?o.i.macos:o.i.windows;document.body.classList.add(e),s.appModel.initDebugInfo(),c()}},97362:(e,t,n)=>{n.d(t,{v_:()=>g});var o=n(22310),s=n(80418),r=n(73224),a=n(98052),i=n(54847),c=n(62262),l=n(8129),u=n(66564);let d=!1;const p=(0,o.Z)((async()=>{return"true"===(await(0,u.G)("abtest_use_new_host",["enabled"])).enabled})),m=["/lv/v1/user/","/lv/v1/ad_maker/"],h=["/artist/v1/homepage/get_effect_list"];async function f(e,t){const n=await p(),o=n&&d,u=n&&!d,g=e.startsWith("/")?`${function(e,t){{const n=(null==t?void 0:t.useNewHost)||!1;if(e){if(m.some((t=>e.startsWith(t))))return n?"https://feed-api.capcutapi.com":"https://feed-api.capcut.com";if(h.includes(e))return n?"https://heycan-api.capcutapi.com":"https://api-heycan-pc-sg.capcut.com"}return n?"https://editor-api.capcutapi.com":"https://editor-api-sg.capcut.com"}}(e,{useNewHost:u})}${e}`:e,y=s.parseUrl(g),{region:w,language:v,appVersionName:b}=i.appModel.appInfo,Z={url:s.stringifyUrl({url:y.url,query:{...!t.disableRegion&&{region:w},language:v,version_name:b,...y.query}}),method:t.method,needCommonParams:!0,header:{"Content-Type":"application/json",...t.headers},...t.data&&{data:JSON.stringify(t.data)},...t.timeout&&{timeout_ms:t.timeout}},$=(n,s,r)=>{const a={rawUrl:e,useNewHost:u,disableNewHostByLoginError:o,...Z,...r};"error"===n?(0,l.RF)(s,null,a):t.onlyLogOnError||(0,l.c6)(s,a)},_=e=>r.I18n.t("pc_stickers_prompt_failed_{X}",{X:e});$("info",`[request] start - ${e}`);let x=null;const H=performance.now();try{x=await a.Jn.call("request",Z)}catch(E){const n=performance.now()-H>=(t.timeout||2e4),o=`[request] ${n?"timeout":"failed"} - jsb - ${e}`;throw $("error",o,{code:E.code,errorText:JSON.stringify(E),timeout:n}),new c.w(o,{code:E.code,displayMessage:_("jsb")})}const C={httpCode:x.httpCode,code:x.response.ret,errmsg:x.response.errmsg,logid:x.response.logid||x.response.log_id};if(200!==x.httpCode){const t=`[request] failed - httpCode ${x.httpCode} - ${e}`;throw $("error",t,C),new c.w(t,{...C,displayMessage:_(`http ${x.httpCode}`)})}if("success"!==x.response.errmsg){const n=`[request] failed - ${C.code} ${C.errmsg} - ${e}`;if($("error",n,C),u&&"1015"===String(C.code)&&location.pathname.endsWith("/publish-text-template.html"))return d=!0,f(e,t);throw new c.w(n,{...C,displayMessage:_(`${C.code} ${C.errmsg}`)})}return $("info",`[request] success ${e}`,C),x.response.data}function g(e,t,n){return f(e,{method:"POST",data:t,...n})}},8129:(e,t,n)=>{n.d(t,{$G:()=>h,RF:()=>l,c6:()=>c,hC:()=>f});var o=n(11449),s=n(74637),r=n.n(s);const a=()=>r()().format("MM-DD HH:mm:ss.SSSZ");function i(e,t){try{var n,o;const s=String(e).trim(),r=null!==(n=null===(o=s.match(/^\[\w+\]/))||void 0===o?void 0:o[0])&&void 0!==n?n:"",a=r.slice(1,-1),i=s.slice(r.length).replace(/\{\S*?\}/g,"").trim().replace(/[\s:-]+/g,"-");return{module:a,scene:t.scene?`${i}-${t.scene}`:i}}catch(s){return{module:"",scene:t.scene||""}}}async function c(e,t){const n=`${a()} ${e}`,{module:s,scene:r}=i(e,{...t}),c={...t,module:s,scene:r};(0,o.Z)("sendLog",{level:"info",content:n,extra:c})}async function l(e,t,n){const s="HeycanError"===(null==t?void 0:t.name)?t.context:t;t&&(0,o.Z)("captureException",t,{...s,...n});const r=`${a()} ${e}`,{module:c,scene:l}=i(e,{...s,...n}),u={stack:null==t?void 0:t.stack,message:null==t?void 0:t.message,...s,...n,module:c,scene:l};(0,o.Z)("sendLog",{level:"error",content:r,extra:u}),console.error(`[slardar] ${r}`,{...u}),t&&console.error(t)}const u=[],d=1e3;function p(e){const t=e.post;e.post=n=>{const{success:o,fail:s}=n;t({...n,success:t=>{(()=>{if(0===u.length)return;const t=u.shift();t&&e.post(t)})(),null==o||o(t)},fail:e=>{u.push(n),u.length>d&&u.shift(),null==s||s(e)}})}}let m=!1;function h(e){m||(m=!0,o.Z.on("init",(()=>{var e;const t=null===(e=o.Z.config())||void 0===e?void 0:e.transport;t&&p(t)})));const{ctx:t,...n}=e;(0,o.Z)("config",n),t&&o.Z.context&&(0,o.Z)("context.merge",t)}function f(e){const{module:t,scene:n,metrics:s,categories:r}=e;(0,o.Z)("sendEvent",{name:"heycan_performance_timing",metrics:s,categories:{...r,module:t,scene:n}})}},2555:(e,t,n)=>{n.d(t,{B:()=>s});var o=n(59787);class s{constructor(){(0,o.Z)(this,"timeoutHandle",null)}timeout(e){return this.cancel(),new Promise((t=>{this.timeoutHandle=setTimeout((()=>{this.timeoutHandle=null,t()}),e)}))}cancel(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null)}hasTimeout(){return null!==this.timeoutHandle}}},43982:()=>{},16613:(e,t,n)=>{n.d(t,{Z:()=>o});const o={macos:"macos",windows:"windows",heycanRatioGroupEllipsis:"heycan-ratio-group-ellipsis",heycanCheckboxEllipsis:"heycan-checkbox-ellipsis",heycanFormFieldEllipsis:"heycan-form-field-ellipsis",heycanPopoverWrapperClearStyle:"heycan-popover-wrapper-clear-style",heycanTextareaThemeGrey:"heycan-textarea-theme-grey",heycanInputThemeGrey:"heycan-input-theme-grey"}},53649:(e,t,n)=>{n(34415),n(69163),n(40398),n(8971),n(91351),n(28200),n(62824),n(74024),n(10972),n(544),n(24799),n(12021),n(79577),n(40641),n(40413),n(8810),n(63931),n(23645),n(28937),n(33686),n(82313),n(76990),n(48069),n(61113),n(88932),n(61294),n(33180),n(42060),n(61892),n(37469)},44296:()=>{window.__assetPrefix__="."}}]);