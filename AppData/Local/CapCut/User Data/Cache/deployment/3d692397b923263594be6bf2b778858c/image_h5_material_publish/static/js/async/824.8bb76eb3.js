"use strict";(self.webpackChunkartist_op_web=self.webpackChunkartist_op_web||[]).push([[824],{74474:(e,t,r)=>{r.d(t,{y:()=>g});var i=r(93302),n=r(50959),o=r(98205),c=r(28516),a=r(23479);const s=(e,t,r)=>r>e&&r<t;var l=r(11527);const u={cursor:"move"},d=(0,a.Pi)((({children:e,index:t,id:r,className:a,onMoveCard:d,onHoverCard:m,onCardClick:p,startPoint:g,scrollAreaRef:h,rect:_,onRect:f})=>{const v=(0,n.useRef)(null),[{handlerId:x},b]=(0,o.L)({accept:"sticker",collect:e=>({handlerId:e.getHandlerId()})}),C=()=>(new Date).getTime()-g.current.clickTime[0]>1e3,[{isDragging:k},T]=(0,c.c)({type:"sticker",item:()=>({id:r,index:t}),collect:e=>({isDragging:e.isDragging(),monitor:e}),canDrag:()=>C()});b(T(v));const y=e=>{var r,i;if(!h.current||!v.current)return;if(!C())return;const n=h.current.getBoundingClientRect(),{top:o,bottom:c}=n;if(s(o,o+20,e.clientY)&&h.current.scrollTop>0)return h.current.scrollTop-=2,void m(t,-1);if(s(c-20,c,e.clientY)&&h.current.scrollTop+h.current.clientHeight<h.current.scrollHeight)return h.current.scrollTop+=2,void m(t,-1);const{hoverIndex:a,direction:l}=((e,t)=>{const r=e.findIndex((e=>s(e.left,e.right,t.x)&&s(e.top,e.bottom,t.y)));if(r<0)return{hoverIndex:-1,direction:0};const i=(e[r].right+e[r].left)/2;return{hoverIndex:r,direction:t.x<i?-1:0}})(_,{x:e.clientX+((null===(r=g.current.centerOffset)||void 0===r?void 0:r.x)||0),y:e.clientY+((null===(i=g.current.centerOffset)||void 0===i?void 0:i.y)||0)});m(t,a,l)},P=(0,i.Z)((e=>y(e)),20);return(0,n.useEffect)((()=>{if(v.current){const e=v.current.getBoundingClientRect();null==f||f(t,e)}}),[v.current,f,t]),(0,l.jsx)("div",{draggable:!0,ref:v,className:a,style:{...u,opacity:k?0:1},"data-handler-id":x,onDrag:P,onDragStart:e=>{var r;if(!h.current||!v.current)return;p(t);const i=(null===(r=h.current)||void 0===r?void 0:r.scrollTop)||0,n=v.current.getBoundingClientRect();g.current={x:(null==e?void 0:e.clientX)||-1,y:(null==e?void 0:e.clientY)||-1,start:!0,scrollTop:i,centerOffset:{x:(n.left+n.right)/2-e.clientX,y:(n.top+n.bottom)/2-e.clientY},index:t,clickTime:g.current.clickTime}},onDragEnd:()=>{C()&&d()},children:e})}));var m=r(26699),p=r(4690);const g=(0,a.Pi)((function({list:e,className:t,getId:r,renderCard:i,onMoveCard:o,onHoverCard:c,onCardClick:a,scrollAreaRef:s}){const[u,g]=(0,n.useState)(-1),[h,_]=(0,n.useState)(-1),f=(0,n.useRef)({x:-1,y:-1,start:!1,scrollTop:0,index:-1,clickTime:[-3e3,0]}),v=(0,n.useRef)([]),x=(e,t)=>{(()=>{const e=Date.now()-f.current.clickTime[0]>1e3;f.current.clickTime=e?[f.current.clickTime[1],Date.now()]:[f.current.clickTime[0],Date.now()]})(),a(e,t)},b=()=>{-1!==u&&(o(f.current.index,u+h),g(-1),f.current={x:-1,y:-1,start:!1,scrollTop:0,index:-1,clickTime:f.current.clickTime})},C=(e,t,r=0)=>{f.current.start&&(g(t),_(r),null==c||c(u))},k=(e,t)=>{v.current[e]=t},T=e=>e!==u?null:h?"left":"right";return(0,l.jsx)(m.W,{backend:p.PD,children:e.map(((e,n)=>(0,l.jsx)(d,{index:n,className:t,scrollAreaRef:s,startPoint:f,rect:v.current,id:r(e),onRect:k,onHoverCard:C,onMoveCard:b,onCardClick:()=>x(e,n),children:i(e,T(n))},n)))})}))},70252:(e,t,r)=>{r.d(t,{l:()=>p});var i=r(50959),n=r(84875),o=r.n(n),c=r(84736),a=r(26800),s=r(86439),l=r(16743),u=r(20182),d=r(11527);const m=e=>{var t;const r=(0,i.useRef)(!1),[n,m]=(0,i.useState)(""),{allowEnter:p=!0,value:g,...h}=e,{className:_,maxLength:f,onChange:v,onCompositionEnd:x,onCompositionStart:b}=h,C=r.current?n:g,k=(0,a.Z)((e=>{const t=e||"";return p?t:t.replace(/\n/g,"")})),T=(0,a.Z)((e=>{const t=k(e);return void 0!==f?(0,s.aF)(t,f):t})),y=(0,a.Z)((e=>{r.current=!0,m(e.currentTarget.value),null==b||b(e)})),P=(0,i.useRef)(null),{saveSelectionIfNeeded:w}=(0,l.u)({getInputElem:()=>P.current}),L=(0,a.Z)(((e,t)=>{w(e),null==v||v(e,t)})),Z=(0,a.Z)((e=>{const t=T(e.currentTarget.value);r.current=!1,m(t),L(t,e),null==x||x(e)})),A=(0,a.Z)(((e,t)=>{const i=k(e);if(r.current)return void m(i);if(void 0===f)return void L(i,t);const n=T(i);L(n,t)})),N=(0,i.useMemo)((()=>({maxRows:3})),[]);return(0,d.jsx)(c.Kx,{autoComplete:"off",...h,ref:P,value:C,className:o()(_,u.Z.textarea),maxLength:void 0,autosize:null!==(t=h.autosize)&&void 0!==t?t:N,rows:1,onChange:A,onCompositionStart:y,onCompositionEnd:Z})},p=(0,c.Q2)(m)},38803:(e,t,r)=>{r.d(t,{Z:()=>p});var i=r(84875),n=r.n(i),o=r(84736),c=r(26800),a=r(45599),s=r(46309),l=r(3767),u=r(21919),d=r(80432),m=r(11527);const p=({className:e,leftText:t,isPublishDisabled:r,isPublishing:i,needConfirmModalOnClose:p,onPublish:g,beforeCancel:h,onCancel:_})=>{const{t:f}=(0,a.$)(),v=(0,c.Z)((async()=>{if(h&&h(),p){if(await l.Z.warn({mainText:f("pc_sticker_cancel_web"),subText:f("pc_sticker_click_unrecoverable_web"),confirmBtnText:f("pc_stickers_release_confirm_quit_web"),cancelBtnText:f("pc_stickers_release_cancel_web")})!==l.L.Confirm)return}_?_():(0,s.Nt)()})),x=u.YW.Creator,{showModalWithoutReview:b}=(0,u.ZP)({protocol:x});return(0,m.jsxs)("div",{className:n()(e,d.Z.root),children:[(0,m.jsx)("div",{className:d.Z.left,onClick:undefined,children:t}),(0,m.jsxs)("div",{className:d.Z.right,children:[(0,m.jsx)("span",{className:d.Z.remind,onClick:b,children:f("pc_sticker_release_agree_{X}_web",{X:(0,m.jsx)("span",{className:d.Z.protocol,children:u.rr[x]},"protocol")})}),(0,m.jsxs)("div",{className:d.Z.buttonContainer,children:[(0,m.jsx)(o.zx,{className:d.Z.button,type:"primary",theme:"solid",disabled:r,loading:i,onClick:g,children:f("pc_stickers_release_web")}),(0,m.jsx)(o.zx,{className:d.Z.button,type:"secondary",theme:"solid",onClick:v,children:f("pc_stickers_release_cancel_web")})]})]})]})}},21130:(e,t,r)=>{r.d(t,{D5:()=>d,pg:()=>p,t9:()=>m});var i=r(59787),n=r(50959),o=r(42983),c=r(97311),a=r(9679),s=r(94435),l=r(67078);const u={[o.Ab.Sticker]:"sticker",[o.Ab.Filter]:"filter",[o.Ab.FilterCollection]:"filter",[o.Ab.AudioEffect]:"audio",[o.Ab.Video]:"video",[o.Ab.TextTemplate]:"text_template"};class d{constructor({itemType:e}){(0,i.Z)(this,"materialTypeParams",{material_category:"",material_type:""}),(0,i.Z)(this,"isCollection",!1),this.isCollection=e>100,this.materialTypeParams={material_category:u[e]||"",material_type:e>100?"collection":"single"}}sendPageActionLog(e){(0,a.iL)({...this.materialTypeParams,...e,...this.isCollection&&{collection_detail:e.collection_detail||"collection_all"}})}sendMaterialUploadStatusLog(e){(0,a.j2)({...this.materialTypeParams,...e})}sendMaterialImportErrorLog(e){return(0,a.DV)({...this.materialTypeParams,...e})}sendMaterialPublishErrorLog(e){return(0,a.Sj)(e.map((e=>({...this.materialTypeParams,...e}))))}sendMaterialPublishStatusLog(e,t){var r;const{status:i,error_type:n,cover_type:o,resolution:u,time:d,path:m}=e,{common_data:p,is_vip:g}=e.publishParams,h=[];return p.is_business&&h.push("business"),g&&h.push("subscribe"),(0,a.$v)({...this.materialTypeParams,status:i,title:p.title,isOriginal:Boolean(p.is_original),tags:p.tags||[],material_format:(0,c.lm)(m),material_size:null===(r=p.file)||void 0===r?void 0:r.size,description:p.description,resolution:u,error_type:n,time:d,cover_type:o,authorize_range:h.join(","),isVipAuthorized:(0,l.$X)(e.publishParams.copyright,s.$x.Vip),isBusinessAuthorized:(0,l.$X)(e.publishParams.copyright,s.$x.Business),...t})}sendClickSubscriptionCheckboxLog(e){this.sendPageActionLog({action:e?"check_box_subscription":"cancel_check_box_subscription"})}sendSubscriptionStatementLog(e){(0,a.ce)({...this.materialTypeParams,...e})}sendClickCommercialCheckboxLog(e){this.sendPageActionLog({action:e?"check_box_commercial":"cancel_check_box_commercial"})}sendCommercialStatementLog(e){(0,a.Ad)({...this.materialTypeParams,...e})}sendAuthorSignLog(e){(0,a._4)({...this.materialTypeParams,...e})}}function m(e){(0,n.useEffect)((()=>{e.sendPageActionLog({action:"upload_page_show"})}),[])}function p(e){const{mainFormLayout:t,sendLogServ:r}=e;(0,n.useEffect)((()=>{"mainForm"===t&&r.sendPageActionLog({action:"detail_page_show"})}),[t])}},97311:(e,t,r)=>{r.d(t,{lm:()=>i});r(96706);const i=e=>e.toLowerCase().split(".").pop()},20182:(e,t,r)=>{r.d(t,{Z:()=>i});const i={textarea:"textarea-LCPYTj"}}}]);