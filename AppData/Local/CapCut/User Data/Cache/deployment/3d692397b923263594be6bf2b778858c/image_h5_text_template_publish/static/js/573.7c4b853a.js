"use strict";(self.webpackChunkartist_op_web=self.webpackChunkartist_op_web||[]).push([[573],{97475:(e,t,n)=>{n.d(t,{i:()=>o});const o={macos:"macos",windows:"windows",heycanRatioGroupEllipsis:"heycan-ratio-group-ellipsis",heycanCheckboxEllipsis:"heycan-checkbox-ellipsis",heycanFormFieldEllipsis:"heycan-form-field-ellipsis",heycanPopoverWrapperClearStyle:"heycan-popover-wrapper-clear-style",heycanTextareaThemeGrey:"heycan-textarea-theme-grey",heycanInputThemeGrey:"heycan-input-theme-grey"}},16480:(e,t,n)=>{n.d(t,{vc:()=>a.v,ZP:()=>c,S1:()=>i.Wq});var o=n(50959),s=n(49340),i=n(82725),r=n(11527),a=n(5777);const c=()=>((0,o.useEffect)((()=>{(0,i.ZP)()}),[]),(0,r.jsx)(s.j3,{}))},5777:(e,t,n)=>{n.d(t,{v:()=>i,w:()=>s});let o={};function s(e){o=e}const i=()=>({intl:{clientOptions:{getOverrideOptions:()=>o}}})},54847:(e,t,n)=>{n.d(t,{appModel:()=>p});var o=n(59787),s=n(66589),i=n(27206),r=n(46309),a=n(8129),c=n(5777);const p=new class{constructor(){(0,o.Z)(this,"appInfo",{language:"",appID:"",region:"",appVersion:"",appVersionName:void 0,currentScene:"",did:""}),(0,o.Z)(this,"debugInfo",{useBOE:!1,boeChannel:"",usePPE:!1,ppeChannel:""}),(0,o.Z)(this,"isInitFailed",!1),(0,o.Z)(this,"isInited",!1),(0,o.Z)(this,"initAppInfoPromise",null),(0,s.ky)(this)}async initAppInfo(){return this.isInitFailed=!1,this.initAppInfoPromise||(this.initAppInfoPromise=this.initAppInfoImpl().catch((e=>{throw this.initAppInfoPromise=null,e}))),this.initAppInfoPromise}async initAppInfoImpl(){console.log("start");try{const e=await(0,r.BN)();(0,s.z)((()=>{this.appInfo={...e,appVersionName:this.getAppVersionName(e.appVersion)}})),console.log("done appInfo",e.language,e.appID,e.region),(0,a.$G)({deviceId:this.appInfo.did,ctx:{appVersion:this.appInfo.appVersionName,os:e.os,osVersion:e.osVersion,language:this.appInfo.language,region:this.appInfo.region}}),(0,c.w)({fallbackHash:"0cf6cd66d0ee07b42b6c77cdc2a1c09c",lazyUpdate:!0})}finally{await i.ZP.changeLanguage({locale:this.appInfo.language})}return this.appInfo}getAppVersionName(e){const t=Number.parseInt(e,10);if(!t)return;const n=Math.floor(t/Math.pow(256,2)),o=t-n*Math.pow(256,2),s=Math.floor(o/256);return`${n}.${s}.${o-256*s}`}setInitFailed(){this.isInitFailed=!0}setInited(){this.isInited=!0}async initDebugInfo(){}}},62262:(e,t,n)=>{n.d(t,{w:()=>s});var o=n(59787);class s extends Error{constructor(e,t){super(e),this.context=t,(0,o.Z)(this,"name","HeycanError")}}},98052:(e,t,n)=>{n.d(t,{Jn:()=>o.ZP,mu:()=>l});var o=n(38508),s=n(97373),i=n(77508),r=n(41503),a=n(76896),c=n(2555);o.ZP.use(new r.Z);class p extends Error{constructor(e,t,n){super(t),this.code=e,this.msg=t,this.error=n}}o.ZP.use(new class extends s.b{name(){return"HeycanPlugin"}async beforeCall({event:e}){if((0,a.c)()&&!window.window.webkit.messageHandlers[e])throw new p(i.GL.NOT_FOUND,`bridge not found, bridgeName=${e}`)}async trigger(e){e.triggerLocal()}});const l=async(e,t)=>{const{timeout_ms:n=3e3,...s}=t||{},r=new c.B;return Promise.race([o.ZP.call(e,s).finally((()=>r.cancel())),new Promise(((t,o)=>{if(!n)return;const s=new p(i.GL.TIMEOUT,`timed out by fe, bridgeName=${e}, timeout=${n}`);r.timeout(n).then((()=>o(s)))}))])}},76896:(e,t,n)=>{n.d(t,{c:()=>i});var o=n(22310);const{userAgent:s}=navigator,i=(0,o.Z)((()=>/macintosh/i.test(s)&&!/(ipod|iphone|ipad)/i.test(s)));(0,o.Z)((()=>/windows/i.test(s)))},74235:(e,t,n)=>{n.d(t,{ZP:()=>o,xB:()=>s});function o(e,t,n){if(void 0===t)return JSON.parse(e);try{return JSON.parse(e)||t}catch(o){return n&&n(o),t}}function s(e){const{len:t,i18n:n}=e,[o]=(n.language||"").split("-");return"zh"===o?Math.floor(t/2):t}},82725:(e,t,n)=>{n.d(t,{Wq:()=>p,ZP:()=>l,cb:()=>c});n(84781);var o=n(97475),s=n(54847),i=n(25807),r=n(76896),a=n(8129);async function c(e){try{await s.appModel.initAppInfo(),await i.$.initUserInfo(),s.appModel.setInited()}catch(t){if((0,a.RF)("initAppAndUserInfo failed",t),s.appModel.setInitFailed(),null!=e&&e.throwOnError)throw t}}async function p(){try{await s.appModel.initAppInfo()}catch(e){(0,a.RF)("tryInitCoreAppInfo failed",e),s.appModel.setInitFailed()}}function l(){document.oncontextmenu=()=>!1,document.ondragover=e=>e.preventDefault(),document.ondrop=e=>e.preventDefault(),document.addEventListener("keydown",(e=>{("w"===e.key&&e.metaKey||"w"===e.key&&e.ctrlKey)&&e.preventDefault()}));const e=(0,r.c)()?o.i.macos:o.i.windows;document.body.classList.add(e),s.appModel.initDebugInfo(),c()}},55425:(e,t,n)=>{n.d(t,{v_:()=>g});var o=n(22310),s=n(80418),i=n(73224),r=n(98052),a=n(54847),c=n(62262),p=n(8129),l=n(46309);let d=!1;const u=(0,o.Z)((async()=>{return"true"===(await async function(e,t){try{return(await(0,l.Gw)({nodeKey:e,keys:t})).nodeKey}catch(n){(0,p.RF)("[getSettings] error",n,{nodeKey:e,keys:t})}return{}}("abtest_use_new_host",["enabled"])).enabled})),h=["/lv/v1/user/","/lv/v1/ad_maker/"],m=["/artist/v1/homepage/get_effect_list"];async function f(e,t){const n=await u(),o=n&&d,l=n&&!d,g=e.startsWith("/")?`${function(e,t){{const n=(null==t?void 0:t.useNewHost)||!1;if(e){if(h.some((t=>e.startsWith(t))))return n?"https://feed-api.capcutapi.com":"https://feed-api.capcut.com";if(m.includes(e))return n?"https://heycan-api.capcutapi.com":"https://api-heycan-pc-sg.capcut.com"}return n?"https://editor-api.capcutapi.com":"https://editor-api-sg.capcut.com"}}(e,{useNewHost:l})}${e}`:e,y=s.parseUrl(g),{region:w,language:I,appVersionName:v}=a.appModel.appInfo,b={url:s.stringifyUrl({url:y.url,query:{...!t.disableRegion&&{region:w},language:I,version_name:v,...y.query}}),method:t.method,needCommonParams:!0,header:{"Content-Type":"application/json",...t.headers},...t.data&&{data:JSON.stringify(t.data)},...t.timeout&&{timeout_ms:t.timeout}},$=(n,s,i)=>{const r={rawUrl:e,useNewHost:l,disableNewHostByLoginError:o,...b,...i};"error"===n?(0,p.RF)(s,null,r):t.onlyLogOnError||(0,p.c6)(s,r)},Z=e=>i.I18n.t("pc_stickers_prompt_failed_{X}",{X:e});$("info",`[request] start - ${e}`);let _=null;const P=performance.now();try{_=await r.Jn.call("request",b)}catch(N){const n=performance.now()-P>=(t.timeout||2e4),o=`[request] ${n?"timeout":"failed"} - jsb - ${e}`;throw $("error",o,{code:N.code,errorText:JSON.stringify(N),timeout:n}),new c.w(o,{code:N.code,displayMessage:Z("jsb")})}const x={httpCode:_.httpCode,code:_.response.ret,errmsg:_.response.errmsg,logid:_.response.logid||_.response.log_id};if(200!==_.httpCode){const t=`[request] failed - httpCode ${_.httpCode} - ${e}`;throw $("error",t,x),new c.w(t,{...x,displayMessage:Z(`http ${_.httpCode}`)})}if("success"!==_.response.errmsg){const n=`[request] failed - ${x.code} ${x.errmsg} - ${e}`;if($("error",n,x),l&&"1015"===String(x.code)&&location.pathname.endsWith("/publish-text-template.html"))return d=!0,f(e,t);throw new c.w(n,{...x,displayMessage:Z(`${x.code} ${x.errmsg}`)})}return $("info",`[request] success ${e}`,x),_.response.data}function g(e,t,n){return f(e,{method:"POST",data:t,...n})}},8129:(e,t,n)=>{n.d(t,{$G:()=>m,RF:()=>p,c6:()=>c,hC:()=>f});var o=n(11449),s=n(74637),i=n.n(s);const r=()=>i()().format("MM-DD HH:mm:ss.SSSZ");function a(e,t){try{var n,o;const s=String(e).trim(),i=null!==(n=null===(o=s.match(/^\[\w+\]/))||void 0===o?void 0:o[0])&&void 0!==n?n:"",r=i.slice(1,-1),a=s.slice(i.length).replace(/\{\S*?\}/g,"").trim().replace(/[\s:-]+/g,"-");return{module:r,scene:t.scene?`${a}-${t.scene}`:a}}catch(s){return{module:"",scene:t.scene||""}}}async function c(e,t){const n=`${r()} ${e}`,{module:s,scene:i}=a(e,{...t}),c={...t,module:s,scene:i};(0,o.Z)("sendLog",{level:"info",content:n,extra:c})}async function p(e,t,n){const s="HeycanError"===(null==t?void 0:t.name)?t.context:t;t&&(0,o.Z)("captureException",t,{...s,...n});const i=`${r()} ${e}`,{module:c,scene:p}=a(e,{...s,...n}),l={stack:null==t?void 0:t.stack,message:null==t?void 0:t.message,...s,...n,module:c,scene:p};(0,o.Z)("sendLog",{level:"error",content:i,extra:l}),console.error(`[slardar] ${i}`,{...l}),t&&console.error(t)}const l=[],d=1e3;function u(e){const t=e.post;e.post=n=>{const{success:o,fail:s}=n;t({...n,success:t=>{(()=>{if(0===l.length)return;const t=l.shift();t&&e.post(t)})(),null==o||o(t)},fail:e=>{l.push(n),l.length>d&&l.shift(),null==s||s(e)}})}}let h=!1;function m(e){h||(h=!0,o.Z.on("init",(()=>{var e;const t=null===(e=o.Z.config())||void 0===e?void 0:e.transport;t&&u(t)})));const{ctx:t,...n}=e;(0,o.Z)("config",n),t&&o.Z.context&&(0,o.Z)("context.merge",t)}function f(e){const{module:t,scene:n,metrics:s,categories:i}=e;(0,o.Z)("sendEvent",{name:"heycan_performance_timing",metrics:s,categories:{...i,module:t,scene:n}})}},53649:(e,t,n)=>{n(34415),n(69163),n(40398),n(8971),n(91351),n(28200),n(62824),n(74024),n(10972),n(544),n(24799),n(12021),n(79577),n(40641),n(40413),n(8810),n(63931),n(23645),n(28937),n(33686),n(82313),n(76990),n(48069),n(61113),n(88932),n(61294),n(33180),n(42060),n(61892),n(37469)},44296:()=>{window.__assetPrefix__="."}}]);