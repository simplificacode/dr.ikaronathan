"use strict";(self.webpackChunkartist_op_web=self.webpackChunkartist_op_web||[]).push([[124],{86349:(e,t,i)=>{i.d(t,{UX:()=>m,XH:()=>p});var a=i(22310),s=i(73224),r=i(42983),l=i(99305);const{t:n}=s.I18n;let o=function(e){return e.all="all",e.paster="paster",e.wordart="wordart",e.soundEffect="soundEffect",e.textTemplate="textTemplate",e.subtitleTemplate="subtitleTemplate",e.video="video",e.stickerFramePack="sticker_frame_zip",e.emoticons="emoticons",e.formula="formula",e.filter="filter",e.filterCollection="filter_collection",e.stickerCollection="sticker_collection",e}({});let c=function(e){return e[e.all=0]="all",e[e.wordart=1]="wordart",e[e.paster=2]="paster",e[e.soundEffect=3]="soundEffect",e[e.video=4]="video",e[e.Song=5]="Song",e[e.TextTemplate=6]="TextTemplate",e[e.Special=7]="Special",e[e.FaceSpecial=8]="FaceSpecial",e[e.Image=9]="Image",e[e.SubtitleTemplate=48]="SubtitleTemplate",e[e.Filter=12]="Filter",e[e.StickerCollection=102]="StickerCollection",e[e.FilterCollection=112]="FilterCollection",e[e.emoticons=105]="emoticons",e[e.stickerFramePack=1e3]="stickerFramePack",e[e.formula=50]="formula",e}({});r.Ab.TextTemplate,n("text_template"),r.Ab.Sticker,n("sticker"),r.Ab.WordArt,n("flower_character"),r.Ab.Filter,n("filter"),r.Ab.Sticker,n("pc_template_authorize_sticker_web"),r.Ab.WordArt,n("pc_template_authorize_effect_web"),r.Ab.Font,n("pc_template_authorize_font_web");const p={[c.paster]:n("original_stickers_web"),[c.TextTemplate]:n("pc_text_template_origial_material_web"),[c.SubtitleTemplate]:n("pc_subtitle_original"),[c.wordart]:n("original_cursive"),[c.soundEffect]:n("pc_material_release_original_material"),[c.Filter]:n("pc_material_release_original_material"),[c.video]:n("pc_material_release_original_material")};c.all,o.all,c.paster,o.paster,c.wordart,o.wordart,c.soundEffect,o.soundEffect,c.video,o.video,c.emoticons,o.emoticons,c.formula,o.formula,c.Filter,o.filter,c.FilterCollection,o.filterCollection,c.TextTemplate,o.textTemplate,c.SubtitleTemplate,o.subtitleTemplate,c.StickerCollection,o.stickerCollection,o.wordart,c.wordart,o.paster,c.paster,o.soundEffect,c.soundEffect,o.video,c.video,o.emoticons,c.emoticons,o.formula,c.formula,o.filter,c.Filter,o.filterCollection,c.FilterCollection,o.textTemplate,c.TextTemplate,c.SubtitleTemplate,o.subtitleTemplate,o.stickerCollection,c.StickerCollection,o.all,o.paster,o.wordart,o.soundEffect,o.video,o.emoticons,o.formula,c.paster,c.StickerCollection,c.wordart,c.soundEffect,c.video,c.stickerFramePack,c.emoticons,c.formula,c.Image,c.Special,c.FaceSpecial,c.TextTemplate,c.SubtitleTemplate,c.Filter,c.FilterCollection,c.paster,c.wordart,c.soundEffect,c.video,c.emoticons,c.TextTemplate,c.SubtitleTemplate;let d=function(e){return e[e.default=0]="default",e[e.latest=1]="latest",e[e.hotest=2]="hotest",e}({});d.default,d.latest,d.hotest,c.all,c.paster,c.video,c.soundEffect,c.wordart;l.Ms.Offline,l.Ms.Online,l.Ms.HomepageOnline,l.Ms.HomepageOnline,l.KM.Passed,l.KM.Passed,l.Ms.Reviewing,l.Ms.SelfView,l.Ms.HomepageOnline,l.Ms.SelfView,l.KM.WaitReview,l.KM.RiskReviewing,l.KM.QualityReviewing,l.KM.CopyrightReviewing,l.Ms.HomepageOnline,l.KM.WaitReview,l.KM.RiskReviewing,l.KM.QualityReviewing,l.KM.CopyrightReviewing,l.KM.WaitReview,l.KM.RiskReviewing,l.KM.QualityReviewing,l.KM.CopyrightReviewing,l.Ms.HomepageOnline,l.Ms.SelfView,l.Ms.Banned,l.Ms.HomepageOnline,l.KM.Unknown,l.KM.RiskReviewFailed,l.KM.QualityReviewFailed,l.KM.CopyrightReviewFailed,l.Ms.SelfView,l.KM.Unknown,l.KM.RiskReviewFailed,l.KM.QualityReviewFailed,l.KM.CopyrightReviewFailed,l.KM.Passed,l.KM.Unknown,l.KM.RiskReviewFailed,l.KM.QualityReviewFailed,l.KM.CopyrightReviewFailed,l.Ms.HomepageOnline,l.KM.QualityReviewFailed,l.KM.CopyrightReviewFailed,l.Ms.SelfView,l.KM.QualityReviewFailed,l.KM.CopyrightReviewFailed,l.KM.Passed;let u=function(e){return e[e.Douyin=0]="Douyin",e[e.Heycon=1]="Heycon",e[e.VideoCut=2]="VideoCut",e[e.WebVideoCut=3]="WebVideoCut",e[e.Ulike=4]="Ulike",e[e.Effect=5]="Effect",e}({});u.Douyin,u.Heycon,u.VideoCut,u.WebVideoCut,u.Ulike,u.Effect,u.Douyin,u.Heycon,u.VideoCut,u.WebVideoCut,u.Ulike,u.Effect,u.Douyin,u.Heycon,u.VideoCut,u.WebVideoCut,u.Ulike,u.Effect;const m=(0,a.Z)((()=>({zh:n("pc_text_tamplate_language_cn_web"),en:n("pc_text_tamplate_language_en_web"),ja:n("pc_text_tamplate_language_jp_web"),ko:n("pc_text_tamplate_language_kr_web")})))},67078:(e,t,i)=>{i.d(t,{$X:()=>l,eD:()=>n,pn:()=>s,sR:()=>r});var a=i(94435);function s({isVip:e,isBusiness:t,authFiles:i}){var s;const r=null!==(s=null==i?void 0:i.map((({uri:e})=>({uri:e}))))&&void 0!==s?s:[];return{root:{is_vip:!1,copyright:{copyright_info:[{scene:a.$x.Vip,auth_status:e?a.U9.Authorized:a.U9.Unauthorized,third_party_agreements:[]},{scene:a.$x.Business,auth_status:t?a.U9.Authorized:a.U9.Unauthorized,third_party_agreements:t?r:[]}]}},commonData:{is_business:!1,is_original:Boolean(e||t)}}}function r(e){const{isOriginal:t=!1,isVip:i=!1,isBusiness:a=!1,authFiles:r}=e;const{root:l}=s({isVip:i,isBusiness:a,authFiles:r});return{copyright:l.copyright}}function l(e,t){return Boolean(null==e?void 0:e.copyright_info.some((e=>e.scene===t&&e.auth_status===a.U9.Authorized)))}function n(e){const t=function(e){const t={isBusiness:!1,isVip:!1,uris:[]};return null==e||e.copyright_info.forEach((e=>{switch(e.scene){case a.$x.Vip:return void(t.isVip=e.auth_status===a.U9.Authorized);case a.$x.Business:return t.isBusiness=e.auth_status===a.U9.Authorized,void(e.thrid_party_agreements&&(t.uris=e.thrid_party_agreements.filter((({uri:e})=>e)).map((({uri:e})=>e))));default:return}})),t}(e.copyright);return{isBusiness:t.isBusiness,isVip:t.isVip,authFiles:t.uris.map(((e,t)=>({uri:e,file:new File([],String(t+1).padStart(2,"0"))})))}}},9679:(e,t,i)=>{i.d(t,{$v:()=>p,Ad:()=>u,DV:()=>o,Es:()=>g,SB:()=>f,Sj:()=>c,_4:()=>m,ce:()=>d,iL:()=>l,j2:()=>n});var a=i(17095);function s(e){return void 0===e?e:String(Math.round(e/1024))}function r(e){const{material_category:t,material_type:i,collection_detail:a}=e;return{material_category:t,material_type:i,...a&&"collection"===i&&{collection_detail:a}}}function l(e){const{action:t,extra:i={}}=e;(0,a.g)({eventName:"personal_page_material_publish_page_action",params:{action:t,...r(e),...i}})}function n(e){const{error_report:t,upload_status:i,time:l,isCompressed:n,sizeBeforeCompress:o,sizeAfterCompress:c,resolutionBeforeCompress:p,resolutionAfterCompress:d,extra:u={}}=e;(0,a.g)({eventName:"personal_page_material_upload_status",params:{...r(e),error_report:t,upload_status:i,time:l,is_compressed:n?1:0,...n&&{material_size_before_compress:s(o),material_size_after_compress:s(c),material_resolution_before_compress:p,material_resolution_after_compress:d},...u}})}function o(e){const{error_report:t}=e;(0,a.g)({eventName:"personal_page_material_import_error_report",params:{...r(e),error_report:t}})}function c(e){if(0===e.length)return;const t=function(e){const t={};return e.forEach((e=>{Object.entries(e).forEach((([e,i])=>{const a=i||"";t[e]=t[e]?`${t[e]},${a}`:a}))})),t}(e),i=new Set(t.material_type.split(","));1===i.size&&(t.material_type=i.values().next().value),(0,a.g)({eventName:"personal_page_material_publish_error_report",params:t})}function p(e){const{status:t,material_type:i,material_category:r,title:l,description:n,isOriginal:o,tags:c,material_format:p,material_size:d,resolution:u,error_type:m,cover_type:g,time:f,extra:_={},authorize_range:h,isVipAuthorized:x,isBusinessAuthorized:T}=e;return(0,a.g)({eventName:"personal_page_material_publish_status",params:{status:t,material_type:i,material_category:r,material_title:l,material_introduction:n,is_original:o?"1":"0",hashtag:c.join(","),material_format:p,material_size:s(d),resolution:u,authorize_range:h,..."fail"===t&&{error_type:m},cover_type:g,time:f,is_subscription_authorized:x?1:0,is_commercial_authorized:T?1:0,..._}})}function d(e){const{action:t,material_category:i,material_type:s,entry_from:r}=e;return(0,a.g)({eventName:"ugc_material_subscription_original_statment",params:{action:t,material_category:i,material_type:s,entry_from:r}})}function u(e){const{action:t,material_category:i,material_type:s,entry_from:r,hasCopyrightAuthorization:l}=e;return(0,a.g)({eventName:"ugc_material_commercial_original_statment",params:{action:t,material_category:i,material_type:s,entry_from:r,..."boolean"==typeof l&&{has_copyright_authorization:l?"1":"0"}}})}function m(e){const{action:t,page_type:i,material_category:s,material_type:r,button_name:l}=e;return(0,a.g)({eventName:"ugc_material_creator_sign_agreement",params:{action:t,page_type:i,material_category:s,material_type:r,...l&&{button_name:l}}})}function g(e){const{multiLang:t,...i}=e,s=e=>({zh:"cn",en:"en",ja:"jp",ko:"kr"}[e]||""),r=e=>{var i;return null!==(i=null==t?void 0:t.map(e).join(","))&&void 0!==i?i:""};return(0,a.g)({eventName:"material_tool_publish_status",params:{...i,...t&&{language_setting:r((({isMultiLang:e})=>e?"multi":"single")),language_type:r((({langs:e})=>s(e[0]))),language_total_type:r((({langs:e})=>e.map(s).join(";")))}}})}function f(e){const{caption_template_cnt:t,captionAnimationIds:i=[],text_template_cnt:s,material_type:r,text_special_effect_cnt:l}=e;return(0,a.g)({eventName:"material_tool_click_publish_confirm",params:{caption_template_cnt:t,caption_animation_id:i.join(","),text_template_cnt:s,material_type:r,text_special_effect_cnt:l}})}},75165:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Qe});var a=i(23479),s=i(45599),r=i(50959),l=i(9608),n=i(11527);const o=(0,a.Pi)((e=>{const{className:t}=e,{t:i}=(0,s.$)(),a=(0,r.useMemo)((()=>[{key:"textTemplate",title:i("pc_text_template_desc_web"),instructions:[{key:"",title:i("pc_text_template_release_effect_web")}]}]),[]),o=(0,r.useMemo)((()=>()=>"init"),[]);return(0,n.jsx)(l.v,{className:t,groups:a,initGroup:"textTemplate",activeGroup:"textTemplate",resetExpandedGroupKey:"textTemplate",getStatus:o})}));var c=i(26800),p=i(12390),d=i(72328),u=i(84875),m=i.n(u),g=i(36983),f=i(69836),_=i(91550),h=i(66589);const x="en";var T=i(97311),v=i(21423),y=i(45735),w=i(17941),S=i(33556),b=i(94435),F=i(67078),L=i(42983),I=i(8129);function C(e){const{id:t,resourceId:i,isMultiLang:a}=e,s=e.languages.map(((e,t)=>function(e,t){const{lang:i,resourceId:a,templateZipData:s}=e,{coverFile:r,extraJson:l}=s.template;return{lang:i,resourceId:a,templateZipData:s,cover:(0,v.B4)({src:t.needSrc?(0,T.y8)(r):"",file:r}),staticFrame:(0,v.wt)({}),file:(0,h.LO)({...(0,v.Dz)({}),previewTime:0,extraJson:l},{extraJson:h.LO.ref}),publishType:a?"update":"create"}}(e,{needSrc:!0})));return(0,h.LO)({id:t,resourceId:a?i:s[0].resourceId,title:"",tags:[],isOriginal:!1,isBusiness:!1,isVip:(0,w.K)(S.YW.OriginalForSubscription),isHighPriority:!1,isMultiLang:a,languages:s,onlineData:{isOriginal:!1,isVip:!1,isBusiness:!1,resourceId:i,langResourceIds:[],langResourceIdMap:{}}},{onlineData:h.LO.ref})}function M(e){return Boolean(e.title&&e.tags.length&&e.languages[0].staticFrame.src)}function k(e){return e.languages[0]}function j(e,t){const i=e.languages[0],{resourceId:a,title:s,tags:r,isVip:l,isBusiness:n,isOriginal:o,isHighPriority:c,languages:p,onlineData:d}=e,{sdkVersion:u}=i.templateZipData,m=t.authFileUploadServiceManager.getUploadedFiles(e.id),g=b.r0.UserPostPcMultiLangTextTemplate,f=c?`${g}_without_review`:g;if(d.resourceId){const t=(0,F.sR)({isOriginal:o,isVip:l,isBusiness:n,authFiles:m,onlineData:d}),{newResourceIdList:c}=function(e){const{onlineData:t,languages:i}=e;let a=!1;const s=[...t.langResourceIds];for(const r of i){const e=t.langResourceIdMap[r.lang];if(e&&e===r.resourceId)continue;const i=s.findIndex((t=>t===(null!=e?e:r.resourceId)));-1===i?s.push(r.resourceId):s[i]=r.resourceId,(0,I.c6)("[TextTemplateService] makeMultiLangTextTemplateReq update resourceIdList",{existingId:e,updatedId:r.resourceId,isAdd:-1===i,languageResourceIds:t.langResourceIds,langResourceIdMap:t.langResourceIdMap}),a=!0}return{newResourceIdList:s,isResourceIdListUpdated:a}}(e);return{id:a,...i.lang===x&&{title:s,description:s,icon:{image_uri:i.cover.uri,static_uri:i.staticFrame.uri},tags:r,...t},collection_info:{resource_id_list:c}}}const _=(0,F.pn)({isVip:l,isBusiness:n,authFiles:m}),h=p.map((e=>e.resourceId));return{effect_type:L.Ab.MultiLanguageTextTemplate,is_vip:l,..._.root,common_data:{title:s,description:s,icon:{image_uri:i.cover.uri,static_uri:i.staticFrame.uri},sdk_version:u,source:f,tags:r,is_original:o,is_business:n,..._.commonData},collection_info:{resource_id_list:h}}}const P="root-Pqbzod",D="statusBar-LA3WnC",R=(0,a.Pi)((e=>{const{className:t,textTemplate:i,isSelected:a,onClick:s}=e,r=k(i),l=!r.staticFrame.src;return(0,n.jsxs)("div",{className:m()(P,t),onClick:()=>{s(i)},children:[(0,n.jsx)(g.Y,{src:l?"":r.cover.src,isInvalid:!1,isSelected:a,size:80,onContextMenu:e=>{e.preventDefault(),s(i)}}),(0,n.jsx)(f.ir,{className:D,loading:l,invalid:!1,errorToolip:"",isInfoComplete:M(i),title:i.title})]})}));var U=i(52918),O=i(84736),A=i(31086),Z=i(57609),N=i(2514),V=i(539),B=i(46309),z=i(3718),E=i(50366),$=i(86156),K=i(54847),H=i(82725),W=i(86324),q=i(1946),J=i(35686),G=i(21130),Y=i(9679),Q=i(25807),X=i(84677),ee=i(62262);const te={[L.Ab.TextTemplate]:L.Ab.MultiLanguageTextTemplate},ie=1;var ae=i(79668),se=i(98052);var re=i(2555),le=i(18370),ne=i(74575),oe=i(33372);function ce(){const e=(0,V.G)({watch:()=>n.isAllUploaded}),t=(0,V.G)({watch:()=>n.isDepUploaded&&!n.isAllUploadedWatcher.isPromptingConfirmToCancel}),i=(0,ne.e)({watch:()=>n.textTemplateList.materials.every((e=>e.languages.every((e=>e.staticFrame.src))))}),a=(0,r.useMemo)((()=>new E.w),[]),{t:l}=(0,s.$)(),n=(0,U.fv)((()=>({formApi:null,setFormApi:e=>{n.formApi=e},performanceTimingCollector:(0,le.uY)(),initOp:new $.q({fetchFirstPage:async()=>{K.appModel.isInited||await(0,H.cb)({throwOnError:!0}),n.performanceTimingCollector.addTiming("initFullAppInfoDone"),(0,I.c6)("[SingleStore] getTextTemplateSingleInitialData req --\x3e");const e=await(0,se.mu)("getTextTemplateSingleInitialData",{});(0,I.c6)("[SingleStore] getTextTemplateSingleInitialData resp <--",(0,_.Z)(e,"type","singles")),n.performanceTimingCollector.addTiming("getInitialDataDone");const t=n.fetchOnlineTextTemplates(e),i=[],a=[],s=[];for(const c of e.singles){const e=await n.makeInitTextTemplate(c,a,s);i.push(e)}n.performanceTimingCollector.addTiming("initTextTemplateDone"),(0,I.c6)("[SingleStore] await fetchOnlineTextTemplates start");const r=await t;n.performanceTimingCollector.addTiming("fetchOnlineDataDone"),(0,I.c6)("[SingleStore] mergeOnlineTextTemplate start");for(const c of i)n.mergeOnlineTextTemplate(c,r);(0,I.c6)("[SingleStore] make init flowerText sticker start");const l=a.map((e=>(0,oe.Sv)(e))),o=s.map((e=>(0,oe.wu)(e)));return()=>{n.textTemplateList.replaceByMap(i,(e=>e)),n.flowerTextList.replaceByMap(l,(e=>e)),n.stickers=o;const e=n.textTemplateList.materials[0];n.textTemplateList.select(e),n.initStaticFrame(n.textTemplateList.materials),n.initUploadFiles(),n.performanceTimingCollector.addSetStateTiming(le.Pk)}},slardarErrorLog:(e,t)=>{(0,I.RF)(`[SingleStore] ${e} failed`,t),n.performanceTimingCollector.addSetStateTiming(le.Pk,{scene:"initFailed"})}}),async makeInitTextTemplate(e,t,i){const{id:a,isMultiLang:s}=e,r=[];(0,I.c6)("[SingleStore] makeInitTextTemplate start",{id:a});const l=s?e.languages:e.languages.slice(0,1);for(const n of l){const{lang:s}=n;(0,I.c6)("[SingleStore] makeInitTextTemplate one language start",{id:a,lang:s});const l=new W.v({id:`${s}-${e.id}`,effectType:L.Ab.TextTemplate,fetchZipBase64:async()=>{const{zipData:t}=await(0,B.FI)({id:e.id,lang:s});return t}});await l.init(),r.push({lang:s,resourceId:n.resourceId,templateZipData:l});for(const e of l.flowerTexts){const i=e.id;let a=t.find((e=>e.groupId&&e.groupId===i));a||(a={groupId:i,subFlowerTexts:[]},t.push(a)),a.subFlowerTexts.push({lang:s,data:e})}for(const e of l.stickers)i.some((t=>t.id===e.id))||i.push(e)}return(0,I.c6)("[SingleStore] makeInitTextTemplate done",{id:a}),C({id:a,isMultiLang:s,resourceId:e.resourceId,languages:r})},fetchOnlineTextTemplates:async({type:e,singles:t})=>"update"!==e?{}:async function({effectType:e,singles:t}){const i=te[e],a={},s=[];for(const c of t){var r;const t=c.isMultiLang?c.resourceId:null===(r=c.languages[0])||void 0===r?void 0:r.resourceId;if(!t)continue;const a=c.isMultiLang?i:e;if(void 0===a)throw new ee.w(`effectType=${e} doesn't support multi lang`,{effectType:e});s.push({id:t,effect_type:a,source:ie})}if(0===s.length)return(0,I.c6)("[OnlineData] fetchOnlineTemplates no reqItems"),a;(0,I.c6)("[OnlineData] fetchOnlineTemplates mgetItem start",{ids:s.map((e=>e.id))});const l=await(0,b.yF)({items:s,pack_optional:{need_tag:!0,need_parent_tag:!1,need_copyright:!0},controller_policy_optional:{from_cache:!1}});(0,I.c6)("[OnlineData] fetchOnlineTemplates mgetItem success",{ids:l.effect_item_list.map((e=>e.common_attr.id))});const n=[];if(l.effect_item_list.forEach((t=>{var s;a[t.common_attr.id]=t,t.common_attr.effect_type===i&&(null===(s=t.collection)||void 0===s||s.resource_id_list.forEach((t=>n.push({id:t,effect_type:e,source:ie}))))})),0===n.length)return(0,I.c6)("[OnlineData] fetchOnlineTemplates no subLangReqItems"),a;(0,I.c6)("[OnlineData] fetchOnlineTemplates subLanguage mgetItem start",{ids:n.map((e=>e.id))});const o=await(0,b.yF)({items:n,pack_optional:{need_tag:!0,need_parent_tag:!1,need_copyright:!0},filter_optional:{no_filter_by_rule:!0},controller_policy_optional:{from_cache:!1}});return(0,I.c6)("[OnlineData] fetchOnlineTemplates subLanguage mgetItem success",{ids:o.effect_item_list.map((e=>e.common_attr.id))}),o.effect_item_list.forEach((e=>{a[e.common_attr.id]=e})),a}({effectType:L.Ab.TextTemplate,singles:t}),mergeOnlineTextTemplate(e,t){const i=function({effectType:e,resourceId:t,mainLang:i,firstLanguage:a,onlineTemplates:s}){var r,l;if(!t)return null;const n=s[a.lang===i?t:a.resourceId||t];if(!n)return(0,I.RF)("[OnlineData] extractOnlineTemplate item not found",null,{id:t,firstLanguage:a,mainLang:i}),null;const{title:o,tag_list:c=[],is_original:p}=n.common_attr,{isBusiness:d,isVip:u,authFiles:m}=(0,F.eD)(n),g={form:{title:o,tags:Array.from(new Set(c.map((e=>e.name)))),isOriginal:p,isBusiness:d,isVip:u,isHighPriority:String(n.common_attr.publish_source).endsWith("_without_review")},authFiles:m,onlineData:{isOriginal:p,isBusiness:d,isVip:u,copyright:n.copyright,langResourceIds:[],langResourceIdMap:{}}},f=s[t],_=te[e];if(!_||(null==f?void 0:f.common_attr.effect_type)!==_)return g;g.onlineData.langResourceIds=null!==(r=null===(l=f.collection)||void 0===l?void 0:l.resource_id_list)&&void 0!==r?r:[],g.onlineData.langResourceIdMap={};for(const x of g.onlineData.langResourceIds){var h;const e=null===(h=s[x])||void 0===h?void 0:h.common_attr.item_language;e?g.onlineData.langResourceIdMap[e]=x:(0,I.RF)("[OnlineData] extractOnlineTemplate lang is empty",null,{id:x,hasItem:Boolean(s[x])})}return g}({effectType:L.Ab.TextTemplate,resourceId:e.resourceId,mainLang:x,firstLanguage:e.languages[0],onlineTemplates:t});i&&((0,X.L)(e,i.form),(0,X.L)(e.onlineData,i.onlineData),i.authFiles.length&&n.authFileUploadServiceManager.ensure(e.id).addOnlineFiles(i.authFiles))},get mainFormLayout(){const{fetchStatus:e}=n.initOp;return e.isFailed?"error":e.hasFetched?"mainForm":"loading"},get needConfirmModalOnClose(){return!0},get field(){return{canBusiness:Q.$.permissions.includes(Q.v.EffectSetBusiness),canVip:Q.$.permissions.includes(Q.v.EffectSetVip),canHighPrio:Q.$.permissions.includes(Q.v.EffectHighPrio)}},pubService:new A.Z,sendLogService:new G.D5({itemType:L.Ab.TextTemplate}),authorSignService:new Z.I({signScene:z.d.BusinessArtist}),authFileUploadServiceManager:new N.r({}),isAllUploadedWatcher:e,fileOp:new v.N0({uploadConfigService:a}),textTemplateList:new J.T({}),flowerTextList:new J.T({}),stickers:[],init(){n.initOp.initFetchFirstPage(null)},retryInit(){n.initOp.retryFetchFirstPage()},selectTextTemplateCard(e){n.saveCurrentForm(),n.textTemplateList.select(e),n.flowerTextList.select(null)},selectFlowerTextCard(e){n.saveCurrentForm(),n.flowerTextList.select(e),n.textTemplateList.select(null)},initTextTemplateForm(e){var t;null===(t=n.formApi)||void 0===t||t.setValues({textTemplate:{title:e.title,tags:[...e.tags],isOriginal:e.isOriginal,isVip:e.isVip,isBusiness:e.isBusiness,isHighPriority:e.isHighPriority}})},saveTextTemplateForm(e){var t;const i=null===(t=n.formApi)||void 0===t?void 0:t.getValues().textTemplate;i&&(0,X.L)(e,{title:i.title||"",tags:i.tags,isOriginal:i.isOriginal||!1,isVip:i.isVip||!1,isBusiness:i.isBusiness||!1,isHighPriority:i.isHighPriority||!1})},initFlowerTextForm(e){var t;null===(t=n.formApi)||void 0===t||t.setValues({flowerText:{title:e.title,tags:[...e.tags]}})},applyTagsToAll(e){n.flowerTextList.updateAll((t=>{t.tags=[...e]}))},saveFlowerTextForm(e){var t;const i=null===(t=n.formApi)||void 0===t?void 0:t.getValues().flowerText;i&&(0,X.L)(e,{title:i.title||"",tags:i.tags})},saveCurrentForm(){n.textTemplateList.selected?n.saveTextTemplateForm(n.textTemplateList.selected):n.flowerTextList.selected&&n.saveFlowerTextForm(n.flowerTextList.selected)},initStaticFrameTimer:new re.B,async initStaticFrame(e){for(const t of e){const{id:e,languages:i}=t;for(let a=0;a<i.length;a+=1){const s=i[a];await n.fileOp.initStaticFrame({id:`${s.lang}-${e}`,getInitIndex:()=>0===a?null:t.languages[0].staticFrame.index,staticFrame:s.staticFrame,templateZipData:s.templateZipData}),await n.initStaticFrameTimer.timeout(100)}}},async initUploadFiles(){try{await a.getUploadConfigs("initUploadFiles")}catch{}for(const e of n.textTemplateList.materials)n.initUploadTextTemplateFiles(e);(0,oe.er)(n.fileOp,{flowerTexts:n.flowerTextList.materials,stickers:n.stickers})},initUploadTextTemplateFiles(e){for(const t of e.languages)n.fileOp.initUploadCover({getCover:()=>t.cover,getInitValues:()=>({id:(0,q.V)("text-template-cover")})})},async retryUpload(){n.depPublishStatus.isCanceled=!1;try{await a.getUploadConfigs("retryUploadFiles")}catch{n.depPublishStatus.isFailed=!0}for(const e of n.textTemplateList.materials)for(const t of e.languages)n.fileOp.retryUpload(t.cover,t.staticFrame,t.file);(0,oe.Id)(n.fileOp,{flowerTexts:n.flowerTextList.materials,stickers:n.stickers})},handleUploadCancel(){t.stop(),i.stop(),n.isAllUploadedWatcher.stop(),n.depPublishStatus.isCanceled=!0},async initUploadStaticFrame(e){await i.start();for(const t of e.languages)n.fileOp.initUploadCover({getCover:()=>t.staticFrame,getInitValues:()=>({id:(0,q.V)("text-template-static-frame"),file:new File([(0,T.Jr)(t.staticFrame.src)],"icon.png",{type:"image/png"})})})},handleStaticFrameChange(e,t){for(const i of e.languages)n.fileOp.updateStaticFrame(i.staticFrame,t)},async publishDeps(){const{textTemplateList:e,flowerTextList:t,stickers:i}=n,a=e.materials[0],s=(0,_.Z)(a,"isVip","isBusiness","isOriginal","isHighPriority"),r=(0,oe.Kl)(t.materials,s),l=(0,oe.Rd)(i,{...s,getTitle:(e,t)=>{const i=String(t+1).padStart(2,"0");return`${a.title}-${i}`}}),o=await n.pubService.batchPublish([...r,...l]),c=(0,oe.Wl)({flowerTexts:n.flowerTextList.materials,stickers:n.stickers}),p=o.map((e=>e.resource_id));return(0,I.c6)("[SingleStore] deps publish success",{resourceIdList:p,depResourceIdMap:c}),{depResourceIdMap:c}},clearTextTemplateZip(){n.fileOp.templateZipCacheMap.clear();for(const e of n.textTemplateList.materials)for(const t of e.languages)n.fileOp.saveTemplateZipCache(e.id,t.lang,t.file)},async initUploadTextTemplateZip(e,t){const{textTemplateList:i}=n;for(const a of i.materials)for(const i of a.languages){const{lang:s,staticFrame:r,templateZipData:l}=i;if(await n.fileOp.initUploadTemplateZip({id:a.id,lang:s,zipFile:i.file,staticFrame:r,templateZipData:l,depResourceIdMap:e,checkIsCanceled:()=>t.isCanceled}),t.isCanceled)return}},depPublishStatus:{isFailed:!1,isCanceled:!1,isDone:!1},async startUploadAndPublishDeps(e){try{for(const e of n.textTemplateList.materials)n.initUploadStaticFrame(e);await t.start();const{depResourceIdMap:i}=await n.publishDeps();if(e.isCanceled)return;await n.initUploadTextTemplateZip(i,e),(0,h.z)((()=>{e.isDone=!0}))}catch(i){(0,h.z)((()=>{e.isFailed=!0})),(0,I.RF)("[SingleStore] startUploadAndPublishDeps failed",i)}},get depUploadStats(){const e={pending:0,succeeded:0,failed:0};for(const t of n.flowerTextList.materials)for(const i of t.subFlowerTexts)(0,v.r)(e,i.cover,i.file);for(const t of n.stickers)(0,v.r)(e,t.cover);return e},get isDepUploaded(){const{pending:e,failed:t}=n.depUploadStats;return!e&&!t},get uploadStats(){const e={uninited:0,...n.depUploadStats};for(const a of n.textTemplateList.materials)for(const t of a.languages)(0,v.r)(e,t.cover,t.staticFrame,t.file);const{isFailed:t,isDone:i}=n.depPublishStatus;return t?e.failed+=1:i?e.succeeded+=1:e.pending+=1,e},get isAllUploaded(){const{pending:e,failed:t}=n.uploadStats;return!e&&!t},get isReadyToPublish(){const{textTemplateList:e,flowerTextList:t}=n;return e.length>0&&e.materials.every((e=>M(e)))&&t.materials.every((e=>(0,oe.QX)(e)))&&!n.isPublishSucceeded},async uploadAndPublish(e){n.saveCurrentForm(),n.sendMaterialToolClickPublishLog(),n.retryUploadAndPublishDeps(),null==e||e.show(),await n.isAllUploadedWatcher.start();try{await n.publish()}finally{null==e||e.hide()}},async retryUploadAndPublishDeps(){n.clearTextTemplateZip(),n.depPublishStatus={isFailed:!1,isCanceled:!1,isDone:!1};const{depPublishStatus:e}=n;await n.retryUpload(),n.startUploadAndPublishDeps(e)},isPublishing:!1,isPublishSucceeded:!1,async publish(){n.isPublishing=!0;try{await n.publishImpl()}catch(e){return O.FN.error(l("pc_sticker_release_failed_retry_web")),(0,h.z)((()=>{n.isPublishing=!1})),n.sendMaterialToolPublishLog("fail"),void(0,I.RF)("[SingleStore] publish failed",e)}(0,h.z)((()=>{n.isPublishing=!1,n.isPublishSucceeded=!0})),O.FN.info({content:l("pc_text_template_release_success_web",{num:n.textTemplateList.length}),textMaxWidth:"80vw"}),n.sendMaterialToolPublishLog("success"),(0,I.c6)("[SingleStore] publish success"),setTimeout((()=>(0,B.gk)({showHomePage:!0})),3e3)},async publishImpl(){const e=n.textTemplateList.materials.map((e=>{const{isMultiLang:t}=e,{authFileUploadServiceManager:i}=n;return e.languages.map((a=>{const s=`${a.lang}-${e.id}`,r=t?function(e,t){const i={...(0,_.Z)(e,["title","tags","isHighPriority","isVip","isBusiness","isOriginal"]),...(0,_.Z)(t,"lang","cover","staticFrame","file"),authFiles:[],baseSource:b.r0.UserPostPcInMultiLangTextTemplate};return"update"===t.publishType?(0,y.xo)({id:t.resourceId,onlineData:e.onlineData,...i}):(0,y.Ob)({effectType:L.Ab.TextTemplate,templateZipData:t.templateZipData,extraJson:t.file.extraJson,...i})}(e,a):function(e,t){const i=k(e),a={...(0,_.Z)(e,["title","tags","isHighPriority","isVip","isBusiness","isOriginal"]),...(0,_.Z)(i,"cover","staticFrame","file"),authFiles:t.authFileUploadServiceManager.getUploadedFiles(e.id),baseSource:b.r0.UserPostPc};return"update"===i.publishType?(0,y.xo)({id:i.resourceId,onlineData:e.onlineData,...a}):(0,y.Ob)({effectType:L.Ab.TextTemplate,templateZipData:i.templateZipData,extraJson:i.file.extraJson,...a})}(e,{authFileUploadServiceManager:i});return{id:s,req:r,onResult:(0,h.aD)((({req:i,resourceId:r,error:l,errorText:o,time:c})=>{n.sendLogService.sendMaterialPublishStatusLog({time:c,status:l?"fail":"success",error_type:o,publishParams:i,path:""}),l?(0,I.RF)(`[SingleStore] single publish failed {${s}}`,l):(a.resourceId=r,t||(e.resourceId=r),(0,I.c6)(`[SingleStore] single publish success {${s}}`,{resourceId:r}))})),onUpdateResult:(0,h.aD)((({req:e,resourceId:t,error:i,errorText:a,time:r})=>{i?(0,I.RF)(`[SingleStore] single update failed {${s}}`,i):(0,I.c6)(`[SingleStore] single update success {${s}}`,{resourceId:t})}))}}))})).flat();(0,I.c6)("[SingleStore] single publish start",{resourceIdList:e.map((e=>e.id))});const t=await n.pubService.batchPublish(e);(0,I.c6)("[SingleStore] single publish done",{resourceIdList:t.map((e=>e.resource_id))});const i=n.textTemplateList.materials.filter((e=>e.isMultiLang)).map((e=>{const{authFileUploadServiceManager:t}=n,{id:i}=e;return{id:i,req:j(e,{authFileUploadServiceManager:t}),onResult:(0,h.aD)((({req:t,resourceId:a,error:s,errorText:r,time:l})=>{s?(0,I.RF)(`[SingleStore] multi lang publish failed {${i}}`,s):(e.resourceId=a,(0,I.c6)(`[SingleStore] multi lang publish success {${i}}`,{resourceId:a}))})),onUpdateResult:(0,h.aD)((({req:e,resourceId:t,error:a,errorText:s,time:r})=>{a?(0,I.RF)(`[SingleStore] multi lang update failed {${i}}`,a):(0,I.c6)(`[SingleStore] multi lang update success {${i}}`,{resourceId:t})}))}}));(0,I.c6)("[SingleStore] multi lang publish start",{resourceIdList:i.map((e=>e.id))}),await n.pubService.batchPublish(i);const a=n.textTemplateList.materials.map((e=>e.resourceId));(0,I.c6)("[SingleStore] multi lang publish done",{resourceIdList:a});const s=n.textTemplateList.materials.filter((e=>e.isMultiLang&&!e.onlineData.resourceId)).map((e=>({id:e.id,resourceId:e.resourceId})));var r;s.length&&((0,I.c6)("[SingleStore] syncTemplateResourceId req --\x3e",{templates:s}),await(r={templates:s},(0,se.mu)("syncTemplateResourceId",r)),(0,I.c6)("[SingleStore] syncTemplateResourceId resp <--"));n.textTemplateList.materials.some((e=>!e.onlineData.resourceId))?(await n.pubService.pollUntilAllInEffectList({ids:a.slice(-A.f),types:[L.Ab.TextTemplate,L.Ab.MultiLanguageTextTemplate]}),(0,I.c6)("[SingleStore] poll done")):(0,I.c6)("[SingleStore] no need to poll")},sendMaterialToolClickPublishLog(){const{textTemplateList:e,flowerTextList:t}=n;(0,Y.SB)({text_template_cnt:e.length,material_type:"single",text_special_effect_cnt:t.length})},sendMaterialToolPublishLog(e){const{textTemplateList:t,flowerTextList:i}=n;(0,Y.Es)({text_template_cnt:t.length,text_special_effect_cnt:i.length,material_type:"single",status:e,success_cnt:t.materials.filter((e=>e.resourceId)).length,multiLang:t.materials.map((e=>({isMultiLang:e.isMultiLang,langs:e.languages.map((e=>e.lang))})))})},collectLogData(){const e=["id","uri","isUploadFailed"],t=n.textTemplateList.materials.map((t=>({...(0,_.Z)(t,"id","resourceId","isMultiLang"),languages:t.languages.map((t=>({...(0,_.Z)(t,"lang","resourceId"),cover:(0,_.Z)(t.cover,e),staticFrame:(0,_.Z)(t.staticFrame,[...e,"index"]),file:(0,_.Z)(t.file,e),extraJson:t.file.extraJson})))}))),i=n.flowerTextList.materials.map((t=>({...(0,_.Z)(t,"id","isDepMaterial","sdkVersion"),subFlowerTexts:t.subFlowerTexts.map((t=>({...(0,_.Z)(t,"id","lang","resourceId"),cover:(0,_.Z)(t.cover,e),file:(0,_.Z)(t.file,e)})))}))),a=n.stickers.map((t=>({...(0,_.Z)(t,"id","resourceId","isDepMaterial","isSequence"),cover:(0,_.Z)(t.cover,e)}))),s={textTemplates:t,textTemplateCount:t.length,flowerTexts:i,stickers:a,isReadyToPublish:n.isReadyToPublish,depPublishStatus:{...n.depPublishStatus},uploadStats:{...n.uploadStats}};(0,I.c6)("[SingleStore] collectLogData",s)}})));return(0,ae.L)({watch:()=>{n.uploadStats,n.isReadyToPublish},collect:n.collectLogData}),(0,r.useEffect)((()=>(window.store=n,n.init(),n.authorSignService.init(),()=>{n.initStaticFrameTimer.cancel()})),[]),n}const pe=(0,r.createContext)(null),de=()=>(0,r.useContext)(pe);var ue=i(73008);const me=(0,a.Pi)((e=>{const{className:t}=e,i=de();return(0,n.jsx)("div",{className:m()(ue.Z.root,t),children:(0,n.jsx)("div",{className:ue.Z.container,children:i.textTemplateList.materials.map(((e,t)=>(0,n.jsx)(R,{className:ue.Z.card,textTemplate:e,isSelected:i.textTemplateList.selectedId===e.id,onClick:i.selectTextTemplateCard},e.id)))})})}));var ge=i(89563);const fe=(0,a.Pi)((e=>{const{className:t}=e,i=de();return(0,n.jsx)("div",{className:m()(ue.Z.root,t),children:(0,n.jsx)("div",{className:ue.Z.container,children:i.flowerTextList.materials.map(((e,t)=>(0,n.jsx)(ge.M,{className:ue.Z.card,flowerText:e,isSelected:i.flowerTextList.selectedId===e.id,onClick:i.selectFlowerTextCard},e.id)))})})}));var _e=i(91285),he=i(28747),xe=i(37991),Te=i(63541),ve=(i(15443),i(76199)),ye=i(6858),we=i(86349),Se=i(15843);const be="root-j3LlEm",Fe="cover-jaNzlL",Le="title-U5EHzZ",Ie="main-MmgxyZ",Ce="container-WuIo82",Me="language-pBRH5f",ke="langText-So03cx",je=(0,a.Pi)((e=>{const{className:t,loading:i,languages:a}=e,l=(0,U.fv)((()=>({coverSrcMap:new Map,copyCoverSrcFromProps(e){const t=new Set;for(const i of e.languages){const{src:e}=i.cover;e&&(t.add(e),l.coverSrcMap.has(e)||(l.coverSrcMap.set(e,""),l.copyOneCoverSrc(e)))}for(const[i,a]of l.coverSrcMap)t.has(i)||(l.destroyCopyedSrc(a),l.coverSrcMap.delete(i))},async copyOneCoverSrc(e){if(e.startsWith("data:"))return void l.coverSrcMap.set(e,e);const t=await(0,T.J9)(e);l.coverSrcMap.has(e)?(0,h.z)((()=>{l.coverSrcMap.set(e,t)})):l.destroyCopyedSrc(t)},destroyCopyedSrc(e){e.startsWith("blob")&&URL.revokeObjectURL(e)},destroy(){for(const e of l.coverSrcMap.values())l.destroyCopyedSrc(e)}})));(0,r.useEffect)((()=>{l.copyCoverSrcFromProps(e)})),(0,r.useEffect)((()=>()=>l.destroy()),[]);const{t:o}=(0,s.$)(),{handleMouseEnter:c}=(0,Se.S)({}),p=e=>{if(i)return"";return l.coverSrcMap.get(e.src)||""};return(0,n.jsxs)("div",{className:m()(be,t),children:[(0,n.jsx)("div",{className:Le,children:o("pc_text_template_language_version_web")}),(0,n.jsx)("div",{className:Ie,children:(0,n.jsx)("div",{className:Ce,children:a.map((({lang:e,cover:t})=>(0,n.jsxs)("div",{className:Me,children:[(0,n.jsx)(g.Y,{className:Fe,src:p(t),isSelected:!1,isInvalid:!1,size:80}),(0,n.jsx)("div",{className:ke,onMouseEnter:c,children:(0,we.UX)()[e]})]},e)))})})]})}));var Pe=i(45033),De=i(53803),Re=i(56130);const Ue="root-Q49OJq",Oe="cover-gS1Ikh",Ae="selectStaticFrame-ts9UIy",Ze="titleField-B79mNJ",Ne="businessCheckbox-hxY8Up",Ve="highPriorityWrapper-zaPxnc",Be="multiLangVersionList-YvOCYN",ze=(0,a.Pi)((e=>{const{textTemplate:t}=e,{t:i}=(0,s.$)(),a=de();(0,r.useLayoutEffect)((()=>a.initTextTemplateForm(t)),[]);const{getDisplayLength:l}=(0,Pe._)(),o=k(t),{openFramePicker:c}=(0,xe.v)(),p=(0,ne.e)({watch:()=>k(t).staticFrame.list.length>0}),d=Boolean(t.languages[0].staticFrame.src),u=(0,r.useMemo)((()=>(0,h.Fl)((()=>t.languages.map((e=>({lang:e.lang,cover:e.cover})))))),[]),m=Boolean(t.onlineData.resourceId);return(0,n.jsxs)("div",{className:Ue,children:[(0,n.jsx)(g.Y,{className:Oe,src:o.staticFrame.src,isInvalid:!1,isSelected:!1,size:128}),(0,n.jsx)("div",{className:Ae,onClick:()=>{c({onOK:e=>a.handleStaticFrameChange(t,e),fetchData:async()=>{await p.start();const{list:e,index:t}=o.staticFrame;return{list:e,index:t}}})},children:i("pc_stickers_release_cover_edit_web")}),(0,n.jsx)(_e.l,{fieldClassName:Ze,label:i("pc_text_template_name_n_web"),field:"textTemplate.title",maxLength:40,allowEnter:!1,placeholder:i("pc_stickers_release_xy_name_web",{X:1,Y:l(40)}),rules:[{required:!0,message:""}],onChange:(0,h.aD)((e=>t.title=e))}),(0,n.jsx)(he.u,{label:(0,n.jsx)("div",{className:Re.Z.labelHeader,children:(0,n.jsx)(O.l0.Label,{required:!0,children:i("pc_text_template_tag_settings_web")})}),placeholder:i("please_enter_the_label_enter_key_to_confirm_the_input_web"),field:"textTemplate.tags",itemType:L.Ab.TextTemplate,recommendConfig:{title:t.title,uri:o.cover.uri},ignoreAddTagOnBlurSelector:`.${Re.Z.applyToAll}`,onChange:(0,h.aD)((e=>t.tags=e))}),t.isMultiLang&&(0,n.jsx)(je,{className:Be,loading:!d,languages:u.get()}),!1,(0,n.jsx)(Te.Z,{children:(0,n.jsxs)("div",{className:De.Z.authGroup,children:[(0,n.jsx)(Te._,{text:i("pc_template_authorize_range_web")}),(0,n.jsxs)("div",{className:De.Z.right,children:[(0,n.jsx)(ve.l,{noLabel:!0,field:"textTemplate.isVip",sendLogService:a.sendLogService}),(0,n.jsx)(ye.R,{fieldClassName:Ne,noLabel:!0,field:"textTemplate.isBusiness",vipField:"textTemplate.isVip",authorSignService:a.authorSignService,getAuthFileUploadService:()=>a.authFileUploadServiceManager.ensure(t.id),sendLogService:a.sendLogService})]})]})}),a.field.canHighPrio&&(0,n.jsx)(Te.Z,{className:Ve,hiddenFieldLabel:!0,children:(0,n.jsxs)("div",{className:De.Z.authGroup,children:[(0,n.jsx)(Te._,{text:i("pc_text_template_release_settings_web")}),(0,n.jsx)("div",{className:De.Z.right,children:(0,n.jsx)(O.z8,{noLabel:!0,field:"textTemplate.isHighPriority",disabled:m,children:i("pc_text_template_release_priority_web")})})]})})]})}));var Ee=i(88370);const $e="topSectionHeader-r1QPRt",Ke=(0,a.Pi)((e=>{const{className:t}=e,i=de(),{t:a}=(0,s.$)(),l=(0,c.Z)((()=>{})),o=(0,r.useRef)(null);return(0,p.O)({className:t,layout:i.mainFormLayout,uploadAreaProps:{titleForUploadArea:"",titleForMainForm:a("pc_text_template_add_click_web"),subTitle:"",draggingTitle:"",draggingDisabled:!0,disabled:!0,disabledTooltip:"",onClick:l,onDrop:l},setFormApi:i.setFormApi,renderImportArea:e=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.S,{className:$e,title:a("pc_text_template_n_collection_web",{X:i.textTemplateList.length})}),(0,n.jsx)(me,{}),i.flowerTextList.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.S,{title:a("pc_text_template_affiliated_web",{X:i.flowerTextList.length})}),(0,n.jsx)(fe,{})]})]}),renderFormArea:()=>i.textTemplateList.selected?(0,n.jsx)(ze,{textTemplate:i.textTemplateList.selected},i.textTemplateList.selectedId):i.flowerTextList.selected?(0,n.jsx)(Ee.p,{flowerText:i.flowerTextList.selected,initFlowerTextForm:i.initFlowerTextForm,applyTagsToAll:i.applyTagsToAll,maxTitleLength:40},i.flowerTextList.selectedId):null,scrollAreaRef:o,onRetry:i.retryInit})}));var He=i(74502),We=i(36775);const qe=(0,a.Pi)((e=>{const{className:t}=e,i=de(),{t:a}=(0,s.$)(),l=(0,r.useRef)(null),o=()=>{i.uploadAndPublish(l.current)},{showModal:c}=(0,S.ZP)({handleBtnText:a("pc_i_see_web"),closeIcon:!0,needReview:!0,protocol:S.YW.Creator,onOk:()=>{(0,w.F)(S.YW.Creator),o()}});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(He.P,{className:t,leftText:"",isPublishDisabled:!i.isReadyToPublish,isPublishing:i.isPublishing,needConfirmModalOnClose:i.needConfirmModalOnClose,onPublish:()=>{(0,w.K)(S.YW.Creator)?o():c()},onCancel:()=>(0,B.gk)({showHomePage:!1})}),(0,n.jsx)(We.q,{ref:l,uploadStats:i.uploadStats,onRetryUpload:i.retryUploadAndPublishDeps,onCancel:i.handleUploadCancel,onShowUploadFail:()=>{},onPromptConfirmToCancel:i.isAllUploadedWatcher.handlePromptConfirmToCancel})]})}));(0,a.Pi)((e=>{const[t,i]=(0,r.useState)(!1);(0,r.useEffect)((()=>{window.showStickerDebugWindow=()=>{var e,t;i(!0),null===(e=window.getSelection())||void 0===e||e.removeAllRanges(),null===(t=window.vconsole)||void 0===t||t.showSwitch()}}),[]);const a=(0,r.useRef)(null),{store:s}=window;return t?(0,n.jsxs)("div",{style:{position:"fixed",top:10,left:0,bottom:10,width:250,zIndex:2,backgroundColor:"white",padding:8,display:"flex",flexDirection:"column",overflow:"auto",color:"black"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)("div",{children:"\u5bfc\u5165\u7684\u6587\u5b57\u6a21\u677f\u72b6\u6001"}),(0,n.jsxs)("div",{style:{display:"flex"},children:[(0,n.jsx)("div",{style:{cursor:"pointer",marginInlineEnd:8},onClick:()=>{var e,t;const i=(null===(e=a.current)||void 0===e?void 0:e.innerText)||"",s=document.createElement("textarea");s.value=i,document.body.append(s),s.select(),document.execCommand("copy"),s.blur(),O.FN.info("\u590d\u5236\u6210\u529f"),null===(t=s.parentNode)||void 0===t||t.removeChild(s)},children:"\u590d\u5236"}),(0,n.jsx)("div",{style:{cursor:"pointer"},onClick:()=>i(!1),children:"\u5173\u95ed"})]})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr",rowGap:10,columnGap:8,marginTop:10},ref:a,children:[s.textTemplateList.materials.map(((e,t)=>(0,n.jsxs)(r.Fragment,{children:[e.languages.map(((i,a)=>(0,n.jsxs)(r.Fragment,{children:[(0,n.jsxs)("div",{children:["\u6587\u5b57\u6a21\u677f",t+1,(0,n.jsx)("br",{}),i.lang," ",0===a&&"\u4e3b"]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",rowGap:6},children:[0===a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:["id: ",e.id]}),(0,n.jsx)("div",{children:e.isMultiLang?`\u591a\u8bed\u8a00 resourceId: ${e.resourceId||"\u65e0"}`:"\u5355\u8bed\u8a00"})]}),(0,n.jsxs)("div",{children:["\u5355\u54c1 resourceId: ",i.resourceId||"\u65e0"]}),i.templateZipData.flowerTexts.map((e=>(0,n.jsxs)("div",{children:["\u9644\u5c5e\u82b1\u5b57: ",e.id]},e.id))),i.templateZipData.stickers.map((e=>(0,n.jsxs)("div",{children:["\u9644\u5c5e\u8d34\u7eb8: ",e.id]},e.id)))]})]},i.lang))),(0,n.jsx)("div",{children:"=========="}),(0,n.jsx)("div",{children:"===================="})]},t))),s.flowerTextList.materials.map(((e,t)=>(0,n.jsxs)(r.Fragment,{children:[e.subFlowerTexts.map(((i,a)=>(0,n.jsxs)(r.Fragment,{children:[(0,n.jsxs)("div",{children:["\u82b1\u5b57",t+1,(0,n.jsx)("br",{}),i.lang," ",0===a&&"\u4e3b"]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",rowGap:6},children:[0===a&&(0,n.jsxs)("div",{children:["groupId: ",e.groupId]}),(0,n.jsxs)("div",{children:["id: ",i.id]}),(0,n.jsxs)("div",{children:["resourceId: ",i.resourceId||"\u65e0"]})]})]},i.lang))),(0,n.jsx)("div",{children:"=========="}),(0,n.jsx)("div",{children:"==================="})]},t))),s.stickers.map(((e,t)=>(0,n.jsxs)(r.Fragment,{children:[(0,n.jsxs)("div",{children:["\u8d34\u7eb8",t+1]}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",rowGap:6},children:(0,n.jsxs)("div",{children:["id: ",e.id]})})]},t)))]})]}):null}));var Je=i(12904),Ge=i(65546),Ye=i(89100);const Qe=(0,a.Pi)((e=>{const t=ce(),{t:i}=(0,s.$)();return(0,Je.F)({title:i("pc_text_template_item_release_web"),pid:"publish-text-template-single"}),(0,Ge.d)(),(0,n.jsxs)(pe.Provider,{value:t,children:[(0,n.jsxs)("div",{className:Ye.Z.page,children:[(0,n.jsxs)("div",{className:Ye.Z.content,children:[(0,n.jsx)(o,{className:Ye.Z.instruction}),(0,n.jsx)(Ke,{className:Ye.Z.mainForm})]}),(0,n.jsx)(qe,{className:Ye.Z.footer})]}),!1]})}))},97311:(e,t,i)=>{i.d(t,{C3:()=>o,J9:()=>n,Jr:()=>r,lm:()=>c,y8:()=>l});var a=i(96706),s=i.n(a);const r=(e,t="image/png")=>{let i=e;e.startsWith("data:")&&(i=e.split(",")[1]);const a=atob(i),s=new Array(a.length);for(let l=0;l<a.length;l++)s[l]=a.charCodeAt(l);const r=new Uint8Array(s);return new Blob([r],{type:t})},l=e=>URL.createObjectURL(e),n=async e=>{const t=await fetch(e),i=await t.blob();return l(i)};const o=async e=>{const t=await e.arrayBuffer(),i=new Uint8Array(t);return s()(i)},c=e=>e.toLowerCase().split(".").pop()}}]);